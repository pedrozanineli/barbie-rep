1
                 Chemistry at HARvard Macromolecular Mechanics
           (CHARMM) - Developmental Version 47a2   February 15, 2021            
                                Revision unknown                                
       Copyright(c) 1984-2020  President and Fellows of Harvard College
                              All Rights Reserved
      Current operating system: Linux-3.10.0-1160.80.1.el7.x86_64(x86_64)       
                 Created on  6/2/24 at 13:17:08 by user: apache      

            Maximum number of ATOMS:    360720, and RESidues:      120240
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUN, 02. 2024. JOBID=1734830673
 RDTITL> * GENERATES IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    DIMENS CHSIZE 5000000 MAXRES 5000000 MAXGRP 5000000
Size      Original         New
MAXA        360720     5000000
MAXB        360720     5000000
MAXT        721440    10000000
MAXP       1082160    15000000
MAXIMP      180360     2500000
MAXNB        90180     1250000
MAXPAD      360720     5000000
MAXRES      120240     5000000
MAXSEG       45090      625000
MAXATC        1400
MAXCB         3000
MAXCT        50000
MAXCP        50000
MAXCI         1200
MAXCH         6400
MAXCN       502503
MAXCRT      120240     1666666
  
 CHARMM>     
  
 CHARMM>    ! Read topology and parameter files
 CHARMM>    stream toppar.str
 VOPEN> Attempting to open::toppar.str::
 OPNLGU> Unit 99 opened for READONLY access to toppar.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUN, 02. 2024. JOBID=1734830673
 RDTITL> * STREAM FILE FOR TOPOLOGY AND PARAMETER READING
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! protein topology and parameter
 CHARMM>    open read card unit 10 name toppar/top_all36_prot.rtf
 VOPEN> Attempting to open::toppar/top_all36_prot.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_prot.rtf
  
 CHARMM>    read  rtf card unit 10
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *>>>>>>>>CHARMM36 ALL-HYDROGEN TOPOLOGY FILE FOR PROTEINS <<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> MAY 2011 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36m_prot.prm
 VOPEN> Attempting to open::toppar/par_all36m_prot.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36m_prot.prm
  
 CHARMM>    read para card unit 20 flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *>>>> CHARMM36 ALL-HYDROGEN PARAMETER FILE FOR PROTEINS <<<<<<<<<<
 TITLE> *>>>>> INCLUDES PHI, PSI CROSS TERM MAP (CMAP) CORRECTION <<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *             PARAMETER SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! nucleic acids
 CHARMM>    open read card unit 10 name toppar/top_all36_na.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_na.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_na.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID TOPOLOGY FILE ////
 TITLE> *   ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                      APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 TITLE> *           PARAMETER SET DISCUSSION FORUM
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_na.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_na.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_na.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * \\\\ CHARMM36 ALL-HYDROGEN NUCLEIC ACID PARAMETER FILE ////
 TITLE> *         ALEXANDER D. MACKERELL JR. AND COWORKERS
 TITLE> *                        APRIL 2011
 TITLE> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG PARAMETER
 TITLE> *                     SET DISCUSSION FORUM
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! carbohydrates
 CHARMM>    open read card unit 10 name toppar/top_all36_carb.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_carb.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_carb.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * $ID: TOP_ALLXX_SUGAR.INP,V 1.106 2014/08/19 19:07:43 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN TOPOLOGIES USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_carb.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_carb.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_carb.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> * $ID: PAR_ALLXX_SUGAR.INP,V 1.132 2014/08/19 19:03:21 ALEX EXP $
 TITLE> *>>>>>>>>>>>> ALL-HYDROGEN PARAMETERS USED IN THE <<<<<<<<<<<<<<<<
 TITLE> *>>>>> DEVELOPMENT OF THE CHARMM CARBOHYDRATE  FORCE FIELD<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>>>>>>>>>>>> JUNE 2009 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 TITLE> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 TITLE> *>>>>>>>>>> VIA THE CHARMM WEB SITE: WWW.CHARMM.ORG <<<<<<<<<<<<<<
 TITLE> *>>>>>>>>>>>>>>> PARAMETER SET DISCUSSION FORUM <<<<<<<<<<<<<<<<<<
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! lipids
 CHARMM>    open read card unit 10 name toppar/top_all36_lipid.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_lipid.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_lipid.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID TOPOLOGY FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_lipid.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_lipid.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_lipid.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  \\\\\\\ CHARMM36 ALL-HYDROGEN LIPID PARAMETER FILE ///////
 TITLE> *  ALL COMMENTS AND QUESTIONS SHOULD BE SUBMITTED TO THE
 TITLE> *  PARAMETER FORUM AT THE CHARMM WEBSITE: WWW.CHARMM.ORG
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! CGENFF
 CHARMM>    open read card unit 10 name toppar/top_all36_cgenff.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_all36_cgenff.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_all36_cgenff.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *          CGENFF: TOPOLOGY FOR THE CHARMM GENERAL FORCE FIELD V. 4.6          *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *

 DRUDES PARTICLES WILL BE GENERATED AUTOMATICALLY FOR ALL ATOMS WITH NON-ZERO ALPHA
 Thole-type dipole screening, Slater-Delta shape {S(u) = 1 - (1+u/2)*exp(-u)}, default radius =  1.300000
  
 CHARMM>     
  
 CHARMM>    open read card unit 20 name toppar/par_all36_cgenff.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   20 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_all36_cgenff.prm::
 OPNLGU> Unit 20 opened for READONLY access to toppar/par_all36_cgenff.prm
  
 CHARMM>    read para card unit 20 append flex

          PARAMETER FILE BEING READ FROM UNIT 20
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *         CGENFF: PARAMETERS FOR THE CHARMM GENERAL FORCE FIELD V. 4.6         *
 TITLE> *                    FOR SMALL MOLECULE DRUG DESIGN                            *
 TITLE> *  --------------------------------------------------------------------------  *
 TITLE> *  2017/8: IF PROTEIN, NUCLEIC ACID AND CARBOHYDRATE TOPOLOGY AND PARAMETER FILES
 TITLE> *  ARE NOT READ PRIOR TO THE CGENFF FILES "WARNING: ATOMS IN NBFIX ' errors will
 TITLE> *  BE ENCOUNTERED.  THESE CAN BE PASSED BY SETTING BOMLEV ( -2) PRIOR TO READING
 TITLE> *  THIS FILE. IN ADDITION, WHEN GENERATING AROMATIC HALOGENS (CL, BR, I) WITH
 TITLE> *  PRE C41B/C42A VERSIONS OF CHARMM "MISSING PARAMETER" ERRORS WILL BE
 TITLE> *  ENCOUNTERED THAT ALSO REQUIRE SETTING BOMLEV ( -2).
 TITLE> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! Phosphates and Sulfates
 CHARMM>    stream toppar/toppar_all36_moreions.str
 VOPEN> Attempting to open::toppar/toppar_all36_moreions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_moreions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIONAL IONS GENERATED USING CGENFF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "345"
 Parameter: NAT <- "345"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "345"
 Parameter: NAT -> "345"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""345"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "345" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES GENERATED BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY
 RDTITL> * CHARMM GENERAL FORCE FIELD (CGENFF) PROGRAM VERSION 2.4.0
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Interface FF
 CHARMM>    open read card unit 10 name toppar/top_interface.rtf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/top_interface.rtf::
 OPNLGU> Unit 10 opened for READONLY access to toppar/top_interface.rtf
  
 CHARMM>    read  rtf card unit 10 append
 MAINIO> Residue topology file being read from unit  10.
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY FOR NANOMATERIALS
 TITLE> *
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO17      -1.050
*** WARNING **** residue TSHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES TSHO21      -1.050
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    open read card unit 10 name toppar/par_interface.prm
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::toppar/par_interface.prm::
 OPNLGU> Unit 10 opened for READONLY access to toppar/par_interface.prm
  
 CHARMM>    read para card unit 10 append flex

          PARAMETER FILE BEING READ FROM UNIT 10
 TITLE> * INTERFACE FF
 TITLE> * TOPOLOGY AND PARAMETER FOR CALY MINERALS, CEMENT MINERALS
 TITLE> *
 PARRDR> Error: Repeated DIHE parameter ( 10947): HGR6  ICG1  ICG1  ICGE is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    stream toppar/toppar_all36_nano_lig.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR NANO-LIGAND
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_nano_lig_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_nano_lig_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_nano_lig_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for synthetic polymer
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_synthetic_polymer_patch.str
 VOPEN> Attempting to open::toppar/toppar_all36_synthetic_polymer_patch.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_synthetic_polymer_patch.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_polymer_solvent.str
 VOPEN> Attempting to open::toppar/toppar_all36_polymer_solvent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_polymer_solvent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SYNTHETIC_POLYMER
 RDTITL> *
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SYNTHETIC POLYMER PARAMETER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for water and ions
 CHARMM>    stream toppar/toppar_water_ions.str
 VOPEN> Attempting to open::toppar/toppar_water_ions.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_water_ions.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR WATER AND IONS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_water_ions.inp
 CHARMM>     
  
 CHARMM>    ! IMPORTANT NOTE: this file contains NBFixes between carboxylates and sodium,
 CHARMM>    ! which will only apply if the main files containing carboxylate atom types
 CHARMM>    ! have been read in first!
 CHARMM>     
  
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !TIP3P water model
 CHARMM>    !
 CHARMM>    !W.L. Jorgensen; J.Chandrasekhar; J.D. Madura; R.W. Impey;
 CHARMM>    !M.L. Klein; "Comparison of simple potential functions for
 CHARMM>    !simulating liquid water", J. Chem. Phys. 79 926-935 (1983).
 CHARMM>    !
 CHARMM>    !IONS
 CHARMM>    !
 CHARMM>    !Ions from Roux and coworkers
 CHARMM>    !
 CHARMM>    !Beglov, D. and Roux, B., Finite Representation of an Infinite
 CHARMM>    !Bulk System: Solvent Boundary Potential for Computer Simulations,
 CHARMM>    !Journal of Chemical Physics, 1994, 100: 9050-9063
 CHARMM>    !
 CHARMM>    !ZINC
 CHARMM>    !
 CHARMM>    !Stote, R.H. and Karplus, M. Zinc Binding in Proteins and
 CHARMM>    !Solution: A Simple but Accurate Nonbonded Representation, PROTEINS:
 CHARMM>    !Structure, Function, and Genetics 23:12-31 (1995)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "468"
 Parameter: NAT <- "468"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "468"
 Parameter: NAT -> "468"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""468"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "468" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR WATER AND IONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for sodium interacting with
 CHARMM>    ! carboxylate oxygens of various CHARMM force fields. It will generate
 CHARMM>    ! level -1 warnings whenever any of these force fields have not been
 CHARMM>    ! read prior to the current stream file. Since we don't want to force
 CHARMM>    ! the user to always read all the force fields, we're suppressing the
 CHARMM>    ! warnings. The only side effect is that you will have "most severe
 CHARMM>    ! warning was at level 0" at the end of your output. Also note that
 CHARMM>    ! the user is responsible for reading the current file last if they
 CHARMM>    ! want the NBFixes to apply. A more elegant solution would require new
 CHARMM>    ! features to be added to CHARMM.
 CHARMM>    ! parallel fix, to avoid duplicated messages in the log
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CARBOXYLATE AND SODIUM
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_dum_noble_gases.str
 VOPEN> Attempting to open::toppar/toppar_dum_noble_gases.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_dum_noble_gases.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPLOGY AND PARAMETER INFORMATION FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_dum_nobel_gases.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous	toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "485"
 Parameter: NAT <- "485"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "485"
 Parameter: NAT -> "485"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""485"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "485" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR HELIUM, NEON AND A DUMMY ATOM.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_ions_won.str
 VOPEN> Attempting to open::toppar/toppar_ions_won.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_ions_won.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOP_IONS_WON.STR: GENERAL MODEL FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !This is a comprehensive set of ions developed using stochastic boundary
 CHARMM>    !conditions. It is strongly recommended that ion parameters in
 CHARMM>    !toppar_water_ions.str be used if available, as they are more highly
 CHARMM>    !optimized.  Accordingly, those ions have been commented in this
 CHARMM>    !file.
 CHARMM>    !
 CHARMM>    !reference
 CHARMM>    !Won, Y., "Force Field for Monovalent, Divalent, and Trivalent Cations
 CHARMM>    !Developed under the Solvent Boundary Potential," Journal of Physical
 CHARMM>    !Chemistry A., 116: 11763-11767, 2012.
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "488"
 Parameter: NAT <- "488"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "488"
 Parameter: NAT -> "488"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""488"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "488" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR WATER AND IONS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PAR_CATION.PRM FOR MONO-, DI-, AND TRIVALENT CATIONS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/cam.str
 VOPEN> Attempting to open::toppar/cam.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/cam.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY GENERATED BY PARMED
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <rtfrdr> *****
      ***** No AUTOgen defaults specified in appended RTF. Potential conflict with prior RTF autogen options. Check.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY PARMED
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    ! The following section contains NBFixes for CAM interacting with
 CHARMM>    ! water.
 CHARMM>    set para
 Parameter: PARA <- "" <empty>
  
 CHARMM>    if ?NUMNODE gt 1 set para node 0
 RDCMND substituted energy or value "?NUMNODE" to "1"
 Comparing "1" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set wrn ?WRNLEV
 RDCMND substituted energy or value "?WRNLEV" to "5"
 Parameter: WRN <- "5"
  
 CHARMM>    ! Some versions of CHARMM don't seem to initialize wrnlev...
 CHARMM>    if "@WRN" eq "?WRNLEV" set wrn 5
 Parameter: WRN -> "5"
 RDCMND: can not substitute energy "?WRNLEV""
 Comparing ""5"" and ""?WRNLEV"".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    set bom ?bomlev
 RDCMND substituted energy or value "?BOMLEV" to "0"
 Parameter: BOM <- "0"
  
 CHARMM>    WRNLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>    BOMLEV -1 @PARA
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NBFIX BETWEEN CAM AND WATER
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    BOMLEV @bom @PARA
 Parameter: BOM -> "0"
 Parameter: PARA -> "" <empty>
  
 CHARMM>    WRNLEV @wrn @PARA
 Parameter: WRN -> "5"
 Parameter: PARA -> "" <empty>
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for protein
 CHARMM>    stream toppar/toppar_all36_prot_arg0.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_arg0.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_arg0.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>> ALL-HYDROGEN TOPOLOGY FOR NEUTRAL ARG <<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> 2007 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Atom names include "R" (for Arg) as the second letter. The
 CHARMM>    ! only other atom types in the additive FF with this second
 CHARMM>    ! letter are histidine [HN]R[123] in the protein FF and CRL[12]
 CHARMM>    ! in toppar_all36_lipid_cholesterol.str , so no more conflicts.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.rtf
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_arg0.inp
 CHARMM>     
  
 CHARMM>    !Li, L., Vorobyov, I.V., MacKerell, Jr., A.D., Allen, T.W., "Is
 CHARMM>    !arginine charged in a membrane?" Biophysical Journal, 94: L11-L13,
 CHARMM>    !2008, PMCID: PMC2157258
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MGU1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU1          0.00
*** WARNING **** residue MGU2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGU2          0.00
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_c36m_d_aminoacids.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_c36m_d_aminoacids.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_c36m_d_aminoacids.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>>>CHARMM36 ALL-HYDROGEN TOPPAR FILE FOR D-PROTEINS <<<<<<<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>>>>> JAN. 2016 <<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> * ALL COMMENTS TO THE CHARMM WEB SITE: WWW.CHARMM.ORG
 RDTITL> *             PARAMETER SET DISCUSSION FORUM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !update 2016/2. use directly inverted CMAPs
 CHARMM>     
  
 CHARMM>    !toppar stream file for D-amino acids. Includes new residue
 CHARMM>    !names, inverted CMAP and additional parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36m_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_d_amino_acid.inp
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "554"
 Parameter: NAT <- "554"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "554"
 Parameter: NAT -> "554"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""554"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "554" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR D- AMINOACIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR D- AMINOACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_fluoro_alkanes.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_fluoro_alkanes.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_fluoro_alkanes.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR FLUORINATED ALKANES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !These parameters are maintained for historic reasons.  The CGenFF
 CHARMM>    !halogen parameters are a significant improvement over these
 CHARMM>    !parameters.
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_fluoro_alkanes.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Chen, I.-J., Yin, D. and MacKerell, Jr., A.D., "Combined Ab
 CHARMM>    !initio/Empirical Approach for Optimization of Lennard-Jones Parameters
 CHARMM>    !for Polar-Neutral Compounds," Journal of Computational Chemistry,
 CHARMM>    !2002, 23:199-213.
 CHARMM>    !
 CHARMM>    !Note that these parameters are higly optimized to reproduce the
 CHARMM>    !corresponding condensed phase properties and have not been incorporated
 CHARMM>    !into the CHARMM22 or CHARMM27 biomolecular force fields
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR FLUOROALKANES
 RDTITL> *
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA  0.0
*** WARNING **** residue FETH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FETH  0.0
*** WARNING **** residue DFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DFET 0.0
*** WARNING **** residue TFET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFET  0.0
*** WARNING **** residue TFE  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TFE   0.0
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * FLUOROALKANE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_heme.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_heme.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_heme.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR HEME AND RELATED
 RDTITL> * LIGANDS AND PATCHES.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !updated 2016/2, allow for use of AUTOGENERATE ANGLE DIHEDRAl PATCH
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_heme.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR HEME AND RELATED COMPOUNDS AND PATCHES
 RDTITL> *
*** WARNING **** residue CO2  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO2             0.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR HEME
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_na_combined.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_na_combined.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_na_combined.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETER STREAM FILE FOR PATCHES TO CREATE
 RDTITL> * MODEL COMPOUNDS AND PATCHES THAT REQUIRE BOTH PROTEIN AND
 RDTITL> * NUCLEIC ACID TOPOLOGY AND PARAMETER INFORMATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>    !stream/toppar_all36_prot_fluoro_alkanes.str ! atom types an parameters for fluorinated compounds
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_na_combined.inp
 CHARMM>     
  
 CHARMM>    !all patches must be followed by AUTOGENERATE ANGLES DIHEDRALS
 CHARMM>     
  
 CHARMM>    !PHOSPHOTYROSINE
 CHARMM>    !
 CHARMM>    !Feng, M.-H., Philippopoulos, M., MacKerell, Jr., A.D. and Lim, C.
 CHARMM>    !Structural Characterization of the Phosphotyrosine Binding Region of a
 CHARMM>    !High-Affinity aSH2 Domain-Phosphopeptide Complex by Molecular Dynamics
 CHARMM>    !Simulation and Chemical Shift Calculations. Journal of the American
 CHARMM>    !Chemical Society, 1996, 118: 11265-11277.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
*** WARNING **** residue THFI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFI       0.00
*** WARNING **** residue THMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THMI       0.00
*** WARNING **** residue THFA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THFA        0.00
*** WARNING **** residue THAO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI THAO         0.00
*** WARNING **** residue RNUS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RNUS         0.00
*** WARNING **** residue NUCL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NUCL        -1.00
*** WARNING **** residue PPH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPH1      -1.00
*** WARNING **** residue BMPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPH      -1.00
*** WARNING **** residue BMPD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BMPD      -2.00
*** WARNING **** residue BDFP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFP      -1.00
*** WARNING **** residue BDFD already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BDFD -2.00
*** WARNING **** residue EP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EP_2        -2.00
*** WARNING **** residue IP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IP_2        -2.00
 There were  13 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR PHOSPHORYLATED AMINO ACIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_retinol.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_retinol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_retinol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR RETINOL AND RETINAL PARAMETERS
 RDTITL> * A. LOCCISANO, A.M.W., J. EVANSECK AND A.D. MACKERELL, JR.
 RDTITL> * APRIL, 2005
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !use with c36 protein force fields
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * RETINAL/RETINOL AND RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue 13DB already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DB       0.00
*** WARNING **** residue 13DP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI 13DP       0.00
*** WARNING **** residue DMB1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMB1       0.00
*** WARNING **** residue DMP1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP1       0.00
*** WARNING **** residue DMP2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMP2       0.00
*** WARNING **** residue CROT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CROT       0.00
*** WARNING **** residue PACP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PACP       0.00
*** WARNING **** residue MECH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MECH       0.00
*** WARNING **** residue TMCH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TMCH       0.00
*** WARNING **** residue FRET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FRET       0.00
*** WARNING **** residue RTOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTOL       0.00
*** WARNING **** residue RTAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAL       0.00
*** WARNING **** residue RTAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI RTAC      -1.00
*** WARNING **** residue PRAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAC      -1.00
*** WARNING **** residue PROL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROL       0.00
*** WARNING **** residue PRAL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRAL       0.00
*** WARNING **** residue SCH1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH1       0.00
*** WARNING **** residue SCH2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH2       1.00
*** WARNING **** residue SCH3 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI SCH3       1.00
 There were  20 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * RETINAL/RETINOL AND RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>> ALL-HYDROGEN TOPOLOGY FOR SMALL MODEL COMPOUNDS USED IN THE <<
 RDTITL> *>> DEVELOPMENT OF THE CHARMM22 PROTEIN ALL-HYDROGEN PARAMETERS <<
 RDTITL> *>>>>>>>>>>>>>>>>>>>>>>> JULY 1997 <<<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
 RDTITL> *>>>>>>>> DIRECT COMMENTS TO ALEXANDER D. MACKERELL JR. <<<<<<<<<<
 RDTITL> *>>>>>>>>>>>>>>> PARAMETER FORUM, WWW.CHARMM.ORG <<<<<<<<<<<<<<<<<
 RDTITL> *CONVERTED TO STREAM FORMAT, DECEMBER 2003
 RDTITL> *CONVERTED TO CHARMM36 PROTEIN ATOM TYPES, MAY 2011
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_prot.rtf
 CHARMM>    !par_all36_prot.prm
 CHARMM>    !
 CHARMM>    !Testcase
 CHARMM>    !test_all36_prot_model.inp
 CHARMM>     
  
 CHARMM>    !changes after 9/98
 CHARMM>    !
 CHARMM>    !change alkene HA1 and HA2 to HE1 and HE2
 CHARMM>    !
 CHARMM>    !improper atom ordering corrected
 CHARMM>    !
 CHARMM>    !version b5i to be consistent with protein toppar files
 CHARMM>    !
 CHARMM>    !Heme vinyl groups upgraded based on new butene parameters
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    ! references
 CHARMM>    !
 CHARMM>    !PROTEINS
 CHARMM>    !
 CHARMM>    !MacKerell, Jr., A. D.; Bashford, D.; Bellott, M.; Dunbrack Jr., R.L.;
 CHARMM>    !Evanseck, J.D.; Field, M.J.; Fischer, S.; Gao, J.; Guo, H.; Ha, S.;
 CHARMM>    !Joseph-McCarthy, D.; Kuchnir, L.; Kuczera, K.; Lau, F.T.K.; Mattos,
 CHARMM>    !C.; Michnick, S.; Ngo, T.; Nguyen, D.T.; Prodhom, B.; Reiher, III,
 CHARMM>    !W.E.; Roux, B.; Schlenkrich, M.; Smith, J.C.; Stote, R.; Straub, J.;
 CHARMM>    !Watanabe, M.; Wiorkiewicz-Kuczera, J.; Yin, D.; Karplus, M.  All-atom
 CHARMM>    !empirical potential for molecular modeling and dynamics Studies of
 CHARMM>    !proteins.  Journal of Physical Chemistry B, 1998, 102, 3586-3616.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR PROTEIN RELATED MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue ACET already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACET       -1.00
*** WARNING **** residue PROA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PROA       -1.00
*** WARNING **** residue GUAN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GUAN        1.00
*** WARNING **** residue MGUA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MGUA        1.00
*** WARNING **** residue GLYN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYN         0.00
*** WARNING **** residue MAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAMM        1.00
*** WARNING **** residue EAMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EAMM        1.00
*** WARNING **** residue ACEH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEH        0.00
*** WARNING **** residue MEOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MEOH        0.00
*** WARNING **** residue METO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI METO       -1.00
*** WARNING **** residue ETOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETOH        0.00
*** WARNING **** residue ETO  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETO        -1.00
*** WARNING **** residue PRO2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRO2        0.00
*** WARNING **** residue FORM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI FORM        0.00
*** WARNING **** residue ACEM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACEM        0.00
*** WARNING **** residue NMA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NMA         0.00
*** WARNING **** residue MESH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MESH        0.00
*** WARNING **** residue MES1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MES1       -1.00
*** WARNING **** residue ETSH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETSH        0.00
*** WARNING **** residue ES1  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ES1        -1.00
*** WARNING **** residue DMDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DMDS        0.00
*** WARNING **** residue DEDS already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DEDS        0.00
*** WARNING **** residue EMS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EMS         0.00
*** WARNING **** residue IMIA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIA        0.00
*** WARNING **** residue MIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MIMI        0.00
*** WARNING **** residue EIMI already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMI        0.00
*** WARNING **** residue IMIM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IMIM        1.00
*** WARNING **** residue EIMM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIMM        1.00
*** WARNING **** residue BENZ already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BENZ        0.00
*** WARNING **** residue EBEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EBEN         0.00
*** WARNING **** residue PHEN already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEN        0.00
*** WARNING **** residue EPHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EPHE        0.00
*** WARNING **** residue PHEO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PHEO       -1.00
*** WARNING **** residue INDO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI INDO        0.00
*** WARNING **** residue EIND already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI EIND        0.00
*** WARNING **** residue PDIP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PDIP        0.00
*** WARNING **** residue ETHA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHA        0.00
*** WARNING **** residue PRPA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPA        0.00
*** WARNING **** residue IBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI IBUT        0.00
*** WARNING **** residue OCOH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI OCOH    0.0
*** WARNING **** residue CO3  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CO3  -2.0
*** WARNING **** residue C3   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI C3    0.00
 There were  42 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_prot_modify_res.str
 VOPEN> Attempting to open::toppar/toppar_all36_prot_modify_res.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_prot_modify_res.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR FILE FOR VARIOUS MODIFIED RESIDUES AND PATCHES, INCLUDING
 RDTITL> * PATCHES TO COVALENTLY LINK RESIDUES TO IONS TO WORK WITH THE
 RDTITL> * ADDITIVE C36 PROTEIN FORCE FIELD
 RDTITL> * REQUIRES CGENFF PARAMETER FILE
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Acetyllysine (ALY)
 CHARMM>    !Norleucine (NLE) and
 CHARMM>    ! residues and patches for Zn-protein interactions modeled using
 CHARMM>    ! bond and angles between the protein and Zn.
 CHARMM>     
  
 CHARMM>    !non-standard amino acids: 2021
 CHARMM>    !Croitoru, A., Park, S.-J., Kumar, A., Lee, J., Im, Wonpil; MacKerell,
 CHARMM>    !A.D., Jr., and Aleksandrov, A. Additive CHARMM36 Force Field for
 CHARMM>    !Nonstandard Amino Acids, Journal of Chemical Theory and Computation,
 CHARMM>    !17:3554-3570, doi: 10.1021/acs.jctc.1c00254.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPPAR FILE PROTEIN MODIFICATIONS
 RDTITL> *
*** WARNING **** residue CGU  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGU              -2.000
*** WARNING **** residue CME  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CME               0.000
*** WARNING **** residue HIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HIC               0.000
*** WARNING **** residue HICP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HICP              1.000
*** WARNING **** residue CGUP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CGUP             -1.000
 There were   5 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL>  
 RDTITL> No title read.
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for nucleic acids
 CHARMM>    stream toppar/toppar_all36_na_nad_ppi.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_nad_ppi.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_nad_ppi.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN NUCLEIC ACID FORCE TOPPAR STREAM FILE
 RDTITL> * NAD+, NADH, ADP, ATP, PPI AND RELATED ANALOGS
 RDTITL> * A.D. MACKERELL, JR., JULY 2001
 RDTITL> * STREAM FOLLOWING RTF AND PARAM READ OF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Update, 2015/1, nomenclature for NAD+ etc. consistent with PDB
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_na.rtf
 CHARMM>    !par_all36_na.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_na_nad_ppi.inp
 CHARMM>     
  
 CHARMM>    !Reference
 CHARMM>    !Pavelites, J.J., Bash, P.A., Gao, J., and MacKerell, Jr.,
 CHARMM>    !A.D. A Molecular Mechanics Force Field for NAD+, NADH and the
 CHARMM>    !Pyrophosphate Groups of Nucleotides, Journal of Computational
 CHARMM>    !Chemistry, 1997, 18: 221-239.
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * NAD, PPI TOPOLOGY
 RDTITL> *
*** WARNING **** residue NIC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NIC         1.00
*** WARNING **** residue NICH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NICH         0.00
*** WARNING **** residue PPI1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI1        -3.00
*** WARNING **** residue PPI2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PPI2        -2.00
*** WARNING **** residue AMP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI AMP         -2.00
*** WARNING **** residue ADP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ADP         -3.00
*** WARNING **** residue ATP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ATP         -4.00
*** WARNING **** residue 5DP  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          PRES 5DP         -3.00
*** WARNING **** residue NAD  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NAD         -1.00
*** WARNING **** residue NADH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADH        -2.00
*** WARNING **** residue NADP already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NADP        -2.00
*** WARNING **** residue NDPH already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NDPH        -3.00
 There were  12 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NAD, PPI PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_na_rna_modified.str
 VOPEN> Attempting to open::toppar/toppar_all36_na_rna_modified.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_na_rna_modified.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * ADDITIVE CHARMM FORCE FIELD FOR MODIFIED RIBONUCLEIC ACIDS, INCLUDING
 RDTITL> * THOSE FOUNDS IN TRNA. YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> * |
 RDTITL> * WARNING: PARAMETERS AND ATOM TYPE ASSIGNMENTS IN THIS FILE ARE SPECIFIC
 RDTITL> * FOR THESE COMPOUNDS AND SHOULD UNDER NO CIRCUMSTANCES BE APPLIED TO
 RDTITL> * OTHER ORGANIC MOLECULES
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! Xu, Y., Vanommeslaeghe, K., Aleksandrov, A., MacKerell, A.D.,
 CHARMM>    ! Jr. Nilsson, L., “Additive CHARMM force field for naturally
 CHARMM>    ! occurring modified ribonucleotides,” Journal of Computational
 CHARMM>    !  Chemistry, DOI: 10.1002/jcc.24307, 2016
 CHARMM>     
  
 CHARMM>    ! Should be used with parent files CGenFF: top_all36_cgenff.inp and par_all36_cgenff.inp
 CHARMM>    !                                    NA36: top_all36_na.inp and par_all36_na.inp
 CHARMM>    !                              and Carb36: top_all36_carb.inp and par_all36_carb.inp
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGIES OF MODIFIED NUCLEOTIDES
 RDTITL> *
*** WARNING **** residue BUG  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUG           -1.00
 There were   1 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIVE CHARMM PARAMETERS FOR MODIFIED NUCLEIC ACIDS, BETA VERSION
 RDTITL> * YOU XU, KAROLINSKA INSTITUTET, 2015.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for lipids
 CHARMM>    stream toppar/toppar_all36_lipid_sphingo.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_sphingo.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_sphingo.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FOR CERAMIDES AND SPINGOMYELINS; REQUIRES FLEX FORMAT FILES
 RDTITL> * TOP_ALL36_LIPID.RTF AND PAR_ALL36_LIPID.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! PSM and SSM Lipids
 CHARMM>    !
 CHARMM>    ! Venable, R. M.; Sodt, A. J.; Rogaski, B.; Rui, H.; Hatcher, E.; MacKerell, A. D.;
 CHARMM>    ! Pastor, R. W.; Klauda, J. B., CHARMM All-Atom Additive Force Field for Sphingomyelin:
 CHARMM>    ! Elucidation of Hydrogen Bonding and of Positive Curvature. Biophys. J. 2014, 107 (1), 134-145
 CHARMM>    !
 CHARMM>    ! Ceramide
 CHARMM>    !
 CHARMM>    ! Submited by Sam Tonddast-Navaei of U. Cincinnati. Advised by Russell Devane
 CHARMM>    ! Tested by Eric Wang of U. Maryland. Advised by Jeffery Klauda
 CHARMM>    !
 CHARMM>    !
 CHARMM>    ! CerAP/Cer6, CerNP/Cer3, and CerEOS/Cer1
 CHARMM>    !
 CHARMM>    ! Wang, E.; Klauda, J. B., Structure and Permeability of Ceramide Bilayers and Multilayers.
 CHARMM>    ! J. Phys. Chem. B., 2019, 123, 11, 2525-2535
 CHARMM>    ! Wang, E.; Klauda, J. B., Molecular Structure of the Long Periodicity Phase in the Stratum Corneum.
 CHARMM>    ! J. Amer. Chem. Soc., 2019. 141, 42, 16930-16943
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "585"
 Parameter: NAT <- "585"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "585"
 Parameter: NAT -> "585"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""585"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "585" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CER/SM RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 14758): NHL   C     CTO1  HAL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 14779): O     C     CTO1  HAL1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_archaeal.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_archaeal.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_archaeal.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR ARCHAEAL LIPIDS.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! This is an on-going file of archaeal lipids
 CHARMM>    ! I am adding meanquinone-7 now
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * ARCHAEAL LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS GENERATED BY ANALOGY BY CGENFF
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_bacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_bacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_bacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! REFERENCES
 CHARMM>    !
 CHARMM>    ! Branched Lipids
 CHARMM>    !
 CHARMM>    ! Lim, J.B. & Klauda, J.B. Branching at the Iso- and Anteiso- Positions in Complex Chlamydia
 CHARMM>    ! Membranes: A Molecular Dynamics Study. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1808:323-331 (2011).
 CHARMM>    !
 CHARMM>    ! Cyclic-replacement of double bond
 CHARMM>    !
 CHARMM>    ! Pandit, K.R. & Klauda, J.B. Membrane models of E. coli containing cyclic moieties in
 CHARMM>    ! the aliphatic lipid chain. Biochimica et Biophysica Acta (BBA) - Biomembranes
 CHARMM>    ! 1818:1205-1210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cardiolipin.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cardiolipin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cardiolipin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL>  
 RDTITL> No title read.
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_cholesterol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_cholesterol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_cholesterol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR CHOLESTEROL.  STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> * TOP_ALL36_CGENFF.RTF
 RDTITL> * AND PAR_ALL36_CGENFF.PRM
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !topology and parameters are included for two cholesterol models. the
 CHARMM>    !model may be selected by setting variable chol_model to 1 or 2, as
 CHARMM>    !specified below
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set chol_model 1 !2 for original Suits et al. model
 Parameter: CHOL_MODEL <- "1"
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    !1) Revised model of Lim et al.  This contains a number of NBFIXes that
 CHARMM>    !makes it unsuitable for ANTON (set chol_model 1)
 CHARMM>    !
 CHARMM>    !2) Original model of Suits et al., which is used on ANTON as well as
 CHARMM>    !being suitable for other systems (set chol_model 2 (or anything but 1....))
 CHARMM>    !
 CHARMM>    !references
 CHARMM>    !
 CHARMM>    !Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    !Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>    !Suits, F., Pitman, M., MacKerell, A.D., Jr., Feller, S.E. "Molecular Level
 CHARMM>    !Organization of Saturated and Polyunsaturated Fatty Acids in a
 CHARMM>    !Phosphatidylcholine Bilayer Containing Cholesterol" Biochemistry,
 CHARMM>    !43(49):15318-28, 2004
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    !test "append"
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have priority, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    if chol_model eq 1 then
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>    ! reference
 CHARMM>    ! Lim, J.B., Rogaski, B. and Klauda, J.B.. "Update of the Cholesterol Force Field
 CHARMM>    ! Parameters in CHARMM" 116: 203-210 (2012).
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR CHOLESTEROL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CHOLESTEROL PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated DIHE parameter ( 15118): OG31  CG30  CG3C  CG3C is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15119): OG31  CG30  CG3C  CG3R is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15120): OG31  CG30  CG3C  HGA1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15118): OG31  CG30  CG3C  CG3C is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15119): OG31  CG30  CG3C  CG3R is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15120): OG31  CG30  CG3C  HGA1 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_dag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_dag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_dag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM DAG
 RDTITL> *
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_inositol.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_inositol.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_inositol.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR INOSITOL-BASED LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lnp.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lnp.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lnp.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LNP
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
 **** WARNING from RTFRDR **** The total charge of the residue, DAGP,  -0.0100000,
 does not equal the expected charge,   0.0000000.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
          PRES DPEPEG
 **** WARNING from RTFRDR **** The total charge of the residue, DPEP,  -0.0100000,
 does not equal the expected charge,   0.0000000.
 There were   2 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * LNP
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_lps.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_lps.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_lps.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR LIPIDA FROM LPS
 RDTITL> *
 WARNING from DECODI -- Zero length string being converted to 0
 RTFRDR> WARNING: Version number is NOT specified.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read param card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_mycobacterial.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_mycobacterial.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_mycobacterial.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF, PAR_ALL36_LIPID.PRM
 RDTITL> * AND
 RDTITL> * TOPPAR_ALL36_LIPID_BACTERIAL.STR
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARRDR> Error: Repeated ANGLE parameter (  5023): CEL1  CEL1  CTL1 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15365): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15366): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15365): CTL2  CG2O  CTL1  CTL3 is replaced
 PARRDR> Error: Repeated DIHE parameter ( 15366): CTL2  CG2O  CTL1  CTL3 is replaced
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_miscellaneous.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_miscellaneous.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_miscellaneous.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR MISCELLANEOUS LIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETER FOR ACYL PYROPHOSPHATE: ADDED 2019_7
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_model.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_model.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_model.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN LIPID FORCE FIELD TOPPAR STREAM FILE
 RDTITL> * COLLECTION OF RESIDUES AND PATCHES FOR MODEL COMPOUNDS USED
 RDTITL> * IN THE OPTIMIZATION THE LIPID FORCE FIELD.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>     
  
 CHARMM>    !Testcase
 CHARMM>    !test_all36_lipid_model.inp
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 LIPID MODEL COMPOUNDS
 RDTITL> *
*** WARNING **** residue MAS  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MAS          0.00
*** WARNING **** residue ETAC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAC         0.00
*** WARNING **** residue MPRO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MPRO         0.00
*** WARNING **** residue MP_1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_1        -1.00
*** WARNING **** residue MP_2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MP_2        -2.00
*** WARNING **** residue MSO4 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MSO4        -1.00
*** WARNING **** residue BUTA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BUTA         0.00
*** WARNING **** residue PENT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PENT         0.00
*** WARNING **** residue HEXA already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI HEXA         0.00
*** WARNING **** residue ETHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETHE       0.00
*** WARNING **** residue PRPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PRPE       0.00
*** WARNING **** residue BTE1 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE1       0.00
*** WARNING **** residue BTE2 already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI BTE2       0.00
*** WARNING **** residue DIPE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIPE       0.00
*** WARNING **** residue DIHE already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI DIHE       0.00
*** WARNING **** residue NC4  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC4          1.00
*** WARNING **** residue NC5  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI NC5          1.00
*** WARNING **** residue CHOL already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI CHOL         1.00
*** WARNING **** residue ACHO already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ACHO         1.00
*** WARNING **** residue PC   already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI PC           0.00
*** WARNING **** residue GPC  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GPC          0.00
*** WARNING **** residue TEA  already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI TEA          1.00
*** WARNING **** residue ETAM already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI ETAM       1.00
*** WARNING **** residue GLYC already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI GLYC         0.00
*** WARNING **** residue MBUT already exists (old one deleted)

      ***** LEVEL  1 WARNING FROM <RTFRDR> *****
      ***** Residue already exists.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

          RESI MBUT         0.00
 There were  25 warning(s) from RTFRDR.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_prot.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_prot.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_prot.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPOLOGY AND PARAMETERS FOR LIPID TAIL LINKERS TO CYSTEINE AND GLYCINE,
 RDTITL> * FOR EXAMPLE, PALMITOYLATION, MARISTOYLATION, FERNASYLATION, GERANYLATION
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * LIPID-MODIFIED PROTEIN RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * CYSTEIN-PALMITATE PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_tag.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_tag.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_tag.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TRIACYLGLYCEROLS [STEPHEN GEE FROM LEHIGH UNIVERSITY]
 RDTITL> *
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_yeast.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_yeast.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_yeast.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR BRANCHED AND CYCLIC CHAINED LIPIDS.  FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * CHOLESTEROL RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_hmmm.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_hmmm.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_hmmm.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND FLEX
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append flex
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR TERMINAL PATCHES FOR HMMM TRUNCATED LIPIDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * NEW PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_detergent.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_detergent.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_detergent.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * TOPPAR STREAM FILE FOR DETERGENTS AND FATTY ACIDS.
 RDTITL> * STREAM FOLLOWING READING OF
 RDTITL> * TOP_ALL36_LIPID.RTF
 RDTITL> * AND
 RDTITL> * PAR_ALL36_LIPID.RTF
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Additional residues added by Im lab, Aug. 2017
 CHARMM>     
  
 CHARMM>    !Fatty acids added Jan. 2016
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * DETERGENT AND FATTY ACID RESIDUES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read para card append flex

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * SB3-12 AND SB3-14 PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_ether.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_ether.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_ether.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> * CHARMM36 ALL-HYDROGEN ETHER LIPID FORCE FIELD INCLUDING PLASMALOGENS ALISON
 RDTITL> * N. LEONARD (A. L.), 7/18 WITH RICHARD PASTOR AND JEFFERY KLAUDA, JPCB 122(26)
 RDTITL> * PP. 6744 - 6754.  ANA WEST, 1/20 WITH VALERIA ZONI, WALTER TEAGUE JR., ALISON
 RDTITL> * LEONARD, STEFANO VANNI, KLAUS GAWRISCH, STEPHANIE TRISTAM-NAGLE, JONATHAN
 RDTITL> * SACHS, AND JEFFERY KLAUDA, JPCB 124(5) PP. 828 - 839.
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    !Parent files that have to be read prior to streaming this file
 CHARMM>    !top_all36_lipid.rtf
 CHARMM>    !par_all36_lipid.prm
 CHARMM>    !top_all36_cgenff.rtf
 CHARMM>    !par_all36_cgenff.prm
 CHARMM>     
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * C36 ETHER MODEL COMPOUNDS
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.

      ***** LEVEL  1 WARNING FROM <DECODF> *****
      ***** Zero length string
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

 WARNING from DECODF -- Zero length string being converted to 0.
  
 CHARMM>     
  
 CHARMM>    read para card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_lipid_oxidized.str
 VOPEN> Attempting to open::toppar/toppar_all36_lipid_oxidized.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_lipid_oxidized.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR OXIDIZED PHOSPHOLIPID
 RDTITL> *

      ***** LEVEL  1 WARNING FROM <rtfrdr> *****
      ***** No AUTOgen defaults specified in appended RTF. Potential conflict with prior RTF autogen options. Check.
      ******************************************
      BOMLEV (  0) IS NOT REACHED. WRNLEV IS  5

  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * ADDITIONAL PARAMETERS FOR OXIDIZED PHOSPHOLIPIDS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for carbohydrates
 CHARMM>    stream toppar/toppar_all36_carb_glycolipid.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycolipid.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycolipid.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOLIPIDS
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PIP RELATED PARAMETERS
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_glycopeptide.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_glycopeptide.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_glycopeptide.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR GLYCOPEPTIDE LINKAGES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> *    NEW PARAMETES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_carb_imlab.str
 VOPEN> Attempting to open::toppar/toppar_all36_carb_imlab.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_carb_imlab.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * GLYCAN CHEMICAL MODIFICATION PATCHES
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    RETURN
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>    ! Additional topologies and parameters for spin/fluorophore labels
 CHARMM>    stream toppar/toppar_all36_label_spin.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_spin.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_spin.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> *>>>>> TOPOLOGY FOR NITROXYDE SPIN LABELS <<<<<<<
 RDTITL> * SHAHIDUL M. ISLAM, UNIVERSITY OF CHICAGO
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    ! please reference the following:
 CHARMM>    !Sezer, D., Freed J. H., and Roux, B. “Parametrization, Molecular Dynamics Simulation, and Calculation of Electron Spin
 CHARMM>    !Resonance Spectra of a Nitroxide Spin Label on a Polyalanine alpha-Helix” J. Phys. Chem. B 2008, 112, 5755-5767
 CHARMM>     
  
 CHARMM>    !Islam, S. M., and Roux, B. “Parameterization and molecular dynamics simulations of a
 CHARMM>    !conformationally constrained double linked spin label constrained by EPR/DEER data”
 CHARMM>    !(planed submission to J journal)
 CHARMM>     
  
 CHARMM>    !test "append" to determine if previous toppar files have been read and
 CHARMM>    !add append to "read rtf card" if true
 CHARMM>    set nat ?NATC
 RDCMND substituted energy or value "?NATC" to "590"
 Parameter: NAT <- "590"
  
 CHARMM>    set app
 Parameter: APP <- "" <empty>
  
 CHARMM>    !We're exploiting what is arguably a bug in the parser. On the left hand side,
 CHARMM>    !the quotes have proirity, so NAT is correctly substituted. On the right hand
 CHARMM>    !side, the ? has priority and NATC" (sic) is not a valid substitution...
 CHARMM>    if "@NAT" ne "?NATC" if @nat ne 0 set app append
 Parameter: NAT -> "590"
 Parameter: NAT -> "590"
 RDCMND: can not substitute energy "?NATC""
 Comparing ""590"" and ""?NATC"".
 IF test evaluated as true.  Performing command
 Comparing "590" and "0".
 IF test evaluated as true.  Performing command
 Parameter: APP <- "APPEND"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read rtf card @app
 Parameter: APP -> "APPEND"
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FOR SPIN LABEL
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    read para card flex @app
 Parameter: APP -> "APPEND"

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * PARAMETERS FOR SPIN LABEL
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 CHARMM>    return
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>    stream toppar/toppar_all36_label_fluorophore.str
 VOPEN> Attempting to open::toppar/toppar_all36_label_fluorophore.str::
 OPNLGU> Unit 98 opened for READONLY access to toppar/toppar_all36_label_fluorophore.str

                    INPUT STREAM SWITCHING TO UNIT    98
 RDTITL> READ RTF CARD APPEND
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>    read rtf card append
 MAINIO> Residue topology file being read from unit  98.
 RDTITL> * TOPOLOGY FILES
 RDTITL> *
  
 CHARMM>     
  
 CHARMM>    read param card flex append

          PARAMETER FILE BEING READ FROM UNIT 98
 RDTITL> * MINI FORCE FIELD PARAMETER FILE.
 RDTITL> *
 PARMIO> NONBOND, HBOND lists and IMAGE atoms cleared.
  
 CHARMM>     
  
 VCLOSE: Closing unit   98 with status "KEEP"

                    RETURNING TO INPUT STREAM    99
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>    ! solvent only? ()
 CHARMM>    ! this should not be here
 CHARMM>    ! Read PSF and Coordinates
 CHARMM>    open read unit 10 card name step2_molpacking.psf
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step2_molpacking.psf::
 OPNLGU> Unit 10 opened for READONLY access to step2_molpacking.psf
  
 CHARMM>    read psf  unit 10 card
 MAINIO> Protein structure file being read from unit  10.
 psf_read_formatted: Reading PSF in the expanded format.
 TITLE>  * CYCLE 1 0 0 0.5
 TITLE>  *  DATE:     6/ 2/24     13:14: 8      CREATED BY USER: apache
 TITLE>  *
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        2   Number of residues   =      692
         Number of atoms         =     9102   Number of groups     =     2780
         Number of bonds         =     9164   Number of angles     =    16372
         Number of dihedrals     =    23604   Number of impropers  =     1870
         Number of cross-terms   =      688   Number of autogens   =        0
         Number of HB acceptors  =      913   Number of HB donors  =     1082
         Number of NB exclusions =        0   Total charge =  -12.00000
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step2_molpacking.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step2_molpacking.crd::
 OPNLGU> Unit 10 opened for READONLY access to step2_molpacking.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * CYCLE 1 0 0 0.5
 TITLE> *  DATE:     6/ 2/24     13:14: 8      CREATED BY USER: APACHE
 TITLE> *
  
 CHARMM>     
  
 CHARMM>    define PROT sele all end
 SELRPN>   9102 atoms have been selected out of   9102
  
 CHARMM>     
  
 CHARMM>    ! protein volume, calculation with a grid spacing of 0.5
 CHARMM>    coor stat
 STATISTICS FOR      9102 SELECTED ATOMS:
    XMIN =  -69.267572 XMAX =   30.618506 XAVE =  -15.963335
    YMIN =  -45.247083 YMAX =   56.788601 YAVE =   14.117156
    ZMIN =  -39.008390 ZMAX =   53.493583 ZAVE =   11.903842
    WMIN =    0.000000 WMAX =   96.690000 WAVE =   59.366383
  
 CHARMM>     
  
 CHARMM>    open write unit 10 card name step3.4_ions_orient.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step3.4_ions_orient.crd::
 OPNLGU> Unit 10 opened for WRITE access to step3.4_ions_orient.crd
  
 CHARMM>    write coor unit 10 card
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   10 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    calc dcel = 0.5
Evaluating: 0.5
 Parameter: DCEL <- "0.5"
  
 CHARMM>    calc xdim = int ( ( ?xmax - ?xmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?XMAX" to "30.6185062"
 RDCMND substituted energy or value "?XMIN" to "-69.2675715"
Evaluating: INT((30.6185062--69.2675715+5.0)/0.5)+1
 Parameter: XDIM <- "210"
  
 CHARMM>    calc ydim = int ( ( ?ymax - ?ymin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?YMAX" to "56.7886006"
 RDCMND substituted energy or value "?YMIN" to "-45.2470827"
Evaluating: INT((56.7886006--45.2470827+5.0)/0.5)+1
 Parameter: YDIM <- "215"
  
 CHARMM>    calc zdim = int ( ( ?zmax - ?zmin + 5.0 ) / @dcel ) + 1
 Parameter: DCEL -> "0.5"
 RDCMND substituted energy or value "?ZMAX" to "53.4935826"
 RDCMND substituted energy or value "?ZMIN" to "-39.0083896"
Evaluating: INT((53.4935826--39.0083896+5.0)/0.5)+1
 Parameter: ZDIM <- "196"
  
 CHARMM>    calc space = @xdim * @ydim * @zdim
 Parameter: XDIM -> "210"
 Parameter: YDIM -> "215"
 Parameter: ZDIM -> "196"
Evaluating: 210*215*196
 Parameter: SPACE <- "8849400"
  
 CHARMM>     
  
 CHARMM>    ! prevent overflow on integer conversion
 CHARMM>    calc maxint = 2**32 / 2 - 1
Evaluating: 2**32/2-1
 Parameter: MAXINT <- "2.147483647E+09"
  
 CHARMM>    if space .gt. @maxint calc space = @maxint
 Parameter: MAXINT -> "2.147483647E+09"
 Parameter: MAXINT -> "2.147483647E+09"
 Comparing "8849400" and "2.147483647E+09".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    scalar wmain = radius
  
 CHARMM>    scalar wmain add 1.4    ! use solvent accessible surface for molecular volume
  
 CHARMM>    scalar 1 = wmain
  
 CHARMM>    scalar 2 set 6.0
  
 CHARMM>    coor volume hole space @space sele .not. resname TIP3 end
 Parameter: SPACE -> "8849400"
 SELRPN>   9102 atoms have been selected out of   9102
 COMPUTING VOLUME PER ATOM WITH:
   XMIN=    -72.0076 XMAX=     33.5640 NX= 211
   YMIN=    -48.0971 YMAX=     59.5286 NY= 215
   ZMIN=    -41.6074 ZMAX=     55.9249 NZ= 194


 A TOTAL OF       88   VACUUM POINTS WERE FOUND
 A TOTAL OF  1125553 OCCUPIED POINTS WERE FOUND
 A TOTAL OF  7675169 EXTERNAL POINTS WERE FOUND
 A TOTAL OF  8800722 SELECTED POINTS WERE FOUND
 TOTAL OCCUPIED  VOLUME =  141727.668010
 TOTAL SELECTED  VOLUME = 1108171.543997
 TOTAL FREE      VOLUME =      11.080806
 FRACTIONAL FREE VOLUME =       0.007818
  
 CHARMM>     
  
 CHARMM>    set molvol = ?volume
 RDCMND substituted energy or value "?VOLUME" to "141727.668"
 Parameter: MOLVOL <- "141727.668"
  
 CHARMM>     
  
 CHARMM>    ! system volume from parameters for water box
 CHARMM>    stream step2_molpacking.str
 VOPEN> Attempting to open::step2_molpacking.str::
 OPNLGU> Unit 99 opened for READONLY access to step2_molpacking.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> SET BOXTYPE = RECT
 RDTITL> No title read.
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     SET BOXTYPE = RECT
 Parameter: BOXTYPE <- "RECT"
  
 CHARMM>     SET EXCLUDE_LENGTH = 0
 Parameter: EXCLUDE_LENGTH <- "0"
  
 CHARMM>     SET PBCX = 0
 Parameter: PBCX <- "0"
  
 CHARMM>     SET PBCY = 0
 Parameter: PBCY <- "0"
  
 CHARMM>     SET PBCZ = 0
 Parameter: PBCZ <- "0"
  
 CHARMM>     SET IMPATCH = NO
 Parameter: IMPATCH <- "NO"
  
 CHARMM>     SET XTLTYPE = CUBIC
 Parameter: XTLTYPE <- "CUBIC"
  
 CHARMM>     SET A = 89.1533903
 Parameter: A <- "89.1533903"
  
 CHARMM>     SET B = 89.1533903
 Parameter: B <- "89.1533903"
  
 CHARMM>     SET C = 89.1533903
 Parameter: C <- "89.1533903"
  
 CHARMM>     SET ALPHA = 90.0
 Parameter: ALPHA <- "90.0"
  
 CHARMM>     SET BETA = 90.0
 Parameter: BETA <- "90.0"
  
 CHARMM>     SET GAMMA = 90.0
 Parameter: GAMMA <- "90.0"
  
 CHARMM>     SET XCEN = 0
 Parameter: XCEN <- "0"
  
 CHARMM>     SET YCEN = 0
 Parameter: YCEN <- "0"
  
 CHARMM>     SET ZCEN = 0
 Parameter: ZCEN <- "0"
  
 CHARMM>     SET NCHARGE = -12
 Parameter: NCHARGE <- "-12"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>    stream polinfo/define_pbc.str
 VOPEN> Attempting to open::polinfo/define_pbc.str::
 OPNLGU> Unit 99 opened for READONLY access to polinfo/define_pbc.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * DEFINES PBC VARIABLES CONTAINING POSITION AND LENGTH OF XY PERIODIC AND
 RDTITL> * MEMBRANE EXCLUSION REGIONS.
 RDTITL> * USAGE: STREAM POLINFO/DEFINE_PBC.STR
 RDTITL> *
 Parameter: IN1 <- "" <empty>
  
 CHARMM>     
  
 CHARMM>    calc npbcz     =   0 ! includes membrane region, if any
Evaluating: 0
 Parameter: NPBCZ <- "0"
  
 CHARMM>    calc pbcztot   = 0 ! total width occupied by periodic components
Evaluating: 0
 Parameter: PBCZTOT <- "0"
  
 CHARMM>    calc pbczextot = 0 ! "" + excluded above/below
Evaluating: 0
 Parameter: PBCZEXTOT <- "0"
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>    if @XTLtype .eq. TETRagonal   calc sysvol = @A * @B * @C
 Parameter: XTLTYPE -> "CUBIC"
 Parameter: A -> "89.1533903"
 Parameter: B -> "89.1533903"
 Parameter: C -> "89.1533903"
 Comparing "CUBIC" and "TETRAGONAL".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    if @XTLtype .eq. CUBIc        calc sysvol = @A * @B * @C
 Parameter: XTLTYPE -> "CUBIC"
 Parameter: A -> "89.1533903"
 Parameter: B -> "89.1533903"
 Parameter: C -> "89.1533903"
 Comparing "CUBIC" and "CUBIC".
 IF test evaluated as true.  Performing command
Evaluating: 89.1533903*89.1533903*89.1533903
 Parameter: SYSVOL <- "708620.299"
  
 CHARMM>    if @XTLtype .eq. ORTHorhombic calc sysvol = @A * @B * @C
 Parameter: XTLTYPE -> "CUBIC"
 Parameter: A -> "89.1533903"
 Parameter: B -> "89.1533903"
 Parameter: C -> "89.1533903"
 Comparing "CUBIC" and "ORTHORHOMBIC".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    if @XTLtype .eq. MONOclinic   calc sysvol = @A * @B * @C * sin ( @beta * ?pi / 180.0 )
 Parameter: XTLTYPE -> "CUBIC"
 Parameter: A -> "89.1533903"
 Parameter: B -> "89.1533903"
 Parameter: C -> "89.1533903"
 Parameter: BETA -> "90.0"
 RDCMND substituted energy or value "?PI" to "3.14159265"
 Comparing "CUBIC" and "MONOCLINIC".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    if @XTLtype .eq. HEXAgonal    calc sysvol = sqrt( 0.75 ) * @C * @A * @A
 Parameter: XTLTYPE -> "CUBIC"
 Parameter: C -> "89.1533903"
 Parameter: A -> "89.1533903"
 Parameter: A -> "89.1533903"
 Comparing "CUBIC" and "HEXAGONAL".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    if @XTLtype .eq. OCTAhedral   calc sysvol = 4.0 * sqrt( 3.0 ) / 9 * @A * @A * @A
 Parameter: XTLTYPE -> "CUBIC"
 Parameter: A -> "89.1533903"
 Parameter: A -> "89.1533903"
 Parameter: A -> "89.1533903"
 Comparing "CUBIC" and "OCTAHEDRAL".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    if @XTLtype .eq. RHDO         calc sysvol = sqrt( 0.5 ) * @A * @A * @A
 Parameter: XTLTYPE -> "CUBIC"
 Parameter: A -> "89.1533903"
 Parameter: A -> "89.1533903"
 Parameter: A -> "89.1533903"
 Comparing "CUBIC" and "RHDO".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    if @XTLtype .eq. TRIClinic then
 Parameter: XTLTYPE -> "CUBIC"
 Comparing "CUBIC" and "TRICLINIC".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>    if @XTLtype .eq. RHOMbohedral then
 Parameter: XTLTYPE -> "CUBIC"
 Comparing "CUBIC" and "RHOMBOHEDRAL".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    ! conc    : concentration (M)
 CHARMM>    ! volumn  : ion accessible volume (Ang**3)
 CHARMM>    ! npos    : number of positive ions of a particular compound
 CHARMM>    ! nneg    : number of negative ions of a particular compound
 CHARMM>    ! nion    : number of positive and negative ions of a particular compound
 CHARMM>    ! npostot : total number of all positive ions
 CHARMM>    ! nnegtot : total number of all negative ions
 CHARMM>    ! niontot : total number of all ions
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    calc volumn = @sysvol - @molvol
 Parameter: SYSVOL -> "708620.299"
 Parameter: MOLVOL -> "141727.668"
Evaluating: 708620.299-141727.668
 Parameter: VOLUMN <- "566892.631"
  
 CHARMM>    calc npostot = 0
Evaluating: 0
 Parameter: NPOSTOT <- "0"
  
 CHARMM>    calc nnegtot = 0
Evaluating: 0
 Parameter: NNEGTOT <- "0"
  
 CHARMM>    calc niontot = 0
Evaluating: 0
 Parameter: NIONTOT <- "0"
  
 CHARMM>     
  
 CHARMM>    define ALLIONS sele none end
 SELRPN>      0 atoms have been selected out of   9102
  
 CHARMM>     
  
 CHARMM>    set ionind = 1
 Parameter: IONIND <- "1"
  
 CHARMM>    label do_ion
  
 CHARMM>        define POS sele none end
 SELRPN>      0 atoms have been selected out of   9102
  
 CHARMM>        define NEG sele none end
 SELRPN>      0 atoms have been selected out of   9102
  
 CHARMM>     
  
 CHARMM>        stream step3.4_ions_count.str @ionind
 Parameter: IONIND -> "1"
 VOPEN> Attempting to open::step3.4_ions_count.str::
 OPNLGU> Unit 99 opened for READONLY access to step3.4_ions_count.str

                    INPUT STREAM SWITCHING TO UNIT    99
 RDTITL> * NUMBER OF EACH ION STRUCTURE, AS CHOSEN BY USER;
 RDTITL> * USAGE: STREAM STEP2_IONS_COUNT.STR INDEX
 RDTITL> *
 Parameter: IN1 <- "1"
  
 CHARMM>     
  
 CHARMM>    if @?IN1 .eq. 0 stop ! ABNORMAL TERMINATION: missing index
 Comparing "1" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    set isusercation = 0
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    set isuseranion  = 0
 Parameter: ISUSERANION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set pos = SOD
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POS <- "SOD"
  
 CHARMM>    if @IN1 .eq. 1 set neg = CLA
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEG <- "CLA"
  
 CHARMM>    if @IN1 .eq. 1 set poscharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negcharge = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGCHARGE <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set posval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: POSVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set negval = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NEGVAL <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set conc = 0.2
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: CONC <- "0.2"
  
 CHARMM>    if @IN1 .eq. 1 set natompos = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMPOS <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set natomneg = 1
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: NATOMNEG <- "1"
  
 CHARMM>    if @IN1 .eq. 1 set isusercation = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERCATION <- "0"
  
 CHARMM>    if @IN1 .eq. 1 set isuseranion  = 0
 Parameter: IN1 -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
 Parameter: ISUSERANION <- "0"
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>    set neutral_index = 1
 Parameter: NEUTRAL_INDEX <- "1"
  
 CHARMM>    set niontypes = 1
 Parameter: NIONTYPES <- "1"
  
 CHARMM>     
  
 VCLOSE: Closing unit   99 with status "KEEP"

                    RETURNING TO INPUT STREAM     5
  
 CHARMM>     
  
 CHARMM>        calc ncharge = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "-12"
Evaluating: INT(-12)
 Parameter: NCHARGE <- "-12"
  
 CHARMM>        calc cgtot = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "-12"
Evaluating: -12
 Parameter: CGTOT <- "-12"
  
 CHARMM>     
  
 CHARMM>        calc npos = 0
Evaluating: 0
 Parameter: NPOS <- "0"
  
 CHARMM>        calc nneg = 0
Evaluating: 0
 Parameter: NNEG <- "0"
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if ncharge .lt. 0 calc npos = int( abs( @cgtot ) / @poscharge )
 Parameter: CGTOT -> "-12"
 Parameter: POSCHARGE -> "1"
 Comparing "-12" and "0".
 IF test evaluated as true.  Performing command
Evaluating: INT(ABS(-12)/1)
 Parameter: NPOS <- "12"
  
 CHARMM>            if ncharge .gt. 0 calc nneg = int( abs( @cgtot ) / @negcharge )
 Parameter: CGTOT -> "-12"
 Parameter: NEGCHARGE -> "1"
 Comparing "-12" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc diff = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "-12"
 Parameter: NPOS -> "12"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "0"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(-12+12*1-0*1)
 Parameter: DIFF <- "0"
  
 CHARMM>     
  
 CHARMM>        if neutral_index .eq. @ionind then
 Parameter: IONIND -> "1"
 Comparing "1" and "1".
 IF test evaluated as true.  Performing command
  
 CHARMM>            set ntries = 0
 Parameter: NTRIES <- "0"
  
 CHARMM>            label neutral
  
 CHARMM>                if diff .gt. 0 calc nneg = @nneg + 1
 Parameter: NNEG -> "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .lt. 0 calc npos = @npos + 1
 Parameter: NPOS -> "12"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                calc diff = int ( @cgtot + @npos*@poscharge - @nneg*@negcharge )
 Parameter: CGTOT -> "-12"
 Parameter: NPOS -> "12"
 Parameter: POSCHARGE -> "1"
 Parameter: NNEG -> "0"
 Parameter: NEGCHARGE -> "1"
Evaluating: INT(-12+12*1-0*1)
 Parameter: DIFF <- "0"
  
 CHARMM>                incr ntries
 Parameter: NTRIES <- "1"
  
 CHARMM>                if ntries .ge. 10 stop ! ABNORMAL TERMINATION: can't neutralize this system
 Comparing "1" and "10".
 IF test evaluated as false.  Skipping command
  
 CHARMM>                if diff .ne. 0 goto neutral
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        calc npos = @npos + int ( @conc * 6.021 * 0.0001 * @volumn ) * @negval
 Parameter: NPOS -> "12"
 Parameter: CONC -> "0.2"
 Parameter: VOLUMN -> "566892.631"
 Parameter: NEGVAL -> "1"
Evaluating: 12+INT(0.2*6.021*0.0001*566892.631)*1
 Parameter: NPOS <- "80"
  
 CHARMM>        calc nneg = @nneg + int ( @conc * 6.021 * 0.0001 * @volumn ) * @posval
 Parameter: NNEG -> "0"
 Parameter: CONC -> "0.2"
 Parameter: VOLUMN -> "566892.631"
 Parameter: POSVAL -> "1"
Evaluating: 0+INT(0.2*6.021*0.0001*566892.631)*1
 Parameter: NNEG <- "68"
  
 CHARMM>     
  
 CHARMM>        if npos .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "80" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>        if nneg .lt. 0 stop ! ABNORMAL TERMINATION: something wrong
 Comparing "68" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Randomly place the ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        ! initial positions for all ions
  
 CHARMM>        calc xpos = @A / 2.0
 Parameter: A -> "89.1533903"
Evaluating: 89.1533903/2.0
 Parameter: XPOS <- "44.5766951"
  
 CHARMM>        calc ypos = @B / 2.0
 Parameter: B -> "89.1533903"
Evaluating: 89.1533903/2.0
 Parameter: YPOS <- "44.5766951"
  
 CHARMM>        calc zpos = @C / 2.0
 Parameter: C -> "89.1533903"
Evaluating: 89.1533903/2.0
 Parameter: ZPOS <- "44.5766951"
  
 CHARMM>     
  
 CHARMM>        ! Generate positive ion
  
 CHARMM>        if npos .gt. 0 then
 Comparing "80" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isusercation .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @pos @npos
 Parameter: POS -> "SOD"
 Parameter: NPOS -> "80"
  
 CHARMM>                generate POS warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment   3 has been generated. Its identifier is POS.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        3   Number of residues   =      772
         Number of atoms         =     9182   Number of groups     =     2860
         Number of bonds         =     9164   Number of angles     =    16372
         Number of dihedrals     =    23604   Number of impropers  =     1870
         Number of cross-terms   =      688   Number of autogens   =        0
         Number of HB acceptors  =      913   Number of HB donors  =     1082
         Number of NB exclusions =        0   Total charge =   68.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define POS sele segid POS end
 SELRPN>     80 atoms have been selected out of   9182
  
 CHARMM>     
  
 CHARMM>            if natompos .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                coor set xdir @xpos ydir @ypos zdir @zpos select POS end
 Parameter: XPOS -> "44.5766951"
 Parameter: YPOS -> "44.5766951"
 Parameter: ZPOS -> "44.5766951"
 SELRPN>     80 atoms have been selected out of   9182
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        ! Generate negative ion
  
 CHARMM>        if nneg .gt. 0 then
 Comparing "68" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if isuseranion .eq. 1 then
 Comparing "0" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                read sequence @neg @nneg
 Parameter: NEG -> "CLA"
 Parameter: NNEG -> "68"
  
 CHARMM>                generate NEG warn
 NO PATCHING WILL BE DONE ON THE FIRST RESIDUE
 NO PATCHING WILL BE DONE ON THE LAST  RESIDUE
 AUTGEN: Autogenerating specified angles and dihedrals.
 GENPSF> Segment   4 has been generated. Its identifier is NEG.
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        4   Number of residues   =      840
         Number of atoms         =     9250   Number of groups     =     2928
         Number of bonds         =     9164   Number of angles     =    16372
         Number of dihedrals     =    23604   Number of impropers  =     1870
         Number of cross-terms   =      688   Number of autogens   =        0
         Number of HB acceptors  =      913   Number of HB donors  =     1082
         Number of NB exclusions =        0   Total charge =   -0.00000
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     68 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if natomneg .gt. 1 then
 Comparing "1" and "1".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>                coor set xdir @xpos ydir @ypos zdir @zpos select NEG end
 Parameter: XPOS -> "44.5766951"
 Parameter: YPOS -> "44.5766951"
 Parameter: ZPOS -> "44.5766951"
 SELRPN>     68 atoms have been selected out of   9250
 SELECTED COORDINATES SET IN THE MAIN SET.

  
 CHARMM>            endif
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele POS .or. NEG end
 SELRPN>    148 atoms have been selected out of   9250
  
 CHARMM>        define ALLIONS sele segid IONS .or. IONS end
 SELRPN>    148 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>        calc nion = @npos + @nneg
 Parameter: NPOS -> "80"
 Parameter: NNEG -> "68"
Evaluating: 80+68
 Parameter: NION <- "148"
  
 CHARMM>     
  
 CHARMM>        incr npostot by @npos
 Parameter: NPOS -> "80"
 Parameter: NPOSTOT <- "80"
  
 CHARMM>        incr nnegtot by @nneg
 Parameter: NNEG -> "68"
 Parameter: NNEGTOT <- "68"
  
 CHARMM>        incr niontot by @nion
 Parameter: NION -> "148"
 Parameter: NIONTOT <- "148"
  
 CHARMM>     
  
 CHARMM>        if nion .eq. 0 goto continue
 Comparing "148" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        !Images Setup [to place all atoms inside the box]
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        COOR CONVERT ALIGNED SYMMETRIC @A @B @C @alpha @beta @gamma
 Parameter: A -> "89.1533903"
 Parameter: B -> "89.1533903"
 Parameter: C -> "89.1533903"
 Parameter: ALPHA -> "90.0"
 Parameter: BETA -> "90.0"
 Parameter: GAMMA -> "90.0"
  
 CHARMM>     
  
 CHARMM>        open read unit 10 card name crystal_image.str
 VOPEN> Attempting to open::crystal_image.str::
 OPNLGU> Unit 10 opened for READONLY access to crystal_image.str
  
 CHARMM>        CRYSTAL DEFINE @XTLtype @A @B @C @alpha @beta @gamma
 Parameter: XTLTYPE -> "CUBIC"
 Parameter: A -> "89.1533903"
 Parameter: B -> "89.1533903"
 Parameter: C -> "89.1533903"
 Parameter: ALPHA -> "90.0"
 Parameter: BETA -> "90.0"
 Parameter: GAMMA -> "90.0"
 Crystal Parameters : Crystal Type = CUBI
           A     =   89.15339 B    =   89.15339 C     =   89.15339
           Alpha =   90.00000 Beta =   90.00000 Gamma =   90.00000
  
 CHARMM>        CRYSTAL READ UNIT 10 CARD
 CRYSTAL FILE BEING READ FROM UNIT    10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUN, 02. 2024. JOBID=1734830673
 TITLE> * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE> *
 TITLE>  * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUN, 02. 2024. JOB
 TITLE>  * STREAM FILE FOR CRYSTAL SYMMETRY OPERATION
 TITLE>  *
                     THERE ARE NO ROTATIONS FOR THIS TRANSFORMATION SET
    26 Transformations have been processed.

  
 CHARMM>     
  
 CHARMM>        !Image centering by residue
  
 CHARMM>        IMAGE BYRES XCEN @xcen YCEN @ycen ZCEN @zcen
 Parameter: XCEN -> "0"
 Parameter: YCEN -> "0"
 Parameter: ZCEN -> "0"
 IMAGE CENTERING ON FOR SOME ATOMS
  
 CHARMM>     
  
 CHARMM>        update image inbf 0

 SELECTED IMAGES ATOMS BEING CENTERED ABOUT  0.000000  0.000000  0.000000
 RESIDUE  216 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  217 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  218 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  219 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  220 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  347 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  348 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  349 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  350 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  351 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  352 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  353 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  354 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  355 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  356 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  357 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  382 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  440 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  441 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  442 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  443 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  446 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  480 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  483 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  487 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  490 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  491 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  492 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  493 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  495 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  525 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  526 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  527 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  528 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  529 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  530 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  580 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  582 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  602 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  603 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  604 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  605 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  606 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  607 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  608 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  609 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  610 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  611 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  612 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  613 OPERATED ON BY TRANSFORMATION P1Z0N1R1
 RESIDUE  614 OPERATED ON BY TRANSFORMATION P1Z0N1R1
 RESIDUE  615 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  616 OPERATED ON BY TRANSFORMATION P1Z0N1R1
 RESIDUE  617 OPERATED ON BY TRANSFORMATION P1Z0N1R1
 RESIDUE  618 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  619 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  620 OPERATED ON BY TRANSFORMATION P1Z0N1R1
 RESIDUE  621 OPERATED ON BY TRANSFORMATION P1Z0N1R1
 RESIDUE  622 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  623 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  624 OPERATED ON BY TRANSFORMATION P1Z0N1R1
 RESIDUE  625 OPERATED ON BY TRANSFORMATION P1Z0N1R1
 RESIDUE  626 OPERATED ON BY TRANSFORMATION P1Z0N1R1
 RESIDUE  627 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  628 OPERATED ON BY TRANSFORMATION P1Z0N1R1
 RESIDUE  629 OPERATED ON BY TRANSFORMATION P1Z0N1R1
 RESIDUE  630 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  631 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  632 OPERATED ON BY TRANSFORMATION P1Z0N1R1
 RESIDUE  633 OPERATED ON BY TRANSFORMATION P1Z0N1R1
 RESIDUE  634 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  635 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  636 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  637 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  638 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  639 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  640 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  641 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  642 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  643 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  644 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  647 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  654 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  655 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  657 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  658 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  659 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  660 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  661 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  662 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  663 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  664 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  665 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  666 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  667 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  668 OPERATED ON BY TRANSFORMATION P1Z0Z0R1
 RESIDUE  669 OPERATED ON BY TRANSFORMATION P1N1Z0R1
 RESIDUE  670 OPERATED ON BY TRANSFORMATION P1N1Z0R1
 RESIDUE  671 OPERATED ON BY TRANSFORMATION P1N1Z0R1
 RESIDUE  672 OPERATED ON BY TRANSFORMATION P1N1Z0R1
 RESIDUE  673 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  674 OPERATED ON BY TRANSFORMATION P1N1Z0R1
 RESIDUE  675 OPERATED ON BY TRANSFORMATION P1N1Z0R1
 RESIDUE  676 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  677 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  678 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  679 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  680 OPERATED ON BY TRANSFORMATION Z0N1Z0R1
 RESIDUE  681 OPERATED ON BY TRANSFORMATION Z0N1N1R1
 RESIDUE  682 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  684 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  685 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  686 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  687 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  688 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  689 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  690 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  691 OPERATED ON BY TRANSFORMATION Z0Z0N1R1
 RESIDUE  692 OPERATED ON BY TRANSFORMATION Z0Z0N1R1

 <MKIMAT2>: updating the image atom lists and remapping
 Transformation   Atoms  Groups  Residues  Min-Distance
    1  N1N1N1R1 has     202     164     153        0.00
    2  N1Z0N1R1 has     519     255     176        0.00
    3  N1P1N1R1 has      26       8       3        2.21
    4  Z0N1N1R1 has      42      12       4        0.00
    5  Z0Z0N1R1 has    1115     438     223        0.00
    6  Z0P1N1R1 has     119      34      11        0.00
    7  N1N1Z0R1 has     402     226     170        0.00
    8  N1Z0Z0R1 has     989     391     210        0.00
    9  N1P1Z0R1 has      36      10       4        1.42
   10  Z0N1Z0R1 has    1752     648     278        0.00
   12  N1N1P1R1 has     104      31      10        0.00
   13  N1Z0P1R1 has     156      48      13        0.00
   14  N1P1P1R1 has       0       0       0       39.33
 Total of14712 atoms and 5193 groups and 2095 residues were included

 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 IMAGE
  
 CHARMM>     
  
 CHARMM>        CONS FIX SELE .NOT. IONS END
 SELRPN>   9102 atoms have been selected out of   9250
  
 CHARMM>        SKIP ALL EXCL VDW ELEC
 SKIPE> The following energy terms will be computed :
  VDW  ELEC
  
 CHARMM>        scalar wmain = charge
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! Initial placement of ions
  
 CHARMM>        !
  
 CHARMM>     
  
 CHARMM>        calc availZ = @C - @pbcztot
 Parameter: C -> "89.1533903"
 Parameter: PBCZTOT -> "0"
Evaluating: 89.1533903-0
 Parameter: AVAILZ <- "89.1533903"
  
 CHARMM>        if availZ .le. 0 stop ! ABNORMAL TERMINATION: invalid system size
 Comparing "89.1533903" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        ! convert to fraction
  
 CHARMM>        calc availZ = @C / @availZ
 Parameter: C -> "89.1533903"
 Parameter: AVAILZ -> "89.1533903"
Evaluating: 89.1533903/89.1533903
 Parameter: AVAILZ <- "1"
  
 CHARMM>        calc cntmax = int(100*@availZ) ! maximum allowed placement attempts
 Parameter: AVAILZ -> "1"
Evaluating: INT(100*1)
 Parameter: CNTMAX <- "100"
  
 CHARMM>        if cntmax .gt. 1000 calc cntmax = 1000
 Comparing "100" and "1000".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        calc cntrand = 0  ! number of placement attempts
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>        calc i   = 1
Evaluating: 1
 Parameter: I <- "1"
  
 CHARMM>        label doinit
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "1"
Evaluating: 1
 Parameter: J <- "1"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "1" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.90334954"
Evaluating: (89.1533903-9.0)*(0.90334954-0.5)
 Parameter: XPOS <- "32.3298331"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.101889949"
Evaluating: (89.1533903-9.0)*(0.101889949-0.5)
 Parameter: YPOS <- "-31.9098703"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.587423586"
Evaluating: (89.1533903-9.0)*(0.587423586-0.5)
 Parameter: ZPOS <- "7.00729681"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.3298331"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 32.3298331-44.5766951
 Parameter: XTRAN <- "-12.246862"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-31.9098703"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -31.9098703-44.5766951
 Parameter: YTRAN <- "-76.4865654"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "7.00729681"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 7.00729681-44.5766951
 Parameter: ZTRAN <- "-37.5693983"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.246862"
 Parameter: YTRAN -> "-76.4865654"
 Parameter: ZTRAN -> "-37.5693983"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -12.246862  -76.486565  -37.569398
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.928136859"
Evaluating: 0.928136859*360.0
 Parameter: XPHI <- "334.129269"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.762307181"
Evaluating: 0.762307181*360.0
 Parameter: YPHI <- "274.430585"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.45925864"
Evaluating: 0.45925864*360.0
 Parameter: ZPHI <- "165.33311"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.3298331"
 Parameter: YPOS -> "-31.9098703"
 Parameter: ZPOS -> "7.00729681"
 Parameter: XPHI -> "334.129269"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.899781   -0.436342
    0.000000    0.436342    0.899781

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   25.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.3298331"
 Parameter: YPOS -> "-31.9098703"
 Parameter: ZPOS -> "7.00729681"
 Parameter: YPHI -> "274.430585"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.077251    0.000000    0.997012
    0.000000    1.000000    0.000000
   -0.997012    0.000000    0.077251

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   85.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.3298331"
 Parameter: YPOS -> "-31.9098703"
 Parameter: ZPOS -> "7.00729681"
 Parameter: ZPHI -> "165.33311"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.967414    0.253199    0.000000
   -0.253199   -0.967414    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  165.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.329833 XMAX =   32.329833 XAVE =   32.329833
    YMIN =  -31.909870 YMAX =  -31.909870 YAVE =  -31.909870
    ZMIN =    7.007297 ZMAX =    7.007297 ZAVE =    7.007297
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.3298331"
Evaluating: 32.3298331+3.5
 Parameter: XMAX <- "35.8298331"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-31.9098703"
Evaluating: -31.9098703+3.5
 Parameter: YMAX <- "-28.4098703"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "7.00729681"
Evaluating: 7.00729681+3.5
 Parameter: ZMAX <- "10.5072968"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.3298331"
Evaluating: 32.3298331-3.5
 Parameter: XMIN <- "28.8298331"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-31.9098703"
Evaluating: -31.9098703-3.5
 Parameter: YMIN <- "-35.4098703"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "7.00729681"
Evaluating: 7.00729681-3.5
 Parameter: ZMIN <- "3.50729681"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.8298331"
 Parameter: XMIN -> "28.8298331"
 Parameter: YMAX -> "-28.4098703"
 Parameter: YMIN -> "-35.4098703"
 Parameter: ZMAX -> "10.5072968"
 Parameter: ZMIN -> "3.50729681"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "2"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "2" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "2"
Evaluating: 2
 Parameter: J <- "2"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "2" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.941607014"
Evaluating: (89.1533903-9.0)*(0.941607014-0.5)
 Parameter: XPOS <- "35.3962994"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.409142584"
Evaluating: (89.1533903-9.0)*(0.409142584-0.5)
 Parameter: YPOS <- "-7.28252993"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.171593472"
Evaluating: (89.1533903-9.0)*(0.171593472-0.5)
 Parameter: ZPOS <- "-26.3228966"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "35.3962994"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 35.3962994-44.5766951
 Parameter: XTRAN <- "-9.1803957"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.28252993"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -7.28252993-44.5766951
 Parameter: YTRAN <- "-51.859225"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.3228966"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -26.3228966-44.5766951
 Parameter: ZTRAN <- "-70.8995917"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.1803957"
 Parameter: YTRAN -> "-51.859225"
 Parameter: ZTRAN -> "-70.8995917"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    -9.180396  -51.859225  -70.899592
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.626540529"
Evaluating: 0.626540529*360.0
 Parameter: XPHI <- "225.55459"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.660947653"
Evaluating: 0.660947653*360.0
 Parameter: YPHI <- "237.941155"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.971112317"
Evaluating: 0.971112317*360.0
 Parameter: ZPHI <- "349.600434"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "35.3962994"
 Parameter: YPOS -> "-7.28252993"
 Parameter: ZPOS -> "-26.3228966"
 Parameter: XPHI -> "225.55459"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.700229   -0.713918
    0.000000    0.713918   -0.700229

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  134.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "35.3962994"
 Parameter: YPOS -> "-7.28252993"
 Parameter: ZPOS -> "-26.3228966"
 Parameter: YPHI -> "237.941155"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.530790    0.000000    0.847503
    0.000000    1.000000    0.000000
   -0.847503    0.000000   -0.530790

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  122.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "35.3962994"
 Parameter: YPOS -> "-7.28252993"
 Parameter: ZPOS -> "-26.3228966"
 Parameter: ZPHI -> "349.600434"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.983573   -0.180512    0.000000
    0.180512    0.983573    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   10.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.396299 XMAX =   35.396299 XAVE =   35.396299
    YMIN =   -7.282530 YMAX =   -7.282530 YAVE =   -7.282530
    ZMIN =  -26.322897 ZMAX =  -26.322897 ZAVE =  -26.322897
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "35.3962994"
Evaluating: 35.3962994+3.5
 Parameter: XMAX <- "38.8962994"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.28252995"
Evaluating: -7.28252995+3.5
 Parameter: YMAX <- "-3.78252995"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.3228966"
Evaluating: -26.3228966+3.5
 Parameter: ZMAX <- "-22.8228966"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "35.3962994"
Evaluating: 35.3962994-3.5
 Parameter: XMIN <- "31.8962994"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.28252995"
Evaluating: -7.28252995-3.5
 Parameter: YMIN <- "-10.78253"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.3228966"
Evaluating: -26.3228966-3.5
 Parameter: ZMIN <- "-29.8228966"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "38.8962994"
 Parameter: XMIN -> "31.8962994"
 Parameter: YMAX -> "-3.78252995"
 Parameter: YMIN -> "-10.78253"
 Parameter: ZMAX -> "-22.8228966"
 Parameter: ZMIN -> "-29.8228966"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "3"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "3" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "3"
Evaluating: 3
 Parameter: J <- "3"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "3" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.775006338"
Evaluating: (89.1533903-9.0)*(0.775006338-0.5)
 Parameter: XPOS <- "22.0426903"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.839682052"
Evaluating: (89.1533903-9.0)*(0.839682052-0.5)
 Parameter: YPOS <- "27.2266681"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.890616405"
Evaluating: (89.1533903-9.0)*(0.890616405-0.5)
 Parameter: ZPOS <- "31.3092292"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "22.0426903"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 22.0426903-44.5766951
 Parameter: XTRAN <- "-22.5340048"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.2266681"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 27.2266681-44.5766951
 Parameter: YTRAN <- "-17.350027"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.3092292"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 31.3092292-44.5766951
 Parameter: ZTRAN <- "-13.2674659"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.5340048"
 Parameter: YTRAN -> "-17.350027"
 Parameter: ZTRAN -> "-13.2674659"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -22.534005  -17.350027  -13.267466
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.882686259"
Evaluating: 0.882686259*360.0
 Parameter: XPHI <- "317.767053"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.699130073"
Evaluating: 0.699130073*360.0
 Parameter: YPHI <- "251.686826"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.349070953"
Evaluating: 0.349070953*360.0
 Parameter: ZPHI <- "125.665543"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "22.0426903"
 Parameter: YPOS -> "27.2266681"
 Parameter: ZPOS -> "31.3092292"
 Parameter: XPHI -> "317.767053"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.740418   -0.672146
    0.000000    0.672146    0.740418

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   42.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "22.0426903"
 Parameter: YPOS -> "27.2266681"
 Parameter: ZPOS -> "31.3092292"
 Parameter: YPHI -> "251.686826"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.314211    0.000000    0.949353
    0.000000    1.000000    0.000000
   -0.949353    0.000000   -0.314211

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  108.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "22.0426903"
 Parameter: YPOS -> "27.2266681"
 Parameter: ZPOS -> "31.3092292"
 Parameter: ZPHI -> "125.665543"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.583053    0.812434    0.000000
   -0.812434   -0.583053    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  125.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.042690 XMAX =   22.042690 XAVE =   22.042690
    YMIN =   27.226668 YMAX =   27.226668 YAVE =   27.226668
    ZMIN =   31.309229 ZMAX =   31.309229 ZAVE =   31.309229
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "22.0426903"
Evaluating: 22.0426903+3.5
 Parameter: XMAX <- "25.5426903"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.2266681"
Evaluating: 27.2266681+3.5
 Parameter: YMAX <- "30.7266681"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.3092292"
Evaluating: 31.3092292+3.5
 Parameter: ZMAX <- "34.8092292"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "22.0426903"
Evaluating: 22.0426903-3.5
 Parameter: XMIN <- "18.5426903"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.2266681"
Evaluating: 27.2266681-3.5
 Parameter: YMIN <- "23.7266681"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.3092292"
Evaluating: 31.3092292-3.5
 Parameter: ZMIN <- "27.8092292"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "25.5426903"
 Parameter: XMIN -> "18.5426903"
 Parameter: YMAX -> "30.7266681"
 Parameter: YMIN -> "23.7266681"
 Parameter: ZMAX -> "34.8092292"
 Parameter: ZMIN -> "27.8092292"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "4"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "4" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "4"
Evaluating: 4
 Parameter: J <- "4"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "4" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.186044179"
Evaluating: (89.1533903-9.0)*(0.186044179-0.5)
 Parameter: XPOS <- "-25.1646235"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.302873646"
Evaluating: (89.1533903-9.0)*(0.302873646-0.5)
 Parameter: YPOS <- "-15.8003456"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.223196294"
Evaluating: (89.1533903-9.0)*(0.223196294-0.5)
 Parameter: ZPOS <- "-22.1867555"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-25.1646235"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -25.1646235-44.5766951
 Parameter: XTRAN <- "-69.7413186"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.8003456"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -15.8003456-44.5766951
 Parameter: YTRAN <- "-60.3770407"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.1867555"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -22.1867555-44.5766951
 Parameter: ZTRAN <- "-66.7634506"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-69.7413186"
 Parameter: YTRAN -> "-60.3770407"
 Parameter: ZTRAN -> "-66.7634506"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -69.741319  -60.377041  -66.763451
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.716937791"
Evaluating: 0.716937791*360.0
 Parameter: XPHI <- "258.097605"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.28888773E-03"
Evaluating: 5.28888773E-03*360.0
 Parameter: YPHI <- "1.90399958"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.848317276"
Evaluating: 0.848317276*360.0
 Parameter: ZPHI <- "305.394219"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-25.1646235"
 Parameter: YPOS -> "-15.8003456"
 Parameter: ZPOS -> "-22.1867555"
 Parameter: XPHI -> "258.097605"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.206245   -0.978500
    0.000000    0.978500   -0.206245

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  101.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-25.1646235"
 Parameter: YPOS -> "-15.8003456"
 Parameter: ZPOS -> "-22.1867555"
 Parameter: YPHI -> "1.90399958"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.999448    0.000000   -0.033225
    0.000000    1.000000    0.000000
    0.033225    0.000000    0.999448

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    1.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-25.1646235"
 Parameter: YPOS -> "-15.8003456"
 Parameter: ZPOS -> "-22.1867555"
 Parameter: ZPHI -> "305.394219"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.579199   -0.815186    0.000000
    0.815186    0.579199    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   54.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.164623 XMAX =  -25.164623 XAVE =  -25.164623
    YMIN =  -15.800346 YMAX =  -15.800346 YAVE =  -15.800346
    ZMIN =  -22.186756 ZMAX =  -22.186756 ZAVE =  -22.186756
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-25.1646235"
Evaluating: -25.1646235+3.5
 Parameter: XMAX <- "-21.6646235"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.8003456"
Evaluating: -15.8003456+3.5
 Parameter: YMAX <- "-12.3003456"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.1867555"
Evaluating: -22.1867555+3.5
 Parameter: ZMAX <- "-18.6867555"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-25.1646235"
Evaluating: -25.1646235-3.5
 Parameter: XMIN <- "-28.6646235"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.8003456"
Evaluating: -15.8003456-3.5
 Parameter: YMIN <- "-19.3003456"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.1867555"
Evaluating: -22.1867555-3.5
 Parameter: ZMIN <- "-25.6867555"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.6646235"
 Parameter: XMIN -> "-28.6646235"
 Parameter: YMAX -> "-12.3003456"
 Parameter: YMIN -> "-19.3003456"
 Parameter: ZMAX -> "-18.6867555"
 Parameter: ZMIN -> "-25.6867555"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "5"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "5" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "5"
Evaluating: 5
 Parameter: J <- "5"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "5" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.585706753"
Evaluating: (89.1533903-9.0)*(0.585706753-0.5)
 Parameter: XPOS <- "6.86968682"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.628100798"
Evaluating: (89.1533903-9.0)*(0.628100798-0.5)
 Parameter: YPOS <- "10.2677133"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "9.811640974E-04"
Evaluating: (89.1533903-9.0)*(9.811640974E-04-0.5)
 Parameter: ZPOS <- "-39.9980515"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.86968682"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 6.86968682-44.5766951
 Parameter: XTRAN <- "-37.7070083"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "10.2677133"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 10.2677133-44.5766951
 Parameter: YTRAN <- "-34.3089818"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.9980515"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -39.9980515-44.5766951
 Parameter: ZTRAN <- "-84.5747466"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.7070083"
 Parameter: YTRAN -> "-34.3089818"
 Parameter: ZTRAN -> "-84.5747466"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -37.707008  -34.308982  -84.574747
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.121550076"
Evaluating: 0.121550076*360.0
 Parameter: XPHI <- "43.7580274"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.504152292"
Evaluating: 0.504152292*360.0
 Parameter: YPHI <- "181.494825"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.937324641E-02"
Evaluating: 3.937324641E-02*360.0
 Parameter: ZPHI <- "14.1743687"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.86968682"
 Parameter: YPOS -> "10.2677133"
 Parameter: ZPOS -> "-39.9980515"
 Parameter: XPHI -> "43.7580274"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.722267    0.691614
    0.000000   -0.691614    0.722267

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   43.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.86968682"
 Parameter: YPOS -> "10.2677133"
 Parameter: ZPOS -> "-39.9980515"
 Parameter: YPHI -> "181.494825"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.999660    0.000000    0.026087
    0.000000    1.000000    0.000000
   -0.026087    0.000000   -0.999660

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  178.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.86968682"
 Parameter: YPOS -> "10.2677133"
 Parameter: ZPOS -> "-39.9980515"
 Parameter: ZPHI -> "14.1743687"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.969555    0.244874    0.000000
   -0.244874    0.969555    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   14.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.869687 XMAX =    6.869687 XAVE =    6.869687
    YMIN =   10.267713 YMAX =   10.267713 YAVE =   10.267713
    ZMIN =  -39.998051 ZMAX =  -39.998051 ZAVE =  -39.998051
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.86968684"
Evaluating: 6.86968684+3.5
 Parameter: XMAX <- "10.3696868"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "10.2677133"
Evaluating: 10.2677133+3.5
 Parameter: YMAX <- "13.7677133"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.9980515"
Evaluating: -39.9980515+3.5
 Parameter: ZMAX <- "-36.4980515"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.86968684"
Evaluating: 6.86968684-3.5
 Parameter: XMIN <- "3.36968684"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "10.2677133"
Evaluating: 10.2677133-3.5
 Parameter: YMIN <- "6.7677133"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.9980515"
Evaluating: -39.9980515-3.5
 Parameter: ZMIN <- "-43.4980515"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.3696868"
 Parameter: XMIN -> "3.36968684"
 Parameter: YMAX -> "13.7677133"
 Parameter: YMIN -> "6.7677133"
 Parameter: ZMAX -> "-36.4980515"
 Parameter: ZMIN -> "-43.4980515"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "6"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "6" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "6"
Evaluating: 6
 Parameter: J <- "6"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "6" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.102308409"
Evaluating: (89.1533903-9.0)*(0.102308409-0.5)
 Parameter: XPOS <- "-31.8763293"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.400298657"
Evaluating: (89.1533903-9.0)*(0.400298657-0.5)
 Parameter: YPOS <- "-7.99140066"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.676818797"
Evaluating: (89.1533903-9.0)*(0.676818797-0.5)
 Parameter: ZPOS <- "14.172626"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.8763293"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -31.8763293-44.5766951
 Parameter: XTRAN <- "-76.4530244"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.99140066"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -7.99140066-44.5766951
 Parameter: YTRAN <- "-52.5680958"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "14.172626"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 14.172626-44.5766951
 Parameter: ZTRAN <- "-30.4040691"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-76.4530244"
 Parameter: YTRAN -> "-52.5680958"
 Parameter: ZTRAN -> "-30.4040691"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -76.453024  -52.568096  -30.404069
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.924410615"
Evaluating: 0.924410615*360.0
 Parameter: XPHI <- "332.787821"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.301100438"
Evaluating: 0.301100438*360.0
 Parameter: YPHI <- "108.396158"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.708688761"
Evaluating: 0.708688761*360.0
 Parameter: ZPHI <- "255.127954"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.8763293"
 Parameter: YPOS -> "-7.99140066"
 Parameter: ZPOS -> "14.172626"
 Parameter: XPHI -> "332.787821"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.889319   -0.457287
    0.000000    0.457287    0.889319

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   27.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.8763293"
 Parameter: YPOS -> "-7.99140066"
 Parameter: ZPOS -> "14.172626"
 Parameter: YPHI -> "108.396158"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.315585    0.000000   -0.948897
    0.000000    1.000000    0.000000
    0.948897    0.000000   -0.315585

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  108.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.8763293"
 Parameter: YPOS -> "-7.99140066"
 Parameter: ZPOS -> "14.172626"
 Parameter: ZPHI -> "255.127954"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.256661   -0.966501    0.000000
    0.966501   -0.256661    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  104.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.876329 XMAX =  -31.876329 XAVE =  -31.876329
    YMIN =   -7.991401 YMAX =   -7.991401 YAVE =   -7.991401
    ZMIN =   14.172626 ZMAX =   14.172626 ZAVE =   14.172626
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.8763293"
Evaluating: -31.8763293+3.5
 Parameter: XMAX <- "-28.3763293"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.99140063"
Evaluating: -7.99140063+3.5
 Parameter: YMAX <- "-4.49140063"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "14.172626"
Evaluating: 14.172626+3.5
 Parameter: ZMAX <- "17.672626"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.8763293"
Evaluating: -31.8763293-3.5
 Parameter: XMIN <- "-35.3763293"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.99140063"
Evaluating: -7.99140063-3.5
 Parameter: YMIN <- "-11.4914006"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "14.172626"
Evaluating: 14.172626-3.5
 Parameter: ZMIN <- "10.672626"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.3763293"
 Parameter: XMIN -> "-35.3763293"
 Parameter: YMAX -> "-4.49140063"
 Parameter: YMIN -> "-11.4914006"
 Parameter: ZMAX -> "17.672626"
 Parameter: ZMIN -> "10.672626"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "7"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "7" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "7" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.202151932"
Evaluating: (89.1533903-9.0)*(0.202151932-0.5)
 Parameter: XPOS <- "-23.8735324"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.494618753"
Evaluating: (89.1533903-9.0)*(0.494618753-0.5)
 Parameter: YPOS <- "-0.431325191"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.640618039"
Evaluating: (89.1533903-9.0)*(0.640618039-0.5)
 Parameter: ZPOS <- "11.2710126"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.8735324"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -23.8735324-44.5766951
 Parameter: XTRAN <- "-68.4502275"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.431325191"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -0.431325191-44.5766951
 Parameter: YTRAN <- "-45.0080203"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "11.2710126"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 11.2710126-44.5766951
 Parameter: ZTRAN <- "-33.3056825"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-68.4502275"
 Parameter: YTRAN -> "-45.0080203"
 Parameter: ZTRAN -> "-33.3056825"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -68.450227  -45.008020  -33.305683
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.834989264"
Evaluating: 0.834989264*360.0
 Parameter: XPHI <- "300.596135"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.463881136"
Evaluating: 0.463881136*360.0
 Parameter: YPHI <- "166.997209"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.534042387E-02"
Evaluating: 3.534042387E-02*360.0
 Parameter: ZPHI <- "12.7225526"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.8735324"
 Parameter: YPOS -> "-0.431325191"
 Parameter: ZPOS -> "11.2710126"
 Parameter: XPHI -> "300.596135"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.508983   -0.860776
    0.000000    0.860776    0.508983

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   59.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.8735324"
 Parameter: YPOS -> "-0.431325191"
 Parameter: ZPOS -> "11.2710126"
 Parameter: YPHI -> "166.997209"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.974359    0.000000   -0.224999
    0.000000    1.000000    0.000000
    0.224999    0.000000   -0.974359

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  167.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.8735324"
 Parameter: YPOS -> "-0.431325191"
 Parameter: ZPOS -> "11.2710126"
 Parameter: ZPHI -> "12.7225526"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.975448    0.220230    0.000000
   -0.220230    0.975448    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   12.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.873532 XMAX =  -23.873532 XAVE =  -23.873532
    YMIN =   -0.431325 YMAX =   -0.431325 YAVE =   -0.431325
    ZMIN =   11.271013 ZMAX =   11.271013 ZAVE =   11.271013
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.8735324"
Evaluating: -23.8735324+3.5
 Parameter: XMAX <- "-20.3735324"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.431325196"
Evaluating: -0.431325196+3.5
 Parameter: YMAX <- "3.0686748"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "11.2710126"
Evaluating: 11.2710126+3.5
 Parameter: ZMAX <- "14.7710126"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.8735324"
Evaluating: -23.8735324-3.5
 Parameter: XMIN <- "-27.3735324"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.431325196"
Evaluating: -0.431325196-3.5
 Parameter: YMIN <- "-3.9313252"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "11.2710126"
Evaluating: 11.2710126-3.5
 Parameter: ZMIN <- "7.7710126"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-20.3735324"
 Parameter: XMIN -> "-27.3735324"
 Parameter: YMAX -> "3.0686748"
 Parameter: YMIN -> "-3.9313252"
 Parameter: ZMAX -> "14.7710126"
 Parameter: ZMIN -> "7.7710126"
 SELRPN>     35 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "35"
 Comparing "35" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     22 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9109 POS      SOD      7        SOD     - 382 PAA1     MET      25       C             4.1911
 9109 POS      SOD      7        SOD     - 383 PAA1     MET      25       O             3.9975
 9109 POS      SOD      7        SOD     - 384 PAA1     ASN      26       N             3.6827
 9109 POS      SOD      7        SOD     - 386 PAA1     ASN      26       CA            2.7202
 9109 POS      SOD      7        SOD     - 388 PAA1     ASN      26       CB            3.3764
 9109 POS      SOD      7        SOD     - 396 PAA1     ASN      26       C             1.2504
 9109 POS      SOD      7        SOD     - 397 PAA1     ASN      26       O             1.2453
 9109 POS      SOD      7        SOD     - 398 PAA1     SER      27       N             1.4668
 9109 POS      SOD      7        SOD     - 400 PAA1     SER      27       CA            1.8031
 9109 POS      SOD      7        SOD     - 402 PAA1     SER      27       CB            3.2153
 9109 POS      SOD      7        SOD     - 405 PAA1     SER      27       OG            3.6186
 9109 POS      SOD      7        SOD     - 407 PAA1     SER      27       C             2.5995
 9109 POS      SOD      7        SOD     - 408 PAA1     SER      27       O             3.1936
 9109 POS      SOD      7        SOD     - 409 PAA1     PHE      28       N             3.3595
 9109 POS      SOD      7        SOD     - 446 PAA1     GLN      30       N             3.7881
 9109 POS      SOD      7        SOD     - 450 PAA1     GLN      30       CB            3.5689
 9109 POS      SOD      7        SOD     - 453 PAA1     GLN      30       CG            3.6382
 9109 POS      SOD      7        SOD     - 456 PAA1     GLN      30       CD            3.5778
 9109 POS      SOD      7        SOD     - 457 PAA1     GLN      30       OE1           4.1591
 9109 POS      SOD      7        SOD     - 458 PAA1     GLN      30       NE2           3.5975
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        20
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "20"
 Comparing "20" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "7" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.604470893"
Evaluating: (89.1533903-9.0)*(0.604470893-0.5)
 Parameter: XPOS <- "8.37369626"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.78479055"
Evaluating: (89.1533903-9.0)*(0.78479055-0.5)
 Parameter: YPOS <- "22.8269281"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.477509087"
Evaluating: (89.1533903-9.0)*(0.477509087-0.5)
 Parameter: ZPOS <- "-1.80272293"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.873532 XMAX =  -23.873532 XAVE =  -23.873532
    YMIN =   -0.431325 YMAX =   -0.431325 YAVE =   -0.431325
    ZMIN =   11.271013 ZMAX =   11.271013 ZAVE =   11.271013
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.37369626"
 RDCMND substituted energy or value "?XAVE" to "-23.8735324"
Evaluating: 8.37369626--23.8735324
 Parameter: XTRAN <- "32.2472287"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.8269281"
 RDCMND substituted energy or value "?YAVE" to "-0.431325196"
Evaluating: 22.8269281--0.431325196
 Parameter: YTRAN <- "23.2582533"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-1.80272293"
 RDCMND substituted energy or value "?ZAVE" to "11.2710126"
Evaluating: -1.80272293-11.2710126
 Parameter: ZTRAN <- "-13.0737355"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.2472287"
 Parameter: YTRAN -> "23.2582533"
 Parameter: ZTRAN -> "-13.0737355"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    32.247229   23.258253  -13.073735
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.217740937"
Evaluating: 0.217740937*360.0
 Parameter: XPHI <- "78.3867373"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.420514907"
Evaluating: 0.420514907*360.0
 Parameter: YPHI <- "151.385367"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.891873221"
Evaluating: 0.891873221*360.0
 Parameter: ZPHI <- "321.07436"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.37369626"
 Parameter: YPOS -> "22.8269281"
 Parameter: ZPOS -> "-1.80272293"
 Parameter: XPHI -> "78.3867373"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.201305    0.979529
    0.000000   -0.979529    0.201305

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   78.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.37369626"
 Parameter: YPOS -> "22.8269281"
 Parameter: ZPOS -> "-1.80272293"
 Parameter: YPHI -> "151.385367"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.877861    0.000000   -0.478916
    0.000000    1.000000    0.000000
    0.478916    0.000000   -0.877861

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  151.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.37369626"
 Parameter: YPOS -> "22.8269281"
 Parameter: ZPOS -> "-1.80272293"
 Parameter: ZPHI -> "321.07436"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.777962   -0.628311    0.000000
    0.628311    0.777962    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   38.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.373696 XMAX =    8.373696 XAVE =    8.373696
    YMIN =   22.826928 YMAX =   22.826928 YAVE =   22.826928
    ZMIN =   -1.802723 ZMAX =   -1.802723 ZAVE =   -1.802723
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.37369621"
Evaluating: 8.37369621+3.5
 Parameter: XMAX <- "11.8736962"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.8269281"
Evaluating: 22.8269281+3.5
 Parameter: YMAX <- "26.3269281"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-1.80272291"
Evaluating: -1.80272291+3.5
 Parameter: ZMAX <- "1.69727709"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.37369621"
Evaluating: 8.37369621-3.5
 Parameter: XMIN <- "4.87369621"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.8269281"
Evaluating: 22.8269281-3.5
 Parameter: YMIN <- "19.3269281"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-1.80272291"
Evaluating: -1.80272291-3.5
 Parameter: ZMIN <- "-5.30272291"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.8736962"
 Parameter: XMIN -> "4.87369621"
 Parameter: YMAX -> "26.3269281"
 Parameter: YMIN -> "19.3269281"
 Parameter: ZMAX -> "1.69727709"
 Parameter: ZMIN -> "-5.30272291"
 SELRPN>      6 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      2 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9109 POS      SOD      7        SOD     -3105 PAA1     ALA      239      N             4.4575
 9109 POS      SOD      7        SOD     -3109 PAA1     ALA      239      CB            3.1604
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "7"
Evaluating: 7
 Parameter: J <- "7"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "7" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.351206989"
Evaluating: (89.1533903-9.0)*(0.351206989-0.5)
 Parameter: XPOS <- "-11.9262643"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.160539433"
Evaluating: (89.1533903-9.0)*(0.160539433-0.5)
 Parameter: YPOS <- "-27.2089153"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.775646144"
Evaluating: (89.1533903-9.0)*(0.775646144-0.5)
 Parameter: ZPOS <- "22.093973"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.373696 XMAX =    8.373696 XAVE =    8.373696
    YMIN =   22.826928 YMAX =   22.826928 YAVE =   22.826928
    ZMIN =   -1.802723 ZMAX =   -1.802723 ZAVE =   -1.802723
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.9262643"
 RDCMND substituted energy or value "?XAVE" to "8.37369621"
Evaluating: -11.9262643-8.37369621
 Parameter: XTRAN <- "-20.2999605"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.2089153"
 RDCMND substituted energy or value "?YAVE" to "22.8269281"
Evaluating: -27.2089153-22.8269281
 Parameter: YTRAN <- "-50.0358434"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.093973"
 RDCMND substituted energy or value "?ZAVE" to "-1.80272291"
Evaluating: 22.093973--1.80272291
 Parameter: ZTRAN <- "23.8966959"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.2999605"
 Parameter: YTRAN -> "-50.0358434"
 Parameter: ZTRAN -> "23.8966959"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -20.299961  -50.035843   23.896696
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.952295945"
Evaluating: 0.952295945*360.0
 Parameter: XPHI <- "342.82654"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.851426957E-02"
Evaluating: 4.851426957E-02*360.0
 Parameter: YPHI <- "17.465137"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.478954836"
Evaluating: 0.478954836*360.0
 Parameter: ZPHI <- "172.423741"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.9262643"
 Parameter: YPOS -> "-27.2089153"
 Parameter: ZPOS -> "22.093973"
 Parameter: XPHI -> "342.82654"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.955415   -0.295266
    0.000000    0.295266    0.955415

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   17.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.9262643"
 Parameter: YPOS -> "-27.2089153"
 Parameter: ZPOS -> "22.093973"
 Parameter: YPHI -> "17.465137"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.953900    0.000000   -0.300125
    0.000000    1.000000    0.000000
    0.300125    0.000000    0.953900

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   17.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.9262643"
 Parameter: YPOS -> "-27.2089153"
 Parameter: ZPOS -> "22.093973"
 Parameter: ZPHI -> "172.423741"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.991270    0.131846    0.000000
   -0.131846   -0.991270    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  172.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.926264 XMAX =  -11.926264 XAVE =  -11.926264
    YMIN =  -27.208915 YMAX =  -27.208915 YAVE =  -27.208915
    ZMIN =   22.093973 ZMAX =   22.093973 ZAVE =   22.093973
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.9262643"
Evaluating: -11.9262643+3.5
 Parameter: XMAX <- "-8.4262643"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.2089153"
Evaluating: -27.2089153+3.5
 Parameter: YMAX <- "-23.7089153"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.093973"
Evaluating: 22.093973+3.5
 Parameter: ZMAX <- "25.593973"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.9262643"
Evaluating: -11.9262643-3.5
 Parameter: XMIN <- "-15.4262643"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.2089153"
Evaluating: -27.2089153-3.5
 Parameter: YMIN <- "-30.7089153"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.093973"
Evaluating: 22.093973-3.5
 Parameter: ZMIN <- "18.593973"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.4262643"
 Parameter: XMIN -> "-15.4262643"
 Parameter: YMAX -> "-23.7089153"
 Parameter: YMIN -> "-30.7089153"
 Parameter: ZMAX -> "25.593973"
 Parameter: ZMIN -> "18.593973"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "8"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "8" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "8"
Evaluating: 8
 Parameter: J <- "8"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "8" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.497324882"
Evaluating: (89.1533903-9.0)*(0.497324882-0.5)
 Parameter: XPOS <- "-0.214419777"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.199962462"
Evaluating: (89.1533903-9.0)*(0.199962462-0.5)
 Parameter: YPOS <- "-24.0490259"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.482700628"
Evaluating: (89.1533903-9.0)*(0.482700628-0.5)
 Parameter: ZPOS <- "-1.38660332"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.214419777"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -0.214419777-44.5766951
 Parameter: XTRAN <- "-44.7911149"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.0490259"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -24.0490259-44.5766951
 Parameter: YTRAN <- "-68.625721"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-1.38660332"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -1.38660332-44.5766951
 Parameter: ZTRAN <- "-45.9632984"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.7911149"
 Parameter: YTRAN -> "-68.625721"
 Parameter: ZTRAN -> "-45.9632984"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -44.791115  -68.625721  -45.963298
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.383411379"
Evaluating: 0.383411379*360.0
 Parameter: XPHI <- "138.028096"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.467246387"
Evaluating: 0.467246387*360.0
 Parameter: YPHI <- "168.208699"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.388461964"
Evaluating: 0.388461964*360.0
 Parameter: ZPHI <- "139.846307"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.214419777"
 Parameter: YPOS -> "-24.0490259"
 Parameter: ZPOS -> "-1.38660332"
 Parameter: XPHI -> "138.028096"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.743473    0.668766
    0.000000   -0.668766   -0.743473

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  138.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.214419777"
 Parameter: YPOS -> "-24.0490259"
 Parameter: ZPOS -> "-1.38660332"
 Parameter: YPHI -> "168.208699"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.978898    0.000000   -0.204347
    0.000000    1.000000    0.000000
    0.204347    0.000000   -0.978898

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  168.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.214419777"
 Parameter: YPOS -> "-24.0490259"
 Parameter: ZPOS -> "-1.38660332"
 Parameter: ZPHI -> "139.846307"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.764317    0.644840    0.000000
   -0.644840   -0.764317    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  139.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.214420 XMAX =   -0.214420 XAVE =   -0.214420
    YMIN =  -24.049026 YMAX =  -24.049026 YAVE =  -24.049026
    ZMIN =   -1.386603 ZMAX =   -1.386603 ZAVE =   -1.386603
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.214419788"
Evaluating: -0.214419788+3.5
 Parameter: XMAX <- "3.28558021"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.0490259"
Evaluating: -24.0490259+3.5
 Parameter: YMAX <- "-20.5490259"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-1.38660331"
Evaluating: -1.38660331+3.5
 Parameter: ZMAX <- "2.11339669"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.214419788"
Evaluating: -0.214419788-3.5
 Parameter: XMIN <- "-3.71441979"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.0490259"
Evaluating: -24.0490259-3.5
 Parameter: YMIN <- "-27.5490259"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-1.38660331"
Evaluating: -1.38660331-3.5
 Parameter: ZMIN <- "-4.88660331"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.28558021"
 Parameter: XMIN -> "-3.71441979"
 Parameter: YMAX -> "-20.5490259"
 Parameter: YMIN -> "-27.5490259"
 Parameter: ZMAX -> "2.11339669"
 Parameter: ZMIN -> "-4.88660331"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "9"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "9" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "9"
Evaluating: 9
 Parameter: J <- "9"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "9" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.476028044"
Evaluating: (89.1533903-9.0)*(0.476028044-0.5)
 Parameter: XPOS <- "-1.92143355"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.517052397"
Evaluating: (89.1533903-9.0)*(0.517052397-0.5)
 Parameter: YPOS <- "1.36680743"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.479008367"
Evaluating: (89.1533903-9.0)*(0.479008367-0.5)
 Parameter: ZPOS <- "-1.68255055"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.92143355"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -1.92143355-44.5766951
 Parameter: XTRAN <- "-46.4981287"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.36680743"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 1.36680743-44.5766951
 Parameter: YTRAN <- "-43.2098877"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-1.68255055"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -1.68255055-44.5766951
 Parameter: ZTRAN <- "-46.2592457"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-46.4981287"
 Parameter: YTRAN -> "-43.2098877"
 Parameter: ZTRAN -> "-46.2592457"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -46.498129  -43.209888  -46.259246
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.304465961E-03"
Evaluating: 1.304465961E-03*360.0
 Parameter: XPHI <- "0.469607746"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.711359851"
Evaluating: 0.711359851*360.0
 Parameter: YPHI <- "256.089546"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.221369459"
Evaluating: 0.221369459*360.0
 Parameter: ZPHI <- "79.6930052"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.92143355"
 Parameter: YPOS -> "1.36680743"
 Parameter: ZPOS -> "-1.68255055"
 Parameter: XPHI -> "0.469607746"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999966    0.008196
    0.000000   -0.008196    0.999966

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    0.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.92143355"
 Parameter: YPOS -> "1.36680743"
 Parameter: ZPOS -> "-1.68255055"
 Parameter: YPHI -> "256.089546"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.240405    0.000000    0.970673
    0.000000    1.000000    0.000000
   -0.970673    0.000000   -0.240405

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  103.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.92143355"
 Parameter: YPOS -> "1.36680743"
 Parameter: ZPOS -> "-1.68255055"
 Parameter: ZPHI -> "79.6930052"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.178922    0.983863    0.000000
   -0.983863    0.178922    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   79.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.921434 XMAX =   -1.921434 XAVE =   -1.921434
    YMIN =    1.366807 YMAX =    1.366807 YAVE =    1.366807
    ZMIN =   -1.682550 ZMAX =   -1.682550 ZAVE =   -1.682550
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.92143359"
Evaluating: -1.92143359+3.5
 Parameter: XMAX <- "1.57856641"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.36680746"
Evaluating: 1.36680746+3.5
 Parameter: YMAX <- "4.86680746"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-1.68255049"
Evaluating: -1.68255049+3.5
 Parameter: ZMAX <- "1.81744951"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.92143359"
Evaluating: -1.92143359-3.5
 Parameter: XMIN <- "-5.42143359"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.36680746"
Evaluating: 1.36680746-3.5
 Parameter: YMIN <- "-2.13319254"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-1.68255049"
Evaluating: -1.68255049-3.5
 Parameter: ZMIN <- "-5.18255049"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.57856641"
 Parameter: XMIN -> "-5.42143359"
 Parameter: YMAX -> "4.86680746"
 Parameter: YMIN -> "-2.13319254"
 Parameter: ZMAX -> "1.81744951"
 Parameter: ZMIN -> "-5.18255049"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "10"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "10" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "10"
Evaluating: 10
 Parameter: J <- "10"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "10" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "4.858910999E-03"
Evaluating: (89.1533903-9.0)*(4.858910999E-03-0.5)
 Parameter: XPOS <- "-39.687237"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.973773693"
Evaluating: (89.1533903-9.0)*(0.973773693-0.5)
 Parameter: YPOS <- "37.9745677"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.82641049"
Evaluating: (89.1533903-9.0)*(0.82641049-0.5)
 Parameter: ZPOS <- "26.1629074"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.687237"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -39.687237-44.5766951
 Parameter: XTRAN <- "-84.2639321"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.9745677"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 37.9745677-44.5766951
 Parameter: YTRAN <- "-6.6021274"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.1629074"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 26.1629074-44.5766951
 Parameter: ZTRAN <- "-18.4137877"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-84.2639321"
 Parameter: YTRAN -> "-6.6021274"
 Parameter: ZTRAN -> "-18.4137877"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -84.263932   -6.602127  -18.413788
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.892615244"
Evaluating: 0.892615244*360.0
 Parameter: XPHI <- "321.341488"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.678261"
Evaluating: 0.678261*360.0
 Parameter: YPHI <- "244.17396"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.330702445"
Evaluating: 0.330702445*360.0
 Parameter: ZPHI <- "119.05288"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.687237"
 Parameter: YPOS -> "37.9745677"
 Parameter: ZPOS -> "26.1629074"
 Parameter: XPHI -> "321.341488"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.780883   -0.624677
    0.000000    0.624677    0.780883

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   38.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.687237"
 Parameter: YPOS -> "37.9745677"
 Parameter: ZPOS -> "26.1629074"
 Parameter: YPHI -> "244.17396"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.435640    0.000000    0.900121
    0.000000    1.000000    0.000000
   -0.900121    0.000000   -0.435640

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  115.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.687237"
 Parameter: YPOS -> "37.9745677"
 Parameter: ZPOS -> "26.1629074"
 Parameter: ZPHI -> "119.05288"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.485617    0.874172    0.000000
   -0.874172   -0.485617    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  119.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.687237 XMAX =  -39.687237 XAVE =  -39.687237
    YMIN =   37.974568 YMAX =   37.974568 YAVE =   37.974568
    ZMIN =   26.162907 ZMAX =   26.162907 ZAVE =   26.162907
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.687237"
Evaluating: -39.687237+3.5
 Parameter: XMAX <- "-36.187237"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.9745677"
Evaluating: 37.9745677+3.5
 Parameter: YMAX <- "41.4745677"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.1629074"
Evaluating: 26.1629074+3.5
 Parameter: ZMAX <- "29.6629074"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.687237"
Evaluating: -39.687237-3.5
 Parameter: XMIN <- "-43.187237"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.9745677"
Evaluating: 37.9745677-3.5
 Parameter: YMIN <- "34.4745677"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.1629074"
Evaluating: 26.1629074-3.5
 Parameter: ZMIN <- "22.6629074"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.187237"
 Parameter: XMIN -> "-43.187237"
 Parameter: YMAX -> "41.4745677"
 Parameter: YMIN -> "34.4745677"
 Parameter: ZMAX -> "29.6629074"
 Parameter: ZMIN -> "22.6629074"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "11"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "11" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "11"
Evaluating: 11
 Parameter: J <- "11"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "11" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.923004374"
Evaluating: (89.1533903-9.0)*(0.923004374-0.5)
 Parameter: XPOS <- "33.9052347"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "8.752342763E-02"
Evaluating: (89.1533903-9.0)*(8.752342763E-02-0.5)
 Parameter: YPOS <- "-33.0613957"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.830463213"
Evaluating: (89.1533903-9.0)*(0.830463213-0.5)
 Parameter: ZPOS <- "26.4877469"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "33.9052347"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 33.9052347-44.5766951
 Parameter: XTRAN <- "-10.6714604"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.0613957"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -33.0613957-44.5766951
 Parameter: YTRAN <- "-77.6380908"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.4877469"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 26.4877469-44.5766951
 Parameter: ZTRAN <- "-18.0889482"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.6714604"
 Parameter: YTRAN -> "-77.6380908"
 Parameter: ZTRAN -> "-18.0889482"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -10.671460  -77.638091  -18.088948
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.581502263"
Evaluating: 0.581502263*360.0
 Parameter: XPHI <- "209.340815"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.774657986"
Evaluating: 0.774657986*360.0
 Parameter: YPHI <- "278.876875"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.827942214"
Evaluating: 0.827942214*360.0
 Parameter: ZPHI <- "298.059197"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "33.9052347"
 Parameter: YPOS -> "-33.0613957"
 Parameter: ZPOS -> "26.4877469"
 Parameter: XPHI -> "209.340815"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.871720   -0.490004
    0.000000    0.490004   -0.871720

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  150.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "33.9052347"
 Parameter: YPOS -> "-33.0613957"
 Parameter: ZPOS -> "26.4877469"
 Parameter: YPHI -> "278.876875"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.154312    0.000000    0.988022
    0.000000    1.000000    0.000000
   -0.988022    0.000000    0.154312

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   81.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "33.9052347"
 Parameter: YPOS -> "-33.0613957"
 Parameter: ZPOS -> "26.4877469"
 Parameter: ZPHI -> "298.059197"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.470384   -0.882462    0.000000
    0.882462    0.470384    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   61.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   33.905235 XMAX =   33.905235 XAVE =   33.905235
    YMIN =  -33.061396 YMAX =  -33.061396 YAVE =  -33.061396
    ZMIN =   26.487747 ZMAX =   26.487747 ZAVE =   26.487747
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "33.9052347"
Evaluating: 33.9052347+3.5
 Parameter: XMAX <- "37.4052347"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.0613957"
Evaluating: -33.0613957+3.5
 Parameter: YMAX <- "-29.5613957"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.4877469"
Evaluating: 26.4877469+3.5
 Parameter: ZMAX <- "29.9877469"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "33.9052347"
Evaluating: 33.9052347-3.5
 Parameter: XMIN <- "30.4052347"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.0613957"
Evaluating: -33.0613957-3.5
 Parameter: YMIN <- "-36.5613957"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.4877469"
Evaluating: 26.4877469-3.5
 Parameter: ZMIN <- "22.9877469"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.4052347"
 Parameter: XMIN -> "30.4052347"
 Parameter: YMAX -> "-29.5613957"
 Parameter: YMIN -> "-36.5613957"
 Parameter: ZMAX -> "29.9877469"
 Parameter: ZMIN -> "22.9877469"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "12"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "12" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "12" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.942972041"
Evaluating: (89.1533903-9.0)*(0.942972041-0.5)
 Parameter: XPOS <- "35.5057109"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.415866198"
Evaluating: (89.1533903-9.0)*(0.415866198-0.5)
 Parameter: YPOS <- "-6.74360947"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.145748742"
Evaluating: (89.1533903-9.0)*(0.145748742-0.5)
 Parameter: ZPOS <- "-28.3944393"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "35.5057109"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 35.5057109-44.5766951
 Parameter: XTRAN <- "-9.0709842"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.74360947"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -6.74360947-44.5766951
 Parameter: YTRAN <- "-51.3203046"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.3944393"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -28.3944393-44.5766951
 Parameter: ZTRAN <- "-72.9711344"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.0709842"
 Parameter: YTRAN -> "-51.3203046"
 Parameter: ZTRAN -> "-72.9711344"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    -9.070984  -51.320305  -72.971134
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.839996425"
Evaluating: 0.839996425*360.0
 Parameter: XPHI <- "302.398713"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.806513316"
Evaluating: 0.806513316*360.0
 Parameter: YPHI <- "290.344794"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.491490511"
Evaluating: 0.491490511*360.0
 Parameter: ZPHI <- "176.936584"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "35.5057109"
 Parameter: YPOS -> "-6.74360947"
 Parameter: ZPOS -> "-28.3944393"
 Parameter: XPHI -> "302.398713"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.535808   -0.844340
    0.000000    0.844340    0.535808

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   57.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "35.5057109"
 Parameter: YPOS -> "-6.74360947"
 Parameter: ZPOS -> "-28.3944393"
 Parameter: YPHI -> "290.344794"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.347669    0.000000    0.937617
    0.000000    1.000000    0.000000
   -0.937617    0.000000    0.347669

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   69.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "35.5057109"
 Parameter: YPOS -> "-6.74360947"
 Parameter: ZPOS -> "-28.3944393"
 Parameter: ZPHI -> "176.936584"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.998571    0.053441    0.000000
   -0.053441   -0.998571    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  176.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.505711 XMAX =   35.505711 XAVE =   35.505711
    YMIN =   -6.743609 YMAX =   -6.743609 YAVE =   -6.743609
    ZMIN =  -28.394439 ZMAX =  -28.394439 ZAVE =  -28.394439
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "35.5057109"
Evaluating: 35.5057109+3.5
 Parameter: XMAX <- "39.0057109"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.74360945"
Evaluating: -6.74360945+3.5
 Parameter: YMAX <- "-3.24360945"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.3944393"
Evaluating: -28.3944393+3.5
 Parameter: ZMAX <- "-24.8944393"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "35.5057109"
Evaluating: 35.5057109-3.5
 Parameter: XMIN <- "32.0057109"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.74360945"
Evaluating: -6.74360945-3.5
 Parameter: YMIN <- "-10.2436095"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.3944393"
Evaluating: -28.3944393-3.5
 Parameter: ZMIN <- "-31.8944393"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.0057109"
 Parameter: XMIN -> "32.0057109"
 Parameter: YMAX -> "-3.24360945"
 Parameter: YMIN -> "-10.2436095"
 Parameter: ZMAX -> "-24.8944393"
 Parameter: ZMIN -> "-31.8944393"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      1 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9114 POS      SOD      12       SOD     -9104 POS      SOD      2        SOD           2.1433
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "12"
Evaluating: 12
 Parameter: J <- "12"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "12" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.32380256"
Evaluating: (89.1533903-9.0)*(0.32380256-0.5)
 Parameter: XPOS <- "-14.1228222"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.999508136"
Evaluating: (89.1533903-9.0)*(0.999508136-0.5)
 Parameter: YPOS <- "40.0372706"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "3.421749118E-02"
Evaluating: (89.1533903-9.0)*(3.421749118E-02-0.5)
 Parameter: ZPOS <- "-37.3340472"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.505711 XMAX =   35.505711 XAVE =   35.505711
    YMIN =   -6.743609 YMAX =   -6.743609 YAVE =   -6.743609
    ZMIN =  -28.394439 ZMAX =  -28.394439 ZAVE =  -28.394439
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.1228222"
 RDCMND substituted energy or value "?XAVE" to "35.5057109"
Evaluating: -14.1228222-35.5057109
 Parameter: XTRAN <- "-49.6285331"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "40.0372706"
 RDCMND substituted energy or value "?YAVE" to "-6.74360945"
Evaluating: 40.0372706--6.74360945
 Parameter: YTRAN <- "46.7808801"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.3340472"
 RDCMND substituted energy or value "?ZAVE" to "-28.3944393"
Evaluating: -37.3340472--28.3944393
 Parameter: ZTRAN <- "-8.9396079"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-49.6285331"
 Parameter: YTRAN -> "46.7808801"
 Parameter: ZTRAN -> "-8.9396079"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -49.628533   46.780880   -8.939608
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.262907268"
Evaluating: 0.262907268*360.0
 Parameter: XPHI <- "94.6466165"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.825100334"
Evaluating: 0.825100334*360.0
 Parameter: YPHI <- "297.03612"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.824104338"
Evaluating: 0.824104338*360.0
 Parameter: ZPHI <- "296.677562"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.1228222"
 Parameter: YPOS -> "40.0372706"
 Parameter: ZPOS -> "-37.3340472"
 Parameter: XPHI -> "94.6466165"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.081010    0.996713
    0.000000   -0.996713   -0.081010

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   94.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.1228222"
 Parameter: YPOS -> "40.0372706"
 Parameter: ZPOS -> "-37.3340472"
 Parameter: YPHI -> "297.03612"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.454552    0.000000    0.890720
    0.000000    1.000000    0.000000
   -0.890720    0.000000    0.454552

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   62.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.1228222"
 Parameter: YPOS -> "40.0372706"
 Parameter: ZPOS -> "-37.3340472"
 Parameter: ZPHI -> "296.677562"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.448969   -0.893547    0.000000
    0.893547    0.448969    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   63.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.122822 XMAX =  -14.122822 XAVE =  -14.122822
    YMIN =   40.037271 YMAX =   40.037271 YAVE =   40.037271
    ZMIN =  -37.334047 ZMAX =  -37.334047 ZAVE =  -37.334047
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.1228222"
Evaluating: -14.1228222+3.5
 Parameter: XMAX <- "-10.6228222"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "40.0372706"
Evaluating: 40.0372706+3.5
 Parameter: YMAX <- "43.5372706"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.3340472"
Evaluating: -37.3340472+3.5
 Parameter: ZMAX <- "-33.8340472"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.1228222"
Evaluating: -14.1228222-3.5
 Parameter: XMIN <- "-17.6228222"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "40.0372706"
Evaluating: 40.0372706-3.5
 Parameter: YMIN <- "36.5372706"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.3340472"
Evaluating: -37.3340472-3.5
 Parameter: ZMIN <- "-40.8340472"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.6228222"
 Parameter: XMIN -> "-17.6228222"
 Parameter: YMAX -> "43.5372706"
 Parameter: YMIN -> "36.5372706"
 Parameter: ZMAX -> "-33.8340472"
 Parameter: ZMIN -> "-40.8340472"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "13"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "13" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "13"
Evaluating: 13
 Parameter: J <- "13"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "13" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.58983464"
Evaluating: (89.1533903-9.0)*(0.58983464-0.5)
 Parameter: XPOS <- "7.20055096"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.675147642"
Evaluating: (89.1533903-9.0)*(0.675147642-0.5)
 Parameter: YPOS <- "14.0386773"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.262567625"
Evaluating: (89.1533903-9.0)*(0.262567625-0.5)
 Parameter: ZPOS <- "-19.0310098"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.20055096"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 7.20055096-44.5766951
 Parameter: XTRAN <- "-37.3761441"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.0386773"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 14.0386773-44.5766951
 Parameter: YTRAN <- "-30.5380178"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.0310098"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -19.0310098-44.5766951
 Parameter: ZTRAN <- "-63.6077049"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-37.3761441"
 Parameter: YTRAN -> "-30.5380178"
 Parameter: ZTRAN -> "-63.6077049"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -37.376144  -30.538018  -63.607705
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.914145571E-02"
Evaluating: 9.914145571E-02*360.0
 Parameter: XPHI <- "35.6909241"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.770388953"
Evaluating: 0.770388953*360.0
 Parameter: YPHI <- "277.340023"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.947146413"
Evaluating: 0.947146413*360.0
 Parameter: ZPHI <- "340.972709"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.20055096"
 Parameter: YPOS -> "14.0386773"
 Parameter: ZPOS -> "-19.0310098"
 Parameter: XPHI -> "35.6909241"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.812176    0.583413
    0.000000   -0.583413    0.812176

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   35.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.20055096"
 Parameter: YPOS -> "14.0386773"
 Parameter: ZPOS -> "-19.0310098"
 Parameter: YPHI -> "277.340023"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.127757    0.000000    0.991805
    0.000000    1.000000    0.000000
   -0.991805    0.000000    0.127757

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   82.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.20055096"
 Parameter: YPOS -> "14.0386773"
 Parameter: ZPOS -> "-19.0310098"
 Parameter: ZPHI -> "340.972709"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.945363   -0.326018    0.000000
    0.326018    0.945363    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   19.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.200551 XMAX =    7.200551 XAVE =    7.200551
    YMIN =   14.038677 YMAX =   14.038677 YAVE =   14.038677
    ZMIN =  -19.031010 ZMAX =  -19.031010 ZAVE =  -19.031010
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.20055096"
Evaluating: 7.20055096+3.5
 Parameter: XMAX <- "10.700551"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.0386773"
Evaluating: 14.0386773+3.5
 Parameter: YMAX <- "17.5386773"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.0310098"
Evaluating: -19.0310098+3.5
 Parameter: ZMAX <- "-15.5310098"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.20055096"
Evaluating: 7.20055096-3.5
 Parameter: XMIN <- "3.70055096"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.0386773"
Evaluating: 14.0386773-3.5
 Parameter: YMIN <- "10.5386773"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.0310098"
Evaluating: -19.0310098-3.5
 Parameter: ZMIN <- "-22.5310098"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.700551"
 Parameter: XMIN -> "3.70055096"
 Parameter: YMAX -> "17.5386773"
 Parameter: YMIN -> "10.5386773"
 Parameter: ZMAX -> "-15.5310098"
 Parameter: ZMIN -> "-22.5310098"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "14"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "14" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "14"
Evaluating: 14
 Parameter: J <- "14"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "14" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.773246013"
Evaluating: (89.1533903-9.0)*(0.773246013-0.5)
 Parameter: XPOS <- "21.9015943"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "9.68699147E-02"
Evaluating: (89.1533903-9.0)*(9.68699147E-02-0.5)
 Parameter: YPOS <- "-32.3122431"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "8.716298604E-02"
Evaluating: (89.1533903-9.0)*(8.716298604E-02-0.5)
 Parameter: ZPOS <- "-33.0902863"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "21.9015943"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 21.9015943-44.5766951
 Parameter: XTRAN <- "-22.6751008"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.3122431"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -32.3122431-44.5766951
 Parameter: YTRAN <- "-76.8889382"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.0902863"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -33.0902863-44.5766951
 Parameter: ZTRAN <- "-77.6669814"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.6751008"
 Parameter: YTRAN -> "-76.8889382"
 Parameter: ZTRAN -> "-77.6669814"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -22.675101  -76.888938  -77.666981
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.670073692"
Evaluating: 0.670073692*360.0
 Parameter: XPHI <- "241.226529"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.685214848"
Evaluating: 0.685214848*360.0
 Parameter: YPHI <- "246.677345"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.921325799E-02"
Evaluating: 7.921325799E-02*360.0
 Parameter: ZPHI <- "28.5167729"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "21.9015943"
 Parameter: YPOS -> "-32.3122431"
 Parameter: ZPOS -> "-33.0902863"
 Parameter: XPHI -> "241.226529"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.481348   -0.876530
    0.000000    0.876530   -0.481348

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  118.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "21.9015943"
 Parameter: YPOS -> "-32.3122431"
 Parameter: ZPOS -> "-33.0902863"
 Parameter: YPHI -> "246.677345"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.395909    0.000000    0.918290
    0.000000    1.000000    0.000000
   -0.918290    0.000000   -0.395909

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  113.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "21.9015943"
 Parameter: YPOS -> "-32.3122431"
 Parameter: ZPOS -> "-33.0902863"
 Parameter: ZPHI -> "28.5167729"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.878677    0.477416    0.000000
   -0.477416    0.878677    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   28.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.901594 XMAX =   21.901594 XAVE =   21.901594
    YMIN =  -32.312243 YMAX =  -32.312243 YAVE =  -32.312243
    ZMIN =  -33.090286 ZMAX =  -33.090286 ZAVE =  -33.090286
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "21.9015943"
Evaluating: 21.9015943+3.5
 Parameter: XMAX <- "25.4015943"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.3122431"
Evaluating: -32.3122431+3.5
 Parameter: YMAX <- "-28.8122431"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.0902863"
Evaluating: -33.0902863+3.5
 Parameter: ZMAX <- "-29.5902863"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "21.9015943"
Evaluating: 21.9015943-3.5
 Parameter: XMIN <- "18.4015943"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.3122431"
Evaluating: -32.3122431-3.5
 Parameter: YMIN <- "-35.8122431"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.0902863"
Evaluating: -33.0902863-3.5
 Parameter: ZMIN <- "-36.5902863"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "25.4015943"
 Parameter: XMIN -> "18.4015943"
 Parameter: YMAX -> "-28.8122431"
 Parameter: YMIN -> "-35.8122431"
 Parameter: ZMAX -> "-29.5902863"
 Parameter: ZMIN -> "-36.5902863"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "15"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "15" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "15"
Evaluating: 15
 Parameter: J <- "15"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "15" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.748197655"
Evaluating: (89.1533903-9.0)*(0.748197655-0.5)
 Parameter: XPOS <- "19.8938835"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.978684075"
Evaluating: (89.1533903-9.0)*(0.978684075-0.5)
 Parameter: YPOS <- "38.3681515"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.278205872"
Evaluating: (89.1533903-9.0)*(0.278205872-0.5)
 Parameter: ZPOS <- "-17.7775513"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.8938835"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 19.8938835-44.5766951
 Parameter: XTRAN <- "-24.6828116"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "38.3681515"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 38.3681515-44.5766951
 Parameter: YTRAN <- "-6.2085436"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.7775513"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -17.7775513-44.5766951
 Parameter: ZTRAN <- "-62.3542464"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-24.6828116"
 Parameter: YTRAN -> "-6.2085436"
 Parameter: ZTRAN -> "-62.3542464"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -24.682812   -6.208544  -62.354246
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.188880019"
Evaluating: 0.188880019*360.0
 Parameter: XPHI <- "67.9968068"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.876152867E-02"
Evaluating: 8.876152867E-02*360.0
 Parameter: YPHI <- "31.9541503"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.832012052"
Evaluating: 0.832012052*360.0
 Parameter: ZPHI <- "299.524339"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.8938835"
 Parameter: YPOS -> "38.3681515"
 Parameter: ZPOS -> "-17.7775513"
 Parameter: XPHI -> "67.9968068"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.374658    0.927163
    0.000000   -0.927163    0.374658

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   68.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.8938835"
 Parameter: YPOS -> "38.3681515"
 Parameter: ZPOS -> "-17.7775513"
 Parameter: YPHI -> "31.9541503"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.848472    0.000000   -0.529240
    0.000000    1.000000    0.000000
    0.529240    0.000000    0.848472

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   31.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.8938835"
 Parameter: YPOS -> "38.3681515"
 Parameter: ZPOS -> "-17.7775513"
 Parameter: ZPHI -> "299.524339"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.492793   -0.870146    0.000000
    0.870146    0.492793    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   60.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.893884 XMAX =   19.893884 XAVE =   19.893884
    YMIN =   38.368152 YMAX =   38.368152 YAVE =   38.368152
    ZMIN =  -17.777551 ZMAX =  -17.777551 ZAVE =  -17.777551
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.8938835"
Evaluating: 19.8938835+3.5
 Parameter: XMAX <- "23.3938835"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "38.3681515"
Evaluating: 38.3681515+3.5
 Parameter: YMAX <- "41.8681515"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.7775513"
Evaluating: -17.7775513+3.5
 Parameter: ZMAX <- "-14.2775513"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.8938835"
Evaluating: 19.8938835-3.5
 Parameter: XMIN <- "16.3938835"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "38.3681515"
Evaluating: 38.3681515-3.5
 Parameter: YMIN <- "34.8681515"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.7775513"
Evaluating: -17.7775513-3.5
 Parameter: ZMIN <- "-21.2775513"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "23.3938835"
 Parameter: XMIN -> "16.3938835"
 Parameter: YMAX -> "41.8681515"
 Parameter: YMIN -> "34.8681515"
 Parameter: ZMAX -> "-14.2775513"
 Parameter: ZMIN -> "-21.2775513"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "16"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "16" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "16"
Evaluating: 16
 Parameter: J <- "16"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "16" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.741461747"
Evaluating: (89.1533903-9.0)*(0.741461747-0.5)
 Parameter: XPOS <- "19.3539776"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "6.338994501E-02"
Evaluating: (89.1533903-9.0)*(6.338994501E-02-0.5)
 Parameter: YPOS <- "-34.9957761"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.92996754"
Evaluating: (89.1533903-9.0)*(0.92996754-0.5)
 Parameter: ZPOS <- "34.463356"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.3539776"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 19.3539776-44.5766951
 Parameter: XTRAN <- "-25.2227175"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.9957761"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -34.9957761-44.5766951
 Parameter: YTRAN <- "-79.5724712"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.463356"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 34.463356-44.5766951
 Parameter: ZTRAN <- "-10.1133391"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.2227175"
 Parameter: YTRAN -> "-79.5724712"
 Parameter: ZTRAN -> "-10.1133391"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -25.222718  -79.572471  -10.113339
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.5854866"
Evaluating: 0.5854866*360.0
 Parameter: XPHI <- "210.775176"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.738371182"
Evaluating: 0.738371182*360.0
 Parameter: YPHI <- "265.813626"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.228891505E-02"
Evaluating: 9.228891505E-02*360.0
 Parameter: ZPHI <- "33.2240094"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.3539776"
 Parameter: YPOS -> "-34.9957761"
 Parameter: ZPOS -> "34.463356"
 Parameter: XPHI -> "210.775176"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.859182   -0.511671
    0.000000    0.511671   -0.859182

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  149.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.3539776"
 Parameter: YPOS -> "-34.9957761"
 Parameter: ZPOS -> "34.463356"
 Parameter: YPHI -> "265.813626"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.073001    0.000000    0.997332
    0.000000    1.000000    0.000000
   -0.997332    0.000000   -0.073001

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   94.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.3539776"
 Parameter: YPOS -> "-34.9957761"
 Parameter: ZPOS -> "34.463356"
 Parameter: ZPHI -> "33.2240094"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.836535    0.547914    0.000000
   -0.547914    0.836535    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   33.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.353978 XMAX =   19.353978 XAVE =   19.353978
    YMIN =  -34.995776 YMAX =  -34.995776 YAVE =  -34.995776
    ZMIN =   34.463356 ZMAX =   34.463356 ZAVE =   34.463356
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.3539776"
Evaluating: 19.3539776+3.5
 Parameter: XMAX <- "22.8539776"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.9957761"
Evaluating: -34.9957761+3.5
 Parameter: YMAX <- "-31.4957761"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.463356"
Evaluating: 34.463356+3.5
 Parameter: ZMAX <- "37.963356"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.3539776"
Evaluating: 19.3539776-3.5
 Parameter: XMIN <- "15.8539776"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.9957761"
Evaluating: -34.9957761-3.5
 Parameter: YMIN <- "-38.4957761"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.463356"
Evaluating: 34.463356-3.5
 Parameter: ZMIN <- "30.963356"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.8539776"
 Parameter: XMIN -> "15.8539776"
 Parameter: YMAX -> "-31.4957761"
 Parameter: YMIN -> "-38.4957761"
 Parameter: ZMAX -> "37.963356"
 Parameter: ZMIN -> "30.963356"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "17"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "17" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "17" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "7.893137174E-02"
Evaluating: (89.1533903-9.0)*(7.893137174E-02-0.5)
 Parameter: XPOS <- "-33.7500781"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.813410753"
Evaluating: (89.1533903-9.0)*(0.813410753-0.5)
 Parameter: YPOS <- "25.1209344"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.979514264"
Evaluating: (89.1533903-9.0)*(0.979514264-0.5)
 Parameter: ZPOS <- "38.434694"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.7500781"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -33.7500781-44.5766951
 Parameter: XTRAN <- "-78.3267732"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.1209344"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 25.1209344-44.5766951
 Parameter: YTRAN <- "-19.4557607"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "38.434694"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 38.434694-44.5766951
 Parameter: ZTRAN <- "-6.1420011"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-78.3267732"
 Parameter: YTRAN -> "-19.4557607"
 Parameter: ZTRAN -> "-6.1420011"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -78.326773  -19.455761   -6.142001
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.626568636E-02"
Evaluating: 6.626568636E-02*360.0
 Parameter: XPHI <- "23.8556471"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.518658172"
Evaluating: 0.518658172*360.0
 Parameter: YPHI <- "186.716942"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.151667295"
Evaluating: 0.151667295*360.0
 Parameter: ZPHI <- "54.6002262"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.7500781"
 Parameter: YPOS -> "25.1209344"
 Parameter: ZPOS -> "38.434694"
 Parameter: XPHI -> "23.8556471"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.914567    0.404434
    0.000000   -0.404434    0.914567

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   23.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.7500781"
 Parameter: YPOS -> "25.1209344"
 Parameter: ZPOS -> "38.434694"
 Parameter: YPHI -> "186.716942"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.993136    0.000000    0.116964
    0.000000    1.000000    0.000000
   -0.116964    0.000000   -0.993136

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  173.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.7500781"
 Parameter: YPOS -> "25.1209344"
 Parameter: ZPOS -> "38.434694"
 Parameter: ZPHI -> "54.6002262"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.579278    0.815130    0.000000
   -0.815130    0.579278    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   54.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.750078 XMAX =  -33.750078 XAVE =  -33.750078
    YMIN =   25.120934 YMAX =   25.120934 YAVE =   25.120934
    ZMIN =   38.434694 ZMAX =   38.434694 ZAVE =   38.434694
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.7500781"
Evaluating: -33.7500781+3.5
 Parameter: XMAX <- "-30.2500781"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.1209344"
Evaluating: 25.1209344+3.5
 Parameter: YMAX <- "28.6209344"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "38.434694"
Evaluating: 38.434694+3.5
 Parameter: ZMAX <- "41.934694"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.7500781"
Evaluating: -33.7500781-3.5
 Parameter: XMIN <- "-37.2500781"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.1209344"
Evaluating: 25.1209344-3.5
 Parameter: YMIN <- "21.6209344"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "38.434694"
Evaluating: 38.434694-3.5
 Parameter: ZMIN <- "34.934694"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.2500781"
 Parameter: XMIN -> "-37.2500781"
 Parameter: YMAX -> "28.6209344"
 Parameter: YMIN -> "21.6209344"
 Parameter: ZMAX -> "41.934694"
 Parameter: ZMIN -> "34.934694"
 SELRPN>     33 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "33"
 Comparing "33" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     13 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9119 POS      SOD      17       SOD     -7747 PAA2     SER      248      CB            3.9540
 9119 POS      SOD      17       SOD     -7754 PAA2     TYR      249      N             4.0790
 9119 POS      SOD      17       SOD     -7756 PAA2     TYR      249      CA            4.2686
 9119 POS      SOD      17       SOD     -8422 PAA2     ASN      299      ND2           3.9923
 9119 POS      SOD      17       SOD     -8429 PAA2     GLU      300      CA            4.3805
 9119 POS      SOD      17       SOD     -8471 PAA2     ILE      303      N             3.8987
 9119 POS      SOD      17       SOD     -8473 PAA2     ILE      303      CA            3.3582
 9119 POS      SOD      17       SOD     -8475 PAA2     ILE      303      CB            1.9237
 9119 POS      SOD      17       SOD     -8477 PAA2     ILE      303      CG2           2.4816
 9119 POS      SOD      17       SOD     -8481 PAA2     ILE      303      CG1           1.2950
 9119 POS      SOD      17       SOD     -8484 PAA2     ILE      303      CD            0.7453
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        11
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "17"
Evaluating: 17
 Parameter: J <- "17"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "17" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.334930984"
Evaluating: (89.1533903-9.0)*(0.334930984-0.5)
 Parameter: XPOS <- "-13.2308413"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "9.237502599E-02"
Evaluating: (89.1533903-9.0)*(9.237502599E-02-0.5)
 Parameter: YPOS <- "-32.6725236"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "3.175185399E-02"
Evaluating: (89.1533903-9.0)*(3.175185399E-02-0.5)
 Parameter: ZPOS <- "-37.5316764"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.750078 XMAX =  -33.750078 XAVE =  -33.750078
    YMIN =   25.120934 YMAX =   25.120934 YAVE =   25.120934
    ZMIN =   38.434694 ZMAX =   38.434694 ZAVE =   38.434694
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.2308413"
 RDCMND substituted energy or value "?XAVE" to "-33.7500781"
Evaluating: -13.2308413--33.7500781
 Parameter: XTRAN <- "20.5192368"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-32.6725236"
 RDCMND substituted energy or value "?YAVE" to "25.1209344"
Evaluating: -32.6725236-25.1209344
 Parameter: YTRAN <- "-57.793458"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.5316764"
 RDCMND substituted energy or value "?ZAVE" to "38.434694"
Evaluating: -37.5316764-38.434694
 Parameter: ZTRAN <- "-75.9663704"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.5192368"
 Parameter: YTRAN -> "-57.793458"
 Parameter: ZTRAN -> "-75.9663704"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    20.519237  -57.793458  -75.966370
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.381344113"
Evaluating: 0.381344113*360.0
 Parameter: XPHI <- "137.283881"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.330734184"
Evaluating: 0.330734184*360.0
 Parameter: YPHI <- "119.064306"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.420382092"
Evaluating: 0.420382092*360.0
 Parameter: ZPHI <- "151.337553"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.2308413"
 Parameter: YPOS -> "-32.6725236"
 Parameter: ZPOS -> "-37.5316764"
 Parameter: XPHI -> "137.283881"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.734724    0.678366
    0.000000   -0.678366   -0.734724

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  137.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.2308413"
 Parameter: YPOS -> "-32.6725236"
 Parameter: ZPOS -> "-37.5316764"
 Parameter: YPHI -> "119.064306"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.485791    0.000000   -0.874075
    0.000000    1.000000    0.000000
    0.874075    0.000000   -0.485791

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  119.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.2308413"
 Parameter: YPOS -> "-32.6725236"
 Parameter: ZPOS -> "-37.5316764"
 Parameter: ZPHI -> "151.337553"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.877461    0.479648    0.000000
   -0.479648   -0.877461    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  151.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.230841 XMAX =  -13.230841 XAVE =  -13.230841
    YMIN =  -32.672524 YMAX =  -32.672524 YAVE =  -32.672524
    ZMIN =  -37.531676 ZMAX =  -37.531676 ZAVE =  -37.531676
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.2308413"
Evaluating: -13.2308413+3.5
 Parameter: XMAX <- "-9.7308413"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-32.6725236"
Evaluating: -32.6725236+3.5
 Parameter: YMAX <- "-29.1725236"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.5316764"
Evaluating: -37.5316764+3.5
 Parameter: ZMAX <- "-34.0316764"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.2308413"
Evaluating: -13.2308413-3.5
 Parameter: XMIN <- "-16.7308413"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-32.6725236"
Evaluating: -32.6725236-3.5
 Parameter: YMIN <- "-36.1725236"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.5316764"
Evaluating: -37.5316764-3.5
 Parameter: ZMIN <- "-41.0316764"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.7308413"
 Parameter: XMIN -> "-16.7308413"
 Parameter: YMAX -> "-29.1725236"
 Parameter: YMIN -> "-36.1725236"
 Parameter: ZMAX -> "-34.0316764"
 Parameter: ZMIN -> "-41.0316764"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "18"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "18" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "18"
Evaluating: 18
 Parameter: J <- "18"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "18" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.225607084"
Evaluating: (89.1533903-9.0)*(0.225607084-0.5)
 Parameter: XPOS <- "-21.9935225"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.232944634"
Evaluating: (89.1533903-9.0)*(0.232944634-0.5)
 Parameter: YPOS <- "-21.405393"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.414653908"
Evaluating: (89.1533903-9.0)*(0.414653908-0.5)
 Parameter: ZPOS <- "-6.84077862"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-21.9935225"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -21.9935225-44.5766951
 Parameter: XTRAN <- "-66.5702176"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.405393"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -21.405393-44.5766951
 Parameter: YTRAN <- "-65.9820881"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-6.84077862"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -6.84077862-44.5766951
 Parameter: ZTRAN <- "-51.4174737"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-66.5702176"
 Parameter: YTRAN -> "-65.9820881"
 Parameter: ZTRAN -> "-51.4174737"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -66.570218  -65.982088  -51.417474
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.060244877E-03"
Evaluating: 4.060244877E-03*360.0
 Parameter: XPHI <- "1.46168816"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.533221826"
Evaluating: 0.533221826*360.0
 Parameter: YPHI <- "191.959857"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.756976333"
Evaluating: 0.756976333*360.0
 Parameter: ZPHI <- "272.51148"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-21.9935225"
 Parameter: YPOS -> "-21.405393"
 Parameter: ZPOS -> "-6.84077862"
 Parameter: XPHI -> "1.46168816"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999675    0.025509
    0.000000   -0.025509    0.999675

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    1.46

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-21.9935225"
 Parameter: YPOS -> "-21.405393"
 Parameter: ZPOS -> "-6.84077862"
 Parameter: YPHI -> "191.959857"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.978293    0.000000    0.207226
    0.000000    1.000000    0.000000
   -0.207226    0.000000   -0.978293

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  168.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-21.9935225"
 Parameter: YPOS -> "-21.405393"
 Parameter: ZPOS -> "-6.84077862"
 Parameter: ZPHI -> "272.51148"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.043820   -0.999039    0.000000
    0.999039    0.043820    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   87.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.993523 XMAX =  -21.993523 XAVE =  -21.993523
    YMIN =  -21.405393 YMAX =  -21.405393 YAVE =  -21.405393
    ZMIN =   -6.840779 ZMAX =   -6.840779 ZAVE =   -6.840779
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-21.9935225"
Evaluating: -21.9935225+3.5
 Parameter: XMAX <- "-18.4935225"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.405393"
Evaluating: -21.405393+3.5
 Parameter: YMAX <- "-17.905393"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-6.84077864"
Evaluating: -6.84077864+3.5
 Parameter: ZMAX <- "-3.34077864"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-21.9935225"
Evaluating: -21.9935225-3.5
 Parameter: XMIN <- "-25.4935225"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.405393"
Evaluating: -21.405393-3.5
 Parameter: YMIN <- "-24.905393"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-6.84077864"
Evaluating: -6.84077864-3.5
 Parameter: ZMIN <- "-10.3407786"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.4935225"
 Parameter: XMIN -> "-25.4935225"
 Parameter: YMAX -> "-17.905393"
 Parameter: YMIN -> "-24.905393"
 Parameter: ZMAX -> "-3.34077864"
 Parameter: ZMIN -> "-10.3407786"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "19"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "19" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "19"
Evaluating: 19
 Parameter: J <- "19"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "19" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.827788294"
Evaluating: (89.1533903-9.0)*(0.827788294-0.5)
 Parameter: XPOS <- "26.2733431"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "4.327695032E-03"
Evaluating: (89.1533903-9.0)*(4.327695032E-03-0.5)
 Parameter: YPOS <- "-39.7298157"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.603789094"
Evaluating: (89.1533903-9.0)*(0.603789094-0.5)
 Parameter: ZPOS <- "8.31904776"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.2733431"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 26.2733431-44.5766951
 Parameter: XTRAN <- "-18.303352"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.7298157"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -39.7298157-44.5766951
 Parameter: YTRAN <- "-84.3065108"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "8.31904776"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 8.31904776-44.5766951
 Parameter: ZTRAN <- "-36.2576473"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.303352"
 Parameter: YTRAN -> "-84.3065108"
 Parameter: ZTRAN -> "-36.2576473"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -18.303352  -84.306511  -36.257647
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.726093565"
Evaluating: 0.726093565*360.0
 Parameter: XPHI <- "261.393683"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.55082387"
Evaluating: 0.55082387*360.0
 Parameter: YPHI <- "198.296593"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.225266362"
Evaluating: 0.225266362*360.0
 Parameter: ZPHI <- "81.0958903"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.2733431"
 Parameter: YPOS -> "-39.7298157"
 Parameter: ZPOS -> "8.31904776"
 Parameter: XPHI -> "261.393683"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.149644   -0.988740
    0.000000    0.988740   -0.149644

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   98.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.2733431"
 Parameter: YPOS -> "-39.7298157"
 Parameter: ZPOS -> "8.31904776"
 Parameter: YPHI -> "198.296593"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.949444    0.000000    0.313936
    0.000000    1.000000    0.000000
   -0.313936    0.000000   -0.949444

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  161.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.2733431"
 Parameter: YPOS -> "-39.7298157"
 Parameter: ZPOS -> "8.31904776"
 Parameter: ZPHI -> "81.0958903"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.154781    0.987949    0.000000
   -0.987949    0.154781    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   81.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.273343 XMAX =   26.273343 XAVE =   26.273343
    YMIN =  -39.729816 YMAX =  -39.729816 YAVE =  -39.729816
    ZMIN =    8.319048 ZMAX =    8.319048 ZAVE =    8.319048
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.2733431"
Evaluating: 26.2733431+3.5
 Parameter: XMAX <- "29.7733431"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.7298157"
Evaluating: -39.7298157+3.5
 Parameter: YMAX <- "-36.2298157"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "8.31904777"
Evaluating: 8.31904777+3.5
 Parameter: ZMAX <- "11.8190478"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.2733431"
Evaluating: 26.2733431-3.5
 Parameter: XMIN <- "22.7733431"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.7298157"
Evaluating: -39.7298157-3.5
 Parameter: YMIN <- "-43.2298157"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "8.31904777"
Evaluating: 8.31904777-3.5
 Parameter: ZMIN <- "4.81904777"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.7733431"
 Parameter: XMIN -> "22.7733431"
 Parameter: YMAX -> "-36.2298157"
 Parameter: YMIN -> "-43.2298157"
 Parameter: ZMAX -> "11.8190478"
 Parameter: ZMIN -> "4.81904777"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "20"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "20" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "20" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.503658012"
Evaluating: (89.1533903-9.0)*(0.503658012-0.5)
 Parameter: XPOS <- "0.293202064"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.573545782"
Evaluating: (89.1533903-9.0)*(0.573545782-0.5)
 Parameter: YPOS <- "5.89494377"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.172666957"
Evaluating: (89.1533903-9.0)*(0.172666957-0.5)
 Parameter: ZPOS <- "-26.2368532"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.293202064"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 0.293202064-44.5766951
 Parameter: XTRAN <- "-44.283493"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.89494377"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 5.89494377-44.5766951
 Parameter: YTRAN <- "-38.6817513"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-26.2368532"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -26.2368532-44.5766951
 Parameter: ZTRAN <- "-70.8135483"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.283493"
 Parameter: YTRAN -> "-38.6817513"
 Parameter: ZTRAN -> "-70.8135483"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -44.283493  -38.681751  -70.813548
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.154243519"
Evaluating: 0.154243519*360.0
 Parameter: XPHI <- "55.5276668"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.983806527"
Evaluating: 0.983806527*360.0
 Parameter: YPHI <- "354.17035"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.942106907"
Evaluating: 0.942106907*360.0
 Parameter: ZPHI <- "339.158487"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.293202064"
 Parameter: YPOS -> "5.89494377"
 Parameter: ZPOS -> "-26.2368532"
 Parameter: XPHI -> "55.5276668"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.566008    0.824400
    0.000000   -0.824400    0.566008

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   55.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.293202064"
 Parameter: YPOS -> "5.89494377"
 Parameter: ZPOS -> "-26.2368532"
 Parameter: YPHI -> "354.17035"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.994828    0.000000    0.101571
    0.000000    1.000000    0.000000
   -0.101571    0.000000    0.994828

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    5.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.293202064"
 Parameter: YPOS -> "5.89494377"
 Parameter: ZPOS -> "-26.2368532"
 Parameter: ZPHI -> "339.158487"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.934568   -0.355784    0.000000
    0.355784    0.934568    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   20.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.293202 XMAX =    0.293202 XAVE =    0.293202
    YMIN =    5.894944 YMAX =    5.894944 YAVE =    5.894944
    ZMIN =  -26.236853 ZMAX =  -26.236853 ZAVE =  -26.236853
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.293202089"
Evaluating: 0.293202089+3.5
 Parameter: XMAX <- "3.79320209"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.8949438"
Evaluating: 5.8949438+3.5
 Parameter: YMAX <- "9.3949438"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-26.2368532"
Evaluating: -26.2368532+3.5
 Parameter: ZMAX <- "-22.7368532"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.293202089"
Evaluating: 0.293202089-3.5
 Parameter: XMIN <- "-3.20679791"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.8949438"
Evaluating: 5.8949438-3.5
 Parameter: YMIN <- "2.3949438"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-26.2368532"
Evaluating: -26.2368532-3.5
 Parameter: ZMIN <- "-29.7368532"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.79320209"
 Parameter: XMIN -> "-3.20679791"
 Parameter: YMAX -> "9.3949438"
 Parameter: YMIN -> "2.3949438"
 Parameter: ZMAX -> "-22.7368532"
 Parameter: ZMIN -> "-29.7368532"
 SELRPN>      9 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      5 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9122 POS      SOD      20       SOD     -2537 PAA1     GLN      187      CB            3.9339
 9122 POS      SOD      20       SOD     -2540 PAA1     GLN      187      CG            3.5654
 9122 POS      SOD      20       SOD     -2543 PAA1     GLN      187      CD            2.6922
 9122 POS      SOD      20       SOD     -2544 PAA1     GLN      187      OE1           2.2891
 9122 POS      SOD      20       SOD     -2545 PAA1     GLN      187      NE2           3.2145
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "20" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.234126832"
Evaluating: (89.1533903-9.0)*(0.234126832-0.5)
 Parameter: XPOS <- "-21.3106358"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "7.645902034E-02"
Evaluating: (89.1533903-9.0)*(7.645902034E-02-0.5)
 Parameter: YPOS <- "-33.9482455"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.495475117"
Evaluating: (89.1533903-9.0)*(0.495475117-0.5)
 Parameter: ZPOS <- "-0.362684713"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.293202 XMAX =    0.293202 XAVE =    0.293202
    YMIN =    5.894944 YMAX =    5.894944 YAVE =    5.894944
    ZMIN =  -26.236853 ZMAX =  -26.236853 ZAVE =  -26.236853
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-21.3106358"
 RDCMND substituted energy or value "?XAVE" to "0.293202089"
Evaluating: -21.3106358-0.293202089
 Parameter: XTRAN <- "-21.6038379"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.9482455"
 RDCMND substituted energy or value "?YAVE" to "5.8949438"
Evaluating: -33.9482455-5.8949438
 Parameter: YTRAN <- "-39.8431893"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-0.362684713"
 RDCMND substituted energy or value "?ZAVE" to "-26.2368532"
Evaluating: -0.362684713--26.2368532
 Parameter: ZTRAN <- "25.8741685"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-21.6038379"
 Parameter: YTRAN -> "-39.8431893"
 Parameter: ZTRAN -> "25.8741685"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -21.603838  -39.843189   25.874168
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.982646577"
Evaluating: 0.982646577*360.0
 Parameter: XPHI <- "353.752768"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.368199446"
Evaluating: 0.368199446*360.0
 Parameter: YPHI <- "132.551801"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.485307047"
Evaluating: 0.485307047*360.0
 Parameter: ZPHI <- "174.710537"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-21.3106358"
 Parameter: YPOS -> "-33.9482455"
 Parameter: ZPOS -> "-0.362684713"
 Parameter: XPHI -> "353.752768"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.994062   -0.108819
    0.000000    0.108819    0.994062

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    6.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-21.3106358"
 Parameter: YPOS -> "-33.9482455"
 Parameter: ZPOS -> "-0.362684713"
 Parameter: YPHI -> "132.551801"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.676257    0.000000   -0.736666
    0.000000    1.000000    0.000000
    0.736666    0.000000   -0.676257

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  132.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-21.3106358"
 Parameter: YPOS -> "-33.9482455"
 Parameter: ZPOS -> "-0.362684713"
 Parameter: ZPHI -> "174.710537"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.995742    0.092187    0.000000
   -0.092187   -0.995742    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  174.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.310636 XMAX =  -21.310636 XAVE =  -21.310636
    YMIN =  -33.948246 YMAX =  -33.948246 YAVE =  -33.948246
    ZMIN =   -0.362685 ZMAX =   -0.362685 ZAVE =   -0.362685
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-21.3106358"
Evaluating: -21.3106358+3.5
 Parameter: XMAX <- "-17.8106358"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.9482455"
Evaluating: -33.9482455+3.5
 Parameter: YMAX <- "-30.4482455"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-0.362684711"
Evaluating: -0.362684711+3.5
 Parameter: ZMAX <- "3.13731529"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-21.3106358"
Evaluating: -21.3106358-3.5
 Parameter: XMIN <- "-24.8106358"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.9482455"
Evaluating: -33.9482455-3.5
 Parameter: YMIN <- "-37.4482455"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-0.362684711"
Evaluating: -0.362684711-3.5
 Parameter: ZMIN <- "-3.86268471"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.8106358"
 Parameter: XMIN -> "-24.8106358"
 Parameter: YMAX -> "-30.4482455"
 Parameter: YMIN -> "-37.4482455"
 Parameter: ZMAX -> "3.13731529"
 Parameter: ZMIN -> "-3.86268471"
 SELRPN>      7 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      4 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9122 POS      SOD      20       SOD     -  59 PAA1     HSD      4        C             4.0094
 9122 POS      SOD      20       SOD     -  60 PAA1     HSD      4        O             3.0489
 9122 POS      SOD      20       SOD     -  85 PAA1     HSD      6        ND1           4.1563
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "20"
Evaluating: 20
 Parameter: J <- "20"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "20" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.870334284"
Evaluating: (89.1533903-9.0)*(0.870334284-0.5)
 Parameter: XPOS <- "29.6835484"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.545748085"
Evaluating: (89.1533903-9.0)*(0.545748085-0.5)
 Parameter: YPOS <- "3.66686411"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.580277136"
Evaluating: (89.1533903-9.0)*(0.580277136-0.5)
 Parameter: ZPOS <- "6.43448461"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.310636 XMAX =  -21.310636 XAVE =  -21.310636
    YMIN =  -33.948246 YMAX =  -33.948246 YAVE =  -33.948246
    ZMIN =   -0.362685 ZMAX =   -0.362685 ZAVE =   -0.362685
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.6835484"
 RDCMND substituted energy or value "?XAVE" to "-21.3106358"
Evaluating: 29.6835484--21.3106358
 Parameter: XTRAN <- "50.9941842"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.66686411"
 RDCMND substituted energy or value "?YAVE" to "-33.9482455"
Evaluating: 3.66686411--33.9482455
 Parameter: YTRAN <- "37.6151096"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "6.43448461"
 RDCMND substituted energy or value "?ZAVE" to "-0.362684711"
Evaluating: 6.43448461--0.362684711
 Parameter: ZTRAN <- "6.79716932"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "50.9941842"
 Parameter: YTRAN -> "37.6151096"
 Parameter: ZTRAN -> "6.79716932"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    50.994184   37.615110    6.797169
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.781608338E-02"
Evaluating: 7.781608338E-02*360.0
 Parameter: XPHI <- "28.01379"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.158002224"
Evaluating: 0.158002224*360.0
 Parameter: YPHI <- "56.8808006"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.621277902"
Evaluating: 0.621277902*360.0
 Parameter: ZPHI <- "223.660045"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.6835484"
 Parameter: YPOS -> "3.66686411"
 Parameter: ZPOS -> "6.43448461"
 Parameter: XPHI -> "28.01379"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.882835    0.469684
    0.000000   -0.469684    0.882835

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   28.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.6835484"
 Parameter: YPOS -> "3.66686411"
 Parameter: ZPOS -> "6.43448461"
 Parameter: YPHI -> "56.8808006"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.546383    0.000000   -0.837536
    0.000000    1.000000    0.000000
    0.837536    0.000000    0.546383

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   56.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.6835484"
 Parameter: YPOS -> "3.66686411"
 Parameter: ZPOS -> "6.43448461"
 Parameter: ZPHI -> "223.660045"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.723449   -0.690378    0.000000
    0.690378   -0.723449    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  136.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.683548 XMAX =   29.683548 XAVE =   29.683548
    YMIN =    3.666864 YMAX =    3.666864 YAVE =    3.666864
    ZMIN =    6.434485 ZMAX =    6.434485 ZAVE =    6.434485
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.6835484"
Evaluating: 29.6835484+3.5
 Parameter: XMAX <- "33.1835484"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.66686411"
Evaluating: 3.66686411+3.5
 Parameter: YMAX <- "7.16686411"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "6.4344846"
Evaluating: 6.4344846+3.5
 Parameter: ZMAX <- "9.9344846"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.6835484"
Evaluating: 29.6835484-3.5
 Parameter: XMIN <- "26.1835484"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.66686411"
Evaluating: 3.66686411-3.5
 Parameter: YMIN <- "0.16686411"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "6.4344846"
Evaluating: 6.4344846-3.5
 Parameter: ZMIN <- "2.9344846"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.1835484"
 Parameter: XMIN -> "26.1835484"
 Parameter: YMAX -> "7.16686411"
 Parameter: YMIN -> "0.16686411"
 Parameter: ZMAX -> "9.9344846"
 Parameter: ZMIN -> "2.9344846"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "21"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "21" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "21" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.74324238"
Evaluating: (89.1533903-9.0)*(0.74324238-0.5)
 Parameter: XPOS <- "19.4967014"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.289413073"
Evaluating: (89.1533903-9.0)*(0.289413073-0.5)
 Parameter: YPOS <- "-16.8792562"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.507769718"
Evaluating: (89.1533903-9.0)*(0.507769718-0.5)
 Parameter: ZPOS <- "0.622769239"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.4967014"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 19.4967014-44.5766951
 Parameter: XTRAN <- "-25.0799937"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.8792562"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -16.8792562-44.5766951
 Parameter: YTRAN <- "-61.4559513"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "0.622769239"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 0.622769239-44.5766951
 Parameter: ZTRAN <- "-43.9539259"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.0799937"
 Parameter: YTRAN -> "-61.4559513"
 Parameter: ZTRAN -> "-43.9539259"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -25.079994  -61.455951  -43.953926
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.926519577"
Evaluating: 0.926519577*360.0
 Parameter: XPHI <- "333.547048"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.997833987E-02"
Evaluating: 5.997833987E-02*360.0
 Parameter: YPHI <- "21.5922024"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.679729267"
Evaluating: 0.679729267*360.0
 Parameter: ZPHI <- "244.702536"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.4967014"
 Parameter: YPOS -> "-16.8792562"
 Parameter: ZPOS -> "0.622769239"
 Parameter: XPHI -> "333.547048"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.895300   -0.445463
    0.000000    0.445463    0.895300

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   26.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.4967014"
 Parameter: YPOS -> "-16.8792562"
 Parameter: ZPOS -> "0.622769239"
 Parameter: YPHI -> "21.5922024"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.929827    0.000000   -0.367998
    0.000000    1.000000    0.000000
    0.367998    0.000000    0.929827

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   21.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.4967014"
 Parameter: YPOS -> "-16.8792562"
 Parameter: ZPOS -> "0.622769239"
 Parameter: ZPHI -> "244.702536"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.427318   -0.904101    0.000000
    0.904101   -0.427318    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  115.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.496701 XMAX =   19.496701 XAVE =   19.496701
    YMIN =  -16.879256 YMAX =  -16.879256 YAVE =  -16.879256
    ZMIN =    0.622769 ZMAX =    0.622769 ZAVE =    0.622769
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.4967014"
Evaluating: 19.4967014+3.5
 Parameter: XMAX <- "22.9967014"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.8792562"
Evaluating: -16.8792562+3.5
 Parameter: YMAX <- "-13.3792562"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "0.622769207"
Evaluating: 0.622769207+3.5
 Parameter: ZMAX <- "4.12276921"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.4967014"
Evaluating: 19.4967014-3.5
 Parameter: XMIN <- "15.9967014"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.8792562"
Evaluating: -16.8792562-3.5
 Parameter: YMIN <- "-20.3792562"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "0.622769207"
Evaluating: 0.622769207-3.5
 Parameter: ZMIN <- "-2.87723079"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.9967014"
 Parameter: XMIN -> "15.9967014"
 Parameter: YMAX -> "-13.3792562"
 Parameter: YMIN -> "-20.3792562"
 Parameter: ZMAX -> "4.12276921"
 Parameter: ZMIN -> "-2.87723079"
 SELRPN>      5 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      1 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9123 POS      SOD      21       SOD     -4356 PAA1     THR      333      CG2           4.0869
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "21"
Evaluating: 21
 Parameter: J <- "21"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "21" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.805356324"
Evaluating: (89.1533903-9.0)*(0.805356324-0.5)
 Parameter: XPOS <- "24.4753446"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.555461329"
Evaluating: (89.1533903-9.0)*(0.555461329-0.5)
 Parameter: YPOS <- "4.44541355"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.956714045"
Evaluating: (89.1533903-9.0)*(0.956714045-0.5)
 Parameter: ZPOS <- "36.6071791"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.496701 XMAX =   19.496701 XAVE =   19.496701
    YMIN =  -16.879256 YMAX =  -16.879256 YAVE =  -16.879256
    ZMIN =    0.622769 ZMAX =    0.622769 ZAVE =    0.622769
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.4753446"
 RDCMND substituted energy or value "?XAVE" to "19.4967014"
Evaluating: 24.4753446-19.4967014
 Parameter: XTRAN <- "4.9786432"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.44541355"
 RDCMND substituted energy or value "?YAVE" to "-16.8792562"
Evaluating: 4.44541355--16.8792562
 Parameter: YTRAN <- "21.3246697"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.6071791"
 RDCMND substituted energy or value "?ZAVE" to "0.622769207"
Evaluating: 36.6071791-0.622769207
 Parameter: ZTRAN <- "35.9844099"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "4.9786432"
 Parameter: YTRAN -> "21.3246697"
 Parameter: ZTRAN -> "35.9844099"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR     4.978643   21.324670   35.984410
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.610355824E-02"
Evaluating: 4.610355824E-02*360.0
 Parameter: XPHI <- "16.597281"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.201797481"
Evaluating: 0.201797481*360.0
 Parameter: YPHI <- "72.6470932"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.581763971"
Evaluating: 0.581763971*360.0
 Parameter: ZPHI <- "209.43503"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.4753446"
 Parameter: YPOS -> "4.44541355"
 Parameter: ZPOS -> "36.6071791"
 Parameter: XPHI -> "16.597281"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.958336    0.285643
    0.000000   -0.285643    0.958336

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   16.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.4753446"
 Parameter: YPOS -> "4.44541355"
 Parameter: ZPOS -> "36.6071791"
 Parameter: YPHI -> "72.6470932"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.298256    0.000000   -0.954486
    0.000000    1.000000    0.000000
    0.954486    0.000000    0.298256

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   72.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.4753446"
 Parameter: YPOS -> "4.44541355"
 Parameter: ZPOS -> "36.6071791"
 Parameter: ZPHI -> "209.43503"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.870914   -0.491436    0.000000
    0.491436   -0.870914    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  150.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.475345 XMAX =   24.475345 XAVE =   24.475345
    YMIN =    4.445414 YMAX =    4.445414 YAVE =    4.445414
    ZMIN =   36.607179 ZMAX =   36.607179 ZAVE =   36.607179
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.4753446"
Evaluating: 24.4753446+3.5
 Parameter: XMAX <- "27.9753446"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.44541357"
Evaluating: 4.44541357+3.5
 Parameter: YMAX <- "7.94541357"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.6071791"
Evaluating: 36.6071791+3.5
 Parameter: ZMAX <- "40.1071791"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.4753446"
Evaluating: 24.4753446-3.5
 Parameter: XMIN <- "20.9753446"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.44541357"
Evaluating: 4.44541357-3.5
 Parameter: YMIN <- "0.94541357"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.6071791"
Evaluating: 36.6071791-3.5
 Parameter: ZMIN <- "33.1071791"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.9753446"
 Parameter: XMIN -> "20.9753446"
 Parameter: YMAX -> "7.94541357"
 Parameter: YMIN -> "0.94541357"
 Parameter: ZMAX -> "40.1071791"
 Parameter: ZMIN -> "33.1071791"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "22"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "22" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "22" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.188980136"
Evaluating: (89.1533903-9.0)*(0.188980136-0.5)
 Parameter: XPOS <- "-24.9292966"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.499689002"
Evaluating: (89.1533903-9.0)*(0.499689002-0.5)
 Parameter: YPOS <- "-2.492754408E-02"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.898731436"
Evaluating: (89.1533903-9.0)*(0.898731436-0.5)
 Parameter: ZPOS <- "31.9596764"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.9292966"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -24.9292966-44.5766951
 Parameter: XTRAN <- "-69.5059917"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.492754408E-02"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -2.492754408E-02-44.5766951
 Parameter: YTRAN <- "-44.6016226"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.9596764"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 31.9596764-44.5766951
 Parameter: ZTRAN <- "-12.6170187"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-69.5059917"
 Parameter: YTRAN -> "-44.6016226"
 Parameter: ZTRAN -> "-12.6170187"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -69.505992  -44.601623  -12.617019
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.220151094"
Evaluating: 0.220151094*360.0
 Parameter: XPHI <- "79.2543938"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.807666332"
Evaluating: 0.807666332*360.0
 Parameter: YPHI <- "290.75988"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.676400244"
Evaluating: 0.676400244*360.0
 Parameter: ZPHI <- "243.504088"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.9292966"
 Parameter: YPOS -> "-2.492754408E-02"
 Parameter: ZPOS -> "31.9596764"
 Parameter: XPHI -> "79.2543938"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.186449    0.982465
    0.000000   -0.982465    0.186449

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   79.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.9292966"
 Parameter: YPOS -> "-2.492754408E-02"
 Parameter: ZPOS -> "31.9596764"
 Parameter: YPHI -> "290.75988"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.354452    0.000000    0.935074
    0.000000    1.000000    0.000000
   -0.935074    0.000000    0.354452

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   69.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.9292966"
 Parameter: YPOS -> "-2.492754408E-02"
 Parameter: ZPOS -> "31.9596764"
 Parameter: ZPHI -> "243.504088"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.446134   -0.894966    0.000000
    0.894966   -0.446134    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  116.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.929297 XMAX =  -24.929297 XAVE =  -24.929297
    YMIN =   -0.024928 YMAX =   -0.024928 YAVE =   -0.024928
    ZMIN =   31.959676 ZMAX =   31.959676 ZAVE =   31.959676
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.9292966"
Evaluating: -24.9292966+3.5
 Parameter: XMAX <- "-21.4292966"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.492758399E-02"
Evaluating: -2.492758399E-02+3.5
 Parameter: YMAX <- "3.47507242"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.9596764"
Evaluating: 31.9596764+3.5
 Parameter: ZMAX <- "35.4596764"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.9292966"
Evaluating: -24.9292966-3.5
 Parameter: XMIN <- "-28.4292966"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.492758399E-02"
Evaluating: -2.492758399E-02-3.5
 Parameter: YMIN <- "-3.52492758"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.9596764"
Evaluating: 31.9596764-3.5
 Parameter: ZMIN <- "28.4596764"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.4292966"
 Parameter: XMIN -> "-28.4292966"
 Parameter: YMAX -> "3.47507242"
 Parameter: YMIN -> "-3.52492758"
 Parameter: ZMAX -> "35.4596764"
 Parameter: ZMIN -> "28.4596764"
 SELRPN>      6 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      1 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9124 POS      SOD      22       SOD     -7544 PAA2     SER      229      CB            3.5813
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "22"
Evaluating: 22
 Parameter: J <- "22"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "22" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "7.862761093E-02"
Evaluating: (89.1533903-9.0)*(7.862761093E-02-0.5)
 Parameter: XPOS <- "-33.7744256"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.118485653"
Evaluating: (89.1533903-9.0)*(0.118485653-0.5)
 Parameter: YPOS <- "-30.5796684"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.646579104"
Evaluating: (89.1533903-9.0)*(0.646579104-0.5)
 Parameter: ZPOS <- "11.7488121"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.929297 XMAX =  -24.929297 XAVE =  -24.929297
    YMIN =   -0.024928 YMAX =   -0.024928 YAVE =   -0.024928
    ZMIN =   31.959676 ZMAX =   31.959676 ZAVE =   31.959676
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.7744256"
 RDCMND substituted energy or value "?XAVE" to "-24.9292966"
Evaluating: -33.7744256--24.9292966
 Parameter: XTRAN <- "-8.845129"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-30.5796684"
 RDCMND substituted energy or value "?YAVE" to "-2.492758399E-02"
Evaluating: -30.5796684--2.492758399E-02
 Parameter: YTRAN <- "-30.5547408"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "11.7488121"
 RDCMND substituted energy or value "?ZAVE" to "31.9596764"
Evaluating: 11.7488121-31.9596764
 Parameter: ZTRAN <- "-20.2108643"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.845129"
 Parameter: YTRAN -> "-30.5547408"
 Parameter: ZTRAN -> "-20.2108643"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    -8.845129  -30.554741  -20.210864
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.830769662"
Evaluating: 0.830769662*360.0
 Parameter: XPHI <- "299.077078"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.759039846"
Evaluating: 0.759039846*360.0
 Parameter: YPHI <- "273.254345"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.873085706"
Evaluating: 0.873085706*360.0
 Parameter: ZPHI <- "314.310854"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.7744256"
 Parameter: YPOS -> "-30.5796684"
 Parameter: ZPOS -> "11.7488121"
 Parameter: XPHI -> "299.077078"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.485986   -0.873967
    0.000000    0.873967    0.485986

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   60.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.7744256"
 Parameter: YPOS -> "-30.5796684"
 Parameter: ZPOS -> "11.7488121"
 Parameter: YPHI -> "273.254345"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.056768    0.000000    0.998387
    0.000000    1.000000    0.000000
   -0.998387    0.000000    0.056768

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   86.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.7744256"
 Parameter: YPOS -> "-30.5796684"
 Parameter: ZPOS -> "11.7488121"
 Parameter: ZPHI -> "314.310854"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.698551   -0.715560    0.000000
    0.715560    0.698551    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   45.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.774426 XMAX =  -33.774426 XAVE =  -33.774426
    YMIN =  -30.579668 YMAX =  -30.579668 YAVE =  -30.579668
    ZMIN =   11.748812 ZMAX =   11.748812 ZAVE =   11.748812
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.7744256"
Evaluating: -33.7744256+3.5
 Parameter: XMAX <- "-30.2744256"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-30.5796684"
Evaluating: -30.5796684+3.5
 Parameter: YMAX <- "-27.0796684"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "11.7488121"
Evaluating: 11.7488121+3.5
 Parameter: ZMAX <- "15.2488121"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.7744256"
Evaluating: -33.7744256-3.5
 Parameter: XMIN <- "-37.2744256"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-30.5796684"
Evaluating: -30.5796684-3.5
 Parameter: YMIN <- "-34.0796684"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "11.7488121"
Evaluating: 11.7488121-3.5
 Parameter: ZMIN <- "8.2488121"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-30.2744256"
 Parameter: XMIN -> "-37.2744256"
 Parameter: YMAX -> "-27.0796684"
 Parameter: YMIN -> "-34.0796684"
 Parameter: ZMAX -> "15.2488121"
 Parameter: ZMIN -> "8.2488121"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "23"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "23" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "23" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.580733594"
Evaluating: (89.1533903-9.0)*(0.580733594-0.5)
 Parameter: XPOS <- "6.47107127"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.800159205"
Evaluating: (89.1533903-9.0)*(0.800159205-0.5)
 Parameter: YPOS <- "24.0587779"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.779833462"
Evaluating: (89.1533903-9.0)*(0.779833462-0.5)
 Parameter: ZPOS <- "22.4296007"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.47107127"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 6.47107127-44.5766951
 Parameter: XTRAN <- "-38.1056238"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.0587779"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 24.0587779-44.5766951
 Parameter: YTRAN <- "-20.5179172"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.4296007"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 22.4296007-44.5766951
 Parameter: ZTRAN <- "-22.1470944"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.1056238"
 Parameter: YTRAN -> "-20.5179172"
 Parameter: ZTRAN -> "-22.1470944"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -38.105624  -20.517917  -22.147094
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.393523135"
Evaluating: 0.393523135*360.0
 Parameter: XPHI <- "141.668329"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.675885985"
Evaluating: 0.675885985*360.0
 Parameter: YPHI <- "243.318955"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.284281035"
Evaluating: 0.284281035*360.0
 Parameter: ZPHI <- "102.341173"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.47107127"
 Parameter: YPOS -> "24.0587779"
 Parameter: ZPOS -> "22.4296007"
 Parameter: XPHI -> "141.668329"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.784434    0.620213
    0.000000   -0.620213   -0.784434

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  141.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.47107127"
 Parameter: YPOS -> "24.0587779"
 Parameter: ZPOS -> "22.4296007"
 Parameter: YPHI -> "243.318955"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.449023    0.000000    0.893520
    0.000000    1.000000    0.000000
   -0.893520    0.000000   -0.449023

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  116.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.47107127"
 Parameter: YPOS -> "24.0587779"
 Parameter: ZPOS -> "22.4296007"
 Parameter: ZPHI -> "102.341173"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.213732    0.976892    0.000000
   -0.976892   -0.213732    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  102.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.471071 XMAX =    6.471071 XAVE =    6.471071
    YMIN =   24.058778 YMAX =   24.058778 YAVE =   24.058778
    ZMIN =   22.429601 ZMAX =   22.429601 ZAVE =   22.429601
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.47107127"
Evaluating: 6.47107127+3.5
 Parameter: XMAX <- "9.97107127"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.0587779"
Evaluating: 24.0587779+3.5
 Parameter: YMAX <- "27.5587779"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.4296007"
Evaluating: 22.4296007+3.5
 Parameter: ZMAX <- "25.9296007"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.47107127"
Evaluating: 6.47107127-3.5
 Parameter: XMIN <- "2.97107127"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.0587779"
Evaluating: 24.0587779-3.5
 Parameter: YMIN <- "20.5587779"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.4296007"
Evaluating: 22.4296007-3.5
 Parameter: ZMIN <- "18.9296007"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.97107127"
 Parameter: XMIN -> "2.97107127"
 Parameter: YMAX -> "27.5587779"
 Parameter: YMIN -> "20.5587779"
 Parameter: ZMAX -> "25.9296007"
 Parameter: ZMIN -> "18.9296007"
 SELRPN>     23 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "23"
 Comparing "23" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     13 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9125 POS      SOD      23       SOD     -2143 PAA1     TYR      152      N             3.6300
 9125 POS      SOD      23       SOD     -2147 PAA1     TYR      152      CB            3.3022
 9125 POS      SOD      23       SOD     -2150 PAA1     TYR      152      CG            1.7888
 9125 POS      SOD      23       SOD     -2151 PAA1     TYR      152      CD1           1.6040
 9125 POS      SOD      23       SOD     -2153 PAA1     TYR      152      CE1           1.2322
 9125 POS      SOD      23       SOD     -2155 PAA1     TYR      152      CZ            1.0360
 9125 POS      SOD      23       SOD     -2156 PAA1     TYR      152      OH            2.3915
 9125 POS      SOD      23       SOD     -2158 PAA1     TYR      152      CD2           1.6545
 9125 POS      SOD      23       SOD     -2160 PAA1     TYR      152      CE2           1.3006
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "23" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.584078417"
Evaluating: (89.1533903-9.0)*(0.584078417-0.5)
 Parameter: XPOS <- "6.73917017"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.515219806"
Evaluating: (89.1533903-9.0)*(0.515219806-0.5)
 Parameter: YPOS <- "1.21991905"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.415824823"
Evaluating: (89.1533903-9.0)*(0.415824823-0.5)
 Parameter: ZPOS <- "-6.74692582"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.471071 XMAX =    6.471071 XAVE =    6.471071
    YMIN =   24.058778 YMAX =   24.058778 YAVE =   24.058778
    ZMIN =   22.429601 ZMAX =   22.429601 ZAVE =   22.429601
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.73917017"
 RDCMND substituted energy or value "?XAVE" to "6.47107127"
Evaluating: 6.73917017-6.47107127
 Parameter: XTRAN <- "0.2680989"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.21991905"
 RDCMND substituted energy or value "?YAVE" to "24.0587779"
Evaluating: 1.21991905-24.0587779
 Parameter: YTRAN <- "-22.8388588"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-6.74692582"
 RDCMND substituted energy or value "?ZAVE" to "22.4296007"
Evaluating: -6.74692582-22.4296007
 Parameter: ZTRAN <- "-29.1765265"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.2680989"
 Parameter: YTRAN -> "-22.8388588"
 Parameter: ZTRAN -> "-29.1765265"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR     0.268099  -22.838859  -29.176527
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.67572152"
Evaluating: 0.67572152*360.0
 Parameter: XPHI <- "243.259747"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.576651319"
Evaluating: 0.576651319*360.0
 Parameter: YPHI <- "207.594475"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.195695625"
Evaluating: 0.195695625*360.0
 Parameter: ZPHI <- "70.450425"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.73917017"
 Parameter: YPOS -> "1.21991905"
 Parameter: ZPOS -> "-6.74692582"
 Parameter: XPHI -> "243.259747"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.449947   -0.893055
    0.000000    0.893055   -0.449947

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  116.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.73917017"
 Parameter: YPOS -> "1.21991905"
 Parameter: ZPOS -> "-6.74692582"
 Parameter: YPHI -> "207.594475"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.886248    0.000000    0.463211
    0.000000    1.000000    0.000000
   -0.463211    0.000000   -0.886248

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  152.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.73917017"
 Parameter: YPOS -> "1.21991905"
 Parameter: ZPOS -> "-6.74692582"
 Parameter: ZPHI -> "70.450425"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.334622    0.942352    0.000000
   -0.942352    0.334622    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   70.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.739170 XMAX =    6.739170 XAVE =    6.739170
    YMIN =    1.219919 YMAX =    1.219919 YAVE =    1.219919
    ZMIN =   -6.746926 ZMAX =   -6.746926 ZAVE =   -6.746926
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.73917016"
Evaluating: 6.73917016+3.5
 Parameter: XMAX <- "10.2391702"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.21991902"
Evaluating: 1.21991902+3.5
 Parameter: YMAX <- "4.71991902"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-6.74692587"
Evaluating: -6.74692587+3.5
 Parameter: ZMAX <- "-3.24692587"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.73917016"
Evaluating: 6.73917016-3.5
 Parameter: XMIN <- "3.23917016"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.21991902"
Evaluating: 1.21991902-3.5
 Parameter: YMIN <- "-2.28008098"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-6.74692587"
Evaluating: -6.74692587-3.5
 Parameter: ZMIN <- "-10.2469259"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.2391702"
 Parameter: XMIN -> "3.23917016"
 Parameter: YMAX -> "4.71991902"
 Parameter: YMIN -> "-2.28008098"
 Parameter: ZMAX -> "-3.24692587"
 Parameter: ZMIN -> "-10.2469259"
 SELRPN>     22 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "22"
 Comparing "22" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     11 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9125 POS      SOD      23       SOD     -3205 PAA1     TYR      249      CA            3.4051
 9125 POS      SOD      23       SOD     -3207 PAA1     TYR      249      CB            2.5575
 9125 POS      SOD      23       SOD     -3210 PAA1     TYR      249      CG            2.4155
 9125 POS      SOD      23       SOD     -3211 PAA1     TYR      249      CD1           3.6075
 9125 POS      SOD      23       SOD     -3218 PAA1     TYR      249      CD2           1.9736
 9125 POS      SOD      23       SOD     -3220 PAA1     TYR      249      CE2           3.1496
 9125 POS      SOD      23       SOD     -3222 PAA1     TYR      249      C             3.1973
 9125 POS      SOD      23       SOD     -3223 PAA1     TYR      249      O             3.3539
 9125 POS      SOD      23       SOD     -3224 PAA1     ALA      250      N             3.6764
 9125 POS      SOD      23       SOD     -3261 PAA1     VAL      253      CG2           3.8934
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "23"
Evaluating: 23
 Parameter: J <- "23"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "23" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.162790298"
Evaluating: (89.1533903-9.0)*(0.162790298-0.5)
 Parameter: XPOS <- "-27.0285009"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.741930793"
Evaluating: (89.1533903-9.0)*(0.741930793-0.5)
 Parameter: YPOS <- "19.3915733"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "7.564810645E-02"
Evaluating: (89.1533903-9.0)*(7.564810645E-02-0.5)
 Parameter: ZPOS <- "-34.0132429"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.739170 XMAX =    6.739170 XAVE =    6.739170
    YMIN =    1.219919 YMAX =    1.219919 YAVE =    1.219919
    ZMIN =   -6.746926 ZMAX =   -6.746926 ZAVE =   -6.746926
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.0285009"
 RDCMND substituted energy or value "?XAVE" to "6.73917016"
Evaluating: -27.0285009-6.73917016
 Parameter: XTRAN <- "-33.7676711"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.3915733"
 RDCMND substituted energy or value "?YAVE" to "1.21991902"
Evaluating: 19.3915733-1.21991902
 Parameter: YTRAN <- "18.1716543"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.0132429"
 RDCMND substituted energy or value "?ZAVE" to "-6.74692587"
Evaluating: -34.0132429--6.74692587
 Parameter: ZTRAN <- "-27.266317"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.7676711"
 Parameter: YTRAN -> "18.1716543"
 Parameter: ZTRAN -> "-27.266317"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -33.767671   18.171654  -27.266317
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.828879767"
Evaluating: 0.828879767*360.0
 Parameter: XPHI <- "298.396716"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.391951344"
Evaluating: 0.391951344*360.0
 Parameter: YPHI <- "141.102484"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.362448462"
Evaluating: 0.362448462*360.0
 Parameter: ZPHI <- "130.481446"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.0285009"
 Parameter: YPOS -> "19.3915733"
 Parameter: ZPOS -> "-34.0132429"
 Parameter: XPHI -> "298.396716"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.475574   -0.879676
    0.000000    0.879676    0.475574

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   61.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.0285009"
 Parameter: YPOS -> "19.3915733"
 Parameter: ZPOS -> "-34.0132429"
 Parameter: YPHI -> "141.102484"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.778270    0.000000   -0.627929
    0.000000    1.000000    0.000000
    0.627929    0.000000   -0.778270

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  141.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.0285009"
 Parameter: YPOS -> "19.3915733"
 Parameter: ZPOS -> "-34.0132429"
 Parameter: ZPHI -> "130.481446"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.649202    0.760616    0.000000
   -0.760616   -0.649202    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  130.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.028501 XMAX =  -27.028501 XAVE =  -27.028501
    YMIN =   19.391573 YMAX =   19.391573 YAVE =   19.391573
    ZMIN =  -34.013243 ZMAX =  -34.013243 ZAVE =  -34.013243
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.0285009"
Evaluating: -27.0285009+3.5
 Parameter: XMAX <- "-23.5285009"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.3915733"
Evaluating: 19.3915733+3.5
 Parameter: YMAX <- "22.8915733"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.0132429"
Evaluating: -34.0132429+3.5
 Parameter: ZMAX <- "-30.5132429"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.0285009"
Evaluating: -27.0285009-3.5
 Parameter: XMIN <- "-30.5285009"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.3915733"
Evaluating: 19.3915733-3.5
 Parameter: YMIN <- "15.8915733"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.0132429"
Evaluating: -34.0132429-3.5
 Parameter: ZMIN <- "-37.5132429"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.5285009"
 Parameter: XMIN -> "-30.5285009"
 Parameter: YMAX -> "22.8915733"
 Parameter: YMIN -> "15.8915733"
 Parameter: ZMAX -> "-30.5132429"
 Parameter: ZMIN -> "-37.5132429"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "24"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "24" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "24"
Evaluating: 24
 Parameter: J <- "24"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "24" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.933168755"
Evaluating: (89.1533903-9.0)*(0.933168755-0.5)
 Parameter: XPOS <- "34.7199443"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.827944435"
Evaluating: (89.1533903-9.0)*(0.827944435-0.5)
 Parameter: YPOS <- "26.2858583"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.791896656"
Evaluating: (89.1533903-9.0)*(0.791896656-0.5)
 Parameter: ZPOS <- "23.3965066"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.7199443"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 34.7199443-44.5766951
 Parameter: XTRAN <- "-9.8567508"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "26.2858583"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 26.2858583-44.5766951
 Parameter: YTRAN <- "-18.2908368"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.3965066"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 23.3965066-44.5766951
 Parameter: ZTRAN <- "-21.1801885"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.8567508"
 Parameter: YTRAN -> "-18.2908368"
 Parameter: ZTRAN -> "-21.1801885"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    -9.856751  -18.290837  -21.180188
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.421757928"
Evaluating: 0.421757928*360.0
 Parameter: XPHI <- "151.832854"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.612013154"
Evaluating: 0.612013154*360.0
 Parameter: YPHI <- "220.324735"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.980889734"
Evaluating: 0.980889734*360.0
 Parameter: ZPHI <- "353.120304"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.7199443"
 Parameter: YPOS -> "26.2858583"
 Parameter: ZPOS -> "23.3965066"
 Parameter: XPHI -> "151.832854"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.881574    0.472045
    0.000000   -0.472045   -0.881574

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  151.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.7199443"
 Parameter: YPOS -> "26.2858583"
 Parameter: ZPOS -> "23.3965066"
 Parameter: YPHI -> "220.324735"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.762389    0.000000    0.647119
    0.000000    1.000000    0.000000
   -0.647119    0.000000   -0.762389

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  139.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.7199443"
 Parameter: YPOS -> "26.2858583"
 Parameter: ZPOS -> "23.3965066"
 Parameter: ZPHI -> "353.120304"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.992800   -0.119785    0.000000
    0.119785    0.992800    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    6.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.719944 XMAX =   34.719944 XAVE =   34.719944
    YMIN =   26.285858 YMAX =   26.285858 YAVE =   26.285858
    ZMIN =   23.396507 ZMAX =   23.396507 ZAVE =   23.396507
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.7199443"
Evaluating: 34.7199443+3.5
 Parameter: XMAX <- "38.2199443"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "26.2858583"
Evaluating: 26.2858583+3.5
 Parameter: YMAX <- "29.7858583"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.3965066"
Evaluating: 23.3965066+3.5
 Parameter: ZMAX <- "26.8965066"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.7199443"
Evaluating: 34.7199443-3.5
 Parameter: XMIN <- "31.2199443"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "26.2858583"
Evaluating: 26.2858583-3.5
 Parameter: YMIN <- "22.7858583"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.3965066"
Evaluating: 23.3965066-3.5
 Parameter: ZMIN <- "19.8965066"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "38.2199443"
 Parameter: XMIN -> "31.2199443"
 Parameter: YMAX -> "29.7858583"
 Parameter: YMIN -> "22.7858583"
 Parameter: ZMAX -> "26.8965066"
 Parameter: ZMIN -> "19.8965066"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "25"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "25" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "25" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.143949888"
Evaluating: (89.1533903-9.0)*(0.143949888-0.5)
 Parameter: XPOS <- "-28.5386236"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.781402022"
Evaluating: (89.1533903-9.0)*(0.781402022-0.5)
 Parameter: YPOS <- "22.5553261"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.932456376"
Evaluating: (89.1533903-9.0)*(0.932456376-0.5)
 Parameter: ZPOS <- "34.6628447"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.5386236"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -28.5386236-44.5766951
 Parameter: XTRAN <- "-73.1153187"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.5553261"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 22.5553261-44.5766951
 Parameter: YTRAN <- "-22.021369"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.6628447"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 34.6628447-44.5766951
 Parameter: ZTRAN <- "-9.9138504"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-73.1153187"
 Parameter: YTRAN -> "-22.021369"
 Parameter: ZTRAN -> "-9.9138504"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -73.115319  -22.021369   -9.913850
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.864035818"
Evaluating: 0.864035818*360.0
 Parameter: XPHI <- "311.052894"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.363984388"
Evaluating: 0.363984388*360.0
 Parameter: YPHI <- "131.03438"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.583225598E-02"
Evaluating: 5.583225598E-02*360.0
 Parameter: ZPHI <- "20.0996122"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.5386236"
 Parameter: YPOS -> "22.5553261"
 Parameter: ZPOS -> "34.6628447"
 Parameter: XPHI -> "311.052894"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.656755   -0.754104
    0.000000    0.754104    0.656755

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   48.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.5386236"
 Parameter: YPOS -> "22.5553261"
 Parameter: ZPOS -> "34.6628447"
 Parameter: YPHI -> "131.03438"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.656512    0.000000   -0.754316
    0.000000    1.000000    0.000000
    0.754316    0.000000   -0.656512

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  131.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.5386236"
 Parameter: YPOS -> "22.5553261"
 Parameter: ZPOS -> "34.6628447"
 Parameter: ZPHI -> "20.0996122"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.939097    0.343653    0.000000
   -0.343653    0.939097    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   20.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.538624 XMAX =  -28.538624 XAVE =  -28.538624
    YMIN =   22.555326 YMAX =   22.555326 YAVE =   22.555326
    ZMIN =   34.662845 ZMAX =   34.662845 ZAVE =   34.662845
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.5386236"
Evaluating: -28.5386236+3.5
 Parameter: XMAX <- "-25.0386236"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.5553261"
Evaluating: 22.5553261+3.5
 Parameter: YMAX <- "26.0553261"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.6628447"
Evaluating: 34.6628447+3.5
 Parameter: ZMAX <- "38.1628447"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.5386236"
Evaluating: -28.5386236-3.5
 Parameter: XMIN <- "-32.0386236"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.5553261"
Evaluating: 22.5553261-3.5
 Parameter: YMIN <- "19.0553261"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.6628447"
Evaluating: 34.6628447-3.5
 Parameter: ZMIN <- "31.1628447"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.0386236"
 Parameter: XMIN -> "-32.0386236"
 Parameter: YMAX -> "26.0553261"
 Parameter: YMIN -> "19.0553261"
 Parameter: ZMAX -> "38.1628447"
 Parameter: ZMIN -> "31.1628447"
 SELRPN>     36 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "36"
 Comparing "36" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     21 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9127 POS      SOD      25       SOD     -7692 PAA2     ALA      242      O             3.3071
 9127 POS      SOD      25       SOD     -7698 PAA2     GLY      243      C             4.2700
 9127 POS      SOD      25       SOD     -7699 PAA2     GLY      243      O             3.8562
 9127 POS      SOD      25       SOD     -7714 PAA2     VAL      244      C             3.7054
 9127 POS      SOD      25       SOD     -7715 PAA2     VAL      244      O             3.7997
 9127 POS      SOD      25       SOD     -7716 PAA2     ALA      245      N             3.2200
 9127 POS      SOD      25       SOD     -7718 PAA2     ALA      245      CA            2.6278
 9127 POS      SOD      25       SOD     -7720 PAA2     ALA      245      CB            3.2409
 9127 POS      SOD      25       SOD     -7724 PAA2     ALA      245      C             1.3336
 9127 POS      SOD      25       SOD     -7725 PAA2     ALA      245      O             2.0332
 9127 POS      SOD      25       SOD     -7726 PAA2     ALA      246      N             0.6217
 9127 POS      SOD      25       SOD     -7728 PAA2     ALA      246      CA            1.2967
 9127 POS      SOD      25       SOD     -7730 PAA2     ALA      246      CB            2.4272
 9127 POS      SOD      25       SOD     -7734 PAA2     ALA      246      C             2.5107
 9127 POS      SOD      25       SOD     -7735 PAA2     ALA      246      O             3.3676
 9127 POS      SOD      25       SOD     -7736 PAA2     GLY      247      N             3.1616
 9127 POS      SOD      25       SOD     -7743 PAA2     SER      248      N             4.4145
 9127 POS      SOD      25       SOD     -7762 PAA2     TYR      249      CD1           3.5656
 9127 POS      SOD      25       SOD     -7764 PAA2     TYR      249      CE1           3.6401
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        19
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "19"
 Comparing "19" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "25"
Evaluating: 25
 Parameter: J <- "25"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "25" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.54292472"
Evaluating: (89.1533903-9.0)*(0.54292472-0.5)
 Parameter: XPOS <- "3.44056184"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.303260576"
Evaluating: (89.1533903-9.0)*(0.303260576-0.5)
 Parameter: YPOS <- "-15.7693318"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "6.800978837E-02"
Evaluating: (89.1533903-9.0)*(6.800978837E-02-0.5)
 Parameter: ZPOS <- "-34.62548"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.538624 XMAX =  -28.538624 XAVE =  -28.538624
    YMIN =   22.555326 YMAX =   22.555326 YAVE =   22.555326
    ZMIN =   34.662845 ZMAX =   34.662845 ZAVE =   34.662845
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "3.44056184"
 RDCMND substituted energy or value "?XAVE" to "-28.5386236"
Evaluating: 3.44056184--28.5386236
 Parameter: XTRAN <- "31.9791854"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.7693318"
 RDCMND substituted energy or value "?YAVE" to "22.5553261"
Evaluating: -15.7693318-22.5553261
 Parameter: YTRAN <- "-38.3246579"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.62548"
 RDCMND substituted energy or value "?ZAVE" to "34.6628447"
Evaluating: -34.62548-34.6628447
 Parameter: ZTRAN <- "-69.2883247"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "31.9791854"
 Parameter: YTRAN -> "-38.3246579"
 Parameter: ZTRAN -> "-69.2883247"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    31.979185  -38.324658  -69.288325
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.105964051"
Evaluating: 0.105964051*360.0
 Parameter: XPHI <- "38.1470584"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.330402382"
Evaluating: 0.330402382*360.0
 Parameter: YPHI <- "118.944858"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.370632671"
Evaluating: 0.370632671*360.0
 Parameter: ZPHI <- "133.427762"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "3.44056184"
 Parameter: YPOS -> "-15.7693318"
 Parameter: ZPOS -> "-34.62548"
 Parameter: XPHI -> "38.1470584"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.786428    0.617682
    0.000000   -0.617682    0.786428

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   38.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "3.44056184"
 Parameter: YPOS -> "-15.7693318"
 Parameter: ZPOS -> "-34.62548"
 Parameter: YPHI -> "118.944858"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.483968    0.000000   -0.875086
    0.000000    1.000000    0.000000
    0.875086    0.000000   -0.483968

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  118.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "3.44056184"
 Parameter: YPOS -> "-15.7693318"
 Parameter: ZPOS -> "-34.62548"
 Parameter: ZPHI -> "133.427762"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.687439    0.726242    0.000000
   -0.726242   -0.687439    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  133.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    3.440562 XMAX =    3.440562 XAVE =    3.440562
    YMIN =  -15.769332 YMAX =  -15.769332 YAVE =  -15.769332
    ZMIN =  -34.625480 ZMAX =  -34.625480 ZAVE =  -34.625480
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "3.44056183"
Evaluating: 3.44056183+3.5
 Parameter: XMAX <- "6.94056183"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.7693318"
Evaluating: -15.7693318+3.5
 Parameter: YMAX <- "-12.2693318"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.62548"
Evaluating: -34.62548+3.5
 Parameter: ZMAX <- "-31.12548"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "3.44056183"
Evaluating: 3.44056183-3.5
 Parameter: XMIN <- "-5.943817E-02"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.7693318"
Evaluating: -15.7693318-3.5
 Parameter: YMIN <- "-19.2693318"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.62548"
Evaluating: -34.62548-3.5
 Parameter: ZMIN <- "-38.12548"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "6.94056183"
 Parameter: XMIN -> "-5.943817E-02"
 Parameter: YMAX -> "-12.2693318"
 Parameter: YMIN -> "-19.2693318"
 Parameter: ZMAX -> "-31.12548"
 Parameter: ZMIN -> "-38.12548"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "26"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "26" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "26"
Evaluating: 26
 Parameter: J <- "26"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "26" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.764988072"
Evaluating: (89.1533903-9.0)*(0.764988072-0.5)
 Parameter: XPOS <- "21.2396924"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.88280755"
Evaluating: (89.1533903-9.0)*(0.88280755-0.5)
 Parameter: YPOS <- "30.683323"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.289041709"
Evaluating: (89.1533903-9.0)*(0.289041709-0.5)
 Parameter: ZPOS <- "-16.9090222"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "21.2396924"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 21.2396924-44.5766951
 Parameter: XTRAN <- "-23.3370027"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.683323"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 30.683323-44.5766951
 Parameter: YTRAN <- "-13.8933721"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.9090222"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -16.9090222-44.5766951
 Parameter: ZTRAN <- "-61.4857173"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.3370027"
 Parameter: YTRAN -> "-13.8933721"
 Parameter: ZTRAN -> "-61.4857173"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -23.337003  -13.893372  -61.485717
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.313551693"
Evaluating: 0.313551693*360.0
 Parameter: XPHI <- "112.878609"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.404185932"
Evaluating: 0.404185932*360.0
 Parameter: YPHI <- "145.506936"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.65250034"
Evaluating: 0.65250034*360.0
 Parameter: ZPHI <- "234.900122"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "21.2396924"
 Parameter: YPOS -> "30.683323"
 Parameter: ZPOS -> "-16.9090222"
 Parameter: XPHI -> "112.878609"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.388780    0.921331
    0.000000   -0.921331   -0.388780

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  112.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "21.2396924"
 Parameter: YPOS -> "30.683323"
 Parameter: ZPOS -> "-16.9090222"
 Parameter: YPHI -> "145.506936"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.824195    0.000000   -0.566306
    0.000000    1.000000    0.000000
    0.566306    0.000000   -0.824195

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  145.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "21.2396924"
 Parameter: YPOS -> "30.683323"
 Parameter: ZPOS -> "-16.9090222"
 Parameter: ZPHI -> "234.900122"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.575004   -0.818151    0.000000
    0.818151   -0.575004    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  125.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   21.239692 XMAX =   21.239692 XAVE =   21.239692
    YMIN =   30.683323 YMAX =   30.683323 YAVE =   30.683323
    ZMIN =  -16.909022 ZMAX =  -16.909022 ZAVE =  -16.909022
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "21.2396924"
Evaluating: 21.2396924+3.5
 Parameter: XMAX <- "24.7396924"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.683323"
Evaluating: 30.683323+3.5
 Parameter: YMAX <- "34.183323"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.9090222"
Evaluating: -16.9090222+3.5
 Parameter: ZMAX <- "-13.4090222"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "21.2396924"
Evaluating: 21.2396924-3.5
 Parameter: XMIN <- "17.7396924"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.683323"
Evaluating: 30.683323-3.5
 Parameter: YMIN <- "27.183323"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.9090222"
Evaluating: -16.9090222-3.5
 Parameter: ZMIN <- "-20.4090222"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.7396924"
 Parameter: XMIN -> "17.7396924"
 Parameter: YMAX -> "34.183323"
 Parameter: YMIN -> "27.183323"
 Parameter: ZMAX -> "-13.4090222"
 Parameter: ZMIN -> "-20.4090222"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "27"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "27" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "27"
Evaluating: 27
 Parameter: J <- "27"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "27" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.396572122"
Evaluating: (89.1533903-9.0)*(0.396572122-0.5)
 Parameter: XPOS <- "-8.29009507"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.893931457"
Evaluating: (89.1533903-9.0)*(0.893931457-0.5)
 Parameter: YPOS <- "31.5749418"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.283326675"
Evaluating: (89.1533903-9.0)*(0.283326675-0.5)
 Parameter: ZPOS <- "-17.3671016"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.29009507"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -8.29009507-44.5766951
 Parameter: XTRAN <- "-52.8667902"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.5749418"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 31.5749418-44.5766951
 Parameter: YTRAN <- "-13.0017533"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.3671016"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -17.3671016-44.5766951
 Parameter: ZTRAN <- "-61.9437967"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-52.8667902"
 Parameter: YTRAN -> "-13.0017533"
 Parameter: ZTRAN -> "-61.9437967"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -52.866790  -13.001753  -61.943797
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.674788162"
Evaluating: 0.674788162*360.0
 Parameter: XPHI <- "242.923738"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.121151597"
Evaluating: 0.121151597*360.0
 Parameter: YPHI <- "43.6145749"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.410688375"
Evaluating: 0.410688375*360.0
 Parameter: ZPHI <- "147.847815"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.29009507"
 Parameter: YPOS -> "31.5749418"
 Parameter: ZPOS -> "-17.3671016"
 Parameter: XPHI -> "242.923738"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.455176   -0.890401
    0.000000    0.890401   -0.455176

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  117.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.29009507"
 Parameter: YPOS -> "31.5749418"
 Parameter: ZPOS -> "-17.3671016"
 Parameter: YPHI -> "43.6145749"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.723996    0.000000   -0.689804
    0.000000    1.000000    0.000000
    0.689804    0.000000    0.723996

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   43.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.29009507"
 Parameter: YPOS -> "31.5749418"
 Parameter: ZPOS -> "-17.3671016"
 Parameter: ZPHI -> "147.847815"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.846638    0.532170    0.000000
   -0.532170   -0.846638    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  147.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.290095 XMAX =   -8.290095 XAVE =   -8.290095
    YMIN =   31.574942 YMAX =   31.574942 YAVE =   31.574942
    ZMIN =  -17.367102 ZMAX =  -17.367102 ZAVE =  -17.367102
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.29009505"
Evaluating: -8.29009505+3.5
 Parameter: XMAX <- "-4.79009505"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.5749418"
Evaluating: 31.5749418+3.5
 Parameter: YMAX <- "35.0749418"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.3671016"
Evaluating: -17.3671016+3.5
 Parameter: ZMAX <- "-13.8671016"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.29009505"
Evaluating: -8.29009505-3.5
 Parameter: XMIN <- "-11.790095"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.5749418"
Evaluating: 31.5749418-3.5
 Parameter: YMIN <- "28.0749418"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.3671016"
Evaluating: -17.3671016-3.5
 Parameter: ZMIN <- "-20.8671016"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.79009505"
 Parameter: XMIN -> "-11.790095"
 Parameter: YMAX -> "35.0749418"
 Parameter: YMIN -> "28.0749418"
 Parameter: ZMAX -> "-13.8671016"
 Parameter: ZMIN -> "-20.8671016"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "28"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "28" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "28"
Evaluating: 28
 Parameter: J <- "28"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "28" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.503155206"
Evaluating: (89.1533903-9.0)*(0.503155206-0.5)
 Parameter: XPOS <- "0.252900458"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "3.387688154E-02"
Evaluating: (89.1533903-9.0)*(3.387688154E-02-0.5)
 Parameter: YPOS <- "-37.3613482"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.235801376"
Evaluating: (89.1533903-9.0)*(0.235801376-0.5)
 Parameter: ZPOS <- "-21.1764154"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.252900458"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 0.252900458-44.5766951
 Parameter: XTRAN <- "-44.3237946"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.3613482"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -37.3613482-44.5766951
 Parameter: YTRAN <- "-81.9380433"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.1764154"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -21.1764154-44.5766951
 Parameter: ZTRAN <- "-65.7531105"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.3237946"
 Parameter: YTRAN -> "-81.9380433"
 Parameter: ZTRAN -> "-65.7531105"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -44.323795  -81.938043  -65.753111
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.752562313"
Evaluating: 0.752562313*360.0
 Parameter: XPHI <- "270.922433"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.75878717"
Evaluating: 0.75878717*360.0
 Parameter: YPHI <- "273.163381"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.894968209E-02"
Evaluating: 1.894968209E-02*360.0
 Parameter: ZPHI <- "6.82188555"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.252900458"
 Parameter: YPOS -> "-37.3613482"
 Parameter: ZPOS -> "-21.1764154"
 Parameter: XPHI -> "270.922433"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.016099   -0.999870
    0.000000    0.999870    0.016099

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   89.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.252900458"
 Parameter: YPOS -> "-37.3613482"
 Parameter: ZPOS -> "-21.1764154"
 Parameter: YPHI -> "273.163381"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.055183    0.000000    0.998476
    0.000000    1.000000    0.000000
   -0.998476    0.000000    0.055183

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   86.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.252900458"
 Parameter: YPOS -> "-37.3613482"
 Parameter: ZPOS -> "-21.1764154"
 Parameter: ZPHI -> "6.82188555"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.992920    0.118783    0.000000
   -0.118783    0.992920    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    6.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.252900 XMAX =    0.252900 XAVE =    0.252900
    YMIN =  -37.361348 YMAX =  -37.361348 YAVE =  -37.361348
    ZMIN =  -21.176415 ZMAX =  -21.176415 ZAVE =  -21.176415
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.25290046"
Evaluating: 0.25290046+3.5
 Parameter: XMAX <- "3.75290046"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.3613482"
Evaluating: -37.3613482+3.5
 Parameter: YMAX <- "-33.8613482"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.1764154"
Evaluating: -21.1764154+3.5
 Parameter: ZMAX <- "-17.6764154"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.25290046"
Evaluating: 0.25290046-3.5
 Parameter: XMIN <- "-3.24709954"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.3613482"
Evaluating: -37.3613482-3.5
 Parameter: YMIN <- "-40.8613482"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.1764154"
Evaluating: -21.1764154-3.5
 Parameter: ZMIN <- "-24.6764154"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.75290046"
 Parameter: XMIN -> "-3.24709954"
 Parameter: YMAX -> "-33.8613482"
 Parameter: YMIN -> "-40.8613482"
 Parameter: ZMAX -> "-17.6764154"
 Parameter: ZMIN -> "-24.6764154"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "29"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "29" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "29"
Evaluating: 29
 Parameter: J <- "29"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "29" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.401749317"
Evaluating: (89.1533903-9.0)*(0.401749317-0.5)
 Parameter: XPOS <- "-7.87512534"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.845649317"
Evaluating: (89.1533903-9.0)*(0.845649317-0.5)
 Parameter: YPOS <- "27.7049646"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.469438133"
Evaluating: (89.1533903-9.0)*(0.469438133-0.5)
 Parameter: ZPOS <- "-2.44963725"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.87512534"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -7.87512534-44.5766951
 Parameter: XTRAN <- "-52.4518204"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.7049646"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 27.7049646-44.5766951
 Parameter: YTRAN <- "-16.8717305"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-2.44963725"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -2.44963725-44.5766951
 Parameter: ZTRAN <- "-47.0263324"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-52.4518204"
 Parameter: YTRAN -> "-16.8717305"
 Parameter: ZTRAN -> "-47.0263324"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -52.451820  -16.871731  -47.026332
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.643042796"
Evaluating: 0.643042796*360.0
 Parameter: XPHI <- "231.495407"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.768680649"
Evaluating: 0.768680649*360.0
 Parameter: YPHI <- "276.725034"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.450805266E-02"
Evaluating: 6.450805266E-02*360.0
 Parameter: ZPHI <- "23.222899"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.87512534"
 Parameter: YPOS -> "27.7049646"
 Parameter: ZPOS -> "-2.44963725"
 Parameter: XPHI -> "231.495407"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.622577   -0.782558
    0.000000    0.782558   -0.622577

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  128.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.87512534"
 Parameter: YPOS -> "27.7049646"
 Parameter: ZPOS -> "-2.44963725"
 Parameter: YPHI -> "276.725034"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.117105    0.000000    0.993120
    0.000000    1.000000    0.000000
   -0.993120    0.000000    0.117105

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   83.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.87512534"
 Parameter: YPOS -> "27.7049646"
 Parameter: ZPOS -> "-2.44963725"
 Parameter: ZPHI -> "23.222899"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.918978    0.394309    0.000000
   -0.394309    0.918978    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   23.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.875125 XMAX =   -7.875125 XAVE =   -7.875125
    YMIN =   27.704965 YMAX =   27.704965 YAVE =   27.704965
    ZMIN =   -2.449637 ZMAX =   -2.449637 ZAVE =   -2.449637
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.87512529"
Evaluating: -7.87512529+3.5
 Parameter: XMAX <- "-4.37512529"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.7049646"
Evaluating: 27.7049646+3.5
 Parameter: YMAX <- "31.2049646"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-2.44963729"
Evaluating: -2.44963729+3.5
 Parameter: ZMAX <- "1.05036271"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.87512529"
Evaluating: -7.87512529-3.5
 Parameter: XMIN <- "-11.3751253"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.7049646"
Evaluating: 27.7049646-3.5
 Parameter: YMIN <- "24.2049646"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-2.44963729"
Evaluating: -2.44963729-3.5
 Parameter: ZMIN <- "-5.94963729"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.37512529"
 Parameter: XMIN -> "-11.3751253"
 Parameter: YMAX -> "31.2049646"
 Parameter: YMIN -> "24.2049646"
 Parameter: ZMAX -> "1.05036271"
 Parameter: ZMIN -> "-5.94963729"
 SELRPN>      3 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      1 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "30"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "30" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "30" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.265674837"
Evaluating: (89.1533903-9.0)*(0.265674837-0.5)
 Parameter: XPOS <- "-18.7819562"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.922919198"
Evaluating: (89.1533903-9.0)*(0.922919198-0.5)
 Parameter: YPOS <- "33.8984075"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.545528584"
Evaluating: (89.1533903-9.0)*(0.545528584-0.5)
 Parameter: ZPOS <- "3.64927036"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.7819562"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -18.7819562-44.5766951
 Parameter: XTRAN <- "-63.3586513"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.8984075"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 33.8984075-44.5766951
 Parameter: YTRAN <- "-10.6782876"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "3.64927036"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 3.64927036-44.5766951
 Parameter: ZTRAN <- "-40.9274247"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-63.3586513"
 Parameter: YTRAN -> "-10.6782876"
 Parameter: ZTRAN -> "-40.9274247"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -63.358651  -10.678288  -40.927425
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.292310569E-03"
Evaluating: 3.292310569E-03*360.0
 Parameter: XPHI <- "1.1852318"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.602667891"
Evaluating: 0.602667891*360.0
 Parameter: YPHI <- "216.960441"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.111602125"
Evaluating: 0.111602125*360.0
 Parameter: ZPHI <- "40.176765"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.7819562"
 Parameter: YPOS -> "33.8984075"
 Parameter: ZPOS -> "3.64927036"
 Parameter: XPHI -> "1.1852318"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999786    0.020685
    0.000000   -0.020685    0.999786

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    1.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.7819562"
 Parameter: YPOS -> "33.8984075"
 Parameter: ZPOS -> "3.64927036"
 Parameter: YPHI -> "216.960441"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.799051    0.000000    0.601263
    0.000000    1.000000    0.000000
   -0.601263    0.000000   -0.799051

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  143.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.7819562"
 Parameter: YPOS -> "33.8984075"
 Parameter: ZPOS -> "3.64927036"
 Parameter: ZPHI -> "40.176765"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.764058    0.645148    0.000000
   -0.645148    0.764058    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   40.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.781956 XMAX =  -18.781956 XAVE =  -18.781956
    YMIN =   33.898407 YMAX =   33.898407 YAVE =   33.898407
    ZMIN =    3.649270 ZMAX =    3.649270 ZAVE =    3.649270
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.7819562"
Evaluating: -18.7819562+3.5
 Parameter: XMAX <- "-15.2819562"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.8984075"
Evaluating: 33.8984075+3.5
 Parameter: YMAX <- "37.3984075"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "3.64927033"
Evaluating: 3.64927033+3.5
 Parameter: ZMAX <- "7.14927033"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.7819562"
Evaluating: -18.7819562-3.5
 Parameter: XMIN <- "-22.2819562"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.8984075"
Evaluating: 33.8984075-3.5
 Parameter: YMIN <- "30.3984075"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "3.64927033"
Evaluating: 3.64927033-3.5
 Parameter: ZMIN <- "0.14927033"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.2819562"
 Parameter: XMIN -> "-22.2819562"
 Parameter: YMAX -> "37.3984075"
 Parameter: YMIN -> "30.3984075"
 Parameter: ZMAX -> "7.14927033"
 Parameter: ZMIN -> "0.14927033"
 SELRPN>     30 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "30"
 Comparing "30" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     15 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9132 POS      SOD      30       SOD     -4984 PAA2     MET      29       CB            4.1901
 9132 POS      SOD      30       SOD     -4991 PAA2     MET      29       CE            3.4417
 9132 POS      SOD      30       SOD     -4995 PAA2     MET      29       C             3.4555
 9132 POS      SOD      30       SOD     -4996 PAA2     MET      29       O             2.5177
 9132 POS      SOD      30       SOD     -5025 PAA2     LEU      32       CB            4.1000
 9132 POS      SOD      30       SOD     -5040 PAA2     SER      33       N             3.0974
 9132 POS      SOD      30       SOD     -5042 PAA2     SER      33       CA            3.2922
 9132 POS      SOD      30       SOD     -5044 PAA2     SER      33       CB            2.9555
 9132 POS      SOD      30       SOD     -5176 PAA2     LEU      43       CB            3.9837
 9132 POS      SOD      30       SOD     -5179 PAA2     LEU      43       CG            3.9017
 9132 POS      SOD      30       SOD     -5181 PAA2     LEU      43       CD1           3.9582
 9132 POS      SOD      30       SOD     -5185 PAA2     LEU      43       CD2           3.2009
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "30"
Evaluating: 30
 Parameter: J <- "30"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "30" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.277931844"
Evaluating: (89.1533903-9.0)*(0.277931844-0.5)
 Parameter: XPOS <- "-17.7995156"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "3.702931876E-02"
Evaluating: (89.1533903-9.0)*(3.702931876E-02-0.5)
 Parameter: YPOS <- "-37.1086697"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.512206793"
Evaluating: (89.1533903-9.0)*(0.512206793-0.5)
 Parameter: ZPOS <- "0.978415844"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.781956 XMAX =  -18.781956 XAVE =  -18.781956
    YMIN =   33.898407 YMAX =   33.898407 YAVE =   33.898407
    ZMIN =    3.649270 ZMAX =    3.649270 ZAVE =    3.649270
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.7995156"
 RDCMND substituted energy or value "?XAVE" to "-18.7819562"
Evaluating: -17.7995156--18.7819562
 Parameter: XTRAN <- "0.9824406"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.1086697"
 RDCMND substituted energy or value "?YAVE" to "33.8984075"
Evaluating: -37.1086697-33.8984075
 Parameter: YTRAN <- "-71.0070772"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "0.978415844"
 RDCMND substituted energy or value "?ZAVE" to "3.64927033"
Evaluating: 0.978415844-3.64927033
 Parameter: ZTRAN <- "-2.67085449"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.9824406"
 Parameter: YTRAN -> "-71.0070772"
 Parameter: ZTRAN -> "-2.67085449"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR     0.982441  -71.007077   -2.670854
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.025546524E-02"
Evaluating: 4.025546524E-02*360.0
 Parameter: XPHI <- "14.4919675"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.797592393"
Evaluating: 0.797592393*360.0
 Parameter: YPHI <- "287.133261"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.918547024"
Evaluating: 0.918547024*360.0
 Parameter: ZPHI <- "330.676929"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.7995156"
 Parameter: YPOS -> "-37.1086697"
 Parameter: ZPOS -> "0.978415844"
 Parameter: XPHI -> "14.4919675"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.968183    0.250244
    0.000000   -0.250244    0.968183

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   14.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.7995156"
 Parameter: YPOS -> "-37.1086697"
 Parameter: ZPOS -> "0.978415844"
 Parameter: YPHI -> "287.133261"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.294595    0.000000    0.955622
    0.000000    1.000000    0.000000
   -0.955622    0.000000    0.294595

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   72.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.7995156"
 Parameter: YPOS -> "-37.1086697"
 Parameter: ZPOS -> "0.978415844"
 Parameter: ZPHI -> "330.676929"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.871872   -0.489734    0.000000
    0.489734    0.871872    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   29.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.799516 XMAX =  -17.799516 XAVE =  -17.799516
    YMIN =  -37.108670 YMAX =  -37.108670 YAVE =  -37.108670
    ZMIN =    0.978416 ZMAX =    0.978416 ZAVE =    0.978416
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.7995156"
Evaluating: -17.7995156+3.5
 Parameter: XMAX <- "-14.2995156"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.1086697"
Evaluating: -37.1086697+3.5
 Parameter: YMAX <- "-33.6086697"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "0.978415825"
Evaluating: 0.978415825+3.5
 Parameter: ZMAX <- "4.47841582"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.7995156"
Evaluating: -17.7995156-3.5
 Parameter: XMIN <- "-21.2995156"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.1086697"
Evaluating: -37.1086697-3.5
 Parameter: YMIN <- "-40.6086697"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "0.978415825"
Evaluating: 0.978415825-3.5
 Parameter: ZMIN <- "-2.52158418"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.2995156"
 Parameter: XMIN -> "-21.2995156"
 Parameter: YMAX -> "-33.6086697"
 Parameter: YMIN -> "-40.6086697"
 Parameter: ZMAX -> "4.47841582"
 Parameter: ZMIN -> "-2.52158418"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "31"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "31" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "31"
Evaluating: 31
 Parameter: J <- "31"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "31" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.326194278"
Evaluating: (89.1533903-9.0)*(0.326194278-0.5)
 Parameter: XPOS <- "-13.9311179"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.187613865"
Evaluating: (89.1533903-9.0)*(0.187613865-0.5)
 Parameter: YPOS <- "-25.0388078"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.354859227"
Evaluating: (89.1533903-9.0)*(0.354859227-0.5)
 Parameter: ZPOS <- "-11.633525"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.9311179"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -13.9311179-44.5766951
 Parameter: XTRAN <- "-58.507813"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.0388078"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -25.0388078-44.5766951
 Parameter: YTRAN <- "-69.6155029"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-11.633525"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -11.633525-44.5766951
 Parameter: ZTRAN <- "-56.2102201"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-58.507813"
 Parameter: YTRAN -> "-69.6155029"
 Parameter: ZTRAN -> "-56.2102201"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -58.507813  -69.615503  -56.210220
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.728545059E-02"
Evaluating: 2.728545059E-02*360.0
 Parameter: XPHI <- "9.82276221"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.930107923"
Evaluating: 0.930107923*360.0
 Parameter: YPHI <- "334.838852"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.819911643"
Evaluating: 0.819911643*360.0
 Parameter: ZPHI <- "295.168191"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.9311179"
 Parameter: YPOS -> "-25.0388078"
 Parameter: ZPOS -> "-11.633525"
 Parameter: XPHI -> "9.82276221"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.985340    0.170601
    0.000000   -0.170601    0.985340

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    9.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.9311179"
 Parameter: YPOS -> "-25.0388078"
 Parameter: ZPOS -> "-11.633525"
 Parameter: YPHI -> "334.838852"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.905116    0.000000    0.425166
    0.000000    1.000000    0.000000
   -0.425166    0.000000    0.905116

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   25.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.9311179"
 Parameter: YPOS -> "-25.0388078"
 Parameter: ZPOS -> "-11.633525"
 Parameter: ZPHI -> "295.168191"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.425277   -0.905063    0.000000
    0.905063    0.425277    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   64.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.931118 XMAX =  -13.931118 XAVE =  -13.931118
    YMIN =  -25.038808 YMAX =  -25.038808 YAVE =  -25.038808
    ZMIN =  -11.633525 ZMAX =  -11.633525 ZAVE =  -11.633525
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.9311179"
Evaluating: -13.9311179+3.5
 Parameter: XMAX <- "-10.4311179"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.0388078"
Evaluating: -25.0388078+3.5
 Parameter: YMAX <- "-21.5388078"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-11.633525"
Evaluating: -11.633525+3.5
 Parameter: ZMAX <- "-8.133525"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.9311179"
Evaluating: -13.9311179-3.5
 Parameter: XMIN <- "-17.4311179"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.0388078"
Evaluating: -25.0388078-3.5
 Parameter: YMIN <- "-28.5388078"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-11.633525"
Evaluating: -11.633525-3.5
 Parameter: ZMIN <- "-15.133525"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.4311179"
 Parameter: XMIN -> "-17.4311179"
 Parameter: YMAX -> "-21.5388078"
 Parameter: YMIN -> "-28.5388078"
 Parameter: ZMAX -> "-8.133525"
 Parameter: ZMIN -> "-15.133525"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "32"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "32" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "32"
Evaluating: 32
 Parameter: J <- "32"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "32" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.210132919"
Evaluating: (89.1533903-9.0)*(0.210132919-0.5)
 Parameter: XPOS <- "-23.2338293"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.300508025"
Evaluating: (89.1533903-9.0)*(0.300508025-0.5)
 Parameter: YPOS <- "-15.9899581"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.42232111"
Evaluating: (89.1533903-9.0)*(0.42232111-0.5)
 Parameter: ZPOS <- "-6.22622639"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.2338293"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -23.2338293-44.5766951
 Parameter: XTRAN <- "-67.8105244"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.9899581"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -15.9899581-44.5766951
 Parameter: YTRAN <- "-60.5666532"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-6.22622639"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -6.22622639-44.5766951
 Parameter: ZTRAN <- "-50.8029215"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-67.8105244"
 Parameter: YTRAN -> "-60.5666532"
 Parameter: ZTRAN -> "-50.8029215"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -67.810524  -60.566653  -50.802921
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.847666015"
Evaluating: 0.847666015*360.0
 Parameter: XPHI <- "305.159765"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.182265764"
Evaluating: 0.182265764*360.0
 Parameter: YPHI <- "65.615675"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.125708929"
Evaluating: 0.125708929*360.0
 Parameter: ZPHI <- "45.2552144"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.2338293"
 Parameter: YPOS -> "-15.9899581"
 Parameter: ZPOS -> "-6.22622639"
 Parameter: XPHI -> "305.159765"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.575858   -0.817549
    0.000000    0.817549    0.575858

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   54.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.2338293"
 Parameter: YPOS -> "-15.9899581"
 Parameter: ZPOS -> "-6.22622639"
 Parameter: YPHI -> "65.615675"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.412855    0.000000   -0.910797
    0.000000    1.000000    0.000000
    0.910797    0.000000    0.412855

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   65.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.2338293"
 Parameter: YPOS -> "-15.9899581"
 Parameter: ZPOS -> "-6.22622639"
 Parameter: ZPHI -> "45.2552144"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.703950    0.710249    0.000000
   -0.710249    0.703950    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   45.26

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.233829 XMAX =  -23.233829 XAVE =  -23.233829
    YMIN =  -15.989958 YMAX =  -15.989958 YAVE =  -15.989958
    ZMIN =   -6.226226 ZMAX =   -6.226226 ZAVE =   -6.226226
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.2338293"
Evaluating: -23.2338293+3.5
 Parameter: XMAX <- "-19.7338293"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.9899581"
Evaluating: -15.9899581+3.5
 Parameter: YMAX <- "-12.4899581"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-6.22622639"
Evaluating: -6.22622639+3.5
 Parameter: ZMAX <- "-2.72622639"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.2338293"
Evaluating: -23.2338293-3.5
 Parameter: XMIN <- "-26.7338293"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.9899581"
Evaluating: -15.9899581-3.5
 Parameter: YMIN <- "-19.4899581"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-6.22622639"
Evaluating: -6.22622639-3.5
 Parameter: ZMIN <- "-9.72622639"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.7338293"
 Parameter: XMIN -> "-26.7338293"
 Parameter: YMAX -> "-12.4899581"
 Parameter: YMIN -> "-19.4899581"
 Parameter: ZMAX -> "-2.72622639"
 Parameter: ZMIN -> "-9.72622639"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "33"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "33" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "33"
Evaluating: 33
 Parameter: J <- "33"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "33" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.509070959"
Evaluating: (89.1533903-9.0)*(0.509070959-0.5)
 Parameter: XPOS <- "0.727068117"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.619744192"
Evaluating: (89.1533903-9.0)*(0.619744192-0.5)
 Parameter: YPOS <- "9.59790296"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.192200263"
Evaluating: (89.1533903-9.0)*(0.192200263-0.5)
 Parameter: ZPOS <- "-24.6711925"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.727068117"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 0.727068117-44.5766951
 Parameter: XTRAN <- "-43.849627"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.59790296"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 9.59790296-44.5766951
 Parameter: YTRAN <- "-34.9787921"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-24.6711925"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -24.6711925-44.5766951
 Parameter: ZTRAN <- "-69.2478876"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.849627"
 Parameter: YTRAN -> "-34.9787921"
 Parameter: ZTRAN -> "-69.2478876"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -43.849627  -34.978792  -69.247888
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.126975095"
Evaluating: 0.126975095*360.0
 Parameter: XPHI <- "45.7110342"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.925885794"
Evaluating: 0.925885794*360.0
 Parameter: YPHI <- "333.318886"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.541157322"
Evaluating: 0.541157322*360.0
 Parameter: ZPHI <- "194.816636"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.727068117"
 Parameter: YPOS -> "9.59790296"
 Parameter: ZPOS -> "-24.6711925"
 Parameter: XPHI -> "45.7110342"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.698277    0.715827
    0.000000   -0.715827    0.698277

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   45.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.727068117"
 Parameter: YPOS -> "9.59790296"
 Parameter: ZPOS -> "-24.6711925"
 Parameter: YPHI -> "333.318886"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.893519    0.000000    0.449024
    0.000000    1.000000    0.000000
   -0.449024    0.000000    0.893519

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   26.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.727068117"
 Parameter: YPOS -> "9.59790296"
 Parameter: ZPOS -> "-24.6711925"
 Parameter: ZPHI -> "194.816636"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.966749   -0.255726    0.000000
    0.255726   -0.966749    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  165.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.727068 XMAX =    0.727068 XAVE =    0.727068
    YMIN =    9.597903 YMAX =    9.597903 YAVE =    9.597903
    ZMIN =  -24.671193 ZMAX =  -24.671193 ZAVE =  -24.671193
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.727068137"
Evaluating: 0.727068137+3.5
 Parameter: XMAX <- "4.22706814"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.59790293"
Evaluating: 9.59790293+3.5
 Parameter: YMAX <- "13.0979029"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-24.6711925"
Evaluating: -24.6711925+3.5
 Parameter: ZMAX <- "-21.1711925"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.727068137"
Evaluating: 0.727068137-3.5
 Parameter: XMIN <- "-2.77293186"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.59790293"
Evaluating: 9.59790293-3.5
 Parameter: YMIN <- "6.09790293"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-24.6711925"
Evaluating: -24.6711925-3.5
 Parameter: ZMIN <- "-28.1711925"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.22706814"
 Parameter: XMIN -> "-2.77293186"
 Parameter: YMAX -> "13.0979029"
 Parameter: YMIN -> "6.09790293"
 Parameter: ZMAX -> "-21.1711925"
 Parameter: ZMIN -> "-28.1711925"
 SELRPN>      3 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      2 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "34"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "34" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "34" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.336839184"
Evaluating: (89.1533903-9.0)*(0.336839184-0.5)
 Parameter: XPOS <- "-13.0778926"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.39950339"
Evaluating: (89.1533903-9.0)*(0.39950339-0.5)
 Parameter: YPOS <- "-8.05514401"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.476805374"
Evaluating: (89.1533903-9.0)*(0.476805374-0.5)
 Parameter: ZPOS <- "-1.85912791"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.0778926"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -13.0778926-44.5766951
 Parameter: XTRAN <- "-57.6545877"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.05514401"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -8.05514401-44.5766951
 Parameter: YTRAN <- "-52.6318391"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-1.85912791"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -1.85912791-44.5766951
 Parameter: ZTRAN <- "-46.435823"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-57.6545877"
 Parameter: YTRAN -> "-52.6318391"
 Parameter: ZTRAN -> "-46.435823"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -57.654588  -52.631839  -46.435823
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.286690725"
Evaluating: 0.286690725*360.0
 Parameter: XPHI <- "103.208661"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.356403213"
Evaluating: 0.356403213*360.0
 Parameter: YPHI <- "128.305157"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.752756558"
Evaluating: 0.752756558*360.0
 Parameter: ZPHI <- "270.992361"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.0778926"
 Parameter: YPOS -> "-8.05514401"
 Parameter: ZPOS -> "-1.85912791"
 Parameter: XPHI -> "103.208661"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.228498    0.973544
    0.000000   -0.973544   -0.228498

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  103.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.0778926"
 Parameter: YPOS -> "-8.05514401"
 Parameter: ZPOS -> "-1.85912791"
 Parameter: YPHI -> "128.305157"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.619850    0.000000   -0.784721
    0.000000    1.000000    0.000000
    0.784721    0.000000   -0.619850

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  128.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.0778926"
 Parameter: YPOS -> "-8.05514401"
 Parameter: ZPOS -> "-1.85912791"
 Parameter: ZPHI -> "270.992361"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.017319   -0.999850    0.000000
    0.999850    0.017319    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   89.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.077893 XMAX =  -13.077893 XAVE =  -13.077893
    YMIN =   -8.055144 YMAX =   -8.055144 YAVE =   -8.055144
    ZMIN =   -1.859128 ZMAX =   -1.859128 ZAVE =   -1.859128
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.0778926"
Evaluating: -13.0778926+3.5
 Parameter: XMAX <- "-9.5778926"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.055144"
Evaluating: -8.055144+3.5
 Parameter: YMAX <- "-4.555144"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-1.8591279"
Evaluating: -1.8591279+3.5
 Parameter: ZMAX <- "1.6408721"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.0778926"
Evaluating: -13.0778926-3.5
 Parameter: XMIN <- "-16.5778926"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.055144"
Evaluating: -8.055144-3.5
 Parameter: YMIN <- "-11.555144"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-1.8591279"
Evaluating: -1.8591279-3.5
 Parameter: ZMIN <- "-5.3591279"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.5778926"
 Parameter: XMIN -> "-16.5778926"
 Parameter: YMAX -> "-4.555144"
 Parameter: YMIN -> "-11.555144"
 Parameter: ZMAX -> "1.6408721"
 Parameter: ZMIN -> "-5.3591279"
 SELRPN>     37 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "37"
 Comparing "37" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     19 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9136 POS      SOD      34       SOD     - 192 PAA1     THR      13       CB            4.3128
 9136 POS      SOD      34       SOD     - 194 PAA1     THR      13       OG1           3.9314
 9136 POS      SOD      34       SOD     - 196 PAA1     THR      13       CG2           3.8438
 9136 POS      SOD      34       SOD     - 224 PAA1     TRP      15       CD1           3.8177
 9136 POS      SOD      34       SOD     - 996 PAA1     PRO      68       O             3.8863
 9136 POS      SOD      34       SOD     -1031 PAA1     LYS      70       C             4.4458
 9136 POS      SOD      34       SOD     -1033 PAA1     LEU      71       N             3.5931
 9136 POS      SOD      34       SOD     -1035 PAA1     LEU      71       CA            2.4318
 9136 POS      SOD      34       SOD     -1037 PAA1     LEU      71       CB            2.5471
 9136 POS      SOD      34       SOD     -1040 PAA1     LEU      71       CG            4.0566
 9136 POS      SOD      34       SOD     -1050 PAA1     LEU      71       C             1.4756
 9136 POS      SOD      34       SOD     -1051 PAA1     LEU      71       O             1.6968
 9136 POS      SOD      34       SOD     -1052 PAA1     GLN      72       N             1.9607
 9136 POS      SOD      34       SOD     -1054 PAA1     GLN      72       CA            2.6920
 9136 POS      SOD      34       SOD     -1056 PAA1     GLN      72       CB            3.8034
 9136 POS      SOD      34       SOD     -1098 PAA1     ASN      75       N             4.3798
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        16
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "16"
 Comparing "16" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "34"
Evaluating: 34
 Parameter: J <- "34"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "34" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.992227226"
Evaluating: (89.1533903-9.0)*(0.992227226-0.5)
 Parameter: XPOS <- "39.453681"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.480904886"
Evaluating: (89.1533903-9.0)*(0.480904886-0.5)
 Parameter: YPOS <- "-1.53053813"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.373877536"
Evaluating: (89.1533903-9.0)*(0.373877536-0.5)
 Parameter: ZPOS <- "-10.1091431"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.077893 XMAX =  -13.077893 XAVE =  -13.077893
    YMIN =   -8.055144 YMAX =   -8.055144 YAVE =   -8.055144
    ZMIN =   -1.859128 ZMAX =   -1.859128 ZAVE =   -1.859128
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "39.453681"
 RDCMND substituted energy or value "?XAVE" to "-13.0778926"
Evaluating: 39.453681--13.0778926
 Parameter: XTRAN <- "52.5315736"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.53053813"
 RDCMND substituted energy or value "?YAVE" to "-8.055144"
Evaluating: -1.53053813--8.055144
 Parameter: YTRAN <- "6.52460587"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-10.1091431"
 RDCMND substituted energy or value "?ZAVE" to "-1.8591279"
Evaluating: -10.1091431--1.8591279
 Parameter: ZTRAN <- "-8.2500152"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "52.5315736"
 Parameter: YTRAN -> "6.52460587"
 Parameter: ZTRAN -> "-8.2500152"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    52.531574    6.524606   -8.250015
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.382563834"
Evaluating: 0.382563834*360.0
 Parameter: XPHI <- "137.72298"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.719378144E-04"
Evaluating: 7.719378144E-04*360.0
 Parameter: YPHI <- "0.277897613"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.570509375"
Evaluating: 0.570509375*360.0
 Parameter: ZPHI <- "205.383375"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "39.453681"
 Parameter: YPOS -> "-1.53053813"
 Parameter: ZPOS -> "-10.1091431"
 Parameter: XPHI -> "137.72298"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.739901    0.672716
    0.000000   -0.672716   -0.739901

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  137.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "39.453681"
 Parameter: YPOS -> "-1.53053813"
 Parameter: ZPOS -> "-10.1091431"
 Parameter: YPHI -> "0.277897613"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.999988    0.000000   -0.004850
    0.000000    1.000000    0.000000
    0.004850    0.000000    0.999988

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    0.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "39.453681"
 Parameter: YPOS -> "-1.53053813"
 Parameter: ZPOS -> "-10.1091431"
 Parameter: ZPHI -> "205.383375"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.903460   -0.428673    0.000000
    0.428673   -0.903460    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  154.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   39.453681 XMAX =   39.453681 XAVE =   39.453681
    YMIN =   -1.530538 YMAX =   -1.530538 YAVE =   -1.530538
    ZMIN =  -10.109143 ZMAX =  -10.109143 ZAVE =  -10.109143
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "39.453681"
Evaluating: 39.453681+3.5
 Parameter: XMAX <- "42.953681"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.53053813"
Evaluating: -1.53053813+3.5
 Parameter: YMAX <- "1.96946187"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-10.1091431"
Evaluating: -10.1091431+3.5
 Parameter: ZMAX <- "-6.6091431"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "39.453681"
Evaluating: 39.453681-3.5
 Parameter: XMIN <- "35.953681"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.53053813"
Evaluating: -1.53053813-3.5
 Parameter: YMIN <- "-5.03053813"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-10.1091431"
Evaluating: -10.1091431-3.5
 Parameter: ZMIN <- "-13.6091431"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "42.953681"
 Parameter: XMIN -> "35.953681"
 Parameter: YMAX -> "1.96946187"
 Parameter: YMIN -> "-5.03053813"
 Parameter: ZMAX -> "-6.6091431"
 Parameter: ZMIN -> "-13.6091431"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "35"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "35" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "35"
Evaluating: 35
 Parameter: J <- "35"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "35" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.323764519"
Evaluating: (89.1533903-9.0)*(0.323764519-0.5)
 Parameter: XPOS <- "-14.1258713"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.22125572"
Evaluating: (89.1533903-9.0)*(0.22125572-0.5)
 Parameter: YPOS <- "-22.3422991"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.988154425"
Evaluating: (89.1533903-9.0)*(0.988154425-0.5)
 Parameter: ZPOS <- "39.1272322"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.1258713"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -14.1258713-44.5766951
 Parameter: XTRAN <- "-58.7025664"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.3422991"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -22.3422991-44.5766951
 Parameter: YTRAN <- "-66.9189942"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.1272322"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 39.1272322-44.5766951
 Parameter: ZTRAN <- "-5.4494629"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-58.7025664"
 Parameter: YTRAN -> "-66.9189942"
 Parameter: ZTRAN -> "-5.4494629"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -58.702566  -66.918994   -5.449463
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.616484162"
Evaluating: 0.616484162*360.0
 Parameter: XPHI <- "221.934298"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.164455605"
Evaluating: 0.164455605*360.0
 Parameter: YPHI <- "59.2040178"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.808893067"
Evaluating: 0.808893067*360.0
 Parameter: ZPHI <- "291.201504"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.1258713"
 Parameter: YPOS -> "-22.3422991"
 Parameter: ZPOS -> "39.1272322"
 Parameter: XPHI -> "221.934298"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.743912   -0.668278
    0.000000    0.668278   -0.743912

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  138.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.1258713"
 Parameter: YPOS -> "-22.3422991"
 Parameter: ZPOS -> "39.1272322"
 Parameter: YPHI -> "59.2040178"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.511983    0.000000   -0.858996
    0.000000    1.000000    0.000000
    0.858996    0.000000    0.511983

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   59.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.1258713"
 Parameter: YPOS -> "-22.3422991"
 Parameter: ZPOS -> "39.1272322"
 Parameter: ZPHI -> "291.201504"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.361649   -0.932314    0.000000
    0.932314    0.361649    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   68.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.125871 XMAX =  -14.125871 XAVE =  -14.125871
    YMIN =  -22.342299 YMAX =  -22.342299 YAVE =  -22.342299
    ZMIN =   39.127232 ZMAX =   39.127232 ZAVE =   39.127232
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.1258713"
Evaluating: -14.1258713+3.5
 Parameter: XMAX <- "-10.6258713"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.3422991"
Evaluating: -22.3422991+3.5
 Parameter: YMAX <- "-18.8422991"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.1272322"
Evaluating: 39.1272322+3.5
 Parameter: ZMAX <- "42.6272322"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.1258713"
Evaluating: -14.1258713-3.5
 Parameter: XMIN <- "-17.6258713"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.3422991"
Evaluating: -22.3422991-3.5
 Parameter: YMIN <- "-25.8422991"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.1272322"
Evaluating: 39.1272322-3.5
 Parameter: ZMIN <- "35.6272322"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.6258713"
 Parameter: XMIN -> "-17.6258713"
 Parameter: YMAX -> "-18.8422991"
 Parameter: YMIN -> "-25.8422991"
 Parameter: ZMAX -> "42.6272322"
 Parameter: ZMIN -> "35.6272322"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "36"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "36" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "36"
Evaluating: 36
 Parameter: J <- "36"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "36" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.94966048"
Evaluating: (89.1533903-9.0)*(0.94966048-0.5)
 Parameter: XPOS <- "36.041812"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "8.412939729E-02"
Evaluating: (89.1533903-9.0)*(8.412939729E-02-0.5)
 Parameter: YPOS <- "-33.3334387"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.361206386"
Evaluating: (89.1533903-9.0)*(0.361206386-0.5)
 Parameter: ZPOS <- "-11.1247787"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.041812"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 36.041812-44.5766951
 Parameter: XTRAN <- "-8.5348831"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.3334387"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -33.3334387-44.5766951
 Parameter: YTRAN <- "-77.9101338"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-11.1247787"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -11.1247787-44.5766951
 Parameter: ZTRAN <- "-55.7014738"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.5348831"
 Parameter: YTRAN -> "-77.9101338"
 Parameter: ZTRAN -> "-55.7014738"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    -8.534883  -77.910134  -55.701474
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.28856476"
Evaluating: 0.28856476*360.0
 Parameter: XPHI <- "103.883314"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.909755034"
Evaluating: 0.909755034*360.0
 Parameter: YPHI <- "327.511812"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.496311317"
Evaluating: 0.496311317*360.0
 Parameter: ZPHI <- "178.672074"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.041812"
 Parameter: YPOS -> "-33.3334387"
 Parameter: ZPOS -> "-11.1247787"
 Parameter: XPHI -> "103.883314"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.239945    0.970786
    0.000000   -0.970786   -0.239945

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  103.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.041812"
 Parameter: YPOS -> "-33.3334387"
 Parameter: ZPOS -> "-11.1247787"
 Parameter: YPHI -> "327.511812"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.843502    0.000000    0.537126
    0.000000    1.000000    0.000000
   -0.537126    0.000000    0.843502

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   32.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.041812"
 Parameter: YPOS -> "-33.3334387"
 Parameter: ZPOS -> "-11.1247787"
 Parameter: ZPHI -> "178.672074"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.999731    0.023175    0.000000
   -0.023175   -0.999731    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  178.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.041812 XMAX =   36.041812 XAVE =   36.041812
    YMIN =  -33.333439 YMAX =  -33.333439 YAVE =  -33.333439
    ZMIN =  -11.124779 ZMAX =  -11.124779 ZAVE =  -11.124779
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.041812"
Evaluating: 36.041812+3.5
 Parameter: XMAX <- "39.541812"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.3334387"
Evaluating: -33.3334387+3.5
 Parameter: YMAX <- "-29.8334387"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-11.1247787"
Evaluating: -11.1247787+3.5
 Parameter: ZMAX <- "-7.6247787"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.041812"
Evaluating: 36.041812-3.5
 Parameter: XMIN <- "32.541812"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.3334387"
Evaluating: -33.3334387-3.5
 Parameter: YMIN <- "-36.8334387"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-11.1247787"
Evaluating: -11.1247787-3.5
 Parameter: ZMIN <- "-14.6247787"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.541812"
 Parameter: XMIN -> "32.541812"
 Parameter: YMAX -> "-29.8334387"
 Parameter: YMIN -> "-36.8334387"
 Parameter: ZMAX -> "-7.6247787"
 Parameter: ZMIN -> "-14.6247787"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "37"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "37" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "37"
Evaluating: 37
 Parameter: J <- "37"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "37" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.164660217"
Evaluating: (89.1533903-9.0)*(0.164660217-0.5)
 Parameter: XPOS <- "-26.8786205"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.412036388"
Evaluating: (89.1533903-9.0)*(0.412036388-0.5)
 Parameter: YPOS <- "-7.05058172"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.32898575"
Evaluating: (89.1533903-9.0)*(0.32898575-0.5)
 Parameter: ZPOS <- "-13.7073719"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-26.8786205"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -26.8786205-44.5766951
 Parameter: XTRAN <- "-71.4553156"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.05058172"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -7.05058172-44.5766951
 Parameter: YTRAN <- "-51.6272768"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-13.7073719"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -13.7073719-44.5766951
 Parameter: ZTRAN <- "-58.284067"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-71.4553156"
 Parameter: YTRAN -> "-51.6272768"
 Parameter: ZTRAN -> "-58.284067"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -71.455316  -51.627277  -58.284067
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.833228704E-02"
Evaluating: 6.833228704E-02*360.0
 Parameter: XPHI <- "24.5996233"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.849799353"
Evaluating: 0.849799353*360.0
 Parameter: YPHI <- "305.927767"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.59397636"
Evaluating: 0.59397636*360.0
 Parameter: ZPHI <- "213.83149"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-26.8786205"
 Parameter: YPOS -> "-7.05058172"
 Parameter: ZPOS -> "-13.7073719"
 Parameter: XPHI -> "24.5996233"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.909239    0.416275
    0.000000   -0.416275    0.909239

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   24.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-26.8786205"
 Parameter: YPOS -> "-7.05058172"
 Parameter: ZPOS -> "-13.7073719"
 Parameter: YPHI -> "305.927767"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.586765    0.000000    0.809757
    0.000000    1.000000    0.000000
   -0.809757    0.000000    0.586765

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   54.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-26.8786205"
 Parameter: YPOS -> "-7.05058172"
 Parameter: ZPOS -> "-13.7073719"
 Parameter: ZPHI -> "213.83149"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.830679   -0.556752    0.000000
    0.556752   -0.830679    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  146.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -26.878621 XMAX =  -26.878621 XAVE =  -26.878621
    YMIN =   -7.050582 YMAX =   -7.050582 YAVE =   -7.050582
    ZMIN =  -13.707372 ZMAX =  -13.707372 ZAVE =  -13.707372
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-26.8786205"
Evaluating: -26.8786205+3.5
 Parameter: XMAX <- "-23.3786205"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.05058174"
Evaluating: -7.05058174+3.5
 Parameter: YMAX <- "-3.55058174"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-13.7073719"
Evaluating: -13.7073719+3.5
 Parameter: ZMAX <- "-10.2073719"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-26.8786205"
Evaluating: -26.8786205-3.5
 Parameter: XMIN <- "-30.3786205"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.05058174"
Evaluating: -7.05058174-3.5
 Parameter: YMIN <- "-10.5505817"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-13.7073719"
Evaluating: -13.7073719-3.5
 Parameter: ZMIN <- "-17.2073719"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-23.3786205"
 Parameter: XMIN -> "-30.3786205"
 Parameter: YMAX -> "-3.55058174"
 Parameter: YMIN -> "-10.5505817"
 Parameter: ZMAX -> "-10.2073719"
 Parameter: ZMIN -> "-17.2073719"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "38"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "38" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "38" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.137765903"
Evaluating: (89.1533903-9.0)*(0.137765903-0.5)
 Parameter: XPOS <- "-29.034291"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.858173949"
Evaluating: (89.1533903-9.0)*(0.858173949-0.5)
 Parameter: YPOS <- "28.7088563"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.684583218"
Evaluating: (89.1533903-9.0)*(0.684583218-0.5)
 Parameter: ZPOS <- "14.7949707"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.034291"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -29.034291-44.5766951
 Parameter: XTRAN <- "-73.6109861"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.7088563"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 28.7088563-44.5766951
 Parameter: YTRAN <- "-15.8678388"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "14.7949707"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 14.7949707-44.5766951
 Parameter: ZTRAN <- "-29.7817244"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-73.6109861"
 Parameter: YTRAN -> "-15.8678388"
 Parameter: ZTRAN -> "-29.7817244"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -73.610986  -15.867839  -29.781724
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.188005048"
Evaluating: 0.188005048*360.0
 Parameter: XPHI <- "67.6818173"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.66892926"
Evaluating: 0.66892926*360.0
 Parameter: YPHI <- "240.814534"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.54216558"
Evaluating: 0.54216558*360.0
 Parameter: ZPHI <- "195.179609"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.034291"
 Parameter: YPOS -> "28.7088563"
 Parameter: ZPOS -> "14.7949707"
 Parameter: XPHI -> "67.6818173"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.379750    0.925089
    0.000000   -0.925089    0.379750

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   67.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.034291"
 Parameter: YPOS -> "28.7088563"
 Parameter: ZPOS -> "14.7949707"
 Parameter: YPHI -> "240.814534"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.487638    0.000000    0.873046
    0.000000    1.000000    0.000000
   -0.873046    0.000000   -0.487638

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  119.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.034291"
 Parameter: YPOS -> "28.7088563"
 Parameter: ZPOS -> "14.7949707"
 Parameter: ZPHI -> "195.179609"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.965110   -0.261846    0.000000
    0.261846   -0.965110    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  164.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.034291 XMAX =  -29.034291 XAVE =  -29.034291
    YMIN =   28.708856 YMAX =   28.708856 YAVE =   28.708856
    ZMIN =   14.794971 ZMAX =   14.794971 ZAVE =   14.794971
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.034291"
Evaluating: -29.034291+3.5
 Parameter: XMAX <- "-25.534291"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.7088563"
Evaluating: 28.7088563+3.5
 Parameter: YMAX <- "32.2088563"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "14.7949707"
Evaluating: 14.7949707+3.5
 Parameter: ZMAX <- "18.2949707"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.034291"
Evaluating: -29.034291-3.5
 Parameter: XMIN <- "-32.534291"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.7088563"
Evaluating: 28.7088563-3.5
 Parameter: YMIN <- "25.2088563"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "14.7949707"
Evaluating: 14.7949707-3.5
 Parameter: ZMIN <- "11.2949707"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.534291"
 Parameter: XMIN -> "-32.534291"
 Parameter: YMAX -> "32.2088563"
 Parameter: YMIN -> "25.2088563"
 Parameter: ZMAX -> "18.2949707"
 Parameter: ZMIN -> "11.2949707"
 SELRPN>     32 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "32"
 Comparing "32" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     16 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9140 POS      SOD      38       SOD     -5679 PAA2     MET      76       O             4.0517
 9140 POS      SOD      38       SOD     -5682 PAA2     ALA      77       CA            2.5595
 9140 POS      SOD      38       SOD     -5684 PAA2     ALA      77       CB            3.2231
 9140 POS      SOD      38       SOD     -5688 PAA2     ALA      77       C             1.2435
 9140 POS      SOD      38       SOD     -5689 PAA2     ALA      77       O             0.9143
 9140 POS      SOD      38       SOD     -5690 PAA2     PHE      78       N             1.9198
 9140 POS      SOD      38       SOD     -5692 PAA2     PHE      78       CA            2.3912
 9140 POS      SOD      38       SOD     -5708 PAA2     PHE      78       C             2.9830
 9140 POS      SOD      38       SOD     -5709 PAA2     PHE      78       O             3.3632
 9140 POS      SOD      38       SOD     -5710 PAA2     ALA      79       N             3.7474
 9140 POS      SOD      38       SOD     -5731 PAA2     SER      81       N             3.5563
 9140 POS      SOD      38       SOD     -5733 PAA2     SER      81       CA            4.1961
 9140 POS      SOD      38       SOD     -5735 PAA2     SER      81       CB            3.5616
 9140 POS      SOD      38       SOD     -5738 PAA2     SER      81       OG            3.0265
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        14
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "14"
 Comparing "14" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "38"
Evaluating: 38
 Parameter: J <- "38"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "38" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.442170421"
Evaluating: (89.1533903-9.0)*(0.442170421-0.5)
 Parameter: XPOS <- "-4.63523682"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.132535927"
Evaluating: (89.1533903-9.0)*(0.132535927-0.5)
 Parameter: YPOS <- "-29.4534913"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "5.823487475E-02"
Evaluating: (89.1533903-9.0)*(5.823487475E-02-0.5)
 Parameter: ZPOS <- "-35.4089725"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.034291 XMAX =  -29.034291 XAVE =  -29.034291
    YMIN =   28.708856 YMAX =   28.708856 YAVE =   28.708856
    ZMIN =   14.794971 ZMAX =   14.794971 ZAVE =   14.794971
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-4.63523682"
 RDCMND substituted energy or value "?XAVE" to "-29.034291"
Evaluating: -4.63523682--29.034291
 Parameter: XTRAN <- "24.3990542"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.4534913"
 RDCMND substituted energy or value "?YAVE" to "28.7088563"
Evaluating: -29.4534913-28.7088563
 Parameter: YTRAN <- "-58.1623476"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-35.4089725"
 RDCMND substituted energy or value "?ZAVE" to "14.7949707"
Evaluating: -35.4089725-14.7949707
 Parameter: ZTRAN <- "-50.2039432"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "24.3990542"
 Parameter: YTRAN -> "-58.1623476"
 Parameter: ZTRAN -> "-50.2039432"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    24.399054  -58.162348  -50.203943
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.283846161E-02"
Evaluating: 8.283846161E-02*360.0
 Parameter: XPHI <- "29.8218462"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.536088972"
Evaluating: 0.536088972*360.0
 Parameter: YPHI <- "192.99203"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.197341732"
Evaluating: 0.197341732*360.0
 Parameter: ZPHI <- "71.0430235"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-4.63523682"
 Parameter: YPOS -> "-29.4534913"
 Parameter: ZPOS -> "-35.4089725"
 Parameter: XPHI -> "29.8218462"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.867576    0.497305
    0.000000   -0.497305    0.867576

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   29.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-4.63523682"
 Parameter: YPOS -> "-29.4534913"
 Parameter: ZPOS -> "-35.4089725"
 Parameter: YPHI -> "192.99203"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.974401    0.000000    0.224816
    0.000000    1.000000    0.000000
   -0.224816    0.000000   -0.974401

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  167.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-4.63523682"
 Parameter: YPOS -> "-29.4534913"
 Parameter: ZPOS -> "-35.4089725"
 Parameter: ZPHI -> "71.0430235"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.324858    0.945763    0.000000
   -0.945763    0.324858    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   71.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -4.635237 XMAX =   -4.635237 XAVE =   -4.635237
    YMIN =  -29.453491 YMAX =  -29.453491 YAVE =  -29.453491
    ZMIN =  -35.408973 ZMAX =  -35.408973 ZAVE =  -35.408973
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-4.63523683"
Evaluating: -4.63523683+3.5
 Parameter: XMAX <- "-1.13523683"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.4534913"
Evaluating: -29.4534913+3.5
 Parameter: YMAX <- "-25.9534913"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-35.4089725"
Evaluating: -35.4089725+3.5
 Parameter: ZMAX <- "-31.9089725"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-4.63523683"
Evaluating: -4.63523683-3.5
 Parameter: XMIN <- "-8.13523683"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.4534913"
Evaluating: -29.4534913-3.5
 Parameter: YMIN <- "-32.9534913"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-35.4089725"
Evaluating: -35.4089725-3.5
 Parameter: ZMIN <- "-38.9089725"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.13523683"
 Parameter: XMIN -> "-8.13523683"
 Parameter: YMAX -> "-25.9534913"
 Parameter: YMIN -> "-32.9534913"
 Parameter: ZMAX -> "-31.9089725"
 Parameter: ZMIN -> "-38.9089725"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "39"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "39" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "39" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.728943127"
Evaluating: (89.1533903-9.0)*(0.728943127-0.5)
 Parameter: XPOS <- "18.3505678"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.181908274"
Evaluating: (89.1533903-9.0)*(0.181908274-0.5)
 Parameter: YPOS <- "-25.4961303"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.641809606"
Evaluating: (89.1533903-9.0)*(0.641809606-0.5)
 Parameter: ZPOS <- "11.3665207"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "18.3505678"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 18.3505678-44.5766951
 Parameter: XTRAN <- "-26.2261273"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.4961303"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -25.4961303-44.5766951
 Parameter: YTRAN <- "-70.0728254"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "11.3665207"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 11.3665207-44.5766951
 Parameter: ZTRAN <- "-33.2101744"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-26.2261273"
 Parameter: YTRAN -> "-70.0728254"
 Parameter: ZTRAN -> "-33.2101744"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -26.226127  -70.072825  -33.210174
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.43251474"
Evaluating: 0.43251474*360.0
 Parameter: XPHI <- "155.705306"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.189284547"
Evaluating: 0.189284547*360.0
 Parameter: YPHI <- "68.1424369"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.972808729"
Evaluating: 0.972808729*360.0
 Parameter: ZPHI <- "350.211142"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "18.3505678"
 Parameter: YPOS -> "-25.4961303"
 Parameter: ZPOS -> "11.3665207"
 Parameter: XPHI -> "155.705306"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.911441    0.411430
    0.000000   -0.411430   -0.911441

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  155.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "18.3505678"
 Parameter: YPOS -> "-25.4961303"
 Parameter: ZPOS -> "11.3665207"
 Parameter: YPHI -> "68.1424369"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.372300    0.000000   -0.928112
    0.000000    1.000000    0.000000
    0.928112    0.000000    0.372300

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   68.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "18.3505678"
 Parameter: YPOS -> "-25.4961303"
 Parameter: ZPOS -> "11.3665207"
 Parameter: ZPHI -> "350.211142"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.985441   -0.170018    0.000000
    0.170018    0.985441    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    9.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.350568 XMAX =   18.350568 XAVE =   18.350568
    YMIN =  -25.496130 YMAX =  -25.496130 YAVE =  -25.496130
    ZMIN =   11.366521 ZMAX =   11.366521 ZAVE =   11.366521
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "18.3505678"
Evaluating: 18.3505678+3.5
 Parameter: XMAX <- "21.8505678"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.4961303"
Evaluating: -25.4961303+3.5
 Parameter: YMAX <- "-21.9961303"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "11.3665207"
Evaluating: 11.3665207+3.5
 Parameter: ZMAX <- "14.8665207"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "18.3505678"
Evaluating: 18.3505678-3.5
 Parameter: XMIN <- "14.8505678"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.4961303"
Evaluating: -25.4961303-3.5
 Parameter: YMIN <- "-28.9961303"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "11.3665207"
Evaluating: 11.3665207-3.5
 Parameter: ZMIN <- "7.8665207"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "21.8505678"
 Parameter: XMIN -> "14.8505678"
 Parameter: YMAX -> "-21.9961303"
 Parameter: YMIN -> "-28.9961303"
 Parameter: ZMAX -> "14.8665207"
 Parameter: ZMIN -> "7.8665207"
 SELRPN>     21 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "21"
 Comparing "21" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      9 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9141 POS      SOD      39       SOD     -4263 PAA1     VAL      325      O             4.2873
 9141 POS      SOD      39       SOD     -4264 PAA1     SER      326      N             3.9541
 9141 POS      SOD      39       SOD     -4266 PAA1     SER      326      CA            2.7837
 9141 POS      SOD      39       SOD     -4268 PAA1     SER      326      CB            2.0484
 9141 POS      SOD      39       SOD     -4271 PAA1     SER      326      OG            1.4240
 9141 POS      SOD      39       SOD     -4273 PAA1     SER      326      C             3.6948
 9141 POS      SOD      39       SOD     -4290 PAA1     VAL      328      CB            4.4614
 9141 POS      SOD      39       SOD     -4296 PAA1     VAL      328      CG2           3.9965
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         8
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "39"
Evaluating: 39
 Parameter: J <- "39"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "39" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "8.332396426E-02"
Evaluating: (89.1533903-9.0)*(8.332396426E-02-0.5)
 Parameter: XPOS <- "-33.3979969"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.177642734"
Evaluating: (89.1533903-9.0)*(0.177642734-0.5)
 Parameter: YPOS <- "-25.8380278"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.828301727"
Evaluating: (89.1533903-9.0)*(0.828301727-0.5)
 Parameter: ZPOS <- "26.3144965"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   18.350568 XMAX =   18.350568 XAVE =   18.350568
    YMIN =  -25.496130 YMAX =  -25.496130 YAVE =  -25.496130
    ZMIN =   11.366521 ZMAX =   11.366521 ZAVE =   11.366521
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.3979969"
 RDCMND substituted energy or value "?XAVE" to "18.3505678"
Evaluating: -33.3979969-18.3505678
 Parameter: XTRAN <- "-51.7485647"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.8380278"
 RDCMND substituted energy or value "?YAVE" to "-25.4961303"
Evaluating: -25.8380278--25.4961303
 Parameter: YTRAN <- "-0.3418975"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.3144965"
 RDCMND substituted energy or value "?ZAVE" to "11.3665207"
Evaluating: 26.3144965-11.3665207
 Parameter: ZTRAN <- "14.9479758"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-51.7485647"
 Parameter: YTRAN -> "-0.3418975"
 Parameter: ZTRAN -> "14.9479758"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -51.748565   -0.341898   14.947976
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.757221855"
Evaluating: 0.757221855*360.0
 Parameter: XPHI <- "272.599868"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.173962888"
Evaluating: 0.173962888*360.0
 Parameter: YPHI <- "62.6266397"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.126061163"
Evaluating: 0.126061163*360.0
 Parameter: ZPHI <- "45.3820187"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.3979969"
 Parameter: YPOS -> "-25.8380278"
 Parameter: ZPOS -> "26.3144965"
 Parameter: XPHI -> "272.599868"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.045361   -0.998971
    0.000000    0.998971    0.045361

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   87.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.3979969"
 Parameter: YPOS -> "-25.8380278"
 Parameter: ZPOS -> "26.3144965"
 Parameter: YPHI -> "62.6266397"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.459787    0.000000   -0.888029
    0.000000    1.000000    0.000000
    0.888029    0.000000    0.459787

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   62.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.3979969"
 Parameter: YPOS -> "-25.8380278"
 Parameter: ZPOS -> "26.3144965"
 Parameter: ZPHI -> "45.3820187"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.702376    0.711806    0.000000
   -0.711806    0.702376    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   45.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.397997 XMAX =  -33.397997 XAVE =  -33.397997
    YMIN =  -25.838028 YMAX =  -25.838028 YAVE =  -25.838028
    ZMIN =   26.314497 ZMAX =   26.314497 ZAVE =   26.314497
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.3979969"
Evaluating: -33.3979969+3.5
 Parameter: XMAX <- "-29.8979969"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.8380278"
Evaluating: -25.8380278+3.5
 Parameter: YMAX <- "-22.3380278"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.3144965"
Evaluating: 26.3144965+3.5
 Parameter: ZMAX <- "29.8144965"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.3979969"
Evaluating: -33.3979969-3.5
 Parameter: XMIN <- "-36.8979969"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.8380278"
Evaluating: -25.8380278-3.5
 Parameter: YMIN <- "-29.3380278"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.3144965"
Evaluating: 26.3144965-3.5
 Parameter: ZMIN <- "22.8144965"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.8979969"
 Parameter: XMIN -> "-36.8979969"
 Parameter: YMAX -> "-22.3380278"
 Parameter: YMIN -> "-29.3380278"
 Parameter: ZMAX -> "29.8144965"
 Parameter: ZMIN -> "22.8144965"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "40"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "40" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "40"
Evaluating: 40
 Parameter: J <- "40"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "40" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.665440532"
Evaluating: (89.1533903-9.0)*(0.665440532-0.5)
 Parameter: XPOS <- "13.2606195"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.84702797"
Evaluating: (89.1533903-9.0)*(0.84702797-0.5)
 Parameter: YPOS <- "27.8154683"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.961887876"
Evaluating: (89.1533903-9.0)*(0.961887876-0.5)
 Parameter: ZPOS <- "37.0218792"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.2606195"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 13.2606195-44.5766951
 Parameter: XTRAN <- "-31.3160756"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.8154683"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 27.8154683-44.5766951
 Parameter: YTRAN <- "-16.7612268"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.0218792"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 37.0218792-44.5766951
 Parameter: ZTRAN <- "-7.5548159"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.3160756"
 Parameter: YTRAN -> "-16.7612268"
 Parameter: ZTRAN -> "-7.5548159"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -31.316076  -16.761227   -7.554816
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.409101957"
Evaluating: 0.409101957*360.0
 Parameter: XPHI <- "147.276705"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.204677289"
Evaluating: 0.204677289*360.0
 Parameter: YPHI <- "73.683824"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.530609535"
Evaluating: 0.530609535*360.0
 Parameter: ZPHI <- "191.019433"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.2606195"
 Parameter: YPOS -> "27.8154683"
 Parameter: ZPOS -> "37.0218792"
 Parameter: XPHI -> "147.276705"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.841291    0.540582
    0.000000   -0.540582   -0.841291

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  147.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.2606195"
 Parameter: YPOS -> "27.8154683"
 Parameter: ZPOS -> "37.0218792"
 Parameter: YPHI -> "73.683824"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.280938    0.000000   -0.959726
    0.000000    1.000000    0.000000
    0.959726    0.000000    0.280938

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   73.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.2606195"
 Parameter: YPOS -> "27.8154683"
 Parameter: ZPOS -> "37.0218792"
 Parameter: ZPHI -> "191.019433"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.981562   -0.191142    0.000000
    0.191142   -0.981562    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  168.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.260620 XMAX =   13.260620 XAVE =   13.260620
    YMIN =   27.815468 YMAX =   27.815468 YAVE =   27.815468
    ZMIN =   37.021879 ZMAX =   37.021879 ZAVE =   37.021879
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.2606195"
Evaluating: 13.2606195+3.5
 Parameter: XMAX <- "16.7606195"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.8154683"
Evaluating: 27.8154683+3.5
 Parameter: YMAX <- "31.3154683"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.0218792"
Evaluating: 37.0218792+3.5
 Parameter: ZMAX <- "40.5218792"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.2606195"
Evaluating: 13.2606195-3.5
 Parameter: XMIN <- "9.7606195"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.8154683"
Evaluating: 27.8154683-3.5
 Parameter: YMIN <- "24.3154683"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.0218792"
Evaluating: 37.0218792-3.5
 Parameter: ZMIN <- "33.5218792"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.7606195"
 Parameter: XMIN -> "9.7606195"
 Parameter: YMAX -> "31.3154683"
 Parameter: YMIN -> "24.3154683"
 Parameter: ZMAX -> "40.5218792"
 Parameter: ZMIN -> "33.5218792"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "41"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "41" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "41"
Evaluating: 41
 Parameter: J <- "41"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "41" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.332750553"
Evaluating: (89.1533903-9.0)*(0.332750553-0.5)
 Parameter: XPOS <- "-13.4056102"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.783600881"
Evaluating: (89.1533903-9.0)*(0.783600881-0.5)
 Parameter: YPOS <- "22.7315721"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.321561022"
Evaluating: (89.1533903-9.0)*(0.321561022-0.5)
 Parameter: ZPOS <- "-14.302489"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.4056102"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -13.4056102-44.5766951
 Parameter: XTRAN <- "-57.9823053"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.7315721"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 22.7315721-44.5766951
 Parameter: YTRAN <- "-21.845123"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-14.302489"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -14.302489-44.5766951
 Parameter: ZTRAN <- "-58.8791841"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-57.9823053"
 Parameter: YTRAN -> "-21.845123"
 Parameter: ZTRAN -> "-58.8791841"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -57.982305  -21.845123  -58.879184
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.494622404"
Evaluating: 0.494622404*360.0
 Parameter: XPHI <- "178.064065"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.925942479"
Evaluating: 0.925942479*360.0
 Parameter: YPHI <- "333.339292"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.846304136"
Evaluating: 0.846304136*360.0
 Parameter: ZPHI <- "304.669489"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.4056102"
 Parameter: YPOS -> "22.7315721"
 Parameter: ZPOS -> "-14.302489"
 Parameter: XPHI -> "178.064065"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999429    0.033782
    0.000000   -0.033782   -0.999429

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  178.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.4056102"
 Parameter: YPOS -> "22.7315721"
 Parameter: ZPOS -> "-14.302489"
 Parameter: YPHI -> "333.339292"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.893679    0.000000    0.448706
    0.000000    1.000000    0.000000
   -0.448706    0.000000    0.893679

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   26.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.4056102"
 Parameter: YPOS -> "22.7315721"
 Parameter: ZPOS -> "-14.302489"
 Parameter: ZPHI -> "304.669489"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.568842   -0.822447    0.000000
    0.822447    0.568842    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   55.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.405610 XMAX =  -13.405610 XAVE =  -13.405610
    YMIN =   22.731572 YMAX =   22.731572 YAVE =   22.731572
    ZMIN =  -14.302489 ZMAX =  -14.302489 ZAVE =  -14.302489
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.4056102"
Evaluating: -13.4056102+3.5
 Parameter: XMAX <- "-9.9056102"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.7315721"
Evaluating: 22.7315721+3.5
 Parameter: YMAX <- "26.2315721"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-14.302489"
Evaluating: -14.302489+3.5
 Parameter: ZMAX <- "-10.802489"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.4056102"
Evaluating: -13.4056102-3.5
 Parameter: XMIN <- "-16.9056102"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.7315721"
Evaluating: 22.7315721-3.5
 Parameter: YMIN <- "19.2315721"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-14.302489"
Evaluating: -14.302489-3.5
 Parameter: ZMIN <- "-17.802489"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.9056102"
 Parameter: XMIN -> "-16.9056102"
 Parameter: YMAX -> "26.2315721"
 Parameter: YMIN -> "19.2315721"
 Parameter: ZMAX -> "-10.802489"
 Parameter: ZMIN -> "-17.802489"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "42"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "42" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "42"
Evaluating: 42
 Parameter: J <- "42"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "42" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.713368972"
Evaluating: (89.1533903-9.0)*(0.713368972-0.5)
 Parameter: XPOS <- "17.1022465"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.548483025"
Evaluating: (89.1533903-9.0)*(0.548483025-0.5)
 Parameter: YPOS <- "3.88607883"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "3.12897569E-03"
Evaluating: (89.1533903-9.0)*(3.12897569E-03-0.5)
 Parameter: ZPOS <- "-39.8258971"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.1022465"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 17.1022465-44.5766951
 Parameter: XTRAN <- "-27.4744486"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.88607883"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 3.88607883-44.5766951
 Parameter: YTRAN <- "-40.6906163"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.8258971"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -39.8258971-44.5766951
 Parameter: ZTRAN <- "-84.4025922"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.4744486"
 Parameter: YTRAN -> "-40.6906163"
 Parameter: ZTRAN -> "-84.4025922"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -27.474449  -40.690616  -84.402592
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.064150758E-02"
Evaluating: 5.064150758E-02*360.0
 Parameter: XPHI <- "18.2309427"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.860843044"
Evaluating: 0.860843044*360.0
 Parameter: YPHI <- "309.903496"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.332998234E-02"
Evaluating: 8.332998234E-02*360.0
 Parameter: ZPHI <- "29.9987936"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.1022465"
 Parameter: YPOS -> "3.88607883"
 Parameter: ZPOS -> "-39.8258971"
 Parameter: XPHI -> "18.2309427"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.949803    0.312848
    0.000000   -0.312848    0.949803

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   18.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.1022465"
 Parameter: YPOS -> "3.88607883"
 Parameter: ZPOS -> "-39.8258971"
 Parameter: YPHI -> "309.903496"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.641496    0.000000    0.767126
    0.000000    1.000000    0.000000
   -0.767126    0.000000    0.641496

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   50.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.1022465"
 Parameter: YPOS -> "3.88607883"
 Parameter: ZPOS -> "-39.8258971"
 Parameter: ZPHI -> "29.9987936"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.866036    0.499982    0.000000
   -0.499982    0.866036    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   30.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.102246 XMAX =   17.102246 XAVE =   17.102246
    YMIN =    3.886079 YMAX =    3.886079 YAVE =    3.886079
    ZMIN =  -39.825897 ZMAX =  -39.825897 ZAVE =  -39.825897
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.1022465"
Evaluating: 17.1022465+3.5
 Parameter: XMAX <- "20.6022465"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.8860788"
Evaluating: 3.8860788+3.5
 Parameter: YMAX <- "7.3860788"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.8258971"
Evaluating: -39.8258971+3.5
 Parameter: ZMAX <- "-36.3258971"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.1022465"
Evaluating: 17.1022465-3.5
 Parameter: XMIN <- "13.6022465"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.8860788"
Evaluating: 3.8860788-3.5
 Parameter: YMIN <- "0.3860788"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.8258971"
Evaluating: -39.8258971-3.5
 Parameter: ZMIN <- "-43.3258971"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.6022465"
 Parameter: XMIN -> "13.6022465"
 Parameter: YMAX -> "7.3860788"
 Parameter: YMIN -> "0.3860788"
 Parameter: ZMAX -> "-36.3258971"
 Parameter: ZMIN -> "-43.3258971"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "43"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "43" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "43" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.215222994"
Evaluating: (89.1533903-9.0)*(0.215222994-0.5)
 Parameter: XPOS <- "-22.8258425"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.338507046"
Evaluating: (89.1533903-9.0)*(0.338507046-0.5)
 Parameter: YPOS <- "-12.9442078"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.225431224"
Evaluating: (89.1533903-9.0)*(0.225431224-0.5)
 Parameter: ZPOS <- "-22.0076183"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.8258425"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -22.8258425-44.5766951
 Parameter: XTRAN <- "-67.4025376"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.9442078"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -12.9442078-44.5766951
 Parameter: YTRAN <- "-57.5209029"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.0076183"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -22.0076183-44.5766951
 Parameter: ZTRAN <- "-66.5843134"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-67.4025376"
 Parameter: YTRAN -> "-57.5209029"
 Parameter: ZTRAN -> "-66.5843134"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -67.402538  -57.520903  -66.584313
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.647064077"
Evaluating: 0.647064077*360.0
 Parameter: XPHI <- "232.943068"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.631135649"
Evaluating: 0.631135649*360.0
 Parameter: YPHI <- "227.208834"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.173705919"
Evaluating: 0.173705919*360.0
 Parameter: ZPHI <- "62.5341308"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.8258425"
 Parameter: YPOS -> "-12.9442078"
 Parameter: ZPOS -> "-22.0076183"
 Parameter: XPHI -> "232.943068"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.602608   -0.798037
    0.000000    0.798037   -0.602608

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  127.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.8258425"
 Parameter: YPOS -> "-12.9442078"
 Parameter: ZPOS -> "-22.0076183"
 Parameter: YPHI -> "227.208834"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.679328    0.000000    0.733835
    0.000000    1.000000    0.000000
   -0.733835    0.000000   -0.679328

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  132.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.8258425"
 Parameter: YPOS -> "-12.9442078"
 Parameter: ZPOS -> "-22.0076183"
 Parameter: ZPHI -> "62.5341308"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.461220    0.887286    0.000000
   -0.887286    0.461220    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   62.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.825843 XMAX =  -22.825843 XAVE =  -22.825843
    YMIN =  -12.944208 YMAX =  -12.944208 YAVE =  -12.944208
    ZMIN =  -22.007618 ZMAX =  -22.007618 ZAVE =  -22.007618
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.8258425"
Evaluating: -22.8258425+3.5
 Parameter: XMAX <- "-19.3258425"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.9442078"
Evaluating: -12.9442078+3.5
 Parameter: YMAX <- "-9.4442078"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.0076183"
Evaluating: -22.0076183+3.5
 Parameter: ZMAX <- "-18.5076183"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.8258425"
Evaluating: -22.8258425-3.5
 Parameter: XMIN <- "-26.3258425"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.9442078"
Evaluating: -12.9442078-3.5
 Parameter: YMIN <- "-16.4442078"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.0076183"
Evaluating: -22.0076183-3.5
 Parameter: ZMIN <- "-25.5076183"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.3258425"
 Parameter: XMIN -> "-26.3258425"
 Parameter: YMAX -> "-9.4442078"
 Parameter: YMIN -> "-16.4442078"
 Parameter: ZMAX -> "-18.5076183"
 Parameter: ZMIN -> "-25.5076183"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      1 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9145 POS      SOD      43       SOD     -9106 POS      SOD      4        SOD           3.6959
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "43"
Evaluating: 43
 Parameter: J <- "43"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "43" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "5.407620875E-02"
Evaluating: (89.1533903-9.0)*(5.407620875E-02-0.5)
 Parameter: XPOS <- "-35.7423037"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.685315868"
Evaluating: (89.1533903-9.0)*(0.685315868-0.5)
 Parameter: YPOS <- "14.8536951"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.115236377"
Evaluating: (89.1533903-9.0)*(0.115236377-0.5)
 Parameter: ZPOS <- "-30.8401088"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.825843 XMAX =  -22.825843 XAVE =  -22.825843
    YMIN =  -12.944208 YMAX =  -12.944208 YAVE =  -12.944208
    ZMIN =  -22.007618 ZMAX =  -22.007618 ZAVE =  -22.007618
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.7423037"
 RDCMND substituted energy or value "?XAVE" to "-22.8258425"
Evaluating: -35.7423037--22.8258425
 Parameter: XTRAN <- "-12.9164612"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.8536951"
 RDCMND substituted energy or value "?YAVE" to "-12.9442078"
Evaluating: 14.8536951--12.9442078
 Parameter: YTRAN <- "27.7979029"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.8401088"
 RDCMND substituted energy or value "?ZAVE" to "-22.0076183"
Evaluating: -30.8401088--22.0076183
 Parameter: ZTRAN <- "-8.8324905"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.9164612"
 Parameter: YTRAN -> "27.7979029"
 Parameter: ZTRAN -> "-8.8324905"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -12.916461   27.797903   -8.832491
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.801703957E-02"
Evaluating: 9.801703957E-02*360.0
 Parameter: XPHI <- "35.2861342"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.10114785"
Evaluating: 0.10114785*360.0
 Parameter: YPHI <- "36.413226"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.479405158"
Evaluating: 0.479405158*360.0
 Parameter: ZPHI <- "172.585857"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.7423037"
 Parameter: YPOS -> "14.8536951"
 Parameter: ZPOS -> "-30.8401088"
 Parameter: XPHI -> "35.2861342"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.816277    0.577660
    0.000000   -0.577660    0.816277

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   35.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.7423037"
 Parameter: YPOS -> "14.8536951"
 Parameter: ZPOS -> "-30.8401088"
 Parameter: YPHI -> "36.413226"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.804757    0.000000   -0.593605
    0.000000    1.000000    0.000000
    0.593605    0.000000    0.804757

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   36.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.7423037"
 Parameter: YPOS -> "14.8536951"
 Parameter: ZPOS -> "-30.8401088"
 Parameter: ZPHI -> "172.585857"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.991639    0.129040    0.000000
   -0.129040   -0.991639    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  172.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.742304 XMAX =  -35.742304 XAVE =  -35.742304
    YMIN =   14.853695 YMAX =   14.853695 YAVE =   14.853695
    ZMIN =  -30.840109 ZMAX =  -30.840109 ZAVE =  -30.840109
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.7423037"
Evaluating: -35.7423037+3.5
 Parameter: XMAX <- "-32.2423037"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.8536951"
Evaluating: 14.8536951+3.5
 Parameter: YMAX <- "18.3536951"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.8401088"
Evaluating: -30.8401088+3.5
 Parameter: ZMAX <- "-27.3401088"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.7423037"
Evaluating: -35.7423037-3.5
 Parameter: XMIN <- "-39.2423037"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.8536951"
Evaluating: 14.8536951-3.5
 Parameter: YMIN <- "11.3536951"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.8401088"
Evaluating: -30.8401088-3.5
 Parameter: ZMIN <- "-34.3401088"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.2423037"
 Parameter: XMIN -> "-39.2423037"
 Parameter: YMAX -> "18.3536951"
 Parameter: YMIN -> "11.3536951"
 Parameter: ZMAX -> "-27.3401088"
 Parameter: ZMIN -> "-34.3401088"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "44"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "44" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "44"
Evaluating: 44
 Parameter: J <- "44"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "44" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.558576848"
Evaluating: (89.1533903-9.0)*(0.558576848-0.5)
 Parameter: XPOS <- "4.69513296"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "8.475153405E-02"
Evaluating: (89.1533903-9.0)*(8.475153405E-02-0.5)
 Parameter: YPOS <- "-33.2835724"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.232704941"
Evaluating: (89.1533903-9.0)*(0.232704941-0.5)
 Parameter: ZPOS <- "-21.4246052"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.69513296"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 4.69513296-44.5766951
 Parameter: XTRAN <- "-39.8815621"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.2835724"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -33.2835724-44.5766951
 Parameter: YTRAN <- "-77.8602675"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.4246052"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -21.4246052-44.5766951
 Parameter: ZTRAN <- "-66.0013003"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.8815621"
 Parameter: YTRAN -> "-77.8602675"
 Parameter: ZTRAN -> "-66.0013003"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -39.881562  -77.860268  -66.001300
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.312443284"
Evaluating: 0.312443284*360.0
 Parameter: XPHI <- "112.479582"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.208888294"
Evaluating: 0.208888294*360.0
 Parameter: YPHI <- "75.1997858"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.250263344"
Evaluating: 0.250263344*360.0
 Parameter: ZPHI <- "90.0948038"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.69513296"
 Parameter: YPOS -> "-33.2835724"
 Parameter: ZPOS -> "-21.4246052"
 Parameter: XPHI -> "112.479582"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.382354    0.924016
    0.000000   -0.924016   -0.382354

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  112.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.69513296"
 Parameter: YPOS -> "-33.2835724"
 Parameter: ZPOS -> "-21.4246052"
 Parameter: YPHI -> "75.1997858"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.255449    0.000000   -0.966822
    0.000000    1.000000    0.000000
    0.966822    0.000000    0.255449

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   75.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.69513296"
 Parameter: YPOS -> "-33.2835724"
 Parameter: ZPOS -> "-21.4246052"
 Parameter: ZPHI -> "90.0948038"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.001655    0.999999    0.000000
   -0.999999   -0.001655    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   90.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.695133 XMAX =    4.695133 XAVE =    4.695133
    YMIN =  -33.283572 YMAX =  -33.283572 YAVE =  -33.283572
    ZMIN =  -21.424605 ZMAX =  -21.424605 ZAVE =  -21.424605
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.69513296"
Evaluating: 4.69513296+3.5
 Parameter: XMAX <- "8.19513296"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.2835724"
Evaluating: -33.2835724+3.5
 Parameter: YMAX <- "-29.7835724"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.4246052"
Evaluating: -21.4246052+3.5
 Parameter: ZMAX <- "-17.9246052"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.69513296"
Evaluating: 4.69513296-3.5
 Parameter: XMIN <- "1.19513296"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.2835724"
Evaluating: -33.2835724-3.5
 Parameter: YMIN <- "-36.7835724"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.4246052"
Evaluating: -21.4246052-3.5
 Parameter: ZMIN <- "-24.9246052"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.19513296"
 Parameter: XMIN -> "1.19513296"
 Parameter: YMAX -> "-29.7835724"
 Parameter: YMIN -> "-36.7835724"
 Parameter: ZMAX -> "-17.9246052"
 Parameter: ZMIN -> "-24.9246052"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "45"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "45" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "45" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.181893078"
Evaluating: (89.1533903-9.0)*(0.181893078-0.5)
 Parameter: XPOS <- "-25.4973483"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.727011014"
Evaluating: (89.1533903-9.0)*(0.727011014-0.5)
 Parameter: YPOS <- "18.1957024"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.769352458"
Evaluating: (89.1533903-9.0)*(0.769352458-0.5)
 Parameter: ZPOS <- "21.5895127"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-25.4973483"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -25.4973483-44.5766951
 Parameter: XTRAN <- "-70.0740434"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "18.1957024"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 18.1957024-44.5766951
 Parameter: YTRAN <- "-26.3809927"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.5895127"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 21.5895127-44.5766951
 Parameter: ZTRAN <- "-22.9871824"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-70.0740434"
 Parameter: YTRAN -> "-26.3809927"
 Parameter: ZTRAN -> "-22.9871824"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -70.074043  -26.380993  -22.987182
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.621893165"
Evaluating: 0.621893165*360.0
 Parameter: XPHI <- "223.881539"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.731999879"
Evaluating: 0.731999879*360.0
 Parameter: YPHI <- "263.519956"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.161857797"
Evaluating: 0.161857797*360.0
 Parameter: ZPHI <- "58.2688069"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-25.4973483"
 Parameter: YPOS -> "18.1957024"
 Parameter: ZPOS -> "21.5895127"
 Parameter: XPHI -> "223.881539"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.720774   -0.693170
    0.000000    0.693170   -0.720774

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  136.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-25.4973483"
 Parameter: YPOS -> "18.1957024"
 Parameter: ZPOS -> "21.5895127"
 Parameter: YPHI -> "263.519956"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.112857    0.000000    0.993611
    0.000000    1.000000    0.000000
   -0.993611    0.000000   -0.112857

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   96.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-25.4973483"
 Parameter: YPOS -> "18.1957024"
 Parameter: ZPOS -> "21.5895127"
 Parameter: ZPHI -> "58.2688069"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.525935    0.850525    0.000000
   -0.850525    0.525935    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   58.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.497348 XMAX =  -25.497348 XAVE =  -25.497348
    YMIN =   18.195702 YMAX =   18.195702 YAVE =   18.195702
    ZMIN =   21.589513 ZMAX =   21.589513 ZAVE =   21.589513
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-25.4973483"
Evaluating: -25.4973483+3.5
 Parameter: XMAX <- "-21.9973483"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "18.1957024"
Evaluating: 18.1957024+3.5
 Parameter: YMAX <- "21.6957024"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.5895127"
Evaluating: 21.5895127+3.5
 Parameter: ZMAX <- "25.0895127"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-25.4973483"
Evaluating: -25.4973483-3.5
 Parameter: XMIN <- "-28.9973483"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "18.1957024"
Evaluating: 18.1957024-3.5
 Parameter: YMIN <- "14.6957024"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.5895127"
Evaluating: 21.5895127-3.5
 Parameter: ZMIN <- "18.0895127"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.9973483"
 Parameter: XMIN -> "-28.9973483"
 Parameter: YMAX -> "21.6957024"
 Parameter: YMIN -> "14.6957024"
 Parameter: ZMAX -> "25.0895127"
 Parameter: ZMIN -> "18.0895127"
 SELRPN>     31 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "31"
 Comparing "31" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     18 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9147 POS      SOD      45       SOD     -6823 PAA2     ALA      163      C             4.0770
 9147 POS      SOD      45       SOD     -6824 PAA2     ALA      163      O             2.9568
 9147 POS      SOD      45       SOD     -6833 PAA2     ALA      164      C             4.4677
 9147 POS      SOD      45       SOD     -6834 PAA2     ALA      164      O             4.1948
 9147 POS      SOD      45       SOD     -6843 PAA2     ALA      165      C             3.7598
 9147 POS      SOD      45       SOD     -6844 PAA2     ALA      165      O             4.0046
 9147 POS      SOD      45       SOD     -6845 PAA2     ALA      166      N             2.9474
 9147 POS      SOD      45       SOD     -6847 PAA2     ALA      166      CA            2.2285
 9147 POS      SOD      45       SOD     -6849 PAA2     ALA      166      CB            2.5960
 9147 POS      SOD      45       SOD     -6853 PAA2     ALA      166      C             1.2761
 9147 POS      SOD      45       SOD     -6854 PAA2     ALA      166      O             2.2045
 9147 POS      SOD      45       SOD     -6855 PAA2     ALA      167      N             0.9121
 9147 POS      SOD      45       SOD     -6857 PAA2     ALA      167      CA            2.0381
 9147 POS      SOD      45       SOD     -6859 PAA2     ALA      167      CB            2.9106
 9147 POS      SOD      45       SOD     -6863 PAA2     ALA      167      C             3.2493
 9147 POS      SOD      45       SOD     -6864 PAA2     ALA      167      O             4.1348
 9147 POS      SOD      45       SOD     -6865 PAA2     ALA      168      N             3.7562
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        17
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "17"
 Comparing "17" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "45" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.357980752"
Evaluating: (89.1533903-9.0)*(0.357980752-0.5)
 Parameter: XPOS <- "-11.3833242"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.682575576"
Evaluating: (89.1533903-9.0)*(0.682575576-0.5)
 Parameter: YPOS <- "14.6340514"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.61724347"
Evaluating: (89.1533903-9.0)*(0.61724347-0.5)
 Parameter: ZPOS <- "9.39746161"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -25.497348 XMAX =  -25.497348 XAVE =  -25.497348
    YMIN =   18.195702 YMAX =   18.195702 YAVE =   18.195702
    ZMIN =   21.589513 ZMAX =   21.589513 ZAVE =   21.589513
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.3833242"
 RDCMND substituted energy or value "?XAVE" to "-25.4973483"
Evaluating: -11.3833242--25.4973483
 Parameter: XTRAN <- "14.1140241"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.6340514"
 RDCMND substituted energy or value "?YAVE" to "18.1957024"
Evaluating: 14.6340514-18.1957024
 Parameter: YTRAN <- "-3.561651"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "9.39746161"
 RDCMND substituted energy or value "?ZAVE" to "21.5895127"
Evaluating: 9.39746161-21.5895127
 Parameter: ZTRAN <- "-12.1920511"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.1140241"
 Parameter: YTRAN -> "-3.561651"
 Parameter: ZTRAN -> "-12.1920511"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    14.114024   -3.561651  -12.192051
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.937513699"
Evaluating: 0.937513699*360.0
 Parameter: XPHI <- "337.504932"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.179467158"
Evaluating: 0.179467158*360.0
 Parameter: YPHI <- "64.6081769"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.193812545"
Evaluating: 0.193812545*360.0
 Parameter: ZPHI <- "69.7725162"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.3833242"
 Parameter: YPOS -> "14.6340514"
 Parameter: ZPOS -> "9.39746161"
 Parameter: XPHI -> "337.504932"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.923912   -0.382604
    0.000000    0.382604    0.923912

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   22.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.3833242"
 Parameter: YPOS -> "14.6340514"
 Parameter: ZPOS -> "9.39746161"
 Parameter: YPHI -> "64.6081769"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.428806    0.000000   -0.903396
    0.000000    1.000000    0.000000
    0.903396    0.000000    0.428806

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   64.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.3833242"
 Parameter: YPOS -> "14.6340514"
 Parameter: ZPOS -> "9.39746161"
 Parameter: ZPHI -> "69.7725162"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.345748    0.938327    0.000000
   -0.938327    0.345748    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   69.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.383324 XMAX =  -11.383324 XAVE =  -11.383324
    YMIN =   14.634051 YMAX =   14.634051 YAVE =   14.634051
    ZMIN =    9.397462 ZMAX =    9.397462 ZAVE =    9.397462
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.3833242"
Evaluating: -11.3833242+3.5
 Parameter: XMAX <- "-7.8833242"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.6340514"
Evaluating: 14.6340514+3.5
 Parameter: YMAX <- "18.1340514"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "9.39746161"
Evaluating: 9.39746161+3.5
 Parameter: ZMAX <- "12.8974616"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.3833242"
Evaluating: -11.3833242-3.5
 Parameter: XMIN <- "-14.8833242"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.6340514"
Evaluating: 14.6340514-3.5
 Parameter: YMIN <- "11.1340514"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "9.39746161"
Evaluating: 9.39746161-3.5
 Parameter: ZMIN <- "5.89746161"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.8833242"
 Parameter: XMIN -> "-14.8833242"
 Parameter: YMAX -> "18.1340514"
 Parameter: YMIN -> "11.1340514"
 Parameter: ZMAX -> "12.8974616"
 Parameter: ZMIN -> "5.89746161"
 SELRPN>      3 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      3 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9147 POS      SOD      45       SOD     - 659 PAA1     ASP      45       CG            4.0582
 9147 POS      SOD      45       SOD     - 660 PAA1     ASP      45       OD1           2.8299
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "45"
Evaluating: 45
 Parameter: J <- "45"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "45" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.999724977"
Evaluating: (89.1533903-9.0)*(0.999724977-0.5)
 Parameter: XPOS <- "40.0546511"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.691112359"
Evaluating: (89.1533903-9.0)*(0.691112359-0.5)
 Parameter: YPOS <- "15.3183035"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "8.003143943E-02"
Evaluating: (89.1533903-9.0)*(8.003143943E-02-0.5)
 Parameter: ZPOS <- "-33.6619039"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.383324 XMAX =  -11.383324 XAVE =  -11.383324
    YMIN =   14.634051 YMAX =   14.634051 YAVE =   14.634051
    ZMIN =    9.397462 ZMAX =    9.397462 ZAVE =    9.397462
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "40.0546511"
 RDCMND substituted energy or value "?XAVE" to "-11.3833242"
Evaluating: 40.0546511--11.3833242
 Parameter: XTRAN <- "51.4379753"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.3183035"
 RDCMND substituted energy or value "?YAVE" to "14.6340514"
Evaluating: 15.3183035-14.6340514
 Parameter: YTRAN <- "0.6842521"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.6619039"
 RDCMND substituted energy or value "?ZAVE" to "9.39746161"
Evaluating: -33.6619039-9.39746161
 Parameter: ZTRAN <- "-43.0593655"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "51.4379753"
 Parameter: YTRAN -> "0.6842521"
 Parameter: ZTRAN -> "-43.0593655"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    51.437975    0.684252  -43.059365
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.1847589"
Evaluating: 0.1847589*360.0
 Parameter: XPHI <- "66.513204"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.563885698"
Evaluating: 0.563885698*360.0
 Parameter: YPHI <- "202.998851"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.445751365"
Evaluating: 0.445751365*360.0
 Parameter: ZPHI <- "160.470491"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "40.0546511"
 Parameter: YPOS -> "15.3183035"
 Parameter: ZPOS -> "-33.6619039"
 Parameter: XPHI -> "66.513204"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.398538    0.917152
    0.000000   -0.917152    0.398538

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   66.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "40.0546511"
 Parameter: YPOS -> "15.3183035"
 Parameter: ZPOS -> "-33.6619039"
 Parameter: YPHI -> "202.998851"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.920513    0.000000    0.390713
    0.000000    1.000000    0.000000
   -0.390713    0.000000   -0.920513

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  157.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "40.0546511"
 Parameter: YPOS -> "15.3183035"
 Parameter: ZPOS -> "-33.6619039"
 Parameter: ZPHI -> "160.470491"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.942469    0.334292    0.000000
   -0.334292   -0.942469    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  160.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   40.054651 XMAX =   40.054651 XAVE =   40.054651
    YMIN =   15.318303 YMAX =   15.318303 YAVE =   15.318303
    ZMIN =  -33.661904 ZMAX =  -33.661904 ZAVE =  -33.661904
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "40.0546511"
Evaluating: 40.0546511+3.5
 Parameter: XMAX <- "43.5546511"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.3183035"
Evaluating: 15.3183035+3.5
 Parameter: YMAX <- "18.8183035"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.6619039"
Evaluating: -33.6619039+3.5
 Parameter: ZMAX <- "-30.1619039"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "40.0546511"
Evaluating: 40.0546511-3.5
 Parameter: XMIN <- "36.5546511"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.3183035"
Evaluating: 15.3183035-3.5
 Parameter: YMIN <- "11.8183035"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.6619039"
Evaluating: -33.6619039-3.5
 Parameter: ZMIN <- "-37.1619039"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "43.5546511"
 Parameter: XMIN -> "36.5546511"
 Parameter: YMAX -> "18.8183035"
 Parameter: YMIN -> "11.8183035"
 Parameter: ZMAX -> "-30.1619039"
 Parameter: ZMIN -> "-37.1619039"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "46"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "46" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "46" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.224608871"
Evaluating: (89.1533903-9.0)*(0.224608871-0.5)
 Parameter: XPOS <- "-22.0735326"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.47261091"
Evaluating: (89.1533903-9.0)*(0.47261091-0.5)
 Parameter: YPOS <- "-2.19532842"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.416666722"
Evaluating: (89.1533903-9.0)*(0.416666722-0.5)
 Parameter: ZPOS <- "-6.67944476"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.0735326"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -22.0735326-44.5766951
 Parameter: XTRAN <- "-66.6502277"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.19532842"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -2.19532842-44.5766951
 Parameter: YTRAN <- "-46.7720235"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-6.67944476"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -6.67944476-44.5766951
 Parameter: ZTRAN <- "-51.2561399"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-66.6502277"
 Parameter: YTRAN -> "-46.7720235"
 Parameter: ZTRAN -> "-51.2561399"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -66.650228  -46.772024  -51.256140
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.548384729E-03"
Evaluating: 2.548384729E-03*360.0
 Parameter: XPHI <- "0.917418502"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.545048637"
Evaluating: 0.545048637*360.0
 Parameter: YPHI <- "196.217509"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.828723688E-02"
Evaluating: 5.828723688E-02*360.0
 Parameter: ZPHI <- "20.9834053"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.0735326"
 Parameter: YPOS -> "-2.19532842"
 Parameter: ZPOS -> "-6.67944476"
 Parameter: XPHI -> "0.917418502"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999872    0.016011
    0.000000   -0.016011    0.999872

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    0.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.0735326"
 Parameter: YPOS -> "-2.19532842"
 Parameter: ZPOS -> "-6.67944476"
 Parameter: YPHI -> "196.217509"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.960208    0.000000    0.279285
    0.000000    1.000000    0.000000
   -0.279285    0.000000   -0.960208

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  163.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.0735326"
 Parameter: YPOS -> "-2.19532842"
 Parameter: ZPOS -> "-6.67944476"
 Parameter: ZPHI -> "20.9834053"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.933684    0.358098    0.000000
   -0.358098    0.933684    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   20.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.073533 XMAX =  -22.073533 XAVE =  -22.073533
    YMIN =   -2.195328 YMAX =   -2.195328 YAVE =   -2.195328
    ZMIN =   -6.679445 ZMAX =   -6.679445 ZAVE =   -6.679445
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.0735326"
Evaluating: -22.0735326+3.5
 Parameter: XMAX <- "-18.5735326"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.1953284"
Evaluating: -2.1953284+3.5
 Parameter: YMAX <- "1.3046716"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-6.67944472"
Evaluating: -6.67944472+3.5
 Parameter: ZMAX <- "-3.17944472"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.0735326"
Evaluating: -22.0735326-3.5
 Parameter: XMIN <- "-25.5735326"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.1953284"
Evaluating: -2.1953284-3.5
 Parameter: YMIN <- "-5.6953284"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-6.67944472"
Evaluating: -6.67944472-3.5
 Parameter: ZMIN <- "-10.1794447"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.5735326"
 Parameter: XMIN -> "-25.5735326"
 Parameter: YMAX -> "1.3046716"
 Parameter: YMIN -> "-5.6953284"
 Parameter: ZMAX -> "-3.17944472"
 Parameter: ZMIN -> "-10.1794447"
 SELRPN>     27 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "27"
 Comparing "27" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     11 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9148 POS      SOD      46       SOD     - 268 PAA1     PRO      18       N             3.6585
 9148 POS      SOD      46       SOD     - 269 PAA1     PRO      18       CD            2.4230
 9148 POS      SOD      46       SOD     - 274 PAA1     PRO      18       CB            3.2793
 9148 POS      SOD      46       SOD     - 277 PAA1     PRO      18       CG            1.8111
 9148 POS      SOD      46       SOD     - 830 PAA1     ILE      57       CG2           4.2245
 9148 POS      SOD      46       SOD     - 841 PAA1     ILE      57       C             3.9510
 9148 POS      SOD      46       SOD     - 842 PAA1     ILE      57       O             3.1922
 9148 POS      SOD      46       SOD     - 890 PAA1     ALA      61       N             3.6181
 9148 POS      SOD      46       SOD     - 892 PAA1     ALA      61       CA            3.0712
 9148 POS      SOD      46       SOD     - 894 PAA1     ALA      61       CB            1.5877
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        10
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "46"
Evaluating: 46
 Parameter: J <- "46"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "46" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.464212977"
Evaluating: (89.1533903-9.0)*(0.464212977-0.5)
 Parameter: XPOS <- "-2.86845122"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.397914163"
Evaluating: (89.1533903-9.0)*(0.397914163-0.5)
 Parameter: YPOS <- "-8.18252594"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "3.93212001E-03"
Evaluating: (89.1533903-9.0)*(3.93212001E-03-0.5)
 Parameter: ZPOS <- "-39.7615224"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.073533 XMAX =  -22.073533 XAVE =  -22.073533
    YMIN =   -2.195328 YMAX =   -2.195328 YAVE =   -2.195328
    ZMIN =   -6.679445 ZMAX =   -6.679445 ZAVE =   -6.679445
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.86845122"
 RDCMND substituted energy or value "?XAVE" to "-22.0735326"
Evaluating: -2.86845122--22.0735326
 Parameter: XTRAN <- "19.2050814"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.18252594"
 RDCMND substituted energy or value "?YAVE" to "-2.1953284"
Evaluating: -8.18252594--2.1953284
 Parameter: YTRAN <- "-5.98719754"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.7615224"
 RDCMND substituted energy or value "?ZAVE" to "-6.67944472"
Evaluating: -39.7615224--6.67944472
 Parameter: ZTRAN <- "-33.0820777"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "19.2050814"
 Parameter: YTRAN -> "-5.98719754"
 Parameter: ZTRAN -> "-33.0820777"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    19.205081   -5.987198  -33.082078
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.366753134"
Evaluating: 0.366753134*360.0
 Parameter: XPHI <- "132.031128"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.866105825"
Evaluating: 0.866105825*360.0
 Parameter: YPHI <- "311.798097"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.983868829"
Evaluating: 0.983868829*360.0
 Parameter: ZPHI <- "354.192778"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.86845122"
 Parameter: YPOS -> "-8.18252594"
 Parameter: ZPOS -> "-39.7615224"
 Parameter: XPHI -> "132.031128"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.669534    0.742781
    0.000000   -0.742781   -0.669534

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  132.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.86845122"
 Parameter: YPOS -> "-8.18252594"
 Parameter: ZPOS -> "-39.7615224"
 Parameter: YPHI -> "311.798097"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.666508    0.000000    0.745498
    0.000000    1.000000    0.000000
   -0.745498    0.000000    0.666508

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   48.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.86845122"
 Parameter: YPOS -> "-8.18252594"
 Parameter: ZPOS -> "-39.7615224"
 Parameter: ZPHI -> "354.192778"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.994868   -0.101182    0.000000
    0.101182    0.994868    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    5.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.868451 XMAX =   -2.868451 XAVE =   -2.868451
    YMIN =   -8.182526 YMAX =   -8.182526 YAVE =   -8.182526
    ZMIN =  -39.761522 ZMAX =  -39.761522 ZAVE =  -39.761522
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.8684512"
Evaluating: -2.8684512+3.5
 Parameter: XMAX <- "0.6315488"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.18252596"
Evaluating: -8.18252596+3.5
 Parameter: YMAX <- "-4.68252596"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.7615224"
Evaluating: -39.7615224+3.5
 Parameter: ZMAX <- "-36.2615224"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.8684512"
Evaluating: -2.8684512-3.5
 Parameter: XMIN <- "-6.3684512"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.18252596"
Evaluating: -8.18252596-3.5
 Parameter: YMIN <- "-11.682526"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.7615224"
Evaluating: -39.7615224-3.5
 Parameter: ZMIN <- "-43.2615224"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.6315488"
 Parameter: XMIN -> "-6.3684512"
 Parameter: YMAX -> "-4.68252596"
 Parameter: YMIN -> "-11.682526"
 Parameter: ZMAX -> "-36.2615224"
 Parameter: ZMIN -> "-43.2615224"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "47"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "47" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "47"
Evaluating: 47
 Parameter: J <- "47"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "47" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.973555926"
Evaluating: (89.1533903-9.0)*(0.973555926-0.5)
 Parameter: XPOS <- "37.957113"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.744800587"
Evaluating: (89.1533903-9.0)*(0.744800587-0.5)
 Parameter: YPOS <- "19.621597"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "9.391507011E-02"
Evaluating: (89.1533903-9.0)*(9.391507011E-02-0.5)
 Parameter: ZPOS <- "-32.5490839"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.957113"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 37.957113-44.5766951
 Parameter: XTRAN <- "-6.6195821"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.621597"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 19.621597-44.5766951
 Parameter: YTRAN <- "-24.9550981"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.5490839"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -32.5490839-44.5766951
 Parameter: ZTRAN <- "-77.125779"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.6195821"
 Parameter: YTRAN -> "-24.9550981"
 Parameter: ZTRAN -> "-77.125779"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    -6.619582  -24.955098  -77.125779
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.199214603"
Evaluating: 0.199214603*360.0
 Parameter: XPHI <- "71.7172571"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.893026726"
Evaluating: 0.893026726*360.0
 Parameter: YPHI <- "321.489621"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.920591346"
Evaluating: 0.920591346*360.0
 Parameter: ZPHI <- "331.412885"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.957113"
 Parameter: YPOS -> "19.621597"
 Parameter: ZPOS -> "-32.5490839"
 Parameter: XPHI -> "71.7172571"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.313706    0.949520
    0.000000   -0.949520    0.313706

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   71.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.957113"
 Parameter: YPOS -> "19.621597"
 Parameter: ZPOS -> "-32.5490839"
 Parameter: YPHI -> "321.489621"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.782495    0.000000    0.622656
    0.000000    1.000000    0.000000
   -0.622656    0.000000    0.782495

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   38.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.957113"
 Parameter: YPOS -> "19.621597"
 Parameter: ZPOS -> "-32.5490839"
 Parameter: ZPHI -> "331.412885"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.878091   -0.478494    0.000000
    0.478494    0.878091    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   28.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.957113 XMAX =   37.957113 XAVE =   37.957113
    YMIN =   19.621597 YMAX =   19.621597 YAVE =   19.621597
    ZMIN =  -32.549084 ZMAX =  -32.549084 ZAVE =  -32.549084
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.957113"
Evaluating: 37.957113+3.5
 Parameter: XMAX <- "41.457113"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.621597"
Evaluating: 19.621597+3.5
 Parameter: YMAX <- "23.121597"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.5490839"
Evaluating: -32.5490839+3.5
 Parameter: ZMAX <- "-29.0490839"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.957113"
Evaluating: 37.957113-3.5
 Parameter: XMIN <- "34.457113"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.621597"
Evaluating: 19.621597-3.5
 Parameter: YMIN <- "16.121597"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.5490839"
Evaluating: -32.5490839-3.5
 Parameter: ZMIN <- "-36.0490839"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "41.457113"
 Parameter: XMIN -> "34.457113"
 Parameter: YMAX -> "23.121597"
 Parameter: YMIN -> "16.121597"
 Parameter: ZMAX -> "-29.0490839"
 Parameter: ZMIN -> "-36.0490839"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "48"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "48" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "48"
Evaluating: 48
 Parameter: J <- "48"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "48" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.857119594"
Evaluating: (89.1533903-9.0)*(0.857119594-0.5)
 Parameter: XPOS <- "28.6243462"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.954715238"
Evaluating: (89.1533903-9.0)*(0.954715238-0.5)
 Parameter: YPOS <- "36.4469679"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.542546536"
Evaluating: (89.1533903-9.0)*(0.542546536-0.5)
 Parameter: ZPOS <- "3.41024911"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.6243462"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 28.6243462-44.5766951
 Parameter: XTRAN <- "-15.9523489"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "36.4469679"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 36.4469679-44.5766951
 Parameter: YTRAN <- "-8.1297272"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "3.41024911"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 3.41024911-44.5766951
 Parameter: ZTRAN <- "-41.166446"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-15.9523489"
 Parameter: YTRAN -> "-8.1297272"
 Parameter: ZTRAN -> "-41.166446"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -15.952349   -8.129727  -41.166446
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.905169939"
Evaluating: 0.905169939*360.0
 Parameter: XPHI <- "325.861178"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.906685472"
Evaluating: 0.906685472*360.0
 Parameter: YPHI <- "326.40677"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.249353816"
Evaluating: 0.249353816*360.0
 Parameter: ZPHI <- "89.7673738"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.6243462"
 Parameter: YPOS -> "36.4469679"
 Parameter: ZPOS -> "3.41024911"
 Parameter: XPHI -> "325.861178"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.827680   -0.561200
    0.000000    0.561200    0.827680

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   34.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.6243462"
 Parameter: YPOS -> "36.4469679"
 Parameter: ZPOS -> "3.41024911"
 Parameter: YPHI -> "326.40677"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.832987    0.000000    0.553293
    0.000000    1.000000    0.000000
   -0.553293    0.000000    0.832987

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   33.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.6243462"
 Parameter: YPOS -> "36.4469679"
 Parameter: ZPOS -> "3.41024911"
 Parameter: ZPHI -> "89.7673738"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.004060    0.999992    0.000000
   -0.999992    0.004060    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   89.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.624346 XMAX =   28.624346 XAVE =   28.624346
    YMIN =   36.446968 YMAX =   36.446968 YAVE =   36.446968
    ZMIN =    3.410249 ZMAX =    3.410249 ZAVE =    3.410249
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.6243462"
Evaluating: 28.6243462+3.5
 Parameter: XMAX <- "32.1243462"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "36.4469679"
Evaluating: 36.4469679+3.5
 Parameter: YMAX <- "39.9469679"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "3.4102491"
Evaluating: 3.4102491+3.5
 Parameter: ZMAX <- "6.9102491"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.6243462"
Evaluating: 28.6243462-3.5
 Parameter: XMIN <- "25.1243462"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "36.4469679"
Evaluating: 36.4469679-3.5
 Parameter: YMIN <- "32.9469679"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "3.4102491"
Evaluating: 3.4102491-3.5
 Parameter: ZMIN <- "-8.97509E-02"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.1243462"
 Parameter: XMIN -> "25.1243462"
 Parameter: YMAX -> "39.9469679"
 Parameter: YMIN -> "32.9469679"
 Parameter: ZMAX -> "6.9102491"
 Parameter: ZMIN -> "-8.97509E-02"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "49"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "49" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "49"
Evaluating: 49
 Parameter: J <- "49"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "49" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.298269564"
Evaluating: (89.1533903-9.0)*(0.298269564-0.5)
 Parameter: XPOS <- "-16.1693784"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.452156223"
Evaluating: (89.1533903-9.0)*(0.452156223-0.5)
 Parameter: YPOS <- "-3.83484093"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.151000492"
Evaluating: (89.1533903-9.0)*(0.151000492-0.5)
 Parameter: ZPOS <- "-27.9734938"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.1693784"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -16.1693784-44.5766951
 Parameter: XTRAN <- "-60.7460735"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.83484093"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -3.83484093-44.5766951
 Parameter: YTRAN <- "-48.411536"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.9734938"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -27.9734938-44.5766951
 Parameter: ZTRAN <- "-72.5501889"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-60.7460735"
 Parameter: YTRAN -> "-48.411536"
 Parameter: ZTRAN -> "-72.5501889"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -60.746074  -48.411536  -72.550189
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.855002662"
Evaluating: 0.855002662*360.0
 Parameter: XPHI <- "307.800958"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.661467391"
Evaluating: 0.661467391*360.0
 Parameter: YPHI <- "238.128261"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.735161967E-02"
Evaluating: 4.735161967E-02*360.0
 Parameter: ZPHI <- "17.0465831"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.1693784"
 Parameter: YPOS -> "-3.83484093"
 Parameter: ZPOS -> "-27.9734938"
 Parameter: XPHI -> "307.800958"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.612920   -0.790145
    0.000000    0.790145    0.612920

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   52.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.1693784"
 Parameter: YPOS -> "-3.83484093"
 Parameter: ZPOS -> "-27.9734938"
 Parameter: YPHI -> "238.128261"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.528020    0.000000    0.849232
    0.000000    1.000000    0.000000
   -0.849232    0.000000   -0.528020

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  121.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.1693784"
 Parameter: YPOS -> "-3.83484093"
 Parameter: ZPOS -> "-27.9734938"
 Parameter: ZPHI -> "17.0465831"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.956067    0.293149    0.000000
   -0.293149    0.956067    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   17.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.169378 XMAX =  -16.169378 XAVE =  -16.169378
    YMIN =   -3.834841 YMAX =   -3.834841 YAVE =   -3.834841
    ZMIN =  -27.973494 ZMAX =  -27.973494 ZAVE =  -27.973494
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.1693784"
Evaluating: -16.1693784+3.5
 Parameter: XMAX <- "-12.6693784"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.83484092"
Evaluating: -3.83484092+3.5
 Parameter: YMAX <- "-0.33484092"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.9734938"
Evaluating: -27.9734938+3.5
 Parameter: ZMAX <- "-24.4734938"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.1693784"
Evaluating: -16.1693784-3.5
 Parameter: XMIN <- "-19.6693784"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.83484092"
Evaluating: -3.83484092-3.5
 Parameter: YMIN <- "-7.33484092"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.9734938"
Evaluating: -27.9734938-3.5
 Parameter: ZMIN <- "-31.4734938"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-12.6693784"
 Parameter: XMIN -> "-19.6693784"
 Parameter: YMAX -> "-0.33484092"
 Parameter: YMIN -> "-7.33484092"
 Parameter: ZMAX -> "-24.4734938"
 Parameter: ZMIN -> "-31.4734938"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "50"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "50" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "50" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.759685964"
Evaluating: (89.1533903-9.0)*(0.759685964-0.5)
 Parameter: XPOS <- "20.8147104"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.469578077"
Evaluating: (89.1533903-9.0)*(0.469578077-0.5)
 Parameter: YPOS <- "-2.43842027"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.487062563"
Evaluating: (89.1533903-9.0)*(0.487062563-0.5)
 Parameter: ZPOS <- "-1.03697944"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "20.8147104"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 20.8147104-44.5766951
 Parameter: XTRAN <- "-23.7619847"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.43842027"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -2.43842027-44.5766951
 Parameter: YTRAN <- "-47.0151154"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-1.03697944"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -1.03697944-44.5766951
 Parameter: ZTRAN <- "-45.6136745"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.7619847"
 Parameter: YTRAN -> "-47.0151154"
 Parameter: ZTRAN -> "-45.6136745"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -23.761985  -47.015115  -45.613675
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.767188942E-02"
Evaluating: 3.767188942E-02*360.0
 Parameter: XPHI <- "13.5618802"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.139097059"
Evaluating: 0.139097059*360.0
 Parameter: YPHI <- "50.0749412"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.157936793"
Evaluating: 0.157936793*360.0
 Parameter: ZPHI <- "56.8572455"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "20.8147104"
 Parameter: YPOS -> "-2.43842027"
 Parameter: ZPOS -> "-1.03697944"
 Parameter: XPHI -> "13.5618802"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.972117    0.234495
    0.000000   -0.234495    0.972117

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   13.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "20.8147104"
 Parameter: YPOS -> "-2.43842027"
 Parameter: ZPOS -> "-1.03697944"
 Parameter: YPHI -> "50.0749412"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.641785    0.000000   -0.766885
    0.000000    1.000000    0.000000
    0.766885    0.000000    0.641785

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   50.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "20.8147104"
 Parameter: YPOS -> "-2.43842027"
 Parameter: ZPOS -> "-1.03697944"
 Parameter: ZPHI -> "56.8572455"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.546727    0.837311    0.000000
   -0.837311    0.546727    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   56.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.814710 XMAX =   20.814710 XAVE =   20.814710
    YMIN =   -2.438420 YMAX =   -2.438420 YAVE =   -2.438420
    ZMIN =   -1.036979 ZMAX =   -1.036979 ZAVE =   -1.036979
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "20.8147104"
Evaluating: 20.8147104+3.5
 Parameter: XMAX <- "24.3147104"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.43842025"
Evaluating: -2.43842025+3.5
 Parameter: YMAX <- "1.06157975"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-1.03697941"
Evaluating: -1.03697941+3.5
 Parameter: ZMAX <- "2.46302059"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "20.8147104"
Evaluating: 20.8147104-3.5
 Parameter: XMIN <- "17.3147104"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.43842025"
Evaluating: -2.43842025-3.5
 Parameter: YMIN <- "-5.93842025"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-1.03697941"
Evaluating: -1.03697941-3.5
 Parameter: ZMIN <- "-4.53697941"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "24.3147104"
 Parameter: XMIN -> "17.3147104"
 Parameter: YMAX -> "1.06157975"
 Parameter: YMIN -> "-5.93842025"
 Parameter: ZMAX -> "2.46302059"
 Parameter: ZMIN -> "-4.53697941"
 SELRPN>     25 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "25"
 Comparing "25" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      8 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9152 POS      SOD      50       SOD     -3979 PAA1     LEU      306      CD2           4.0528
 9152 POS      SOD      50       SOD     -4469 PAA1     VAL      341      CA            2.8269
 9152 POS      SOD      50       SOD     -4471 PAA1     VAL      341      CB            1.9837
 9152 POS      SOD      50       SOD     -4473 PAA1     VAL      341      CG1           0.8307
 9152 POS      SOD      50       SOD     -4477 PAA1     VAL      341      CG2           2.5097
 9152 POS      SOD      50       SOD     -4481 PAA1     VAL      341      C             3.3835
 9152 POS      SOD      50       SOD     -4482 PAA1     VAL      341      O             3.4416
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "50"
Evaluating: 50
 Parameter: J <- "50"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "50" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.627555112"
Evaluating: (89.1533903-9.0)*(0.627555112-0.5)
 Parameter: XPOS <- "10.2239747"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.850295287"
Evaluating: (89.1533903-9.0)*(0.850295287-0.5)
 Parameter: YPOS <- "28.0773549"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.497902132"
Evaluating: (89.1533903-9.0)*(0.497902132-0.5)
 Parameter: ZPOS <- "-0.168151233"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   20.814710 XMAX =   20.814710 XAVE =   20.814710
    YMIN =   -2.438420 YMAX =   -2.438420 YAVE =   -2.438420
    ZMIN =   -1.036979 ZMAX =   -1.036979 ZAVE =   -1.036979
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.2239747"
 RDCMND substituted energy or value "?XAVE" to "20.8147104"
Evaluating: 10.2239747-20.8147104
 Parameter: XTRAN <- "-10.5907357"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.0773549"
 RDCMND substituted energy or value "?YAVE" to "-2.43842025"
Evaluating: 28.0773549--2.43842025
 Parameter: YTRAN <- "30.5157751"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-0.168151233"
 RDCMND substituted energy or value "?ZAVE" to "-1.03697941"
Evaluating: -0.168151233--1.03697941
 Parameter: ZTRAN <- "0.868828177"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.5907357"
 Parameter: YTRAN -> "30.5157751"
 Parameter: ZTRAN -> "0.868828177"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -10.590736   30.515775    0.868828
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.561856614"
Evaluating: 0.561856614*360.0
 Parameter: XPHI <- "202.268381"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.506855625E-02"
Evaluating: 6.506855625E-02*360.0
 Parameter: YPHI <- "23.4246803"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.80023116"
Evaluating: 0.80023116*360.0
 Parameter: ZPHI <- "288.083218"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.2239747"
 Parameter: YPOS -> "28.0773549"
 Parameter: ZPOS -> "-0.168151233"
 Parameter: XPHI -> "202.268381"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.925419   -0.378946
    0.000000    0.378946   -0.925419

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  157.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.2239747"
 Parameter: YPOS -> "28.0773549"
 Parameter: ZPOS -> "-0.168151233"
 Parameter: YPHI -> "23.4246803"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.917583    0.000000   -0.397543
    0.000000    1.000000    0.000000
    0.397543    0.000000    0.917583

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   23.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.2239747"
 Parameter: YPOS -> "28.0773549"
 Parameter: ZPOS -> "-0.168151233"
 Parameter: ZPHI -> "288.083218"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.310398   -0.950607    0.000000
    0.950607    0.310398    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   71.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.223975 XMAX =   10.223975 XAVE =   10.223975
    YMIN =   28.077355 YMAX =   28.077355 YAVE =   28.077355
    ZMIN =   -0.168151 ZMAX =   -0.168151 ZAVE =   -0.168151
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.2239746"
Evaluating: 10.2239746+3.5
 Parameter: XMAX <- "13.7239746"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.0773549"
Evaluating: 28.0773549+3.5
 Parameter: YMAX <- "31.5773549"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-0.168151265"
Evaluating: -0.168151265+3.5
 Parameter: ZMAX <- "3.33184873"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.2239746"
Evaluating: 10.2239746-3.5
 Parameter: XMIN <- "6.7239746"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.0773549"
Evaluating: 28.0773549-3.5
 Parameter: YMIN <- "24.5773549"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-0.168151265"
Evaluating: -0.168151265-3.5
 Parameter: ZMIN <- "-3.66815127"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.7239746"
 Parameter: XMIN -> "6.7239746"
 Parameter: YMAX -> "31.5773549"
 Parameter: YMIN -> "24.5773549"
 Parameter: ZMAX -> "3.33184873"
 Parameter: ZMIN -> "-3.66815127"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "51"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "51" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "51"
Evaluating: 51
 Parameter: J <- "51"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "51" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.902954955"
Evaluating: (89.1533903-9.0)*(0.902954955-0.5)
 Parameter: XPOS <- "32.2982058"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.308531697"
Evaluating: (89.1533903-9.0)*(0.308531697-0.5)
 Parameter: YPOS <- "-15.3468336"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.448335292"
Evaluating: (89.1533903-9.0)*(0.448335292-0.5)
 Parameter: ZPOS <- "-4.14110151"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "32.2982058"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 32.2982058-44.5766951
 Parameter: XTRAN <- "-12.2784893"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.3468336"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -15.3468336-44.5766951
 Parameter: YTRAN <- "-59.9235287"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-4.14110151"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -4.14110151-44.5766951
 Parameter: ZTRAN <- "-48.7177966"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.2784893"
 Parameter: YTRAN -> "-59.9235287"
 Parameter: ZTRAN -> "-48.7177966"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -12.278489  -59.923529  -48.717797
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.832992212"
Evaluating: 0.832992212*360.0
 Parameter: XPHI <- "299.877196"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.360341223"
Evaluating: 0.360341223*360.0
 Parameter: YPHI <- "129.72284"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.320755985"
Evaluating: 0.320755985*360.0
 Parameter: ZPHI <- "115.472155"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "32.2982058"
 Parameter: YPOS -> "-15.3468336"
 Parameter: ZPOS -> "-4.14110151"
 Parameter: XPHI -> "299.877196"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.498143   -0.867095
    0.000000    0.867095    0.498143

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   60.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "32.2982058"
 Parameter: YPOS -> "-15.3468336"
 Parameter: ZPOS -> "-4.14110151"
 Parameter: YPHI -> "129.72284"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.639074    0.000000   -0.769145
    0.000000    1.000000    0.000000
    0.769145    0.000000   -0.639074

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  129.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "32.2982058"
 Parameter: YPOS -> "-15.3468336"
 Parameter: ZPOS -> "-4.14110151"
 Parameter: ZPHI -> "115.472155"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.430072    0.902794    0.000000
   -0.902794   -0.430072    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  115.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.298206 XMAX =   32.298206 XAVE =   32.298206
    YMIN =  -15.346834 YMAX =  -15.346834 YAVE =  -15.346834
    ZMIN =   -4.141102 ZMAX =   -4.141102 ZAVE =   -4.141102
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "32.2982058"
Evaluating: 32.2982058+3.5
 Parameter: XMAX <- "35.7982058"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.3468336"
Evaluating: -15.3468336+3.5
 Parameter: YMAX <- "-11.8468336"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-4.14110151"
Evaluating: -4.14110151+3.5
 Parameter: ZMAX <- "-0.64110151"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "32.2982058"
Evaluating: 32.2982058-3.5
 Parameter: XMIN <- "28.7982058"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.3468336"
Evaluating: -15.3468336-3.5
 Parameter: YMIN <- "-18.8468336"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-4.14110151"
Evaluating: -4.14110151-3.5
 Parameter: ZMIN <- "-7.64110151"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.7982058"
 Parameter: XMIN -> "28.7982058"
 Parameter: YMAX -> "-11.8468336"
 Parameter: YMIN -> "-18.8468336"
 Parameter: ZMAX -> "-0.64110151"
 Parameter: ZMIN -> "-7.64110151"
 SELRPN>      4 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      2 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9153 POS      SOD      51       SOD     -3585 PAA1     SER      278      CB            4.4145
 9153 POS      SOD      51       SOD     -3591 PAA1     SER      278      O             3.7993
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "51"
Evaluating: 51
 Parameter: J <- "51"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "51" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.925262737"
Evaluating: (89.1533903-9.0)*(0.925262737-0.5)
 Parameter: XPOS <- "34.0862501"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.344748483"
Evaluating: (89.1533903-9.0)*(0.344748483-0.5)
 Parameter: YPOS <- "-12.4439354"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.643248232"
Evaluating: (89.1533903-9.0)*(0.643248232-0.5)
 Parameter: ZPOS <- "11.4818314"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   32.298206 XMAX =   32.298206 XAVE =   32.298206
    YMIN =  -15.346834 YMAX =  -15.346834 YAVE =  -15.346834
    ZMIN =   -4.141102 ZMAX =   -4.141102 ZAVE =   -4.141102
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.0862501"
 RDCMND substituted energy or value "?XAVE" to "32.2982058"
Evaluating: 34.0862501-32.2982058
 Parameter: XTRAN <- "1.7880443"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.4439354"
 RDCMND substituted energy or value "?YAVE" to "-15.3468336"
Evaluating: -12.4439354--15.3468336
 Parameter: YTRAN <- "2.9028982"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "11.4818314"
 RDCMND substituted energy or value "?ZAVE" to "-4.14110151"
Evaluating: 11.4818314--4.14110151
 Parameter: ZTRAN <- "15.6229329"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.7880443"
 Parameter: YTRAN -> "2.9028982"
 Parameter: ZTRAN -> "15.6229329"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR     1.788044    2.902898   15.622933
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.46192814"
Evaluating: 0.46192814*360.0
 Parameter: XPHI <- "166.29413"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.254486547"
Evaluating: 0.254486547*360.0
 Parameter: YPHI <- "91.6151569"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.689797939"
Evaluating: 0.689797939*360.0
 Parameter: ZPHI <- "248.327258"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.0862501"
 Parameter: YPOS -> "-12.4439354"
 Parameter: ZPOS -> "11.4818314"
 Parameter: XPHI -> "166.29413"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.971525    0.236938
    0.000000   -0.236938   -0.971525

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  166.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.0862501"
 Parameter: YPOS -> "-12.4439354"
 Parameter: ZPOS -> "11.4818314"
 Parameter: YPHI -> "91.6151569"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.028186    0.000000   -0.999603
    0.000000    1.000000    0.000000
    0.999603    0.000000   -0.028186

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   91.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.0862501"
 Parameter: YPOS -> "-12.4439354"
 Parameter: ZPOS -> "11.4818314"
 Parameter: ZPHI -> "248.327258"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.369305   -0.929308    0.000000
    0.929308   -0.369305    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  111.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.086250 XMAX =   34.086250 XAVE =   34.086250
    YMIN =  -12.443935 YMAX =  -12.443935 YAVE =  -12.443935
    ZMIN =   11.481831 ZMAX =   11.481831 ZAVE =   11.481831
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.0862501"
Evaluating: 34.0862501+3.5
 Parameter: XMAX <- "37.5862501"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.4439354"
Evaluating: -12.4439354+3.5
 Parameter: YMAX <- "-8.9439354"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "11.4818314"
Evaluating: 11.4818314+3.5
 Parameter: ZMAX <- "14.9818314"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.0862501"
Evaluating: 34.0862501-3.5
 Parameter: XMIN <- "30.5862501"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.4439354"
Evaluating: -12.4439354-3.5
 Parameter: YMIN <- "-15.9439354"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "11.4818314"
Evaluating: 11.4818314-3.5
 Parameter: ZMIN <- "7.9818314"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "37.5862501"
 Parameter: XMIN -> "30.5862501"
 Parameter: YMAX -> "-8.9439354"
 Parameter: YMIN -> "-15.9439354"
 Parameter: ZMAX -> "14.9818314"
 Parameter: ZMIN -> "7.9818314"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "52"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "52" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "52"
Evaluating: 52
 Parameter: J <- "52"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "52" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.422217797"
Evaluating: (89.1533903-9.0)*(0.422217797-0.5)
 Parameter: XPOS <- "-6.23450728"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.370990978"
Evaluating: (89.1533903-9.0)*(0.370990978-0.5)
 Parameter: YPOS <- "-10.3405105"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.971992429"
Evaluating: (89.1533903-9.0)*(0.971992429-0.5)
 Parameter: ZPOS <- "37.8317934"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-6.23450728"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -6.23450728-44.5766951
 Parameter: XTRAN <- "-50.8112024"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-10.3405105"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -10.3405105-44.5766951
 Parameter: YTRAN <- "-54.9172056"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "37.8317934"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 37.8317934-44.5766951
 Parameter: ZTRAN <- "-6.7449017"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-50.8112024"
 Parameter: YTRAN -> "-54.9172056"
 Parameter: ZTRAN -> "-6.7449017"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -50.811202  -54.917206   -6.744902
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.107485105"
Evaluating: 0.107485105*360.0
 Parameter: XPHI <- "38.6946378"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.575350552"
Evaluating: 0.575350552*360.0
 Parameter: YPHI <- "207.126199"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.519088949"
Evaluating: 0.519088949*360.0
 Parameter: ZPHI <- "186.872022"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-6.23450728"
 Parameter: YPOS -> "-10.3405105"
 Parameter: ZPOS -> "37.8317934"
 Parameter: XPHI -> "38.6946378"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.780489    0.625170
    0.000000   -0.625170    0.780489

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   38.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-6.23450728"
 Parameter: YPOS -> "-10.3405105"
 Parameter: ZPOS -> "37.8317934"
 Parameter: YPHI -> "207.126199"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.890004    0.000000    0.455952
    0.000000    1.000000    0.000000
   -0.455952    0.000000   -0.890004

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  152.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-6.23450728"
 Parameter: YPOS -> "-10.3405105"
 Parameter: ZPOS -> "37.8317934"
 Parameter: ZPHI -> "186.872022"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.992816   -0.119652    0.000000
    0.119652   -0.992816    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  173.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -6.234507 XMAX =   -6.234507 XAVE =   -6.234507
    YMIN =  -10.340510 YMAX =  -10.340510 YAVE =  -10.340510
    ZMIN =   37.831793 ZMAX =   37.831793 ZAVE =   37.831793
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-6.2345073"
Evaluating: -6.2345073+3.5
 Parameter: XMAX <- "-2.7345073"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-10.3405105"
Evaluating: -10.3405105+3.5
 Parameter: YMAX <- "-6.8405105"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "37.8317934"
Evaluating: 37.8317934+3.5
 Parameter: ZMAX <- "41.3317934"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-6.2345073"
Evaluating: -6.2345073-3.5
 Parameter: XMIN <- "-9.7345073"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-10.3405105"
Evaluating: -10.3405105-3.5
 Parameter: YMIN <- "-13.8405105"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "37.8317934"
Evaluating: 37.8317934-3.5
 Parameter: ZMIN <- "34.3317934"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.7345073"
 Parameter: XMIN -> "-9.7345073"
 Parameter: YMAX -> "-6.8405105"
 Parameter: YMIN -> "-13.8405105"
 Parameter: ZMAX -> "41.3317934"
 Parameter: ZMIN -> "34.3317934"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "53"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "53" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "53" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.262256563"
Evaluating: (89.1533903-9.0)*(0.262256563-0.5)
 Parameter: XPOS <- "-19.0559425"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.34211356"
Evaluating: (89.1533903-9.0)*(0.34211356-0.5)
 Parameter: YPOS <- "-12.6551334"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.71055041"
Evaluating: (89.1533903-9.0)*(0.71055041-0.5)
 Parameter: ZPOS <- "16.8763292"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-19.0559425"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -19.0559425-44.5766951
 Parameter: XTRAN <- "-63.6326376"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.6551334"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -12.6551334-44.5766951
 Parameter: YTRAN <- "-57.2318285"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.8763292"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 16.8763292-44.5766951
 Parameter: ZTRAN <- "-27.7003659"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-63.6326376"
 Parameter: YTRAN -> "-57.2318285"
 Parameter: ZTRAN -> "-27.7003659"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -63.632638  -57.231828  -27.700366
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.589669802E-02"
Evaluating: 7.589669802E-02*360.0
 Parameter: XPHI <- "27.3228113"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.339405207"
Evaluating: 0.339405207*360.0
 Parameter: YPHI <- "122.185875"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.141400083"
Evaluating: 0.141400083*360.0
 Parameter: ZPHI <- "50.9040299"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-19.0559425"
 Parameter: YPOS -> "-12.6551334"
 Parameter: ZPOS -> "16.8763292"
 Parameter: XPHI -> "27.3228113"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.888435    0.459003
    0.000000   -0.459003    0.888435

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   27.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-19.0559425"
 Parameter: YPOS -> "-12.6551334"
 Parameter: ZPOS -> "16.8763292"
 Parameter: YPHI -> "122.185875"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.532668    0.000000   -0.846325
    0.000000    1.000000    0.000000
    0.846325    0.000000   -0.532668

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  122.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-19.0559425"
 Parameter: YPOS -> "-12.6551334"
 Parameter: ZPOS -> "16.8763292"
 Parameter: ZPHI -> "50.9040299"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.630621    0.776091    0.000000
   -0.776091    0.630621    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   50.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.055942 XMAX =  -19.055942 XAVE =  -19.055942
    YMIN =  -12.655133 YMAX =  -12.655133 YAVE =  -12.655133
    ZMIN =   16.876329 ZMAX =   16.876329 ZAVE =   16.876329
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-19.0559425"
Evaluating: -19.0559425+3.5
 Parameter: XMAX <- "-15.5559425"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.6551334"
Evaluating: -12.6551334+3.5
 Parameter: YMAX <- "-9.1551334"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.8763292"
Evaluating: 16.8763292+3.5
 Parameter: ZMAX <- "20.3763292"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-19.0559425"
Evaluating: -19.0559425-3.5
 Parameter: XMIN <- "-22.5559425"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.6551334"
Evaluating: -12.6551334-3.5
 Parameter: YMIN <- "-16.1551334"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.8763292"
Evaluating: 16.8763292-3.5
 Parameter: ZMIN <- "13.3763292"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.5559425"
 Parameter: XMIN -> "-22.5559425"
 Parameter: YMAX -> "-9.1551334"
 Parameter: YMIN -> "-16.1551334"
 Parameter: ZMAX -> "20.3763292"
 Parameter: ZMIN -> "13.3763292"
 SELRPN>     15 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "15"
 Comparing "15" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      6 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9155 POS      SOD      53       SOD     -1516 PAA1     SER      107      CA            4.0927
 9155 POS      SOD      53       SOD     -1518 PAA1     SER      107      CB            3.0097
 9155 POS      SOD      53       SOD     -1521 PAA1     SER      107      OG            1.8139
 9155 POS      SOD      53       SOD     -1523 PAA1     SER      107      C             4.1543
 9155 POS      SOD      53       SOD     -1578 PAA1     LEU      111      CD1           3.8579
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "53"
Evaluating: 53
 Parameter: J <- "53"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "53" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "6.120747811E-02"
Evaluating: (89.1533903-9.0)*(6.120747811E-02-0.5)
 Parameter: XPOS <- "-35.1707083"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.304884214"
Evaluating: (89.1533903-9.0)*(0.304884214-0.5)
 Parameter: YPOS <- "-15.6391917"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "8.696357787E-02"
Evaluating: (89.1533903-9.0)*(8.696357787E-02-0.5)
 Parameter: ZPOS <- "-33.1062696"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -19.055942 XMAX =  -19.055942 XAVE =  -19.055942
    YMIN =  -12.655133 YMAX =  -12.655133 YAVE =  -12.655133
    ZMIN =   16.876329 ZMAX =   16.876329 ZAVE =   16.876329
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.1707083"
 RDCMND substituted energy or value "?XAVE" to "-19.0559425"
Evaluating: -35.1707083--19.0559425
 Parameter: XTRAN <- "-16.1147658"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.6391917"
 RDCMND substituted energy or value "?YAVE" to "-12.6551334"
Evaluating: -15.6391917--12.6551334
 Parameter: YTRAN <- "-2.9840583"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.1062696"
 RDCMND substituted energy or value "?ZAVE" to "16.8763292"
Evaluating: -33.1062696-16.8763292
 Parameter: ZTRAN <- "-49.9825988"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-16.1147658"
 Parameter: YTRAN -> "-2.9840583"
 Parameter: ZTRAN -> "-49.9825988"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -16.114766   -2.984058  -49.982599
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.598100194"
Evaluating: 0.598100194*360.0
 Parameter: XPHI <- "215.31607"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.164648513"
Evaluating: 0.164648513*360.0
 Parameter: YPHI <- "59.2734647"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.930259372"
Evaluating: 0.930259372*360.0
 Parameter: ZPHI <- "334.893374"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.1707083"
 Parameter: YPOS -> "-15.6391917"
 Parameter: ZPOS -> "-33.1062696"
 Parameter: XPHI -> "215.31607"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.815975   -0.578087
    0.000000    0.578087   -0.815975

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  144.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.1707083"
 Parameter: YPOS -> "-15.6391917"
 Parameter: ZPOS -> "-33.1062696"
 Parameter: YPHI -> "59.2734647"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.510941    0.000000   -0.859616
    0.000000    1.000000    0.000000
    0.859616    0.000000    0.510941

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   59.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.1707083"
 Parameter: YPOS -> "-15.6391917"
 Parameter: ZPOS -> "-33.1062696"
 Parameter: ZPHI -> "334.893374"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.905520   -0.424304    0.000000
    0.424304    0.905520    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   25.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.170708 XMAX =  -35.170708 XAVE =  -35.170708
    YMIN =  -15.639192 YMAX =  -15.639192 YAVE =  -15.639192
    ZMIN =  -33.106270 ZMAX =  -33.106270 ZAVE =  -33.106270
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.1707083"
Evaluating: -35.1707083+3.5
 Parameter: XMAX <- "-31.6707083"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.6391917"
Evaluating: -15.6391917+3.5
 Parameter: YMAX <- "-12.1391917"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.1062696"
Evaluating: -33.1062696+3.5
 Parameter: ZMAX <- "-29.6062696"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.1707083"
Evaluating: -35.1707083-3.5
 Parameter: XMIN <- "-38.6707083"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.6391917"
Evaluating: -15.6391917-3.5
 Parameter: YMIN <- "-19.1391917"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.1062696"
Evaluating: -33.1062696-3.5
 Parameter: ZMIN <- "-36.6062696"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-31.6707083"
 Parameter: XMIN -> "-38.6707083"
 Parameter: YMAX -> "-12.1391917"
 Parameter: YMIN -> "-19.1391917"
 Parameter: ZMAX -> "-29.6062696"
 Parameter: ZMIN -> "-36.6062696"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "54"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "54" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "54" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.743919888"
Evaluating: (89.1533903-9.0)*(0.743919888-0.5)
 Parameter: XPOS <- "19.551006"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.156898289"
Evaluating: (89.1533903-9.0)*(0.156898289-0.5)
 Parameter: YPOS <- "-27.5007654"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.557645793"
Evaluating: (89.1533903-9.0)*(0.557645793-0.5)
 Parameter: ZPOS <- "4.62050575"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.551006"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 19.551006-44.5766951
 Parameter: XTRAN <- "-25.0256891"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.5007654"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -27.5007654-44.5766951
 Parameter: YTRAN <- "-72.0774605"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "4.62050575"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 4.62050575-44.5766951
 Parameter: ZTRAN <- "-39.9561894"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.0256891"
 Parameter: YTRAN -> "-72.0774605"
 Parameter: ZTRAN -> "-39.9561894"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -25.025689  -72.077461  -39.956189
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.112651626"
Evaluating: 0.112651626*360.0
 Parameter: XPHI <- "40.5545854"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.491290666E-02"
Evaluating: 6.491290666E-02*360.0
 Parameter: YPHI <- "23.3686464"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.341916498"
Evaluating: 0.341916498*360.0
 Parameter: ZPHI <- "123.089939"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.551006"
 Parameter: YPOS -> "-27.5007654"
 Parameter: ZPOS -> "4.62050575"
 Parameter: XPHI -> "40.5545854"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.759787    0.650172
    0.000000   -0.650172    0.759787

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   40.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.551006"
 Parameter: YPOS -> "-27.5007654"
 Parameter: ZPOS -> "4.62050575"
 Parameter: YPHI -> "23.3686464"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.917972    0.000000   -0.396646
    0.000000    1.000000    0.000000
    0.396646    0.000000    0.917972

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   23.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.551006"
 Parameter: YPOS -> "-27.5007654"
 Parameter: ZPOS -> "4.62050575"
 Parameter: ZPHI -> "123.089939"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.545955    0.837815    0.000000
   -0.837815   -0.545955    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  123.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.551006 XMAX =   19.551006 XAVE =   19.551006
    YMIN =  -27.500765 YMAX =  -27.500765 YAVE =  -27.500765
    ZMIN =    4.620506 ZMAX =    4.620506 ZAVE =    4.620506
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.551006"
Evaluating: 19.551006+3.5
 Parameter: XMAX <- "23.051006"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.5007654"
Evaluating: -27.5007654+3.5
 Parameter: YMAX <- "-24.0007654"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "4.62050572"
Evaluating: 4.62050572+3.5
 Parameter: ZMAX <- "8.12050572"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.551006"
Evaluating: 19.551006-3.5
 Parameter: XMIN <- "16.051006"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.5007654"
Evaluating: -27.5007654-3.5
 Parameter: YMIN <- "-31.0007654"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "4.62050572"
Evaluating: 4.62050572-3.5
 Parameter: ZMIN <- "1.12050572"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "23.051006"
 Parameter: XMIN -> "16.051006"
 Parameter: YMAX -> "-24.0007654"
 Parameter: YMIN -> "-31.0007654"
 Parameter: ZMAX -> "8.12050572"
 Parameter: ZMIN -> "1.12050572"
 SELRPN>      3 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      2 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9156 POS      SOD      54       SOD     -4247 PAA1     ASN      324      O             3.2086
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "54"
Evaluating: 54
 Parameter: J <- "54"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "54" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.852465505"
Evaluating: (89.1533903-9.0)*(0.852465505-0.5)
 Parameter: XPOS <- "28.2513052"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "8.170806571E-02"
Evaluating: (89.1533903-9.0)*(8.170806571E-02-0.5)
 Parameter: YPOS <- "-33.5275167"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.230428086"
Evaluating: (89.1533903-9.0)*(0.230428086-0.5)
 Parameter: ZPOS <- "-21.6071028"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.551006 XMAX =   19.551006 XAVE =   19.551006
    YMIN =  -27.500765 YMAX =  -27.500765 YAVE =  -27.500765
    ZMIN =    4.620506 ZMAX =    4.620506 ZAVE =    4.620506
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.2513052"
 RDCMND substituted energy or value "?XAVE" to "19.551006"
Evaluating: 28.2513052-19.551006
 Parameter: XTRAN <- "8.7002992"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.5275167"
 RDCMND substituted energy or value "?YAVE" to "-27.5007654"
Evaluating: -33.5275167--27.5007654
 Parameter: YTRAN <- "-6.0267513"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.6071028"
 RDCMND substituted energy or value "?ZAVE" to "4.62050572"
Evaluating: -21.6071028-4.62050572
 Parameter: ZTRAN <- "-26.2276085"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "8.7002992"
 Parameter: YTRAN -> "-6.0267513"
 Parameter: ZTRAN -> "-26.2276085"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR     8.700299   -6.026751  -26.227608
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.895399386"
Evaluating: 0.895399386*360.0
 Parameter: XPHI <- "322.343779"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.360120219"
Evaluating: 0.360120219*360.0
 Parameter: YPHI <- "129.643279"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.430226375"
Evaluating: 0.430226375*360.0
 Parameter: ZPHI <- "154.881495"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.2513052"
 Parameter: YPOS -> "-33.5275167"
 Parameter: ZPOS -> "-21.6071028"
 Parameter: XPHI -> "322.343779"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.791691   -0.610922
    0.000000    0.610922    0.791691

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   37.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.2513052"
 Parameter: YPOS -> "-33.5275167"
 Parameter: ZPOS -> "-21.6071028"
 Parameter: YPHI -> "129.643279"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.638006    0.000000   -0.770032
    0.000000    1.000000    0.000000
    0.770032    0.000000   -0.638006

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  129.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.2513052"
 Parameter: YPOS -> "-33.5275167"
 Parameter: ZPOS -> "-21.6071028"
 Parameter: ZPHI -> "154.881495"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.905432    0.424492    0.000000
   -0.424492   -0.905432    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  154.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.251305 XMAX =   28.251305 XAVE =   28.251305
    YMIN =  -33.527517 YMAX =  -33.527517 YAVE =  -33.527517
    ZMIN =  -21.607103 ZMAX =  -21.607103 ZAVE =  -21.607103
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.2513052"
Evaluating: 28.2513052+3.5
 Parameter: XMAX <- "31.7513052"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.5275167"
Evaluating: -33.5275167+3.5
 Parameter: YMAX <- "-30.0275167"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.6071028"
Evaluating: -21.6071028+3.5
 Parameter: ZMAX <- "-18.1071028"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.2513052"
Evaluating: 28.2513052-3.5
 Parameter: XMIN <- "24.7513052"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.5275167"
Evaluating: -33.5275167-3.5
 Parameter: YMIN <- "-37.0275167"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.6071028"
Evaluating: -21.6071028-3.5
 Parameter: ZMIN <- "-25.1071028"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.7513052"
 Parameter: XMIN -> "24.7513052"
 Parameter: YMAX -> "-30.0275167"
 Parameter: YMIN -> "-37.0275167"
 Parameter: ZMAX -> "-18.1071028"
 Parameter: ZMIN -> "-25.1071028"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "55"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "55" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "55"
Evaluating: 55
 Parameter: J <- "55"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "55" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.598125582"
Evaluating: (89.1533903-9.0)*(0.598125582-0.5)
 Parameter: XPOS <- "7.86509807"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.283176965"
Evaluating: (89.1533903-9.0)*(0.283176965-0.5)
 Parameter: YPOS <- "-17.3791014"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.499387115"
Evaluating: (89.1533903-9.0)*(0.499387115-0.5)
 Parameter: ZPOS <- "-4.912481061E-02"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.86509807"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 7.86509807-44.5766951
 Parameter: XTRAN <- "-36.711597"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-17.3791014"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -17.3791014-44.5766951
 Parameter: YTRAN <- "-61.9557965"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-4.912481061E-02"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -4.912481061E-02-44.5766951
 Parameter: ZTRAN <- "-44.6258199"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.711597"
 Parameter: YTRAN -> "-61.9557965"
 Parameter: ZTRAN -> "-44.6258199"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -36.711597  -61.955796  -44.625820
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.140991125"
Evaluating: 0.140991125*360.0
 Parameter: XPHI <- "50.756805"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.103766364E-02"
Evaluating: 1.103766364E-02*360.0
 Parameter: YPHI <- "3.97355891"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.180147721"
Evaluating: 0.180147721*360.0
 Parameter: ZPHI <- "64.8531796"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.86509807"
 Parameter: YPOS -> "-17.3791014"
 Parameter: ZPOS -> "-4.912481061E-02"
 Parameter: XPHI -> "50.756805"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.632613    0.774468
    0.000000   -0.774468    0.632613

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   50.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.86509807"
 Parameter: YPOS -> "-17.3791014"
 Parameter: ZPOS -> "-4.912481061E-02"
 Parameter: YPHI -> "3.97355891"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.997596    0.000000   -0.069296
    0.000000    1.000000    0.000000
    0.069296    0.000000    0.997596

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    3.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.86509807"
 Parameter: YPOS -> "-17.3791014"
 Parameter: ZPOS -> "-4.912481061E-02"
 Parameter: ZPHI -> "64.8531796"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.424939    0.905222    0.000000
   -0.905222    0.424939    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   64.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.865098 XMAX =    7.865098 XAVE =    7.865098
    YMIN =  -17.379101 YMAX =  -17.379101 YAVE =  -17.379101
    ZMIN =   -0.049125 ZMAX =   -0.049125 ZAVE =   -0.049125
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.86509809"
Evaluating: 7.86509809+3.5
 Parameter: XMAX <- "11.3650981"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-17.3791014"
Evaluating: -17.3791014+3.5
 Parameter: YMAX <- "-13.8791014"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-4.912480184E-02"
Evaluating: -4.912480184E-02+3.5
 Parameter: ZMAX <- "3.4508752"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.86509809"
Evaluating: 7.86509809-3.5
 Parameter: XMIN <- "4.36509809"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-17.3791014"
Evaluating: -17.3791014-3.5
 Parameter: YMIN <- "-20.8791014"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-4.912480184E-02"
Evaluating: -4.912480184E-02-3.5
 Parameter: ZMIN <- "-3.5491248"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.3650981"
 Parameter: XMIN -> "4.36509809"
 Parameter: YMAX -> "-13.8791014"
 Parameter: YMIN -> "-20.8791014"
 Parameter: ZMAX -> "3.4508752"
 Parameter: ZMIN -> "-3.5491248"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "56"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "56" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "56" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "56"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "4.470518362E-02"
Evaluating: (89.1533903-9.0)*(4.470518362E-02-0.5)
 Parameter: XPOS <- "-36.4934231"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.167819821"
Evaluating: (89.1533903-9.0)*(0.167819821-0.5)
 Parameter: YPOS <- "-26.6253675"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.854941574"
Evaluating: (89.1533903-9.0)*(0.854941574-0.5)
 Parameter: ZPOS <- "28.4497705"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.4934231"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -36.4934231-44.5766951
 Parameter: XTRAN <- "-81.0701182"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-26.6253675"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -26.6253675-44.5766951
 Parameter: YTRAN <- "-71.2020626"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.4497705"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 28.4497705-44.5766951
 Parameter: ZTRAN <- "-16.1269246"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-81.0701182"
 Parameter: YTRAN -> "-71.2020626"
 Parameter: ZTRAN -> "-16.1269246"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -81.070118  -71.202063  -16.126925
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.675960078"
Evaluating: 0.675960078*360.0
 Parameter: XPHI <- "243.345628"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.204301725"
Evaluating: 0.204301725*360.0
 Parameter: YPHI <- "73.548621"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.771945227"
Evaluating: 0.771945227*360.0
 Parameter: ZPHI <- "277.900282"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.4934231"
 Parameter: YPOS -> "-26.6253675"
 Parameter: ZPOS -> "28.4497705"
 Parameter: XPHI -> "243.345628"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.448607   -0.893729
    0.000000    0.893729   -0.448607

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  116.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.4934231"
 Parameter: YPOS -> "-26.6253675"
 Parameter: ZPOS -> "28.4497705"
 Parameter: YPHI -> "73.548621"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.283202    0.000000   -0.959060
    0.000000    1.000000    0.000000
    0.959060    0.000000    0.283202

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   73.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.4934231"
 Parameter: YPOS -> "-26.6253675"
 Parameter: ZPOS -> "28.4497705"
 Parameter: ZPHI -> "277.900282"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.137449   -0.990509    0.000000
    0.990509    0.137449    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   82.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.493423 XMAX =  -36.493423 XAVE =  -36.493423
    YMIN =  -26.625367 YMAX =  -26.625367 YAVE =  -26.625367
    ZMIN =   28.449771 ZMAX =   28.449771 ZAVE =   28.449771
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.4934231"
Evaluating: -36.4934231+3.5
 Parameter: XMAX <- "-32.9934231"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-26.6253675"
Evaluating: -26.6253675+3.5
 Parameter: YMAX <- "-23.1253675"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.4497705"
Evaluating: 28.4497705+3.5
 Parameter: ZMAX <- "31.9497705"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.4934231"
Evaluating: -36.4934231-3.5
 Parameter: XMIN <- "-39.9934231"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-26.6253675"
Evaluating: -26.6253675-3.5
 Parameter: YMIN <- "-30.1253675"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.4497705"
Evaluating: 28.4497705-3.5
 Parameter: ZMIN <- "24.9497705"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.9934231"
 Parameter: XMIN -> "-39.9934231"
 Parameter: YMAX -> "-23.1253675"
 Parameter: YMIN -> "-30.1253675"
 Parameter: ZMAX -> "31.9497705"
 Parameter: ZMIN -> "24.9497705"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      1 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9158 POS      SOD      56       SOD     -9141 POS      SOD      39       SOD           3.8420
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "56"
Evaluating: 56
 Parameter: J <- "56"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "56" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "56"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.451635334"
Evaluating: (89.1533903-9.0)*(0.451635334-0.5)
 Parameter: XPOS <- "-3.87659195"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.199964586"
Evaluating: (89.1533903-9.0)*(0.199964586-0.5)
 Parameter: YPOS <- "-24.0488556"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.218403209"
Evaluating: (89.1533903-9.0)*(0.218403209-0.5)
 Parameter: ZPOS <- "-22.5709375"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.493423 XMAX =  -36.493423 XAVE =  -36.493423
    YMIN =  -26.625367 YMAX =  -26.625367 YAVE =  -26.625367
    ZMIN =   28.449771 ZMAX =   28.449771 ZAVE =   28.449771
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.87659195"
 RDCMND substituted energy or value "?XAVE" to "-36.4934231"
Evaluating: -3.87659195--36.4934231
 Parameter: XTRAN <- "32.6168312"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.0488556"
 RDCMND substituted energy or value "?YAVE" to "-26.6253675"
Evaluating: -24.0488556--26.6253675
 Parameter: YTRAN <- "2.5765119"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-22.5709375"
 RDCMND substituted energy or value "?ZAVE" to "28.4497705"
Evaluating: -22.5709375-28.4497705
 Parameter: ZTRAN <- "-51.020708"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "32.6168312"
 Parameter: YTRAN -> "2.5765119"
 Parameter: ZTRAN -> "-51.020708"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    32.616831    2.576512  -51.020708
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.391804761"
Evaluating: 0.391804761*360.0
 Parameter: XPHI <- "141.049714"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.98455897"
Evaluating: 0.98455897*360.0
 Parameter: YPHI <- "354.441229"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.451874097"
Evaluating: 0.451874097*360.0
 Parameter: ZPHI <- "162.674675"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.87659195"
 Parameter: YPOS -> "-24.0488556"
 Parameter: ZPOS -> "-22.5709375"
 Parameter: XPHI -> "141.049714"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.777692    0.628646
    0.000000   -0.628646   -0.777692

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  141.05

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.87659195"
 Parameter: YPOS -> "-24.0488556"
 Parameter: ZPOS -> "-22.5709375"
 Parameter: YPHI -> "354.441229"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.995297    0.000000    0.096867
    0.000000    1.000000    0.000000
   -0.096867    0.000000    0.995297

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    5.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.87659195"
 Parameter: YPOS -> "-24.0488556"
 Parameter: ZPOS -> "-22.5709375"
 Parameter: ZPHI -> "162.674675"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.954629    0.297797    0.000000
   -0.297797   -0.954629    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  162.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.876592 XMAX =   -3.876592 XAVE =   -3.876592
    YMIN =  -24.048856 YMAX =  -24.048856 YAVE =  -24.048856
    ZMIN =  -22.570938 ZMAX =  -22.570938 ZAVE =  -22.570938
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.876592"
Evaluating: -3.876592+3.5
 Parameter: XMAX <- "-0.376592"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.0488556"
Evaluating: -24.0488556+3.5
 Parameter: YMAX <- "-20.5488556"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-22.5709375"
Evaluating: -22.5709375+3.5
 Parameter: ZMAX <- "-19.0709375"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.876592"
Evaluating: -3.876592-3.5
 Parameter: XMIN <- "-7.376592"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.0488556"
Evaluating: -24.0488556-3.5
 Parameter: YMIN <- "-27.5488556"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-22.5709375"
Evaluating: -22.5709375-3.5
 Parameter: ZMIN <- "-26.0709375"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-0.376592"
 Parameter: XMIN -> "-7.376592"
 Parameter: YMAX -> "-20.5488556"
 Parameter: YMIN -> "-27.5488556"
 Parameter: ZMAX -> "-19.0709375"
 Parameter: ZMIN -> "-26.0709375"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "57"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "57" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "57"
Evaluating: 57
 Parameter: J <- "57"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "57" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.572463226"
Evaluating: (89.1533903-9.0)*(0.572463226-0.5)
 Parameter: XPOS <- "5.80817324"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.670701478"
Evaluating: (89.1533903-9.0)*(0.670701478-0.5)
 Parameter: YPOS <- "13.6823022"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.954068265"
Evaluating: (89.1533903-9.0)*(0.954068265-0.5)
 Parameter: ZPOS <- "36.3951109"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.80817324"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 5.80817324-44.5766951
 Parameter: XTRAN <- "-38.7685219"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.6823022"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 13.6823022-44.5766951
 Parameter: YTRAN <- "-30.8943929"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.3951109"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 36.3951109-44.5766951
 Parameter: ZTRAN <- "-8.1815842"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.7685219"
 Parameter: YTRAN -> "-30.8943929"
 Parameter: ZTRAN -> "-8.1815842"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -38.768522  -30.894393   -8.181584
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.700704493E-02"
Evaluating: 1.700704493E-02*360.0
 Parameter: XPHI <- "6.12253617"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.475690519"
Evaluating: 0.475690519*360.0
 Parameter: YPHI <- "171.248587"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.453632392"
Evaluating: 0.453632392*360.0
 Parameter: ZPHI <- "163.307661"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.80817324"
 Parameter: YPOS -> "13.6823022"
 Parameter: ZPOS -> "36.3951109"
 Parameter: XPHI -> "6.12253617"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.994296    0.106655
    0.000000   -0.106655    0.994296

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    6.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.80817324"
 Parameter: YPOS -> "13.6823022"
 Parameter: ZPOS -> "36.3951109"
 Parameter: YPHI -> "171.248587"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.988358    0.000000   -0.152148
    0.000000    1.000000    0.000000
    0.152148    0.000000   -0.988358

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  171.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.80817324"
 Parameter: YPOS -> "13.6823022"
 Parameter: ZPOS -> "36.3951109"
 Parameter: ZPHI -> "163.307661"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.957861    0.287232    0.000000
   -0.287232   -0.957861    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  163.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.808173 XMAX =    5.808173 XAVE =    5.808173
    YMIN =   13.682302 YMAX =   13.682302 YAVE =   13.682302
    ZMIN =   36.395111 ZMAX =   36.395111 ZAVE =   36.395111
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.8081732"
Evaluating: 5.8081732+3.5
 Parameter: XMAX <- "9.3081732"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.6823022"
Evaluating: 13.6823022+3.5
 Parameter: YMAX <- "17.1823022"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.3951109"
Evaluating: 36.3951109+3.5
 Parameter: ZMAX <- "39.8951109"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.8081732"
Evaluating: 5.8081732-3.5
 Parameter: XMIN <- "2.3081732"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.6823022"
Evaluating: 13.6823022-3.5
 Parameter: YMIN <- "10.1823022"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.3951109"
Evaluating: 36.3951109-3.5
 Parameter: ZMIN <- "32.8951109"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.3081732"
 Parameter: XMIN -> "2.3081732"
 Parameter: YMAX -> "17.1823022"
 Parameter: YMIN -> "10.1823022"
 Parameter: ZMAX -> "39.8951109"
 Parameter: ZMIN -> "32.8951109"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "58"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "58" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "58"
Evaluating: 58
 Parameter: J <- "58"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "58" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.401936134"
Evaluating: (89.1533903-9.0)*(0.401936134-0.5)
 Parameter: XPOS <- "-7.86015133"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.833959278"
Evaluating: (89.1533903-9.0)*(0.833959278-0.5)
 Parameter: YPOS <- "26.7679684"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.283428732"
Evaluating: (89.1533903-9.0)*(0.283428732-0.5)
 Parameter: ZPOS <- "-17.3589214"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.86015133"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -7.86015133-44.5766951
 Parameter: XTRAN <- "-52.4368464"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "26.7679684"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 26.7679684-44.5766951
 Parameter: YTRAN <- "-17.8087267"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.3589214"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -17.3589214-44.5766951
 Parameter: ZTRAN <- "-61.9356165"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-52.4368464"
 Parameter: YTRAN -> "-17.8087267"
 Parameter: ZTRAN -> "-61.9356165"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -52.436846  -17.808727  -61.935617
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.718971034"
Evaluating: 0.718971034*360.0
 Parameter: XPHI <- "258.829572"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.187581075"
Evaluating: 0.187581075*360.0
 Parameter: YPHI <- "67.529187"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.086493479E-02"
Evaluating: 4.086493479E-02*360.0
 Parameter: ZPHI <- "14.7113765"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.86015133"
 Parameter: YPOS -> "26.7679684"
 Parameter: ZPOS -> "-17.3589214"
 Parameter: XPHI -> "258.829572"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.193728   -0.981055
    0.000000    0.981055   -0.193728

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  101.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.86015133"
 Parameter: YPOS -> "26.7679684"
 Parameter: ZPOS -> "-17.3589214"
 Parameter: YPHI -> "67.529187"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.382213    0.000000   -0.924074
    0.000000    1.000000    0.000000
    0.924074    0.000000    0.382213

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   67.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.86015133"
 Parameter: YPOS -> "26.7679684"
 Parameter: ZPOS -> "-17.3589214"
 Parameter: ZPHI -> "14.7113765"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.967217    0.253950    0.000000
   -0.253950    0.967217    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   14.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.860151 XMAX =   -7.860151 XAVE =   -7.860151
    YMIN =   26.767968 YMAX =   26.767968 YAVE =   26.767968
    ZMIN =  -17.358921 ZMAX =  -17.358921 ZAVE =  -17.358921
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.86015132"
Evaluating: -7.86015132+3.5
 Parameter: XMAX <- "-4.36015132"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "26.7679684"
Evaluating: 26.7679684+3.5
 Parameter: YMAX <- "30.2679684"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.3589214"
Evaluating: -17.3589214+3.5
 Parameter: ZMAX <- "-13.8589214"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.86015132"
Evaluating: -7.86015132-3.5
 Parameter: XMIN <- "-11.3601513"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "26.7679684"
Evaluating: 26.7679684-3.5
 Parameter: YMIN <- "23.2679684"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.3589214"
Evaluating: -17.3589214-3.5
 Parameter: ZMIN <- "-20.8589214"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.36015132"
 Parameter: XMIN -> "-11.3601513"
 Parameter: YMAX -> "30.2679684"
 Parameter: YMIN -> "23.2679684"
 Parameter: ZMAX -> "-13.8589214"
 Parameter: ZMIN -> "-20.8589214"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "59"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "59" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "59" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.529315652"
Evaluating: (89.1533903-9.0)*(0.529315652-0.5)
 Parameter: XPOS <- "2.3497489"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.746710711"
Evaluating: (89.1533903-9.0)*(0.746710711-0.5)
 Parameter: YPOS <- "19.7746999"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.708611246"
Evaluating: (89.1533903-9.0)*(0.708611246-0.5)
 Parameter: ZPOS <- "16.7208986"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "2.3497489"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 2.3497489-44.5766951
 Parameter: XTRAN <- "-42.2269462"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "19.7746999"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 19.7746999-44.5766951
 Parameter: YTRAN <- "-24.8019952"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.7208986"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 16.7208986-44.5766951
 Parameter: ZTRAN <- "-27.8557965"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-42.2269462"
 Parameter: YTRAN -> "-24.8019952"
 Parameter: ZTRAN -> "-27.8557965"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -42.226946  -24.801995  -27.855797
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.873798539"
Evaluating: 0.873798539*360.0
 Parameter: XPHI <- "314.567474"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.972276518"
Evaluating: 0.972276518*360.0
 Parameter: YPHI <- "350.019546"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.854528986E-02"
Evaluating: 3.854528986E-02*360.0
 Parameter: ZPHI <- "13.8763043"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "2.3497489"
 Parameter: YPOS -> "19.7746999"
 Parameter: ZPOS -> "16.7208986"
 Parameter: XPHI -> "314.567474"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.701749   -0.712425
    0.000000    0.712425    0.701749

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   45.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "2.3497489"
 Parameter: YPOS -> "19.7746999"
 Parameter: ZPOS -> "16.7208986"
 Parameter: YPHI -> "350.019546"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.984867    0.000000    0.173312
    0.000000    1.000000    0.000000
   -0.173312    0.000000    0.984867

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    9.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "2.3497489"
 Parameter: YPOS -> "19.7746999"
 Parameter: ZPOS -> "16.7208986"
 Parameter: ZPHI -> "13.8763043"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.970816    0.239827    0.000000
   -0.239827    0.970816    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   13.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.349749 XMAX =    2.349749 XAVE =    2.349749
    YMIN =   19.774700 YMAX =   19.774700 YAVE =   19.774700
    ZMIN =   16.720899 ZMAX =   16.720899 ZAVE =   16.720899
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "2.3497489"
Evaluating: 2.3497489+3.5
 Parameter: XMAX <- "5.8497489"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "19.7746999"
Evaluating: 19.7746999+3.5
 Parameter: YMAX <- "23.2746999"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.7208986"
Evaluating: 16.7208986+3.5
 Parameter: ZMAX <- "20.2208986"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "2.3497489"
Evaluating: 2.3497489-3.5
 Parameter: XMIN <- "-1.1502511"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "19.7746999"
Evaluating: 19.7746999-3.5
 Parameter: YMIN <- "16.2746999"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.7208986"
Evaluating: 16.7208986-3.5
 Parameter: ZMIN <- "13.2208986"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "5.8497489"
 Parameter: XMIN -> "-1.1502511"
 Parameter: YMAX -> "23.2746999"
 Parameter: YMIN -> "16.2746999"
 Parameter: ZMAX -> "20.2208986"
 Parameter: ZMIN -> "13.2208986"
 SELRPN>     15 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "15"
 Comparing "15" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      9 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9161 POS      SOD      59       SOD     -2169 PAA1     GLY      153      C             2.8139
 9161 POS      SOD      59       SOD     -2170 PAA1     GLY      153      O             3.7092
 9161 POS      SOD      59       SOD     -2171 PAA1     GLN      154      N             1.5529
 9161 POS      SOD      59       SOD     -2173 PAA1     GLN      154      CA            1.6981
 9161 POS      SOD      59       SOD     -2175 PAA1     GLN      154      CB            1.3942
 9161 POS      SOD      59       SOD     -2178 PAA1     GLN      154      CG            2.8579
 9161 POS      SOD      59       SOD     -2186 PAA1     GLN      154      C             3.0693
 9161 POS      SOD      59       SOD     -2187 PAA1     GLN      154      O             3.5771
 9161 POS      SOD      59       SOD     -2188 PAA1     GLY      155      N             4.0763
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         9
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "59" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.327735167"
Evaluating: (89.1533903-9.0)*(0.327735167-0.5)
 Parameter: XPOS <- "-13.8076104"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.493438664"
Evaluating: (89.1533903-9.0)*(0.493438664-0.5)
 Parameter: YPOS <- "-0.525913325"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.957448424"
Evaluating: (89.1533903-9.0)*(0.957448424-0.5)
 Parameter: ZPOS <- "36.6660421"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    2.349749 XMAX =    2.349749 XAVE =    2.349749
    YMIN =   19.774700 YMAX =   19.774700 YAVE =   19.774700
    ZMIN =   16.720899 ZMAX =   16.720899 ZAVE =   16.720899
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.8076104"
 RDCMND substituted energy or value "?XAVE" to "2.3497489"
Evaluating: -13.8076104-2.3497489
 Parameter: XTRAN <- "-16.1573593"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.525913325"
 RDCMND substituted energy or value "?YAVE" to "19.7746999"
Evaluating: -0.525913325-19.7746999
 Parameter: YTRAN <- "-20.3006132"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "36.6660421"
 RDCMND substituted energy or value "?ZAVE" to "16.7208986"
Evaluating: 36.6660421-16.7208986
 Parameter: ZTRAN <- "19.9451435"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-16.1573593"
 Parameter: YTRAN -> "-20.3006132"
 Parameter: ZTRAN -> "19.9451435"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -16.157359  -20.300613   19.945144
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.922747524"
Evaluating: 0.922747524*360.0
 Parameter: XPHI <- "332.189109"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.659994654"
Evaluating: 0.659994654*360.0
 Parameter: YPHI <- "237.598075"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.980366018"
Evaluating: 0.980366018*360.0
 Parameter: ZPHI <- "352.931766"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.8076104"
 Parameter: YPOS -> "-0.525913325"
 Parameter: ZPOS -> "36.6660421"
 Parameter: XPHI -> "332.189109"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.884492   -0.466555
    0.000000    0.466555    0.884492

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   27.81

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.8076104"
 Parameter: YPOS -> "-0.525913325"
 Parameter: ZPOS -> "36.6660421"
 Parameter: YPHI -> "237.598075"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.535855    0.000000    0.844310
    0.000000    1.000000    0.000000
   -0.844310    0.000000   -0.535855

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  122.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.8076104"
 Parameter: YPOS -> "-0.525913325"
 Parameter: ZPOS -> "36.6660421"
 Parameter: ZPHI -> "352.931766"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.992400   -0.123051    0.000000
    0.123051    0.992400    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    7.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.807610 XMAX =  -13.807610 XAVE =  -13.807610
    YMIN =   -0.525913 YMAX =   -0.525913 YAVE =   -0.525913
    ZMIN =   36.666042 ZMAX =   36.666042 ZAVE =   36.666042
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.8076104"
Evaluating: -13.8076104+3.5
 Parameter: XMAX <- "-10.3076104"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.525913302"
Evaluating: -0.525913302+3.5
 Parameter: YMAX <- "2.9740867"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "36.6660421"
Evaluating: 36.6660421+3.5
 Parameter: ZMAX <- "40.1660421"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.8076104"
Evaluating: -13.8076104-3.5
 Parameter: XMIN <- "-17.3076104"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.525913302"
Evaluating: -0.525913302-3.5
 Parameter: YMIN <- "-4.0259133"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "36.6660421"
Evaluating: 36.6660421-3.5
 Parameter: ZMIN <- "33.1660421"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.3076104"
 Parameter: XMIN -> "-17.3076104"
 Parameter: YMAX -> "2.9740867"
 Parameter: YMIN -> "-4.0259133"
 Parameter: ZMAX -> "40.1660421"
 Parameter: ZMIN -> "33.1660421"
 SELRPN>      2 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      2 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9161 POS      SOD      59       SOD     -7493 PAA2     ASN      225      OD1           3.5783
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "59"
Evaluating: 59
 Parameter: J <- "59"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "59" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.334689806"
Evaluating: (89.1533903-9.0)*(0.334689806-0.5)
 Parameter: XPOS <- "-13.2501725"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.876273852"
Evaluating: (89.1533903-9.0)*(0.876273852-0.5)
 Parameter: YPOS <- "30.1596249"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.231271628"
Evaluating: (89.1533903-9.0)*(0.231271628-0.5)
 Parameter: ZPOS <- "-21.5394901"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.807610 XMAX =  -13.807610 XAVE =  -13.807610
    YMIN =   -0.525913 YMAX =   -0.525913 YAVE =   -0.525913
    ZMIN =   36.666042 ZMAX =   36.666042 ZAVE =   36.666042
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-13.2501725"
 RDCMND substituted energy or value "?XAVE" to "-13.8076104"
Evaluating: -13.2501725--13.8076104
 Parameter: XTRAN <- "0.5574379"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.1596249"
 RDCMND substituted energy or value "?YAVE" to "-0.525913302"
Evaluating: 30.1596249--0.525913302
 Parameter: YTRAN <- "30.6855382"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.5394901"
 RDCMND substituted energy or value "?ZAVE" to "36.6660421"
Evaluating: -21.5394901-36.6660421
 Parameter: ZTRAN <- "-58.2055322"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "0.5574379"
 Parameter: YTRAN -> "30.6855382"
 Parameter: ZTRAN -> "-58.2055322"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR     0.557438   30.685538  -58.205532
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.162362305"
Evaluating: 0.162362305*360.0
 Parameter: XPHI <- "58.4504298"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.961475335"
Evaluating: 0.961475335*360.0
 Parameter: YPHI <- "346.131121"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.281408464"
Evaluating: 0.281408464*360.0
 Parameter: ZPHI <- "101.307047"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-13.2501725"
 Parameter: YPOS -> "30.1596249"
 Parameter: ZPOS -> "-21.5394901"
 Parameter: XPHI -> "58.4504298"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.523236    0.852188
    0.000000   -0.852188    0.523236

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   58.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-13.2501725"
 Parameter: YPOS -> "30.1596249"
 Parameter: ZPOS -> "-21.5394901"
 Parameter: YPHI -> "346.131121"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.970847    0.000000    0.239701
    0.000000    1.000000    0.000000
   -0.239701    0.000000    0.970847

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   13.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-13.2501725"
 Parameter: YPOS -> "30.1596249"
 Parameter: ZPOS -> "-21.5394901"
 Parameter: ZPHI -> "101.307047"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.196067    0.980591    0.000000
   -0.980591   -0.196067    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  101.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -13.250173 XMAX =  -13.250173 XAVE =  -13.250173
    YMIN =   30.159625 YMAX =   30.159625 YAVE =   30.159625
    ZMIN =  -21.539490 ZMAX =  -21.539490 ZAVE =  -21.539490
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-13.2501725"
Evaluating: -13.2501725+3.5
 Parameter: XMAX <- "-9.7501725"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.1596249"
Evaluating: 30.1596249+3.5
 Parameter: YMAX <- "33.6596249"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.5394901"
Evaluating: -21.5394901+3.5
 Parameter: ZMAX <- "-18.0394901"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-13.2501725"
Evaluating: -13.2501725-3.5
 Parameter: XMIN <- "-16.7501725"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.1596249"
Evaluating: 30.1596249-3.5
 Parameter: YMIN <- "26.6596249"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.5394901"
Evaluating: -21.5394901-3.5
 Parameter: ZMIN <- "-25.0394901"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-9.7501725"
 Parameter: XMIN -> "-16.7501725"
 Parameter: YMAX -> "33.6596249"
 Parameter: YMIN -> "26.6596249"
 Parameter: ZMAX -> "-18.0394901"
 Parameter: ZMIN -> "-25.0394901"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "60"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "60" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "60"
Evaluating: 60
 Parameter: J <- "60"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "60" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.56192194"
Evaluating: (89.1533903-9.0)*(0.56192194-0.5)
 Parameter: XPOS <- "4.96325342"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.34356361"
Evaluating: (89.1533903-9.0)*(0.34356361-0.5)
 Parameter: YPOS <- "-12.538907"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.285597059"
Evaluating: (89.1533903-9.0)*(0.285597059-0.5)
 Parameter: ZPOS <- "-17.1851226"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.96325342"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 4.96325342-44.5766951
 Parameter: XTRAN <- "-39.6134417"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.538907"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -12.538907-44.5766951
 Parameter: YTRAN <- "-57.1156021"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-17.1851226"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -17.1851226-44.5766951
 Parameter: ZTRAN <- "-61.7618177"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.6134417"
 Parameter: YTRAN -> "-57.1156021"
 Parameter: ZTRAN -> "-61.7618177"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -39.613442  -57.115602  -61.761818
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.222796547"
Evaluating: 0.222796547*360.0
 Parameter: XPHI <- "80.2067569"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.938675672"
Evaluating: 0.938675672*360.0
 Parameter: YPHI <- "337.923242"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.340958025"
Evaluating: 0.340958025*360.0
 Parameter: ZPHI <- "122.744889"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.96325342"
 Parameter: YPOS -> "-12.538907"
 Parameter: ZPOS -> "-17.1851226"
 Parameter: XPHI -> "80.2067569"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.170093    0.985428
    0.000000   -0.985428    0.170093

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   80.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.96325342"
 Parameter: YPOS -> "-12.538907"
 Parameter: ZPOS -> "-17.1851226"
 Parameter: YPHI -> "337.923242"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.926681    0.000000    0.375848
    0.000000    1.000000    0.000000
   -0.375848    0.000000    0.926681

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   22.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.96325342"
 Parameter: YPOS -> "-12.538907"
 Parameter: ZPOS -> "-17.1851226"
 Parameter: ZPHI -> "122.744889"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.540899    0.841087    0.000000
   -0.841087   -0.540899    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  122.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.963253 XMAX =    4.963253 XAVE =    4.963253
    YMIN =  -12.538907 YMAX =  -12.538907 YAVE =  -12.538907
    ZMIN =  -17.185123 ZMAX =  -17.185123 ZAVE =  -17.185123
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.96325343"
Evaluating: 4.96325343+3.5
 Parameter: XMAX <- "8.46325343"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.538907"
Evaluating: -12.538907+3.5
 Parameter: YMAX <- "-9.038907"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-17.1851226"
Evaluating: -17.1851226+3.5
 Parameter: ZMAX <- "-13.6851226"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.96325343"
Evaluating: 4.96325343-3.5
 Parameter: XMIN <- "1.46325343"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.538907"
Evaluating: -12.538907-3.5
 Parameter: YMIN <- "-16.038907"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-17.1851226"
Evaluating: -17.1851226-3.5
 Parameter: ZMIN <- "-20.6851226"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.46325343"
 Parameter: XMIN -> "1.46325343"
 Parameter: YMAX -> "-9.038907"
 Parameter: YMIN -> "-16.038907"
 Parameter: ZMAX -> "-13.6851226"
 Parameter: ZMIN -> "-20.6851226"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "61"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "61" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "61"
Evaluating: 61
 Parameter: J <- "61"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "61" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "3.453249666E-02"
Evaluating: (89.1533903-9.0)*(3.453249666E-02-0.5)
 Parameter: XPOS <- "-37.3087985"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.989481847"
Evaluating: (89.1533903-9.0)*(0.989481847-0.5)
 Parameter: YPOS <- "39.2336295"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.289358868"
Evaluating: (89.1533903-9.0)*(0.289358868-0.5)
 Parameter: ZPOS <- "-16.8836009"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-37.3087985"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -37.3087985-44.5766951
 Parameter: XTRAN <- "-81.8854936"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.2336295"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 39.2336295-44.5766951
 Parameter: YTRAN <- "-5.3430656"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.8836009"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -16.8836009-44.5766951
 Parameter: ZTRAN <- "-61.460296"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-81.8854936"
 Parameter: YTRAN -> "-5.3430656"
 Parameter: ZTRAN -> "-61.460296"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -81.885494   -5.343066  -61.460296
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.35084456"
Evaluating: 0.35084456*360.0
 Parameter: XPHI <- "126.304042"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.551231913"
Evaluating: 0.551231913*360.0
 Parameter: YPHI <- "198.443489"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.118628149"
Evaluating: 0.118628149*360.0
 Parameter: ZPHI <- "42.7061336"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-37.3087985"
 Parameter: YPOS -> "39.2336295"
 Parameter: ZPOS -> "-16.8836009"
 Parameter: XPHI -> "126.304042"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.592070    0.805887
    0.000000   -0.805887   -0.592070

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  126.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-37.3087985"
 Parameter: YPOS -> "39.2336295"
 Parameter: ZPOS -> "-16.8836009"
 Parameter: YPHI -> "198.443489"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.948636    0.000000    0.316369
    0.000000    1.000000    0.000000
   -0.316369    0.000000   -0.948636

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  161.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-37.3087985"
 Parameter: YPOS -> "39.2336295"
 Parameter: ZPOS -> "-16.8836009"
 Parameter: ZPHI -> "42.7061336"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.734842    0.678238    0.000000
   -0.678238    0.734842    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   42.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.308799 XMAX =  -37.308799 XAVE =  -37.308799
    YMIN =   39.233629 YMAX =   39.233629 YAVE =   39.233629
    ZMIN =  -16.883601 ZMAX =  -16.883601 ZAVE =  -16.883601
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-37.3087985"
Evaluating: -37.3087985+3.5
 Parameter: XMAX <- "-33.8087985"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.2336295"
Evaluating: 39.2336295+3.5
 Parameter: YMAX <- "42.7336295"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.8836009"
Evaluating: -16.8836009+3.5
 Parameter: ZMAX <- "-13.3836009"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-37.3087985"
Evaluating: -37.3087985-3.5
 Parameter: XMIN <- "-40.8087985"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.2336295"
Evaluating: 39.2336295-3.5
 Parameter: YMIN <- "35.7336295"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.8836009"
Evaluating: -16.8836009-3.5
 Parameter: ZMIN <- "-20.3836009"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.8087985"
 Parameter: XMIN -> "-40.8087985"
 Parameter: YMAX -> "42.7336295"
 Parameter: YMIN -> "35.7336295"
 Parameter: ZMAX -> "-13.3836009"
 Parameter: ZMIN -> "-20.3836009"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "62"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "62" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "62"
Evaluating: 62
 Parameter: J <- "62"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "62" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.524939221"
Evaluating: (89.1533903-9.0)*(0.524939221-0.5)
 Parameter: XPOS <- "1.99896311"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.230867449"
Evaluating: (89.1533903-9.0)*(0.230867449-0.5)
 Parameter: YPOS <- "-21.5718864"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.882739927"
Evaluating: (89.1533903-9.0)*(0.882739927-0.5)
 Parameter: ZPOS <- "30.6779028"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "1.99896311"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 1.99896311-44.5766951
 Parameter: XTRAN <- "-42.577732"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.5718864"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -21.5718864-44.5766951
 Parameter: YTRAN <- "-66.1485815"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.6779028"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 30.6779028-44.5766951
 Parameter: ZTRAN <- "-13.8987923"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-42.577732"
 Parameter: YTRAN -> "-66.1485815"
 Parameter: ZTRAN -> "-13.8987923"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -42.577732  -66.148582  -13.898792
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.335922374"
Evaluating: 0.335922374*360.0
 Parameter: XPHI <- "120.932055"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.846264098"
Evaluating: 0.846264098*360.0
 Parameter: YPHI <- "304.655075"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.945128183"
Evaluating: 0.945128183*360.0
 Parameter: ZPHI <- "340.246146"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "1.99896311"
 Parameter: YPOS -> "-21.5718864"
 Parameter: ZPOS -> "30.6779028"
 Parameter: XPHI -> "120.932055"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.514021    0.857777
    0.000000   -0.857777   -0.514021

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  120.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "1.99896311"
 Parameter: YPOS -> "-21.5718864"
 Parameter: ZPOS -> "30.6779028"
 Parameter: YPHI -> "304.655075"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.568635    0.000000    0.822590
    0.000000    1.000000    0.000000
   -0.822590    0.000000    0.568635

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   55.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "1.99896311"
 Parameter: YPOS -> "-21.5718864"
 Parameter: ZPOS -> "30.6779028"
 Parameter: ZPHI -> "340.246146"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.941153   -0.337980    0.000000
    0.337980    0.941153    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   19.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    1.998963 XMAX =    1.998963 XAVE =    1.998963
    YMIN =  -21.571886 YMAX =  -21.571886 YAVE =  -21.571886
    ZMIN =   30.677903 ZMAX =   30.677903 ZAVE =   30.677903
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "1.9989631"
Evaluating: 1.9989631+3.5
 Parameter: XMAX <- "5.4989631"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.5718864"
Evaluating: -21.5718864+3.5
 Parameter: YMAX <- "-18.0718864"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.6779028"
Evaluating: 30.6779028+3.5
 Parameter: ZMAX <- "34.1779028"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "1.9989631"
Evaluating: 1.9989631-3.5
 Parameter: XMIN <- "-1.5010369"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.5718864"
Evaluating: -21.5718864-3.5
 Parameter: YMIN <- "-25.0718864"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.6779028"
Evaluating: 30.6779028-3.5
 Parameter: ZMIN <- "27.1779028"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "5.4989631"
 Parameter: XMIN -> "-1.5010369"
 Parameter: YMAX -> "-18.0718864"
 Parameter: YMIN -> "-25.0718864"
 Parameter: ZMAX -> "34.1779028"
 Parameter: ZMIN -> "27.1779028"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "63"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "63" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "63"
Evaluating: 63
 Parameter: J <- "63"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "63" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.506152743"
Evaluating: (89.1533903-9.0)*(0.506152743-0.5)
 Parameter: XPOS <- "0.493163211"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.762065391"
Evaluating: (89.1533903-9.0)*(0.762065391-0.5)
 Parameter: YPOS <- "21.0054296"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.893679599"
Evaluating: (89.1533903-9.0)*(0.893679599-0.5)
 Parameter: ZPOS <- "31.5547546"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.493163211"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 0.493163211-44.5766951
 Parameter: XTRAN <- "-44.0835319"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "21.0054296"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 21.0054296-44.5766951
 Parameter: YTRAN <- "-23.5712655"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.5547546"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 31.5547546-44.5766951
 Parameter: ZTRAN <- "-13.0219405"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.0835319"
 Parameter: YTRAN -> "-23.5712655"
 Parameter: ZTRAN -> "-13.0219405"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -44.083532  -23.571265  -13.021940
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.761903429"
Evaluating: 0.761903429*360.0
 Parameter: XPHI <- "274.285234"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.841798654"
Evaluating: 0.841798654*360.0
 Parameter: YPHI <- "303.047515"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.487503747E-02"
Evaluating: 1.487503747E-02*360.0
 Parameter: ZPHI <- "5.35501349"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.493163211"
 Parameter: YPOS -> "21.0054296"
 Parameter: ZPOS -> "31.5547546"
 Parameter: XPHI -> "274.285234"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.074722   -0.997204
    0.000000    0.997204    0.074722

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   85.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.493163211"
 Parameter: YPOS -> "21.0054296"
 Parameter: ZPOS -> "31.5547546"
 Parameter: YPHI -> "303.047515"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.545334    0.000000    0.838219
    0.000000    1.000000    0.000000
   -0.838219    0.000000    0.545334

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   56.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.493163211"
 Parameter: YPOS -> "21.0054296"
 Parameter: ZPOS -> "31.5547546"
 Parameter: ZPHI -> "5.35501349"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.995636    0.093327    0.000000
   -0.093327    0.995636    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    5.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.493163 XMAX =    0.493163 XAVE =    0.493163
    YMIN =   21.005430 YMAX =   21.005430 YAVE =   21.005430
    ZMIN =   31.554755 ZMAX =   31.554755 ZAVE =   31.554755
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.493163205"
Evaluating: 0.493163205+3.5
 Parameter: XMAX <- "3.99316321"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "21.0054296"
Evaluating: 21.0054296+3.5
 Parameter: YMAX <- "24.5054296"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.5547546"
Evaluating: 31.5547546+3.5
 Parameter: ZMAX <- "35.0547546"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.493163205"
Evaluating: 0.493163205-3.5
 Parameter: XMIN <- "-3.00683679"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "21.0054296"
Evaluating: 21.0054296-3.5
 Parameter: YMIN <- "17.5054296"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.5547546"
Evaluating: 31.5547546-3.5
 Parameter: ZMIN <- "28.0547546"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.99316321"
 Parameter: XMIN -> "-3.00683679"
 Parameter: YMAX -> "24.5054296"
 Parameter: YMIN -> "17.5054296"
 Parameter: ZMAX -> "35.0547546"
 Parameter: ZMIN -> "28.0547546"
 SELRPN>      2 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      0 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "64"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "64" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "64"
Evaluating: 64
 Parameter: J <- "64"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "64" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.615598567"
Evaluating: (89.1533903-9.0)*(0.615598567-0.5)
 Parameter: XPOS <- "9.26561706"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.85725898"
Evaluating: (89.1533903-9.0)*(0.85725898-0.5)
 Parameter: YPOS <- "28.6355185"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.85843341"
Evaluating: (89.1533903-9.0)*(0.85843341-0.5)
 Parameter: ZPOS <- "28.729653"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.26561706"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 9.26561706-44.5766951
 Parameter: XTRAN <- "-35.311078"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.6355185"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 28.6355185-44.5766951
 Parameter: YTRAN <- "-15.9411766"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.729653"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 28.729653-44.5766951
 Parameter: ZTRAN <- "-15.8470421"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-35.311078"
 Parameter: YTRAN -> "-15.9411766"
 Parameter: ZTRAN -> "-15.8470421"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -35.311078  -15.941177  -15.847042
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.372001852"
Evaluating: 0.372001852*360.0
 Parameter: XPHI <- "133.920667"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.608054327E-02"
Evaluating: 8.608054327E-02*360.0
 Parameter: YPHI <- "30.9889956"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.246732266"
Evaluating: 0.246732266*360.0
 Parameter: ZPHI <- "88.8236158"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.26561706"
 Parameter: YPOS -> "28.6355185"
 Parameter: ZPOS -> "28.729653"
 Parameter: XPHI -> "133.920667"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.693662    0.720301
    0.000000   -0.720301   -0.693662

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  133.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.26561706"
 Parameter: YPOS -> "28.6355185"
 Parameter: ZPOS -> "28.729653"
 Parameter: YPHI -> "30.9889956"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.857266    0.000000   -0.514873
    0.000000    1.000000    0.000000
    0.514873    0.000000    0.857266

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   30.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.26561706"
 Parameter: YPOS -> "28.6355185"
 Parameter: ZPOS -> "28.729653"
 Parameter: ZPHI -> "88.8236158"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.020530    0.999789    0.000000
   -0.999789    0.020530    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   88.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.265617 XMAX =    9.265617 XAVE =    9.265617
    YMIN =   28.635518 YMAX =   28.635518 YAVE =   28.635518
    ZMIN =   28.729653 ZMAX =   28.729653 ZAVE =   28.729653
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.26561706"
Evaluating: 9.26561706+3.5
 Parameter: XMAX <- "12.7656171"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.6355185"
Evaluating: 28.6355185+3.5
 Parameter: YMAX <- "32.1355185"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.729653"
Evaluating: 28.729653+3.5
 Parameter: ZMAX <- "32.229653"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.26561706"
Evaluating: 9.26561706-3.5
 Parameter: XMIN <- "5.76561706"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.6355185"
Evaluating: 28.6355185-3.5
 Parameter: YMIN <- "25.1355185"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.729653"
Evaluating: 28.729653-3.5
 Parameter: ZMIN <- "25.229653"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.7656171"
 Parameter: XMIN -> "5.76561706"
 Parameter: YMAX -> "32.1355185"
 Parameter: YMIN -> "25.1355185"
 Parameter: ZMAX -> "32.229653"
 Parameter: ZMIN -> "25.229653"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "65"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "65" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "65"
Evaluating: 65
 Parameter: J <- "65"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "65" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.127403642"
Evaluating: (89.1533903-9.0)*(0.127403642-0.5)
 Parameter: XPOS <- "-29.8648613"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.460566469"
Evaluating: (89.1533903-9.0)*(0.460566469-0.5)
 Parameter: YPOS <- "-3.1607312"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.988113632"
Evaluating: (89.1533903-9.0)*(0.988113632-0.5)
 Parameter: ZPOS <- "39.1239625"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.8648613"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -29.8648613-44.5766951
 Parameter: XTRAN <- "-74.4415564"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.1607312"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -3.1607312-44.5766951
 Parameter: YTRAN <- "-47.7374263"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.1239625"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 39.1239625-44.5766951
 Parameter: ZTRAN <- "-5.4527326"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-74.4415564"
 Parameter: YTRAN -> "-47.7374263"
 Parameter: ZTRAN -> "-5.4527326"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -74.441556  -47.737426   -5.452733
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.281433362"
Evaluating: 0.281433362*360.0
 Parameter: XPHI <- "101.31601"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.973885734"
Evaluating: 0.973885734*360.0
 Parameter: YPHI <- "350.598864"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.85399547"
Evaluating: 0.85399547*360.0
 Parameter: ZPHI <- "307.438369"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.8648613"
 Parameter: YPOS -> "-3.1607312"
 Parameter: ZPOS -> "39.1239625"
 Parameter: XPHI -> "101.31601"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.196220    0.980560
    0.000000   -0.980560   -0.196220

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  101.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.8648613"
 Parameter: YPOS -> "-3.1607312"
 Parameter: ZPOS -> "39.1239625"
 Parameter: YPHI -> "350.598864"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.986569    0.000000    0.163346
    0.000000    1.000000    0.000000
   -0.163346    0.000000    0.986569

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    9.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.8648613"
 Parameter: YPOS -> "-3.1607312"
 Parameter: ZPOS -> "39.1239625"
 Parameter: ZPHI -> "307.438369"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.607908   -0.794008    0.000000
    0.794008    0.607908    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   52.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.864861 XMAX =  -29.864861 XAVE =  -29.864861
    YMIN =   -3.160731 YMAX =   -3.160731 YAVE =   -3.160731
    ZMIN =   39.123962 ZMAX =   39.123962 ZAVE =   39.123962
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.8648613"
Evaluating: -29.8648613+3.5
 Parameter: XMAX <- "-26.3648613"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.1607312"
Evaluating: -3.1607312+3.5
 Parameter: YMAX <- "0.3392688"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.1239625"
Evaluating: 39.1239625+3.5
 Parameter: ZMAX <- "42.6239625"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.8648613"
Evaluating: -29.8648613-3.5
 Parameter: XMIN <- "-33.3648613"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.1607312"
Evaluating: -3.1607312-3.5
 Parameter: YMIN <- "-6.6607312"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.1239625"
Evaluating: 39.1239625-3.5
 Parameter: ZMIN <- "35.6239625"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.3648613"
 Parameter: XMIN -> "-33.3648613"
 Parameter: YMAX -> "0.3392688"
 Parameter: YMIN -> "-6.6607312"
 Parameter: ZMAX -> "42.6239625"
 Parameter: ZMIN -> "35.6239625"
 SELRPN>      2 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      1 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "66"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "66" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "66"
Evaluating: 66
 Parameter: J <- "66"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "66" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.664788917"
Evaluating: (89.1533903-9.0)*(0.664788917-0.5)
 Parameter: XPOS <- "13.2083904"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.948325761"
Evaluating: (89.1533903-9.0)*(0.948325761-0.5)
 Parameter: YPOS <- "35.9348297"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.162606918"
Evaluating: (89.1533903-9.0)*(0.162606918-0.5)
 Parameter: ZPOS <- "-27.0431994"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "13.2083904"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 13.2083904-44.5766951
 Parameter: XTRAN <- "-31.3683047"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.9348297"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 35.9348297-44.5766951
 Parameter: YTRAN <- "-8.6418654"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.0431994"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -27.0431994-44.5766951
 Parameter: ZTRAN <- "-71.6198945"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.3683047"
 Parameter: YTRAN -> "-8.6418654"
 Parameter: ZTRAN -> "-71.6198945"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -31.368305   -8.641865  -71.619895
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.64755299E-02"
Evaluating: 4.64755299E-02*360.0
 Parameter: XPHI <- "16.7311908"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.217492568E-02"
Evaluating: 9.217492568E-02*360.0
 Parameter: YPHI <- "33.1829732"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.336634923"
Evaluating: 0.336634923*360.0
 Parameter: ZPHI <- "121.188572"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "13.2083904"
 Parameter: YPOS -> "35.9348297"
 Parameter: ZPOS -> "-27.0431994"
 Parameter: XPHI -> "16.7311908"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.957666    0.287882
    0.000000   -0.287882    0.957666

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   16.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "13.2083904"
 Parameter: YPOS -> "35.9348297"
 Parameter: ZPOS -> "-27.0431994"
 Parameter: YPHI -> "33.1829732"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.836927    0.000000   -0.547315
    0.000000    1.000000    0.000000
    0.547315    0.000000    0.836927

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   33.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "13.2083904"
 Parameter: YPOS -> "35.9348297"
 Parameter: ZPOS -> "-27.0431994"
 Parameter: ZPHI -> "121.188572"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.517856    0.855468    0.000000
   -0.855468   -0.517856    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  121.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   13.208390 XMAX =   13.208390 XAVE =   13.208390
    YMIN =   35.934830 YMAX =   35.934830 YAVE =   35.934830
    ZMIN =  -27.043199 ZMAX =  -27.043199 ZAVE =  -27.043199
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "13.2083904"
Evaluating: 13.2083904+3.5
 Parameter: XMAX <- "16.7083904"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.9348297"
Evaluating: 35.9348297+3.5
 Parameter: YMAX <- "39.4348297"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.0431994"
Evaluating: -27.0431994+3.5
 Parameter: ZMAX <- "-23.5431994"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "13.2083904"
Evaluating: 13.2083904-3.5
 Parameter: XMIN <- "9.7083904"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.9348297"
Evaluating: 35.9348297-3.5
 Parameter: YMIN <- "32.4348297"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.0431994"
Evaluating: -27.0431994-3.5
 Parameter: ZMIN <- "-30.5431994"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.7083904"
 Parameter: XMIN -> "9.7083904"
 Parameter: YMAX -> "39.4348297"
 Parameter: YMIN -> "32.4348297"
 Parameter: ZMAX -> "-23.5431994"
 Parameter: ZMIN -> "-30.5431994"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "67"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "67" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "67"
Evaluating: 67
 Parameter: J <- "67"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "67" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.493905019"
Evaluating: (89.1533903-9.0)*(0.493905019-0.5)
 Parameter: XPOS <- "-0.488533391"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.467079441"
Evaluating: (89.1533903-9.0)*(0.467079441-0.5)
 Parameter: YPOS <- "-2.63869441"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.379651654"
Evaluating: (89.1533903-9.0)*(0.379651654-0.5)
 Parameter: ZPOS <- "-9.64632795"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.488533391"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -0.488533391-44.5766951
 Parameter: XTRAN <- "-45.0652285"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.63869441"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -2.63869441-44.5766951
 Parameter: YTRAN <- "-47.2153895"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-9.64632795"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -9.64632795-44.5766951
 Parameter: ZTRAN <- "-54.2230231"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-45.0652285"
 Parameter: YTRAN -> "-47.2153895"
 Parameter: ZTRAN -> "-54.2230231"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -45.065229  -47.215390  -54.223023
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.64866552"
Evaluating: 0.64866552*360.0
 Parameter: XPHI <- "233.519587"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.19204304"
Evaluating: 0.19204304*360.0
 Parameter: YPHI <- "69.1354944"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.816220075"
Evaluating: 0.816220075*360.0
 Parameter: ZPHI <- "293.839227"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.488533391"
 Parameter: YPOS -> "-2.63869441"
 Parameter: ZPOS -> "-9.64632795"
 Parameter: XPHI -> "233.519587"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.594548   -0.804060
    0.000000    0.804060   -0.594548

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  126.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.488533391"
 Parameter: YPOS -> "-2.63869441"
 Parameter: ZPOS -> "-9.64632795"
 Parameter: YPHI -> "69.1354944"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.356159    0.000000   -0.934425
    0.000000    1.000000    0.000000
    0.934425    0.000000    0.356159

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   69.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.488533391"
 Parameter: YPOS -> "-2.63869441"
 Parameter: ZPOS -> "-9.64632795"
 Parameter: ZPHI -> "293.839227"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.404172   -0.914683    0.000000
    0.914683    0.404172    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   66.16

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.488533 XMAX =   -0.488533 XAVE =   -0.488533
    YMIN =   -2.638694 YMAX =   -2.638694 YAVE =   -2.638694
    ZMIN =   -9.646328 ZMAX =   -9.646328 ZAVE =   -9.646328
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.488533438"
Evaluating: -0.488533438+3.5
 Parameter: XMAX <- "3.01146656"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.63869443"
Evaluating: -2.63869443+3.5
 Parameter: YMAX <- "0.86130557"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-9.64632794"
Evaluating: -9.64632794+3.5
 Parameter: ZMAX <- "-6.14632794"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.488533438"
Evaluating: -0.488533438-3.5
 Parameter: XMIN <- "-3.98853344"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.63869443"
Evaluating: -2.63869443-3.5
 Parameter: YMIN <- "-6.13869443"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-9.64632794"
Evaluating: -9.64632794-3.5
 Parameter: ZMIN <- "-13.1463279"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.01146656"
 Parameter: XMIN -> "-3.98853344"
 Parameter: YMAX -> "0.86130557"
 Parameter: YMIN -> "-6.13869443"
 Parameter: ZMAX -> "-6.14632794"
 Parameter: ZMIN -> "-13.1463279"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "68"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "68" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "68"
Evaluating: 68
 Parameter: J <- "68"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "68" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.613321282"
Evaluating: (89.1533903-9.0)*(0.613321282-0.5)
 Parameter: XPOS <- "9.08308495"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.649690538"
Evaluating: (89.1533903-9.0)*(0.649690538-0.5)
 Parameter: YPOS <- "11.9982041"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.826511311"
Evaluating: (89.1533903-9.0)*(0.826511311-0.5)
 Parameter: ZPOS <- "26.1709885"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.08308495"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 9.08308495-44.5766951
 Parameter: XTRAN <- "-35.4936102"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.9982041"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 11.9982041-44.5766951
 Parameter: YTRAN <- "-32.578491"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.1709885"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 26.1709885-44.5766951
 Parameter: ZTRAN <- "-18.4057066"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-35.4936102"
 Parameter: YTRAN -> "-32.578491"
 Parameter: ZTRAN -> "-18.4057066"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -35.493610  -32.578491  -18.405707
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.732425036"
Evaluating: 0.732425036*360.0
 Parameter: XPHI <- "263.673013"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.876358362"
Evaluating: 0.876358362*360.0
 Parameter: YPHI <- "315.48901"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.401811948"
Evaluating: 0.401811948*360.0
 Parameter: ZPHI <- "144.652301"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.08308495"
 Parameter: YPOS -> "11.9982041"
 Parameter: ZPOS -> "26.1709885"
 Parameter: XPHI -> "263.673013"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.110202   -0.993909
    0.000000    0.993909   -0.110202

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   96.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.08308495"
 Parameter: YPOS -> "11.9982041"
 Parameter: ZPOS -> "26.1709885"
 Parameter: YPHI -> "315.48901"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.713116    0.000000    0.701046
    0.000000    1.000000    0.000000
   -0.701046    0.000000    0.713116

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   44.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.08308495"
 Parameter: YPOS -> "11.9982041"
 Parameter: ZPOS -> "26.1709885"
 Parameter: ZPHI -> "144.652301"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.815656    0.578537    0.000000
   -0.578537   -0.815656    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  144.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.083085 XMAX =    9.083085 XAVE =    9.083085
    YMIN =   11.998204 YMAX =   11.998204 YAVE =   11.998204
    ZMIN =   26.170989 ZMAX =   26.170989 ZAVE =   26.170989
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.08308498"
Evaluating: 9.08308498+3.5
 Parameter: XMAX <- "12.583085"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.9982041"
Evaluating: 11.9982041+3.5
 Parameter: YMAX <- "15.4982041"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.1709885"
Evaluating: 26.1709885+3.5
 Parameter: ZMAX <- "29.6709885"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.08308498"
Evaluating: 9.08308498-3.5
 Parameter: XMIN <- "5.58308498"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.9982041"
Evaluating: 11.9982041-3.5
 Parameter: YMIN <- "8.4982041"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.1709885"
Evaluating: 26.1709885-3.5
 Parameter: ZMIN <- "22.6709885"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.583085"
 Parameter: XMIN -> "5.58308498"
 Parameter: YMAX -> "15.4982041"
 Parameter: YMIN -> "8.4982041"
 Parameter: ZMAX -> "29.6709885"
 Parameter: ZMIN -> "22.6709885"
 SELRPN>     16 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "16"
 Comparing "16" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      7 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9170 POS      SOD      68       SOD     -7367 PAA2     GLN      215      N             3.7054
 9170 POS      SOD      68       SOD     -7369 PAA2     GLN      215      CA            3.3707
 9170 POS      SOD      68       SOD     -7371 PAA2     GLN      215      CB            3.1903
 9170 POS      SOD      68       SOD     -7374 PAA2     GLN      215      CG            2.1092
 9170 POS      SOD      68       SOD     -7377 PAA2     GLN      215      CD            3.1819
 9170 POS      SOD      68       SOD     -7378 PAA2     GLN      215      OE1           4.3119
 9170 POS      SOD      68       SOD     -7379 PAA2     GLN      215      NE2           3.3329
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "68"
Evaluating: 68
 Parameter: J <- "68"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "68" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.890262134"
Evaluating: (89.1533903-9.0)*(0.890262134-0.5)
 Parameter: XPOS <- "31.2808331"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.581333459"
Evaluating: (89.1533903-9.0)*(0.581333459-0.5)
 Parameter: YPOS <- "6.51915248"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.513646462"
Evaluating: (89.1533903-9.0)*(0.513646462-0.5)
 Parameter: ZPOS <- "1.09381019"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.083085 XMAX =    9.083085 XAVE =    9.083085
    YMIN =   11.998204 YMAX =   11.998204 YAVE =   11.998204
    ZMIN =   26.170989 ZMAX =   26.170989 ZAVE =   26.170989
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.2808331"
 RDCMND substituted energy or value "?XAVE" to "9.08308498"
Evaluating: 31.2808331-9.08308498
 Parameter: XTRAN <- "22.1977481"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.51915248"
 RDCMND substituted energy or value "?YAVE" to "11.9982041"
Evaluating: 6.51915248-11.9982041
 Parameter: YTRAN <- "-5.47905162"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "1.09381019"
 RDCMND substituted energy or value "?ZAVE" to "26.1709885"
Evaluating: 1.09381019-26.1709885
 Parameter: ZTRAN <- "-25.0771783"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "22.1977481"
 Parameter: YTRAN -> "-5.47905162"
 Parameter: ZTRAN -> "-25.0771783"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    22.197748   -5.479052  -25.077178
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.694716094"
Evaluating: 0.694716094*360.0
 Parameter: XPHI <- "250.097794"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.199852554"
Evaluating: 0.199852554*360.0
 Parameter: YPHI <- "71.9469194"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.199630685"
Evaluating: 0.199630685*360.0
 Parameter: ZPHI <- "71.8670466"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.2808331"
 Parameter: YPOS -> "6.51915248"
 Parameter: ZPOS -> "1.09381019"
 Parameter: XPHI -> "250.097794"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.340416   -0.940275
    0.000000    0.940275   -0.340416

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  109.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.2808331"
 Parameter: YPOS -> "6.51915248"
 Parameter: ZPOS -> "1.09381019"
 Parameter: YPHI -> "71.9469194"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.309898    0.000000   -0.950770
    0.000000    1.000000    0.000000
    0.950770    0.000000    0.309898

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   71.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.2808331"
 Parameter: YPOS -> "6.51915248"
 Parameter: ZPOS -> "1.09381019"
 Parameter: ZPHI -> "71.8670466"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.311223    0.950337    0.000000
   -0.950337    0.311223    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   71.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.280833 XMAX =   31.280833 XAVE =   31.280833
    YMIN =    6.519152 YMAX =    6.519152 YAVE =    6.519152
    ZMIN =    1.093810 ZMAX =    1.093810 ZAVE =    1.093810
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.280833"
Evaluating: 31.280833+3.5
 Parameter: XMAX <- "34.780833"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.51915247"
Evaluating: 6.51915247+3.5
 Parameter: YMAX <- "10.0191525"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "1.09381017"
Evaluating: 1.09381017+3.5
 Parameter: ZMAX <- "4.59381017"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.280833"
Evaluating: 31.280833-3.5
 Parameter: XMIN <- "27.780833"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.51915247"
Evaluating: 6.51915247-3.5
 Parameter: YMIN <- "3.01915247"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "1.09381017"
Evaluating: 1.09381017-3.5
 Parameter: ZMIN <- "-2.40618983"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.780833"
 Parameter: XMIN -> "27.780833"
 Parameter: YMAX -> "10.0191525"
 Parameter: YMIN -> "3.01915247"
 Parameter: ZMAX -> "4.59381017"
 Parameter: ZMIN -> "-2.40618983"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "69"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "69" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "69"
Evaluating: 69
 Parameter: J <- "69"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "69" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "69"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.472787298"
Evaluating: (89.1533903-9.0)*(0.472787298-0.5)
 Parameter: XPOS <- "-2.18119032"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.206889305"
Evaluating: (89.1533903-9.0)*(0.206889305-0.5)
 Parameter: YPOS <- "-23.4938159"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "7.166696086E-02"
Evaluating: (89.1533903-9.0)*(7.166696086E-02-0.5)
 Parameter: ZPOS <- "-34.3323453"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.18119032"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -2.18119032-44.5766951
 Parameter: XTRAN <- "-46.7578854"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.4938159"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -23.4938159-44.5766951
 Parameter: YTRAN <- "-68.070511"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.3323453"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -34.3323453-44.5766951
 Parameter: ZTRAN <- "-78.9090404"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-46.7578854"
 Parameter: YTRAN -> "-68.070511"
 Parameter: ZTRAN -> "-78.9090404"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -46.757885  -68.070511  -78.909040
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.508813878"
Evaluating: 0.508813878*360.0
 Parameter: XPHI <- "183.172996"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.737312589"
Evaluating: 0.737312589*360.0
 Parameter: YPHI <- "265.432532"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.502490923"
Evaluating: 0.502490923*360.0
 Parameter: ZPHI <- "180.896732"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.18119032"
 Parameter: YPOS -> "-23.4938159"
 Parameter: ZPOS -> "-34.3323453"
 Parameter: XPHI -> "183.172996"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.998467   -0.055351
    0.000000    0.055351   -0.998467

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  176.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.18119032"
 Parameter: YPOS -> "-23.4938159"
 Parameter: ZPOS -> "-34.3323453"
 Parameter: YPHI -> "265.432532"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.079633    0.000000    0.996824
    0.000000    1.000000    0.000000
   -0.996824    0.000000   -0.079633

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   94.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.18119032"
 Parameter: YPOS -> "-23.4938159"
 Parameter: ZPOS -> "-34.3323453"
 Parameter: ZPHI -> "180.896732"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.999878   -0.015650    0.000000
    0.015650   -0.999878    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  179.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.181190 XMAX =   -2.181190 XAVE =   -2.181190
    YMIN =  -23.493816 YMAX =  -23.493816 YAVE =  -23.493816
    ZMIN =  -34.332345 ZMAX =  -34.332345 ZAVE =  -34.332345
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.18119032"
Evaluating: -2.18119032+3.5
 Parameter: XMAX <- "1.31880968"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.4938159"
Evaluating: -23.4938159+3.5
 Parameter: YMAX <- "-19.9938159"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.3323453"
Evaluating: -34.3323453+3.5
 Parameter: ZMAX <- "-30.8323453"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.18119032"
Evaluating: -2.18119032-3.5
 Parameter: XMIN <- "-5.68119032"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.4938159"
Evaluating: -23.4938159-3.5
 Parameter: YMIN <- "-26.9938159"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.3323453"
Evaluating: -34.3323453-3.5
 Parameter: ZMIN <- "-37.8323453"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.31880968"
 Parameter: XMIN -> "-5.68119032"
 Parameter: YMAX -> "-19.9938159"
 Parameter: YMIN -> "-26.9938159"
 Parameter: ZMAX -> "-30.8323453"
 Parameter: ZMIN -> "-37.8323453"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "70"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "70" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "70"
Evaluating: 70
 Parameter: J <- "70"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "70" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "70"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.635002327"
Evaluating: (89.1533903-9.0)*(0.635002327-0.5)
 Parameter: XPOS <- "10.8208942"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.141498125"
Evaluating: (89.1533903-9.0)*(0.141498125-0.5)
 Parameter: YPOS <- "-28.7351407"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.990293982"
Evaluating: (89.1533903-9.0)*(0.990293982-0.5)
 Parameter: ZPOS <- "39.2987249"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.8208942"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 10.8208942-44.5766951
 Parameter: XTRAN <- "-33.7558009"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.7351407"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -28.7351407-44.5766951
 Parameter: YTRAN <- "-73.3118358"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.2987249"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 39.2987249-44.5766951
 Parameter: ZTRAN <- "-5.2779702"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.7558009"
 Parameter: YTRAN -> "-73.3118358"
 Parameter: ZTRAN -> "-5.2779702"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -33.755801  -73.311836   -5.277970
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.692349704"
Evaluating: 0.692349704*360.0
 Parameter: XPHI <- "249.245893"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.203082091"
Evaluating: 0.203082091*360.0
 Parameter: YPHI <- "73.1095528"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.906360898"
Evaluating: 0.906360898*360.0
 Parameter: ZPHI <- "326.289923"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.8208942"
 Parameter: YPOS -> "-28.7351407"
 Parameter: ZPOS -> "39.2987249"
 Parameter: XPHI -> "249.245893"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.354358   -0.935110
    0.000000    0.935110   -0.354358

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  110.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.8208942"
 Parameter: YPOS -> "-28.7351407"
 Parameter: ZPOS -> "39.2987249"
 Parameter: YPHI -> "73.1095528"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.290543    0.000000   -0.956862
    0.000000    1.000000    0.000000
    0.956862    0.000000    0.290543

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   73.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.8208942"
 Parameter: YPOS -> "-28.7351407"
 Parameter: ZPOS -> "39.2987249"
 Parameter: ZPHI -> "326.289923"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.831857   -0.554991    0.000000
    0.554991    0.831857    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   33.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.820894 XMAX =   10.820894 XAVE =   10.820894
    YMIN =  -28.735141 YMAX =  -28.735141 YAVE =  -28.735141
    ZMIN =   39.298725 ZMAX =   39.298725 ZAVE =   39.298725
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.8208942"
Evaluating: 10.8208942+3.5
 Parameter: XMAX <- "14.3208942"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.7351407"
Evaluating: -28.7351407+3.5
 Parameter: YMAX <- "-25.2351407"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.2987249"
Evaluating: 39.2987249+3.5
 Parameter: ZMAX <- "42.7987249"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.8208942"
Evaluating: 10.8208942-3.5
 Parameter: XMIN <- "7.3208942"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.7351407"
Evaluating: -28.7351407-3.5
 Parameter: YMIN <- "-32.2351407"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.2987249"
Evaluating: 39.2987249-3.5
 Parameter: ZMIN <- "35.7987249"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.3208942"
 Parameter: XMIN -> "7.3208942"
 Parameter: YMAX -> "-25.2351407"
 Parameter: YMIN -> "-32.2351407"
 Parameter: ZMAX -> "42.7987249"
 Parameter: ZMIN -> "35.7987249"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "71"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "71" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "71"
Evaluating: 71
 Parameter: J <- "71"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "71" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "71"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.218547781"
Evaluating: (89.1533903-9.0)*(0.218547781-0.5)
 Parameter: XPOS <- "-22.5593496"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.276844398"
Evaluating: (89.1533903-9.0)*(0.276844398-0.5)
 Parameter: YPOS <- "-17.8866781"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.832634825"
Evaluating: (89.1533903-9.0)*(0.832634825-0.5)
 Parameter: ZPOS <- "26.661809"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.5593496"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -22.5593496-44.5766951
 Parameter: XTRAN <- "-67.1360447"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-17.8866781"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -17.8866781-44.5766951
 Parameter: YTRAN <- "-62.4633732"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.661809"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 26.661809-44.5766951
 Parameter: ZTRAN <- "-17.9148861"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-67.1360447"
 Parameter: YTRAN -> "-62.4633732"
 Parameter: ZTRAN -> "-17.9148861"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -67.136045  -62.463373  -17.914886
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.344673789"
Evaluating: 0.344673789*360.0
 Parameter: XPHI <- "124.082564"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.774013574"
Evaluating: 0.774013574*360.0
 Parameter: YPHI <- "278.644887"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.313244527"
Evaluating: 0.313244527*360.0
 Parameter: ZPHI <- "112.76803"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.5593496"
 Parameter: YPOS -> "-17.8866781"
 Parameter: ZPOS -> "26.661809"
 Parameter: XPHI -> "124.082564"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.560387    0.828231
    0.000000   -0.828231   -0.560387

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  124.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.5593496"
 Parameter: YPOS -> "-17.8866781"
 Parameter: ZPOS -> "26.661809"
 Parameter: YPHI -> "278.644887"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.150310    0.000000    0.988639
    0.000000    1.000000    0.000000
   -0.988639    0.000000    0.150310

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   81.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.5593496"
 Parameter: YPOS -> "-17.8866781"
 Parameter: ZPOS -> "26.661809"
 Parameter: ZPHI -> "112.76803"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.387001    0.922079    0.000000
   -0.922079   -0.387001    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  112.77

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.559350 XMAX =  -22.559350 XAVE =  -22.559350
    YMIN =  -17.886678 YMAX =  -17.886678 YAVE =  -17.886678
    ZMIN =   26.661809 ZMAX =   26.661809 ZAVE =   26.661809
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.5593496"
Evaluating: -22.5593496+3.5
 Parameter: XMAX <- "-19.0593496"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-17.8866781"
Evaluating: -17.8866781+3.5
 Parameter: YMAX <- "-14.3866781"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.661809"
Evaluating: 26.661809+3.5
 Parameter: ZMAX <- "30.161809"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.5593496"
Evaluating: -22.5593496-3.5
 Parameter: XMIN <- "-26.0593496"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-17.8866781"
Evaluating: -17.8866781-3.5
 Parameter: YMIN <- "-21.3866781"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.661809"
Evaluating: 26.661809-3.5
 Parameter: ZMIN <- "23.161809"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.0593496"
 Parameter: XMIN -> "-26.0593496"
 Parameter: YMAX -> "-14.3866781"
 Parameter: YMIN -> "-21.3866781"
 Parameter: ZMAX -> "30.161809"
 Parameter: ZMIN -> "23.161809"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "72"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "72" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "72"
Evaluating: 72
 Parameter: J <- "72"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "72" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "72"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.471219823"
Evaluating: (89.1533903-9.0)*(0.471219823-0.5)
 Parameter: XPOS <- "-2.30682876"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.834963495"
Evaluating: (89.1533903-9.0)*(0.834963495-0.5)
 Parameter: YPOS <- "26.8484598"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.928380621"
Evaluating: (89.1533903-9.0)*(0.928380621-0.5)
 Parameter: ZPOS <- "34.3361591"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-2.30682876"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -2.30682876-44.5766951
 Parameter: XTRAN <- "-46.8835239"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "26.8484598"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 26.8484598-44.5766951
 Parameter: YTRAN <- "-17.7282353"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.3361591"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 34.3361591-44.5766951
 Parameter: ZTRAN <- "-10.240536"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-46.8835239"
 Parameter: YTRAN -> "-17.7282353"
 Parameter: ZTRAN -> "-10.240536"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -46.883524  -17.728235  -10.240536
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.314245948"
Evaluating: 0.314245948*360.0
 Parameter: XPHI <- "113.128541"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "4.887473615E-02"
Evaluating: 4.887473615E-02*360.0
 Parameter: YPHI <- "17.594905"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.324706227"
Evaluating: 0.324706227*360.0
 Parameter: ZPHI <- "116.894242"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-2.30682876"
 Parameter: YPOS -> "26.8484598"
 Parameter: ZPOS -> "34.3361591"
 Parameter: XPHI -> "113.128541"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.392795    0.919626
    0.000000   -0.919626   -0.392795

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  113.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-2.30682876"
 Parameter: YPOS -> "26.8484598"
 Parameter: ZPOS -> "34.3361591"
 Parameter: YPHI -> "17.594905"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.953218    0.000000   -0.302285
    0.000000    1.000000    0.000000
    0.302285    0.000000    0.953218

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   17.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-2.30682876"
 Parameter: YPOS -> "26.8484598"
 Parameter: ZPOS -> "34.3361591"
 Parameter: ZPHI -> "116.894242"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.452345    0.891843    0.000000
   -0.891843   -0.452345    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  116.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -2.306829 XMAX =   -2.306829 XAVE =   -2.306829
    YMIN =   26.848460 YMAX =   26.848460 YAVE =   26.848460
    ZMIN =   34.336159 ZMAX =   34.336159 ZAVE =   34.336159
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-2.30682874"
Evaluating: -2.30682874+3.5
 Parameter: XMAX <- "1.19317126"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "26.8484598"
Evaluating: 26.8484598+3.5
 Parameter: YMAX <- "30.3484598"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.3361591"
Evaluating: 34.3361591+3.5
 Parameter: ZMAX <- "37.8361591"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-2.30682874"
Evaluating: -2.30682874-3.5
 Parameter: XMIN <- "-5.80682874"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "26.8484598"
Evaluating: 26.8484598-3.5
 Parameter: YMIN <- "23.3484598"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.3361591"
Evaluating: 34.3361591-3.5
 Parameter: ZMIN <- "30.8361591"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "1.19317126"
 Parameter: XMIN -> "-5.80682874"
 Parameter: YMAX -> "30.3484598"
 Parameter: YMIN -> "23.3484598"
 Parameter: ZMAX -> "37.8361591"
 Parameter: ZMIN -> "30.8361591"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "73"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "73" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "73"
Evaluating: 73
 Parameter: J <- "73"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "73" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "73"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.799951214"
Evaluating: (89.1533903-9.0)*(0.799951214-0.5)
 Parameter: XPOS <- "24.0421067"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.258775931"
Evaluating: (89.1533903-9.0)*(0.258775931-0.5)
 Parameter: YPOS <- "-19.334927"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.315709859"
Evaluating: (89.1533903-9.0)*(0.315709859-0.5)
 Parameter: ZPOS <- "-14.7714796"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.0421067"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 24.0421067-44.5766951
 Parameter: XTRAN <- "-20.5345884"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-19.334927"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -19.334927-44.5766951
 Parameter: YTRAN <- "-63.9116221"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-14.7714796"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -14.7714796-44.5766951
 Parameter: ZTRAN <- "-59.3481747"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.5345884"
 Parameter: YTRAN -> "-63.9116221"
 Parameter: ZTRAN -> "-59.3481747"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -20.534588  -63.911622  -59.348175
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.971621928"
Evaluating: 0.971621928*360.0
 Parameter: XPHI <- "349.783894"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.499551351"
Evaluating: 0.499551351*360.0
 Parameter: YPHI <- "179.838486"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.486614496"
Evaluating: 0.486614496*360.0
 Parameter: ZPHI <- "175.181219"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.0421067"
 Parameter: YPOS -> "-19.334927"
 Parameter: ZPOS -> "-14.7714796"
 Parameter: XPHI -> "349.783894"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.984146   -0.177361
    0.000000    0.177361    0.984146

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   10.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.0421067"
 Parameter: YPOS -> "-19.334927"
 Parameter: ZPOS -> "-14.7714796"
 Parameter: YPHI -> "179.838486"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.999996    0.000000   -0.002819
    0.000000    1.000000    0.000000
    0.002819    0.000000   -0.999996

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  179.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.0421067"
 Parameter: YPOS -> "-19.334927"
 Parameter: ZPOS -> "-14.7714796"
 Parameter: ZPHI -> "175.181219"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.996465    0.084004    0.000000
   -0.084004   -0.996465    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  175.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.042107 XMAX =   24.042107 XAVE =   24.042107
    YMIN =  -19.334927 YMAX =  -19.334927 YAVE =  -19.334927
    ZMIN =  -14.771480 ZMAX =  -14.771480 ZAVE =  -14.771480
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.0421067"
Evaluating: 24.0421067+3.5
 Parameter: XMAX <- "27.5421067"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-19.334927"
Evaluating: -19.334927+3.5
 Parameter: YMAX <- "-15.834927"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-14.7714796"
Evaluating: -14.7714796+3.5
 Parameter: ZMAX <- "-11.2714796"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.0421067"
Evaluating: 24.0421067-3.5
 Parameter: XMIN <- "20.5421067"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-19.334927"
Evaluating: -19.334927-3.5
 Parameter: YMIN <- "-22.834927"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-14.7714796"
Evaluating: -14.7714796-3.5
 Parameter: ZMIN <- "-18.2714796"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.5421067"
 Parameter: XMIN -> "20.5421067"
 Parameter: YMAX -> "-15.834927"
 Parameter: YMIN -> "-22.834927"
 Parameter: ZMAX -> "-11.2714796"
 Parameter: ZMIN -> "-18.2714796"
 SELRPN>     13 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "13"
 Comparing "13" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      6 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9175 POS      SOD      73       SOD     -3497 PAA1     ALA      270      N             3.2608
 9175 POS      SOD      73       SOD     -3499 PAA1     ALA      270      CA            2.5370
 9175 POS      SOD      73       SOD     -3501 PAA1     ALA      270      CB            1.0989
 9175 POS      SOD      73       SOD     -3505 PAA1     ALA      270      C             3.2262
 9175 POS      SOD      73       SOD     -3507 PAA1     ALA      271      N             3.6102
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "73"
Evaluating: 73
 Parameter: J <- "73"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "73" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "73"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.455221943"
Evaluating: (89.1533903-9.0)*(0.455221943-0.5)
 Parameter: XPOS <- "-3.58911308"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.190026526"
Evaluating: (89.1533903-9.0)*(0.190026526-0.5)
 Parameter: YPOS <- "-24.8454248"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.426900608"
Evaluating: (89.1533903-9.0)*(0.426900608-0.5)
 Parameter: ZPOS <- "-5.8591641"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.042107 XMAX =   24.042107 XAVE =   24.042107
    YMIN =  -19.334927 YMAX =  -19.334927 YAVE =  -19.334927
    ZMIN =  -14.771480 ZMAX =  -14.771480 ZAVE =  -14.771480
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.58911308"
 RDCMND substituted energy or value "?XAVE" to "24.0421067"
Evaluating: -3.58911308-24.0421067
 Parameter: XTRAN <- "-27.6312198"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.8454248"
 RDCMND substituted energy or value "?YAVE" to "-19.334927"
Evaluating: -24.8454248--19.334927
 Parameter: YTRAN <- "-5.5104978"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-5.8591641"
 RDCMND substituted energy or value "?ZAVE" to "-14.7714796"
Evaluating: -5.8591641--14.7714796
 Parameter: ZTRAN <- "8.9123155"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.6312198"
 Parameter: YTRAN -> "-5.5104978"
 Parameter: ZTRAN -> "8.9123155"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -27.631220   -5.510498    8.912316
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.260056846"
Evaluating: 0.260056846*360.0
 Parameter: XPHI <- "93.6204646"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.967812768"
Evaluating: 0.967812768*360.0
 Parameter: YPHI <- "348.412596"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.458731815"
Evaluating: 0.458731815*360.0
 Parameter: ZPHI <- "165.143453"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.58911308"
 Parameter: YPOS -> "-24.8454248"
 Parameter: ZPOS -> "-5.8591641"
 Parameter: XPHI -> "93.6204646"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.063147    0.998004
    0.000000   -0.998004   -0.063147

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   93.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.58911308"
 Parameter: YPOS -> "-24.8454248"
 Parameter: ZPOS -> "-5.8591641"
 Parameter: YPHI -> "348.412596"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.979619    0.000000    0.200863
    0.000000    1.000000    0.000000
   -0.200863    0.000000    0.979619

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   11.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.58911308"
 Parameter: YPOS -> "-24.8454248"
 Parameter: ZPOS -> "-5.8591641"
 Parameter: ZPHI -> "165.143453"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.966571    0.256400    0.000000
   -0.256400   -0.966571    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  165.14

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.589113 XMAX =   -3.589113 XAVE =   -3.589113
    YMIN =  -24.845425 YMAX =  -24.845425 YAVE =  -24.845425
    ZMIN =   -5.859164 ZMAX =   -5.859164 ZAVE =   -5.859164
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.58911306"
Evaluating: -3.58911306+3.5
 Parameter: XMAX <- "-8.911306E-02"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.8454248"
Evaluating: -24.8454248+3.5
 Parameter: YMAX <- "-21.3454248"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-5.8591641"
Evaluating: -5.8591641+3.5
 Parameter: ZMAX <- "-2.3591641"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.58911306"
Evaluating: -3.58911306-3.5
 Parameter: XMIN <- "-7.08911306"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.8454248"
Evaluating: -24.8454248-3.5
 Parameter: YMIN <- "-28.3454248"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-5.8591641"
Evaluating: -5.8591641-3.5
 Parameter: ZMIN <- "-9.3591641"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.911306E-02"
 Parameter: XMIN -> "-7.08911306"
 Parameter: YMAX -> "-21.3454248"
 Parameter: YMIN -> "-28.3454248"
 Parameter: ZMAX -> "-2.3591641"
 Parameter: ZMIN -> "-9.3591641"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "74"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "74" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "74"
Evaluating: 74
 Parameter: J <- "74"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "74" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "74"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.85319965"
Evaluating: (89.1533903-9.0)*(0.85319965-0.5)
 Parameter: XPOS <- "28.3101494"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.423941962"
Evaluating: (89.1533903-9.0)*(0.423941962-0.5)
 Parameter: YPOS <- "-6.09630961"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.908088194"
Evaluating: (89.1533903-9.0)*(0.908088194-0.5)
 Parameter: ZPOS <- "32.7096523"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.3101494"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 28.3101494-44.5766951
 Parameter: XTRAN <- "-16.2665457"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-6.09630961"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -6.09630961-44.5766951
 Parameter: YTRAN <- "-50.6730047"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.7096523"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 32.7096523-44.5766951
 Parameter: ZTRAN <- "-11.8670428"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-16.2665457"
 Parameter: YTRAN -> "-50.6730047"
 Parameter: ZTRAN -> "-11.8670428"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -16.266546  -50.673005  -11.867043
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.912166181E-02"
Evaluating: 8.912166181E-02*360.0
 Parameter: XPHI <- "32.0837983"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.175084904"
Evaluating: 0.175084904*360.0
 Parameter: YPHI <- "63.0305654"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.218772781"
Evaluating: 0.218772781*360.0
 Parameter: ZPHI <- "78.7582012"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.3101494"
 Parameter: YPOS -> "-6.09630961"
 Parameter: ZPOS -> "32.7096523"
 Parameter: XPHI -> "32.0837983"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.847272    0.531159
    0.000000   -0.531159    0.847272

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   32.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.3101494"
 Parameter: YPOS -> "-6.09630961"
 Parameter: ZPOS -> "32.7096523"
 Parameter: YPHI -> "63.0305654"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.453515    0.000000   -0.891249
    0.000000    1.000000    0.000000
    0.891249    0.000000    0.453515

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   63.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.3101494"
 Parameter: YPOS -> "-6.09630961"
 Parameter: ZPOS -> "32.7096523"
 Parameter: ZPHI -> "78.7582012"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.194950    0.980813    0.000000
   -0.980813    0.194950    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   78.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.310149 XMAX =   28.310149 XAVE =   28.310149
    YMIN =   -6.096310 YMAX =   -6.096310 YAVE =   -6.096310
    ZMIN =   32.709652 ZMAX =   32.709652 ZAVE =   32.709652
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.3101494"
Evaluating: 28.3101494+3.5
 Parameter: XMAX <- "31.8101494"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-6.09630961"
Evaluating: -6.09630961+3.5
 Parameter: YMAX <- "-2.59630961"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.7096523"
Evaluating: 32.7096523+3.5
 Parameter: ZMAX <- "36.2096523"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.3101494"
Evaluating: 28.3101494-3.5
 Parameter: XMIN <- "24.8101494"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-6.09630961"
Evaluating: -6.09630961-3.5
 Parameter: YMIN <- "-9.59630961"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.7096523"
Evaluating: 32.7096523-3.5
 Parameter: ZMIN <- "29.2096523"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "31.8101494"
 Parameter: XMIN -> "24.8101494"
 Parameter: YMAX -> "-2.59630961"
 Parameter: YMIN -> "-9.59630961"
 Parameter: ZMAX -> "36.2096523"
 Parameter: ZMIN -> "29.2096523"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "75"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "75" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "75"
Evaluating: 75
 Parameter: J <- "75"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "75" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "75"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.931058047"
Evaluating: (89.1533903-9.0)*(0.931058047-0.5)
 Parameter: XPOS <- "34.5507639"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.388321777"
Evaluating: (89.1533903-9.0)*(0.388321777-0.5)
 Parameter: YPOS <- "-8.9513882"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.601628854"
Evaluating: (89.1533903-9.0)*(0.601628854-0.5)
 Parameter: ZPOS <- "8.1458972"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "34.5507639"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 34.5507639-44.5766951
 Parameter: XTRAN <- "-10.0259312"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.9513882"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -8.9513882-44.5766951
 Parameter: YTRAN <- "-53.5280833"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "8.1458972"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 8.1458972-44.5766951
 Parameter: ZTRAN <- "-36.4307979"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.0259312"
 Parameter: YTRAN -> "-53.5280833"
 Parameter: ZTRAN -> "-36.4307979"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -10.025931  -53.528083  -36.430798
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.308324129"
Evaluating: 0.308324129*360.0
 Parameter: XPHI <- "110.996686"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.274102432"
Evaluating: 0.274102432*360.0
 Parameter: YPHI <- "98.6768755"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.396972393"
Evaluating: 0.396972393*360.0
 Parameter: ZPHI <- "142.910061"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "34.5507639"
 Parameter: YPOS -> "-8.9513882"
 Parameter: ZPOS -> "8.1458972"
 Parameter: XPHI -> "110.996686"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.358314    0.933601
    0.000000   -0.933601   -0.358314

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  111.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "34.5507639"
 Parameter: YPOS -> "-8.9513882"
 Parameter: ZPOS -> "8.1458972"
 Parameter: YPHI -> "98.6768755"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.150862    0.000000   -0.988555
    0.000000    1.000000    0.000000
    0.988555    0.000000   -0.150862

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   98.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "34.5507639"
 Parameter: YPOS -> "-8.9513882"
 Parameter: ZPOS -> "8.1458972"
 Parameter: ZPHI -> "142.910061"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.797690    0.603068    0.000000
   -0.603068   -0.797690    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  142.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   34.550764 XMAX =   34.550764 XAVE =   34.550764
    YMIN =   -8.951388 YMAX =   -8.951388 YAVE =   -8.951388
    ZMIN =    8.145897 ZMAX =    8.145897 ZAVE =    8.145897
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "34.5507639"
Evaluating: 34.5507639+3.5
 Parameter: XMAX <- "38.0507639"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.9513882"
Evaluating: -8.9513882+3.5
 Parameter: YMAX <- "-5.4513882"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "8.1458972"
Evaluating: 8.1458972+3.5
 Parameter: ZMAX <- "11.6458972"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "34.5507639"
Evaluating: 34.5507639-3.5
 Parameter: XMIN <- "31.0507639"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.9513882"
Evaluating: -8.9513882-3.5
 Parameter: YMIN <- "-12.4513882"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "8.1458972"
Evaluating: 8.1458972-3.5
 Parameter: ZMIN <- "4.6458972"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "38.0507639"
 Parameter: XMIN -> "31.0507639"
 Parameter: YMAX -> "-5.4513882"
 Parameter: YMIN -> "-12.4513882"
 Parameter: ZMAX -> "11.6458972"
 Parameter: ZMIN -> "4.6458972"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      1 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "76"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "76" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "76"
Evaluating: 76
 Parameter: J <- "76"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "76" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "76"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.944950021"
Evaluating: (89.1533903-9.0)*(0.944950021-0.5)
 Parameter: XPOS <- "35.6642527"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.244855611"
Evaluating: (89.1533903-9.0)*(0.244855611-0.5)
 Parameter: YPOS <- "-20.4506878"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.162776814"
Evaluating: (89.1533903-9.0)*(0.162776814-0.5)
 Parameter: ZPOS <- "-27.0295816"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "35.6642527"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 35.6642527-44.5766951
 Parameter: XTRAN <- "-8.9124424"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.4506878"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -20.4506878-44.5766951
 Parameter: YTRAN <- "-65.0273829"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.0295816"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -27.0295816-44.5766951
 Parameter: ZTRAN <- "-71.6062767"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.9124424"
 Parameter: YTRAN -> "-65.0273829"
 Parameter: ZTRAN -> "-71.6062767"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    -8.912442  -65.027383  -71.606277
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.984514587"
Evaluating: 0.984514587*360.0
 Parameter: XPHI <- "354.425251"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.542401965"
Evaluating: 0.542401965*360.0
 Parameter: YPHI <- "195.264707"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.729642638"
Evaluating: 0.729642638*360.0
 Parameter: ZPHI <- "262.67135"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "35.6642527"
 Parameter: YPOS -> "-20.4506878"
 Parameter: ZPOS -> "-27.0295816"
 Parameter: XPHI -> "354.425251"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.995270   -0.097144
    0.000000    0.097144    0.995270

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    5.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "35.6642527"
 Parameter: YPOS -> "-20.4506878"
 Parameter: ZPOS -> "-27.0295816"
 Parameter: YPHI -> "195.264707"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.964720    0.000000    0.263279
    0.000000    1.000000    0.000000
   -0.263279    0.000000   -0.964720

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  164.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "35.6642527"
 Parameter: YPOS -> "-20.4506878"
 Parameter: ZPOS -> "-27.0295816"
 Parameter: ZPHI -> "262.67135"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.127561   -0.991831    0.000000
    0.991831   -0.127561    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   97.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.664253 XMAX =   35.664253 XAVE =   35.664253
    YMIN =  -20.450688 YMAX =  -20.450688 YAVE =  -20.450688
    ZMIN =  -27.029582 ZMAX =  -27.029582 ZAVE =  -27.029582
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "35.6642527"
Evaluating: 35.6642527+3.5
 Parameter: XMAX <- "39.1642527"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.4506878"
Evaluating: -20.4506878+3.5
 Parameter: YMAX <- "-16.9506878"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.0295816"
Evaluating: -27.0295816+3.5
 Parameter: ZMAX <- "-23.5295816"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "35.6642527"
Evaluating: 35.6642527-3.5
 Parameter: XMIN <- "32.1642527"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.4506878"
Evaluating: -20.4506878-3.5
 Parameter: YMIN <- "-23.9506878"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.0295816"
Evaluating: -27.0295816-3.5
 Parameter: ZMIN <- "-30.5295816"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.1642527"
 Parameter: XMIN -> "32.1642527"
 Parameter: YMAX -> "-16.9506878"
 Parameter: YMIN -> "-23.9506878"
 Parameter: ZMAX -> "-23.5295816"
 Parameter: ZMIN -> "-30.5295816"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "77"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "77" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "77"
Evaluating: 77
 Parameter: J <- "77"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "77" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "77"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.271632576"
Evaluating: (89.1533903-9.0)*(0.271632576-0.5)
 Parameter: XPOS <- "-18.3044233"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.519621301"
Evaluating: (89.1533903-9.0)*(0.519621301-0.5)
 Parameter: YPOS <- "1.5727138"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.322880803"
Evaluating: (89.1533903-9.0)*(0.322880803-0.5)
 Parameter: ZPOS <- "-14.1967041"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.3044233"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -18.3044233-44.5766951
 Parameter: XTRAN <- "-62.8811184"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.5727138"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 1.5727138-44.5766951
 Parameter: YTRAN <- "-43.0039813"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-14.1967041"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -14.1967041-44.5766951
 Parameter: ZTRAN <- "-58.7733992"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-62.8811184"
 Parameter: YTRAN -> "-43.0039813"
 Parameter: ZTRAN -> "-58.7733992"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -62.881118  -43.003981  -58.773399
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.96802506"
Evaluating: 0.96802506*360.0
 Parameter: XPHI <- "348.489022"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.887827752"
Evaluating: 0.887827752*360.0
 Parameter: YPHI <- "319.617991"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.747180803"
Evaluating: 0.747180803*360.0
 Parameter: ZPHI <- "268.985089"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.3044233"
 Parameter: YPOS -> "1.5727138"
 Parameter: ZPOS -> "-14.1967041"
 Parameter: XPHI -> "348.489022"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.979886   -0.199556
    0.000000    0.199556    0.979886

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   11.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.3044233"
 Parameter: YPOS -> "1.5727138"
 Parameter: ZPOS -> "-14.1967041"
 Parameter: YPHI -> "319.617991"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.761742    0.000000    0.647881
    0.000000    1.000000    0.000000
   -0.647881    0.000000    0.761742

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   40.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.3044233"
 Parameter: YPOS -> "1.5727138"
 Parameter: ZPOS -> "-14.1967041"
 Parameter: ZPHI -> "268.985089"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.017713   -0.999843    0.000000
    0.999843   -0.017713    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   91.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.304423 XMAX =  -18.304423 XAVE =  -18.304423
    YMIN =    1.572714 YMAX =    1.572714 YAVE =    1.572714
    ZMIN =  -14.196704 ZMAX =  -14.196704 ZAVE =  -14.196704
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.3044233"
Evaluating: -18.3044233+3.5
 Parameter: XMAX <- "-14.8044233"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.5727138"
Evaluating: 1.5727138+3.5
 Parameter: YMAX <- "5.0727138"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-14.1967041"
Evaluating: -14.1967041+3.5
 Parameter: ZMAX <- "-10.6967041"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.3044233"
Evaluating: -18.3044233-3.5
 Parameter: XMIN <- "-21.8044233"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.5727138"
Evaluating: 1.5727138-3.5
 Parameter: YMIN <- "-1.9272862"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-14.1967041"
Evaluating: -14.1967041-3.5
 Parameter: ZMIN <- "-17.6967041"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.8044233"
 Parameter: XMIN -> "-21.8044233"
 Parameter: YMAX -> "5.0727138"
 Parameter: YMIN -> "-1.9272862"
 Parameter: ZMAX -> "-10.6967041"
 Parameter: ZMIN -> "-17.6967041"
 SELRPN>     26 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "26"
 Comparing "26" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     12 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9179 POS      SOD      77       SOD     - 870 PAA1     SER      59       O             3.5133
 9179 POS      SOD      77       SOD     - 889 PAA1     LEU      60       O             4.4739
 9179 POS      SOD      77       SOD     - 910 PAA1     GLN      63       N             2.7992
 9179 POS      SOD      77       SOD     - 912 PAA1     GLN      63       CA            2.0626
 9179 POS      SOD      77       SOD     - 914 PAA1     GLN      63       CB            0.9034
 9179 POS      SOD      77       SOD     - 917 PAA1     GLN      63       CG            0.6947
 9179 POS      SOD      77       SOD     - 920 PAA1     GLN      63       CD            1.8987
 9179 POS      SOD      77       SOD     - 921 PAA1     GLN      63       OE1           2.5078
 9179 POS      SOD      77       SOD     - 922 PAA1     GLN      63       NE2           2.9834
 9179 POS      SOD      77       SOD     - 925 PAA1     GLN      63       C             3.2905
 9179 POS      SOD      77       SOD     - 926 PAA1     GLN      63       O             3.6672
 9179 POS      SOD      77       SOD     - 941 PAA1     ARG      65       CG            4.4051
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "77"
Evaluating: 77
 Parameter: J <- "77"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "77" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "77"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.263685752"
Evaluating: (89.1533903-9.0)*(0.263685752-0.5)
 Parameter: XPOS <- "-18.9413882"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "6.32059151E-02"
Evaluating: (89.1533903-9.0)*(6.32059151E-02-0.5)
 Parameter: YPOS <- "-35.0105268"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.254914978"
Evaluating: (89.1533903-9.0)*(0.254914978-0.5)
 Parameter: ZPOS <- "-19.6443954"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.304423 XMAX =  -18.304423 XAVE =  -18.304423
    YMIN =    1.572714 YMAX =    1.572714 YAVE =    1.572714
    ZMIN =  -14.196704 ZMAX =  -14.196704 ZAVE =  -14.196704
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.9413882"
 RDCMND substituted energy or value "?XAVE" to "-18.3044233"
Evaluating: -18.9413882--18.3044233
 Parameter: XTRAN <- "-0.6369649"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.0105268"
 RDCMND substituted energy or value "?YAVE" to "1.5727138"
Evaluating: -35.0105268-1.5727138
 Parameter: YTRAN <- "-36.5832406"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.6443954"
 RDCMND substituted energy or value "?ZAVE" to "-14.1967041"
Evaluating: -19.6443954--14.1967041
 Parameter: ZTRAN <- "-5.4476913"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-0.6369649"
 Parameter: YTRAN -> "-36.5832406"
 Parameter: ZTRAN -> "-5.4476913"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    -0.636965  -36.583241   -5.447691
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.877893713"
Evaluating: 0.877893713*360.0
 Parameter: XPHI <- "316.041737"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.238624808"
Evaluating: 0.238624808*360.0
 Parameter: YPHI <- "85.9049309"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.590310774"
Evaluating: 0.590310774*360.0
 Parameter: ZPHI <- "212.511879"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.9413882"
 Parameter: YPOS -> "-35.0105268"
 Parameter: ZPOS -> "-19.6443954"
 Parameter: XPHI -> "316.041737"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.719846   -0.694134
    0.000000    0.694134    0.719846

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   43.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.9413882"
 Parameter: YPOS -> "-35.0105268"
 Parameter: ZPOS -> "-19.6443954"
 Parameter: YPHI -> "85.9049309"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.071412    0.000000   -0.997447
    0.000000    1.000000    0.000000
    0.997447    0.000000    0.071412

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   85.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.9413882"
 Parameter: YPOS -> "-35.0105268"
 Parameter: ZPOS -> "-19.6443954"
 Parameter: ZPHI -> "212.511879"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.843280   -0.537474    0.000000
    0.537474   -0.843280    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  147.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.941388 XMAX =  -18.941388 XAVE =  -18.941388
    YMIN =  -35.010527 YMAX =  -35.010527 YAVE =  -35.010527
    ZMIN =  -19.644395 ZMAX =  -19.644395 ZAVE =  -19.644395
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.9413882"
Evaluating: -18.9413882+3.5
 Parameter: XMAX <- "-15.4413882"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.0105268"
Evaluating: -35.0105268+3.5
 Parameter: YMAX <- "-31.5105268"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.6443954"
Evaluating: -19.6443954+3.5
 Parameter: ZMAX <- "-16.1443954"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.9413882"
Evaluating: -18.9413882-3.5
 Parameter: XMIN <- "-22.4413882"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.0105268"
Evaluating: -35.0105268-3.5
 Parameter: YMIN <- "-38.5105268"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.6443954"
Evaluating: -19.6443954-3.5
 Parameter: ZMIN <- "-23.1443954"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.4413882"
 Parameter: XMIN -> "-22.4413882"
 Parameter: YMAX -> "-31.5105268"
 Parameter: YMIN -> "-38.5105268"
 Parameter: ZMAX -> "-16.1443954"
 Parameter: ZMIN -> "-23.1443954"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "78"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "78" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "78"
Evaluating: 78
 Parameter: J <- "78"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "78" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "78"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.575301474"
Evaluating: (89.1533903-9.0)*(0.575301474-0.5)
 Parameter: XPOS <- "6.03566844"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.568545803"
Evaluating: (89.1533903-9.0)*(0.568545803-0.5)
 Parameter: YPOS <- "5.4941785"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.829421038"
Evaluating: (89.1533903-9.0)*(0.829421038-0.5)
 Parameter: ZPOS <- "26.404213"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.03566844"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 6.03566844-44.5766951
 Parameter: XTRAN <- "-38.5410267"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "5.4941785"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 5.4941785-44.5766951
 Parameter: YTRAN <- "-39.0825166"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.404213"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 26.404213-44.5766951
 Parameter: ZTRAN <- "-18.1724821"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.5410267"
 Parameter: YTRAN -> "-39.0825166"
 Parameter: ZTRAN -> "-18.1724821"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -38.541027  -39.082517  -18.172482
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.941675324E-02"
Evaluating: 6.941675324E-02*360.0
 Parameter: XPHI <- "24.9900312"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.874908356"
Evaluating: 0.874908356*360.0
 Parameter: YPHI <- "314.967008"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.611924463"
Evaluating: 0.611924463*360.0
 Parameter: ZPHI <- "220.292807"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.03566844"
 Parameter: YPOS -> "5.4941785"
 Parameter: ZPOS -> "26.404213"
 Parameter: XPHI -> "24.9900312"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.906381    0.422461
    0.000000   -0.422461    0.906381

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   24.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.03566844"
 Parameter: YPOS -> "5.4941785"
 Parameter: ZPOS -> "26.404213"
 Parameter: YPHI -> "314.967008"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.706699    0.000000    0.707514
    0.000000    1.000000    0.000000
   -0.707514    0.000000    0.706699

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   45.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.03566844"
 Parameter: YPOS -> "5.4941785"
 Parameter: ZPOS -> "26.404213"
 Parameter: ZPHI -> "220.292807"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.762750   -0.646694    0.000000
    0.646694   -0.762750    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  139.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.035668 XMAX =    6.035668 XAVE =    6.035668
    YMIN =    5.494178 YMAX =    5.494178 YAVE =    5.494178
    ZMIN =   26.404213 ZMAX =   26.404213 ZAVE =   26.404213
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.03566846"
Evaluating: 6.03566846+3.5
 Parameter: XMAX <- "9.53566846"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "5.49417848"
Evaluating: 5.49417848+3.5
 Parameter: YMAX <- "8.99417848"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.404213"
Evaluating: 26.404213+3.5
 Parameter: ZMAX <- "29.904213"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.03566846"
Evaluating: 6.03566846-3.5
 Parameter: XMIN <- "2.53566846"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "5.49417848"
Evaluating: 5.49417848-3.5
 Parameter: YMIN <- "1.99417848"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.404213"
Evaluating: 26.404213-3.5
 Parameter: ZMIN <- "22.904213"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.53566846"
 Parameter: XMIN -> "2.53566846"
 Parameter: YMAX -> "8.99417848"
 Parameter: YMIN -> "1.99417848"
 Parameter: ZMAX -> "29.904213"
 Parameter: ZMIN -> "22.904213"
 SELRPN>      2 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      1 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "79"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "79" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "79"
Evaluating: 79
 Parameter: J <- "79"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "79" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "79"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.619025608"
Evaluating: (89.1533903-9.0)*(0.619025608-0.5)
 Parameter: XPOS <- "9.54030601"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.32114416"
Evaluating: (89.1533903-9.0)*(0.32114416-0.5)
 Parameter: YPOS <- "-14.335902"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.614615884"
Evaluating: (89.1533903-9.0)*(0.614615884-0.5)
 Parameter: ZPOS <- "9.18685168"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.54030601"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 9.54030601-44.5766951
 Parameter: XTRAN <- "-35.0363891"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.335902"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -14.335902-44.5766951
 Parameter: YTRAN <- "-58.9125971"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "9.18685168"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 9.18685168-44.5766951
 Parameter: ZTRAN <- "-35.3898434"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-35.0363891"
 Parameter: YTRAN -> "-58.9125971"
 Parameter: ZTRAN -> "-35.3898434"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -35.036389  -58.912597  -35.389843
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.374516509"
Evaluating: 0.374516509*360.0
 Parameter: XPHI <- "134.825943"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.396631262"
Evaluating: 0.396631262*360.0
 Parameter: YPHI <- "142.787254"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.917618001"
Evaluating: 0.917618001*360.0
 Parameter: ZPHI <- "330.34248"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.54030601"
 Parameter: YPOS -> "-14.335902"
 Parameter: ZPOS -> "9.18685168"
 Parameter: XPHI -> "134.825943"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.704955    0.709252
    0.000000   -0.709252   -0.704955

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  134.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.54030601"
 Parameter: YPOS -> "-14.335902"
 Parameter: ZPOS -> "9.18685168"
 Parameter: YPHI -> "142.787254"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.796395    0.000000   -0.604776
    0.000000    1.000000    0.000000
    0.604776    0.000000   -0.796395

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  142.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.54030601"
 Parameter: YPOS -> "-14.335902"
 Parameter: ZPOS -> "9.18685168"
 Parameter: ZPHI -> "330.34248"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.868999   -0.494815    0.000000
    0.494815    0.868999    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   29.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.540306 XMAX =    9.540306 XAVE =    9.540306
    YMIN =  -14.335902 YMAX =  -14.335902 YAVE =  -14.335902
    ZMIN =    9.186852 ZMAX =    9.186852 ZAVE =    9.186852
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.54030602"
Evaluating: 9.54030602+3.5
 Parameter: XMAX <- "13.040306"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.335902"
Evaluating: -14.335902+3.5
 Parameter: YMAX <- "-10.835902"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "9.18685169"
Evaluating: 9.18685169+3.5
 Parameter: ZMAX <- "12.6868517"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.54030602"
Evaluating: 9.54030602-3.5
 Parameter: XMIN <- "6.04030602"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.335902"
Evaluating: -14.335902-3.5
 Parameter: YMIN <- "-17.835902"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "9.18685169"
Evaluating: 9.18685169-3.5
 Parameter: ZMIN <- "5.68685169"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.040306"
 Parameter: XMIN -> "6.04030602"
 Parameter: YMAX -> "-10.835902"
 Parameter: YMIN -> "-17.835902"
 Parameter: ZMAX -> "12.6868517"
 Parameter: ZMIN -> "5.68685169"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "80"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "80" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "80" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "1.600431534E-02"
Evaluating: (89.1533903-9.0)*(1.600431534E-02-0.5)
 Parameter: XPOS <- "-38.793895"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.427392478"
Evaluating: (89.1533903-9.0)*(0.427392478-0.5)
 Parameter: YPOS <- "-5.81973905"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.768126884"
Evaluating: (89.1533903-9.0)*(0.768126884-0.5)
 Parameter: ZPOS <- "21.4912788"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.793895"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -38.793895-44.5766951
 Parameter: XTRAN <- "-83.3705901"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.81973905"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -5.81973905-44.5766951
 Parameter: YTRAN <- "-50.3964342"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "21.4912788"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 21.4912788-44.5766951
 Parameter: ZTRAN <- "-23.0854163"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-83.3705901"
 Parameter: YTRAN -> "-50.3964342"
 Parameter: ZTRAN -> "-23.0854163"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -83.370590  -50.396434  -23.085416
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.802149646"
Evaluating: 0.802149646*360.0
 Parameter: XPHI <- "288.773873"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.38514689"
Evaluating: 0.38514689*360.0
 Parameter: YPHI <- "138.65288"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.234754082"
Evaluating: 0.234754082*360.0
 Parameter: ZPHI <- "84.5114695"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.793895"
 Parameter: YPOS -> "-5.81973905"
 Parameter: ZPOS -> "21.4912788"
 Parameter: XPHI -> "288.773873"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.321834   -0.946796
    0.000000    0.946796    0.321834

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   71.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.793895"
 Parameter: YPOS -> "-5.81973905"
 Parameter: ZPOS -> "21.4912788"
 Parameter: YPHI -> "138.65288"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.750721    0.000000   -0.660619
    0.000000    1.000000    0.000000
    0.660619    0.000000   -0.750721

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  138.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.793895"
 Parameter: YPOS -> "-5.81973905"
 Parameter: ZPOS -> "21.4912788"
 Parameter: ZPHI -> "84.5114695"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.095646    0.995415    0.000000
   -0.995415    0.095646    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   84.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.793895 XMAX =  -38.793895 XAVE =  -38.793895
    YMIN =   -5.819739 YMAX =   -5.819739 YAVE =   -5.819739
    ZMIN =   21.491279 ZMAX =   21.491279 ZAVE =   21.491279
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.793895"
Evaluating: -38.793895+3.5
 Parameter: XMAX <- "-35.293895"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.81973908"
Evaluating: -5.81973908+3.5
 Parameter: YMAX <- "-2.31973908"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "21.4912788"
Evaluating: 21.4912788+3.5
 Parameter: ZMAX <- "24.9912788"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.793895"
Evaluating: -38.793895-3.5
 Parameter: XMIN <- "-42.293895"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.81973908"
Evaluating: -5.81973908-3.5
 Parameter: YMIN <- "-9.31973908"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "21.4912788"
Evaluating: 21.4912788-3.5
 Parameter: ZMIN <- "17.9912788"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.293895"
 Parameter: XMIN -> "-42.293895"
 Parameter: YMAX -> "-2.31973908"
 Parameter: YMIN -> "-9.31973908"
 Parameter: ZMAX -> "24.9912788"
 Parameter: ZMIN -> "17.9912788"
 SELRPN>     14 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "14"
 Comparing "14" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      8 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9182 POS      SOD      80       SOD     -7058 PAA2     GLN      185      CA            3.8964
 9182 POS      SOD      80       SOD     -7060 PAA2     GLN      185      CB            3.3170
 9182 POS      SOD      80       SOD     -7063 PAA2     GLN      185      CG            3.0899
 9182 POS      SOD      80       SOD     -7066 PAA2     GLN      185      CD            3.6640
 9182 POS      SOD      80       SOD     -7068 PAA2     GLN      185      NE2           3.8608
 9182 POS      SOD      80       SOD     -7071 PAA2     GLN      185      C             3.3366
 9182 POS      SOD      80       SOD     -7072 PAA2     GLN      185      O             2.2831
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         7
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "80" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.20967117"
Evaluating: (89.1533903-9.0)*(0.20967117-0.5)
 Parameter: XPOS <- "-23.27084"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.808991891"
Evaluating: (89.1533903-9.0)*(0.808991891-0.5)
 Parameter: YPOS <- "24.7667476"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.901465793"
Evaluating: (89.1533903-9.0)*(0.901465793-0.5)
 Parameter: ZPOS <- "32.1788444"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.793895 XMAX =  -38.793895 XAVE =  -38.793895
    YMIN =   -5.819739 YMAX =   -5.819739 YAVE =   -5.819739
    ZMIN =   21.491279 ZMAX =   21.491279 ZAVE =   21.491279
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.27084"
 RDCMND substituted energy or value "?XAVE" to "-38.793895"
Evaluating: -23.27084--38.793895
 Parameter: XTRAN <- "15.523055"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "24.7667476"
 RDCMND substituted energy or value "?YAVE" to "-5.81973908"
Evaluating: 24.7667476--5.81973908
 Parameter: YTRAN <- "30.5864867"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.1788444"
 RDCMND substituted energy or value "?ZAVE" to "21.4912788"
Evaluating: 32.1788444-21.4912788
 Parameter: ZTRAN <- "10.6875656"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "15.523055"
 Parameter: YTRAN -> "30.5864867"
 Parameter: ZTRAN -> "10.6875656"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    15.523055   30.586487   10.687566
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.892585297"
Evaluating: 0.892585297*360.0
 Parameter: XPHI <- "321.330707"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.163956722"
Evaluating: 0.163956722*360.0
 Parameter: YPHI <- "59.0244199"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.312971309"
Evaluating: 0.312971309*360.0
 Parameter: ZPHI <- "112.669671"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.27084"
 Parameter: YPOS -> "24.7667476"
 Parameter: ZPOS -> "32.1788444"
 Parameter: XPHI -> "321.330707"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.780765   -0.624824
    0.000000    0.624824    0.780765

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   38.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.27084"
 Parameter: YPOS -> "24.7667476"
 Parameter: ZPOS -> "32.1788444"
 Parameter: YPHI -> "59.0244199"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.514673    0.000000   -0.857387
    0.000000    1.000000    0.000000
    0.857387    0.000000    0.514673

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   59.02

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.27084"
 Parameter: YPOS -> "24.7667476"
 Parameter: ZPOS -> "32.1788444"
 Parameter: ZPHI -> "112.669671"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.385418    0.922742    0.000000
   -0.922742   -0.385418    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  112.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.270840 XMAX =  -23.270840 XAVE =  -23.270840
    YMIN =   24.766748 YMAX =   24.766748 YAVE =   24.766748
    ZMIN =   32.178844 ZMAX =   32.178844 ZAVE =   32.178844
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.27084"
Evaluating: -23.27084+3.5
 Parameter: XMAX <- "-19.77084"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "24.7667476"
Evaluating: 24.7667476+3.5
 Parameter: YMAX <- "28.2667476"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.1788444"
Evaluating: 32.1788444+3.5
 Parameter: ZMAX <- "35.6788444"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.27084"
Evaluating: -23.27084-3.5
 Parameter: XMIN <- "-26.77084"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "24.7667476"
Evaluating: 24.7667476-3.5
 Parameter: YMIN <- "21.2667476"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.1788444"
Evaluating: 32.1788444-3.5
 Parameter: ZMIN <- "28.6788444"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.77084"
 Parameter: XMIN -> "-26.77084"
 Parameter: YMAX -> "28.2667476"
 Parameter: YMIN -> "21.2667476"
 Parameter: ZMAX -> "35.6788444"
 Parameter: ZMIN -> "28.6788444"
 SELRPN>      8 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      4 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9182 POS      SOD      80       SOD     -7685 PAA2     ALA      242      CA            3.3572
 9182 POS      SOD      80       SOD     -7687 PAA2     ALA      242      CB            2.4385
 9182 POS      SOD      80       SOD     -7691 PAA2     ALA      242      C             3.7810
 9182 POS      SOD      80       SOD     -7692 PAA2     ALA      242      O             3.8115
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "80"
Evaluating: 80
 Parameter: J <- "80"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "80" and "80".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "POS"
 Parameter: J -> "80"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.962289567"
Evaluating: (89.1533903-9.0)*(0.962289567-0.5)
 Parameter: XPOS <- "37.0540761"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.656267076"
Evaluating: (89.1533903-9.0)*(0.656267076-0.5)
 Parameter: YPOS <- "12.5253359"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.702480507"
Evaluating: (89.1533903-9.0)*(0.702480507-0.5)
 Parameter: ZPOS <- "16.2294991"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.270840 XMAX =  -23.270840 XAVE =  -23.270840
    YMIN =   24.766748 YMAX =   24.766748 YAVE =   24.766748
    ZMIN =   32.178844 ZMAX =   32.178844 ZAVE =   32.178844
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.0540761"
 RDCMND substituted energy or value "?XAVE" to "-23.27084"
Evaluating: 37.0540761--23.27084
 Parameter: XTRAN <- "60.3249161"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "12.5253359"
 RDCMND substituted energy or value "?YAVE" to "24.7667476"
Evaluating: 12.5253359-24.7667476
 Parameter: YTRAN <- "-12.2414117"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.2294991"
 RDCMND substituted energy or value "?ZAVE" to "32.1788444"
Evaluating: 16.2294991-32.1788444
 Parameter: ZTRAN <- "-15.9493453"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "60.3249161"
 Parameter: YTRAN -> "-12.2414117"
 Parameter: ZTRAN -> "-15.9493453"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    60.324916  -12.241412  -15.949345
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.199552199"
Evaluating: 0.199552199*360.0
 Parameter: XPHI <- "71.8387916"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.792498836"
Evaluating: 0.792498836*360.0
 Parameter: YPHI <- "285.299581"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.802661572"
Evaluating: 0.802661572*360.0
 Parameter: ZPHI <- "288.958166"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.0540761"
 Parameter: YPOS -> "12.5253359"
 Parameter: ZPOS -> "16.2294991"
 Parameter: XPHI -> "71.8387916"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.311692    0.950183
    0.000000   -0.950183    0.311692

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   71.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.0540761"
 Parameter: YPOS -> "12.5253359"
 Parameter: ZPOS -> "16.2294991"
 Parameter: YPHI -> "285.299581"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.263866    0.000000    0.964559
    0.000000    1.000000    0.000000
   -0.964559    0.000000    0.263866

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   74.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.0540761"
 Parameter: YPOS -> "12.5253359"
 Parameter: ZPOS -> "16.2294991"
 Parameter: ZPHI -> "288.958166"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.324878   -0.945756    0.000000
    0.945756    0.324878    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   71.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.054076 XMAX =   37.054076 XAVE =   37.054076
    YMIN =   12.525336 YMAX =   12.525336 YAVE =   12.525336
    ZMIN =   16.229499 ZMAX =   16.229499 ZAVE =   16.229499
    WMIN =    1.000000 WMAX =    1.000000 WAVE =    1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.0540761"
Evaluating: 37.0540761+3.5
 Parameter: XMAX <- "40.5540761"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "12.5253359"
Evaluating: 12.5253359+3.5
 Parameter: YMAX <- "16.0253359"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.2294991"
Evaluating: 16.2294991+3.5
 Parameter: ZMAX <- "19.7294991"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.0540761"
Evaluating: 37.0540761-3.5
 Parameter: XMIN <- "33.5540761"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "12.5253359"
Evaluating: 12.5253359-3.5
 Parameter: YMIN <- "9.0253359"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.2294991"
Evaluating: 16.2294991-3.5
 Parameter: ZMIN <- "12.7294991"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.5540761"
 Parameter: XMIN -> "33.5540761"
 Parameter: YMAX -> "16.0253359"
 Parameter: YMIN -> "9.0253359"
 Parameter: ZMAX -> "19.7294991"
 Parameter: ZMIN -> "12.7294991"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "81"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "81" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "81" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "81"
 Parameter: NPOS -> "80"
Evaluating: 81-80
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.322840661"
Evaluating: (89.1533903-9.0)*(0.322840661-0.5)
 Parameter: XPOS <- "-14.1999216"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "2.516562501E-03"
Evaluating: (89.1533903-9.0)*(2.516562501E-03-0.5)
 Parameter: YPOS <- "-39.8749841"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.900945396"
Evaluating: (89.1533903-9.0)*(0.900945396-0.5)
 Parameter: ZPOS <- "32.1371328"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.1999216"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -14.1999216-44.5766951
 Parameter: XTRAN <- "-58.7766167"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.8749841"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -39.8749841-44.5766951
 Parameter: YTRAN <- "-84.4516792"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "32.1371328"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 32.1371328-44.5766951
 Parameter: ZTRAN <- "-12.4395623"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-58.7766167"
 Parameter: YTRAN -> "-84.4516792"
 Parameter: ZTRAN -> "-12.4395623"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -58.776617  -84.451679  -12.439562
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.957235937"
Evaluating: 0.957235937*360.0
 Parameter: XPHI <- "344.604937"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.820178936"
Evaluating: 0.820178936*360.0
 Parameter: YPHI <- "295.264417"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.685635947"
Evaluating: 0.685635947*360.0
 Parameter: ZPHI <- "246.828941"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.1999216"
 Parameter: YPOS -> "-39.8749841"
 Parameter: ZPOS -> "32.1371328"
 Parameter: XPHI -> "344.604937"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.964118   -0.265473
    0.000000    0.265473    0.964118

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   15.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.1999216"
 Parameter: YPOS -> "-39.8749841"
 Parameter: ZPOS -> "32.1371328"
 Parameter: YPHI -> "295.264417"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.426796    0.000000    0.904348
    0.000000    1.000000    0.000000
   -0.904348    0.000000    0.426796

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   64.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.1999216"
 Parameter: YPOS -> "-39.8749841"
 Parameter: ZPOS -> "32.1371328"
 Parameter: ZPHI -> "246.828941"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.393478   -0.919334    0.000000
    0.919334   -0.393478    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  113.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.199922 XMAX =  -14.199922 XAVE =  -14.199922
    YMIN =  -39.874984 YMAX =  -39.874984 YAVE =  -39.874984
    ZMIN =   32.137133 ZMAX =   32.137133 ZAVE =   32.137133
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.1999216"
Evaluating: -14.1999216+3.5
 Parameter: XMAX <- "-10.6999216"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.8749841"
Evaluating: -39.8749841+3.5
 Parameter: YMAX <- "-36.3749841"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "32.1371328"
Evaluating: 32.1371328+3.5
 Parameter: ZMAX <- "35.6371328"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.1999216"
Evaluating: -14.1999216-3.5
 Parameter: XMIN <- "-17.6999216"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.8749841"
Evaluating: -39.8749841-3.5
 Parameter: YMIN <- "-43.3749841"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "32.1371328"
Evaluating: 32.1371328-3.5
 Parameter: ZMIN <- "28.6371328"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.6999216"
 Parameter: XMIN -> "-17.6999216"
 Parameter: YMAX -> "-36.3749841"
 Parameter: YMIN -> "-43.3749841"
 Parameter: ZMAX -> "35.6371328"
 Parameter: ZMIN -> "28.6371328"
 SELRPN>      8 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      4 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9183 NEG      CLA      1        CLA     -6604 PAA2     ASN      144      CB            4.0506
 9183 NEG      CLA      1        CLA     -6607 PAA2     ASN      144      CG            3.5962
 9183 NEG      CLA      1        CLA     -6608 PAA2     ASN      144      OD1           4.2460
 9183 NEG      CLA      1        CLA     -6609 PAA2     ASN      144      ND2           3.0969
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "81"
Evaluating: 81
 Parameter: J <- "81"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "81" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "81"
 Parameter: NPOS -> "80"
Evaluating: 81-80
 Parameter: J <- "1"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "1"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.24051686"
Evaluating: (89.1533903-9.0)*(0.24051686-0.5)
 Parameter: XPOS <- "-20.7984534"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.719224058"
Evaluating: (89.1533903-9.0)*(0.719224058-0.5)
 Parameter: YPOS <- "17.5715515"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.885273963"
Evaluating: (89.1533903-9.0)*(0.885273963-0.5)
 Parameter: ZPOS <- "30.8810143"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.199922 XMAX =  -14.199922 XAVE =  -14.199922
    YMIN =  -39.874984 YMAX =  -39.874984 YAVE =  -39.874984
    ZMIN =   32.137133 ZMAX =   32.137133 ZAVE =   32.137133
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.7984534"
 RDCMND substituted energy or value "?XAVE" to "-14.1999216"
Evaluating: -20.7984534--14.1999216
 Parameter: XTRAN <- "-6.5985318"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.5715515"
 RDCMND substituted energy or value "?YAVE" to "-39.8749841"
Evaluating: 17.5715515--39.8749841
 Parameter: YTRAN <- "57.4465356"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.8810143"
 RDCMND substituted energy or value "?ZAVE" to "32.1371328"
Evaluating: 30.8810143-32.1371328
 Parameter: ZTRAN <- "-1.2561185"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.5985318"
 Parameter: YTRAN -> "57.4465356"
 Parameter: ZTRAN -> "-1.2561185"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    -6.598532   57.446536   -1.256118
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.400615203E-02"
Evaluating: 7.400615203E-02*360.0
 Parameter: XPHI <- "26.6422147"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.986314464"
Evaluating: 0.986314464*360.0
 Parameter: YPHI <- "355.073207"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.584938886"
Evaluating: 0.584938886*360.0
 Parameter: ZPHI <- "210.577999"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.7984534"
 Parameter: YPOS -> "17.5715515"
 Parameter: ZPOS -> "30.8810143"
 Parameter: XPHI -> "26.6422147"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.893824    0.448418
    0.000000   -0.448418    0.893824

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   26.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.7984534"
 Parameter: YPOS -> "17.5715515"
 Parameter: ZPOS -> "30.8810143"
 Parameter: YPHI -> "355.073207"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.996305    0.000000    0.085883
    0.000000    1.000000    0.000000
   -0.085883    0.000000    0.996305

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    4.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.7984534"
 Parameter: YPOS -> "17.5715515"
 Parameter: ZPOS -> "30.8810143"
 Parameter: ZPHI -> "210.577999"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.860937   -0.508711    0.000000
    0.508711   -0.860937    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  149.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.798453 XMAX =  -20.798453 XAVE =  -20.798453
    YMIN =   17.571552 YMAX =   17.571552 YAVE =   17.571552
    ZMIN =   30.881014 ZMAX =   30.881014 ZAVE =   30.881014
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.7984534"
Evaluating: -20.7984534+3.5
 Parameter: XMAX <- "-17.2984534"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.5715515"
Evaluating: 17.5715515+3.5
 Parameter: YMAX <- "21.0715515"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.8810143"
Evaluating: 30.8810143+3.5
 Parameter: ZMAX <- "34.3810143"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.7984534"
Evaluating: -20.7984534-3.5
 Parameter: XMIN <- "-24.2984534"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.5715515"
Evaluating: 17.5715515-3.5
 Parameter: YMIN <- "14.0715515"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.8810143"
Evaluating: 30.8810143-3.5
 Parameter: ZMIN <- "27.3810143"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.2984534"
 Parameter: XMIN -> "-24.2984534"
 Parameter: YMAX -> "21.0715515"
 Parameter: YMIN -> "14.0715515"
 Parameter: ZMAX -> "34.3810143"
 Parameter: ZMIN -> "27.3810143"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      0 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "82"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "82" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "82"
Evaluating: 82
 Parameter: J <- "82"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "82" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "82"
 Parameter: NPOS -> "80"
Evaluating: 82-80
 Parameter: J <- "2"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "2"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.430459765"
Evaluating: (89.1533903-9.0)*(0.430459765-0.5)
 Parameter: XPOS <- "-5.5738856"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.953974852"
Evaluating: (89.1533903-9.0)*(0.953974852-0.5)
 Parameter: YPOS <- "36.3876235"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.363960866"
Evaluating: (89.1533903-9.0)*(0.363960866-0.5)
 Parameter: ZPOS <- "-10.9039978"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.5738856"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -5.5738856-44.5766951
 Parameter: XTRAN <- "-50.1505807"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "36.3876235"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 36.3876235-44.5766951
 Parameter: YTRAN <- "-8.1890716"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-10.9039978"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -10.9039978-44.5766951
 Parameter: ZTRAN <- "-55.4806929"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-50.1505807"
 Parameter: YTRAN -> "-8.1890716"
 Parameter: ZTRAN -> "-55.4806929"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -50.150581   -8.189072  -55.480693
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.615112003"
Evaluating: 0.615112003*360.0
 Parameter: XPHI <- "221.440321"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.42614982"
Evaluating: 0.42614982*360.0
 Parameter: YPHI <- "153.413935"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.59480783"
Evaluating: 0.59480783*360.0
 Parameter: ZPHI <- "214.130819"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.5738856"
 Parameter: YPOS -> "36.3876235"
 Parameter: ZPOS -> "-10.9039978"
 Parameter: XPHI -> "221.440321"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.749645   -0.661840
    0.000000    0.661840   -0.749645

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  138.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.5738856"
 Parameter: YPOS -> "36.3876235"
 Parameter: ZPOS -> "-10.9039978"
 Parameter: YPHI -> "153.413935"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.894263    0.000000   -0.447542
    0.000000    1.000000    0.000000
    0.447542    0.000000   -0.894263

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  153.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.5738856"
 Parameter: YPOS -> "36.3876235"
 Parameter: ZPOS -> "-10.9039978"
 Parameter: ZPHI -> "214.130819"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.827759   -0.561084    0.000000
    0.561084   -0.827759    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  145.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.573886 XMAX =   -5.573886 XAVE =   -5.573886
    YMIN =   36.387624 YMAX =   36.387624 YAVE =   36.387624
    ZMIN =  -10.903998 ZMAX =  -10.903998 ZAVE =  -10.903998
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.5738856"
Evaluating: -5.5738856+3.5
 Parameter: XMAX <- "-2.0738856"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "36.3876235"
Evaluating: 36.3876235+3.5
 Parameter: YMAX <- "39.8876235"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-10.9039978"
Evaluating: -10.9039978+3.5
 Parameter: ZMAX <- "-7.4039978"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.5738856"
Evaluating: -5.5738856-3.5
 Parameter: XMIN <- "-9.0738856"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "36.3876235"
Evaluating: 36.3876235-3.5
 Parameter: YMIN <- "32.8876235"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-10.9039978"
Evaluating: -10.9039978-3.5
 Parameter: ZMIN <- "-14.4039978"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.0738856"
 Parameter: XMIN -> "-9.0738856"
 Parameter: YMAX -> "39.8876235"
 Parameter: YMIN -> "32.8876235"
 Parameter: ZMAX -> "-7.4039978"
 Parameter: ZMIN -> "-14.4039978"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      0 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "83"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "83" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "83" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "83"
 Parameter: NPOS -> "80"
Evaluating: 83-80
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.32107718"
Evaluating: (89.1533903-9.0)*(0.32107718-0.5)
 Parameter: XPOS <- "-14.3412706"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.456973359"
Evaluating: (89.1533903-9.0)*(0.456973359-0.5)
 Parameter: YPOS <- "-3.44873115"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.127469155"
Evaluating: (89.1533903-9.0)*(0.127469155-0.5)
 Parameter: ZPOS <- "-29.8596102"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-14.3412706"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -14.3412706-44.5766951
 Parameter: XTRAN <- "-58.9179657"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.44873115"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -3.44873115-44.5766951
 Parameter: YTRAN <- "-48.0254263"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-29.8596102"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -29.8596102-44.5766951
 Parameter: ZTRAN <- "-74.4363053"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-58.9179657"
 Parameter: YTRAN -> "-48.0254263"
 Parameter: ZTRAN -> "-74.4363053"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -58.917966  -48.025426  -74.436305
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.399925514"
Evaluating: 0.399925514*360.0
 Parameter: XPHI <- "143.973185"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.494144838"
Evaluating: 0.494144838*360.0
 Parameter: YPHI <- "177.892142"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.58585949"
Evaluating: 0.58585949*360.0
 Parameter: ZPHI <- "210.909416"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-14.3412706"
 Parameter: YPOS -> "-3.44873115"
 Parameter: ZPOS -> "-29.8596102"
 Parameter: XPHI -> "143.973185"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.808742    0.588164
    0.000000   -0.588164   -0.808742

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  143.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-14.3412706"
 Parameter: YPOS -> "-3.44873115"
 Parameter: ZPOS -> "-29.8596102"
 Parameter: YPHI -> "177.892142"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.999323    0.000000   -0.036781
    0.000000    1.000000    0.000000
    0.036781    0.000000   -0.999323

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  177.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-14.3412706"
 Parameter: YPOS -> "-3.44873115"
 Parameter: ZPOS -> "-29.8596102"
 Parameter: ZPHI -> "210.909416"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.857980   -0.513682    0.000000
    0.513682   -0.857980    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  149.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.341271 XMAX =  -14.341271 XAVE =  -14.341271
    YMIN =   -3.448731 YMAX =   -3.448731 YAVE =   -3.448731
    ZMIN =  -29.859610 ZMAX =  -29.859610 ZAVE =  -29.859610
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-14.3412706"
Evaluating: -14.3412706+3.5
 Parameter: XMAX <- "-10.8412706"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.44873119"
Evaluating: -3.44873119+3.5
 Parameter: YMAX <- "5.126881E-02"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-29.8596102"
Evaluating: -29.8596102+3.5
 Parameter: ZMAX <- "-26.3596102"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-14.3412706"
Evaluating: -14.3412706-3.5
 Parameter: XMIN <- "-17.8412706"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.44873119"
Evaluating: -3.44873119-3.5
 Parameter: YMIN <- "-6.94873119"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-29.8596102"
Evaluating: -29.8596102-3.5
 Parameter: ZMIN <- "-33.3596102"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-10.8412706"
 Parameter: XMIN -> "-17.8412706"
 Parameter: YMAX -> "5.126881E-02"
 Parameter: YMIN -> "-6.94873119"
 Parameter: ZMAX -> "-26.3596102"
 Parameter: ZMIN -> "-33.3596102"
 SELRPN>     11 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      7 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9185 NEG      CLA      3        CLA     -2444 PAA1     GLY      180      C             4.0163
 9185 NEG      CLA      3        CLA     -2445 PAA1     GLY      180      O             4.0908
 9185 NEG      CLA      3        CLA     -2448 PAA1     GLY      181      CA            3.5122
 9185 NEG      CLA      3        CLA     -2463 PAA1     TYR      182      CE1           4.1247
 9185 NEG      CLA      3        CLA     -2466 PAA1     TYR      182      OH            3.7480
 9185 NEG      CLA      3        CLA     -9151 POS      SOD      49       SOD           2.6549
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "83" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "83"
 Parameter: NPOS -> "80"
Evaluating: 83-80
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.958326316"
Evaluating: (89.1533903-9.0)*(0.958326316-0.5)
 Parameter: XPOS <- "36.7364081"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.668376216"
Evaluating: (89.1533903-9.0)*(0.668376216-0.5)
 Parameter: YPOS <- "13.4959246"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "8.717131796E-02"
Evaluating: (89.1533903-9.0)*(8.717131796E-02-0.5)
 Parameter: ZPOS <- "-33.0896185"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -14.341271 XMAX =  -14.341271 XAVE =  -14.341271
    YMIN =   -3.448731 YMAX =   -3.448731 YAVE =   -3.448731
    ZMIN =  -29.859610 ZMAX =  -29.859610 ZAVE =  -29.859610
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.7364081"
 RDCMND substituted energy or value "?XAVE" to "-14.3412706"
Evaluating: 36.7364081--14.3412706
 Parameter: XTRAN <- "51.0776787"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.4959246"
 RDCMND substituted energy or value "?YAVE" to "-3.44873119"
Evaluating: 13.4959246--3.44873119
 Parameter: YTRAN <- "16.9446558"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.0896185"
 RDCMND substituted energy or value "?ZAVE" to "-29.8596102"
Evaluating: -33.0896185--29.8596102
 Parameter: ZTRAN <- "-3.2300083"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "51.0776787"
 Parameter: YTRAN -> "16.9446558"
 Parameter: ZTRAN -> "-3.2300083"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    51.077679   16.944656   -3.230008
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.906433059"
Evaluating: 0.906433059*360.0
 Parameter: XPHI <- "326.315901"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.209349323"
Evaluating: 0.209349323*360.0
 Parameter: YPHI <- "75.3657563"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.33430719"
Evaluating: 0.33430719*360.0
 Parameter: ZPHI <- "120.350588"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.7364081"
 Parameter: YPOS -> "13.4959246"
 Parameter: ZPOS -> "-33.0896185"
 Parameter: XPHI -> "326.315901"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.832108   -0.554614
    0.000000    0.554614    0.832108

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   33.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.7364081"
 Parameter: YPOS -> "13.4959246"
 Parameter: ZPOS -> "-33.0896185"
 Parameter: YPHI -> "75.3657563"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.252648    0.000000   -0.967558
    0.000000    1.000000    0.000000
    0.967558    0.000000    0.252648

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   75.37

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.7364081"
 Parameter: YPOS -> "13.4959246"
 Parameter: ZPOS -> "-33.0896185"
 Parameter: ZPHI -> "120.350588"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.505290    0.862950    0.000000
   -0.862950   -0.505290    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  120.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.736408 XMAX =   36.736408 XAVE =   36.736408
    YMIN =   13.495925 YMAX =   13.495925 YAVE =   13.495925
    ZMIN =  -33.089619 ZMAX =  -33.089619 ZAVE =  -33.089619
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.7364081"
Evaluating: 36.7364081+3.5
 Parameter: XMAX <- "40.2364081"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.4959246"
Evaluating: 13.4959246+3.5
 Parameter: YMAX <- "16.9959246"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.0896185"
Evaluating: -33.0896185+3.5
 Parameter: ZMAX <- "-29.5896185"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.7364081"
Evaluating: 36.7364081-3.5
 Parameter: XMIN <- "33.2364081"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.4959246"
Evaluating: 13.4959246-3.5
 Parameter: YMIN <- "9.9959246"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.0896185"
Evaluating: -33.0896185-3.5
 Parameter: ZMIN <- "-36.5896185"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.2364081"
 Parameter: XMIN -> "33.2364081"
 Parameter: YMAX -> "16.9959246"
 Parameter: YMIN -> "9.9959246"
 Parameter: ZMAX -> "-29.5896185"
 Parameter: ZMIN -> "-36.5896185"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      1 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9185 NEG      CLA      3        CLA     -9147 POS      SOD      45       SOD           3.8287
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "83" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "83"
 Parameter: NPOS -> "80"
Evaluating: 83-80
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "4.366382454E-02"
Evaluating: (89.1533903-9.0)*(4.366382454E-02-0.5)
 Parameter: XPOS <- "-36.5768916"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "4.177079753E-02"
Evaluating: (89.1533903-9.0)*(4.177079753E-02-0.5)
 Parameter: YPOS <- "-36.7286241"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.991887855"
Evaluating: (89.1533903-9.0)*(0.991887855-0.5)
 Parameter: ZPOS <- "39.4264792"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.736408 XMAX =   36.736408 XAVE =   36.736408
    YMIN =   13.495925 YMAX =   13.495925 YAVE =   13.495925
    ZMIN =  -33.089619 ZMAX =  -33.089619 ZAVE =  -33.089619
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.5768916"
 RDCMND substituted energy or value "?XAVE" to "36.7364081"
Evaluating: -36.5768916-36.7364081
 Parameter: XTRAN <- "-73.3132997"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-36.7286241"
 RDCMND substituted energy or value "?YAVE" to "13.4959246"
Evaluating: -36.7286241-13.4959246
 Parameter: YTRAN <- "-50.2245487"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.4264792"
 RDCMND substituted energy or value "?ZAVE" to "-33.0896185"
Evaluating: 39.4264792--33.0896185
 Parameter: ZTRAN <- "72.5160977"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-73.3132997"
 Parameter: YTRAN -> "-50.2245487"
 Parameter: ZTRAN -> "72.5160977"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -73.313300  -50.224549   72.516098
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.111422206"
Evaluating: 0.111422206*360.0
 Parameter: XPHI <- "40.1119942"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.801313458"
Evaluating: 0.801313458*360.0
 Parameter: YPHI <- "288.472845"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.12637019"
Evaluating: 0.12637019*360.0
 Parameter: ZPHI <- "45.4932684"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.5768916"
 Parameter: YPOS -> "-36.7286241"
 Parameter: ZPOS -> "39.4264792"
 Parameter: XPHI -> "40.1119942"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.764787    0.644284
    0.000000   -0.644284    0.764787

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   40.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.5768916"
 Parameter: YPOS -> "-36.7286241"
 Parameter: ZPOS -> "39.4264792"
 Parameter: YPHI -> "288.472845"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.316855    0.000000    0.948474
    0.000000    1.000000    0.000000
   -0.948474    0.000000    0.316855

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   71.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.5768916"
 Parameter: YPOS -> "-36.7286241"
 Parameter: ZPOS -> "39.4264792"
 Parameter: ZPHI -> "45.4932684"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.700993    0.713168    0.000000
   -0.713168    0.700993    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   45.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.576892 XMAX =  -36.576892 XAVE =  -36.576892
    YMIN =  -36.728624 YMAX =  -36.728624 YAVE =  -36.728624
    ZMIN =   39.426479 ZMAX =   39.426479 ZAVE =   39.426479
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.5768916"
Evaluating: -36.5768916+3.5
 Parameter: XMAX <- "-33.0768916"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-36.7286241"
Evaluating: -36.7286241+3.5
 Parameter: YMAX <- "-33.2286241"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.4264792"
Evaluating: 39.4264792+3.5
 Parameter: ZMAX <- "42.9264792"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.5768916"
Evaluating: -36.5768916-3.5
 Parameter: XMIN <- "-40.0768916"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-36.7286241"
Evaluating: -36.7286241-3.5
 Parameter: YMIN <- "-40.2286241"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.4264792"
Evaluating: 39.4264792-3.5
 Parameter: ZMIN <- "35.9264792"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-33.0768916"
 Parameter: XMIN -> "-40.0768916"
 Parameter: YMAX -> "-33.2286241"
 Parameter: YMIN -> "-40.2286241"
 Parameter: ZMAX -> "42.9264792"
 Parameter: ZMIN -> "35.9264792"
 SELRPN>      7 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      5 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9185 NEG      CLA      3        CLA     -8880 PAA2     ASP      331      CB            3.5958
 9185 NEG      CLA      3        CLA     -8883 PAA2     ASP      331      CG            2.1984
 9185 NEG      CLA      3        CLA     -8884 PAA2     ASP      331      OD1           1.5913
 9185 NEG      CLA      3        CLA     -8885 PAA2     ASP      331      OD2           2.4701
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "3"
Evaluating: 3+1
 Parameter: CNTRAND <- "4"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "4" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "83" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "83"
 Parameter: NPOS -> "80"
Evaluating: 83-80
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.224477387"
Evaluating: (89.1533903-9.0)*(0.224477387-0.5)
 Parameter: XPOS <- "-22.0840715"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.455039171"
Evaluating: (89.1533903-9.0)*(0.455039171-0.5)
 Parameter: YPOS <- "-3.60376288"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.679939828"
Evaluating: (89.1533903-9.0)*(0.679939828-0.5)
 Parameter: ZPOS <- "14.4227873"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.576892 XMAX =  -36.576892 XAVE =  -36.576892
    YMIN =  -36.728624 YMAX =  -36.728624 YAVE =  -36.728624
    ZMIN =   39.426479 ZMAX =   39.426479 ZAVE =   39.426479
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-22.0840715"
 RDCMND substituted energy or value "?XAVE" to "-36.5768916"
Evaluating: -22.0840715--36.5768916
 Parameter: XTRAN <- "14.4928201"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.60376288"
 RDCMND substituted energy or value "?YAVE" to "-36.7286241"
Evaluating: -3.60376288--36.7286241
 Parameter: YTRAN <- "33.1248612"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "14.4227873"
 RDCMND substituted energy or value "?ZAVE" to "39.4264792"
Evaluating: 14.4227873-39.4264792
 Parameter: ZTRAN <- "-25.0036919"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.4928201"
 Parameter: YTRAN -> "33.1248612"
 Parameter: ZTRAN -> "-25.0036919"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    14.492820   33.124861  -25.003692
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.504407938"
Evaluating: 0.504407938*360.0
 Parameter: XPHI <- "181.586858"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.346204337"
Evaluating: 0.346204337*360.0
 Parameter: YPHI <- "124.633561"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.830554524"
Evaluating: 0.830554524*360.0
 Parameter: ZPHI <- "298.999629"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-22.0840715"
 Parameter: YPOS -> "-3.60376288"
 Parameter: ZPOS -> "14.4227873"
 Parameter: XPHI -> "181.586858"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999616   -0.027692
    0.000000    0.027692   -0.999616

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  178.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-22.0840715"
 Parameter: YPOS -> "-3.60376288"
 Parameter: ZPOS -> "14.4227873"
 Parameter: YPHI -> "124.633561"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.568326    0.000000   -0.822804
    0.000000    1.000000    0.000000
    0.822804    0.000000   -0.568326

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  124.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-22.0840715"
 Parameter: YPOS -> "-3.60376288"
 Parameter: ZPOS -> "14.4227873"
 Parameter: ZPHI -> "298.999629"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.484804   -0.874623    0.000000
    0.874623    0.484804    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   61.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.084072 XMAX =  -22.084072 XAVE =  -22.084072
    YMIN =   -3.603763 YMAX =   -3.603763 YAVE =   -3.603763
    ZMIN =   14.422787 ZMAX =   14.422787 ZAVE =   14.422787
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-22.0840715"
Evaluating: -22.0840715+3.5
 Parameter: XMAX <- "-18.5840715"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.60376286"
Evaluating: -3.60376286+3.5
 Parameter: YMAX <- "-0.10376286"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "14.4227873"
Evaluating: 14.4227873+3.5
 Parameter: ZMAX <- "17.9227873"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-22.0840715"
Evaluating: -22.0840715-3.5
 Parameter: XMIN <- "-25.5840715"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.60376286"
Evaluating: -3.60376286-3.5
 Parameter: YMIN <- "-7.10376286"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "14.4227873"
Evaluating: 14.4227873-3.5
 Parameter: ZMIN <- "10.9227873"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-18.5840715"
 Parameter: XMIN -> "-25.5840715"
 Parameter: YMAX -> "-0.10376286"
 Parameter: YMIN -> "-7.10376286"
 Parameter: ZMAX -> "17.9227873"
 Parameter: ZMIN -> "10.9227873"
 SELRPN>     29 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "29"
 Comparing "29" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     15 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9185 NEG      CLA      3        CLA     - 400 PAA1     SER      27       CA            3.6620
 9185 NEG      CLA      3        CLA     - 407 PAA1     SER      27       C             2.7862
 9185 NEG      CLA      3        CLA     - 408 PAA1     SER      27       O             1.8942
 9185 NEG      CLA      3        CLA     - 409 PAA1     PHE      28       N             3.6274
 9185 NEG      CLA      3        CLA     - 411 PAA1     PHE      28       CA            3.9045
 9185 NEG      CLA      3        CLA     - 427 PAA1     PHE      28       C             4.3827
 9185 NEG      CLA      3        CLA     - 428 PAA1     PHE      28       O             4.3251
 9185 NEG      CLA      3        CLA     - 463 PAA1     GLY      31       N             3.3821
 9185 NEG      CLA      3        CLA     - 465 PAA1     GLY      31       CA            3.4053
 9185 NEG      CLA      3        CLA     -1496 PAA1     ALA      105      O             3.9300
 9185 NEG      CLA      3        CLA     -1534 PAA1     ASN      108      ND2           3.4329
 9185 NEG      CLA      3        CLA     -1539 PAA1     ALA      109      N             4.1977
 9185 NEG      CLA      3        CLA     -1600 PAA1     GLN      112      NE2           3.6644
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        13
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "13"
 Comparing "13" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "4"
Evaluating: 4+1
 Parameter: CNTRAND <- "5"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "5" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "83"
Evaluating: 83
 Parameter: J <- "83"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "83" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "83"
 Parameter: NPOS -> "80"
Evaluating: 83-80
 Parameter: J <- "3"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "3"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.428998904"
Evaluating: (89.1533903-9.0)*(0.428998904-0.5)
 Parameter: XPOS <- "-5.69097856"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.14535411"
Evaluating: (89.1533903-9.0)*(0.14535411-0.5)
 Parameter: YPOS <- "-28.4260704"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.234020307"
Evaluating: (89.1533903-9.0)*(0.234020307-0.5)
 Parameter: ZPOS <- "-21.3191741"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -22.084072 XMAX =  -22.084072 XAVE =  -22.084072
    YMIN =   -3.603763 YMAX =   -3.603763 YAVE =   -3.603763
    ZMIN =   14.422787 ZMAX =   14.422787 ZAVE =   14.422787
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.69097856"
 RDCMND substituted energy or value "?XAVE" to "-22.0840715"
Evaluating: -5.69097856--22.0840715
 Parameter: XTRAN <- "16.3930929"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-28.4260704"
 RDCMND substituted energy or value "?YAVE" to "-3.60376286"
Evaluating: -28.4260704--3.60376286
 Parameter: YTRAN <- "-24.8223075"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.3191741"
 RDCMND substituted energy or value "?ZAVE" to "14.4227873"
Evaluating: -21.3191741-14.4227873
 Parameter: ZTRAN <- "-35.7419614"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "16.3930929"
 Parameter: YTRAN -> "-24.8223075"
 Parameter: ZTRAN -> "-35.7419614"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    16.393093  -24.822308  -35.741961
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.694213136"
Evaluating: 0.694213136*360.0
 Parameter: XPHI <- "249.916729"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.406184957E-02"
Evaluating: 1.406184957E-02*360.0
 Parameter: YPHI <- "5.06226585"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.490566011"
Evaluating: 0.490566011*360.0
 Parameter: ZPHI <- "176.603764"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.69097856"
 Parameter: YPOS -> "-28.4260704"
 Parameter: ZPOS -> "-21.3191741"
 Parameter: XPHI -> "249.916729"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.343385   -0.939195
    0.000000    0.939195   -0.343385

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  110.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.69097856"
 Parameter: YPOS -> "-28.4260704"
 Parameter: ZPOS -> "-21.3191741"
 Parameter: YPHI -> "5.06226585"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.996099    0.000000   -0.088238
    0.000000    1.000000    0.000000
    0.088238    0.000000    0.996099

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    5.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.69097856"
 Parameter: YPOS -> "-28.4260704"
 Parameter: ZPOS -> "-21.3191741"
 Parameter: ZPHI -> "176.603764"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.998244    0.059241    0.000000
   -0.059241   -0.998244    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  176.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.690978 XMAX =   -5.690978 XAVE =   -5.690978
    YMIN =  -28.426070 YMAX =  -28.426070 YAVE =  -28.426070
    ZMIN =  -21.319174 ZMAX =  -21.319174 ZAVE =  -21.319174
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.69097847"
Evaluating: -5.69097847+3.5
 Parameter: XMAX <- "-2.19097847"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-28.4260704"
Evaluating: -28.4260704+3.5
 Parameter: YMAX <- "-24.9260704"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.3191741"
Evaluating: -21.3191741+3.5
 Parameter: ZMAX <- "-17.8191741"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.69097847"
Evaluating: -5.69097847-3.5
 Parameter: XMIN <- "-9.19097847"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-28.4260704"
Evaluating: -28.4260704-3.5
 Parameter: YMIN <- "-31.9260704"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.3191741"
Evaluating: -21.3191741-3.5
 Parameter: ZMIN <- "-24.8191741"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.19097847"
 Parameter: XMIN -> "-9.19097847"
 Parameter: YMAX -> "-24.9260704"
 Parameter: YMIN -> "-31.9260704"
 Parameter: ZMAX -> "-17.8191741"
 Parameter: ZMIN -> "-24.8191741"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "84"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "84" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "84"
Evaluating: 84
 Parameter: J <- "84"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "84" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "84"
 Parameter: NPOS -> "80"
Evaluating: 84-80
 Parameter: J <- "4"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "4"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.352622858"
Evaluating: (89.1533903-9.0)*(0.352622858-0.5)
 Parameter: XPOS <- "-11.8127776"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.189791303"
Evaluating: (89.1533903-9.0)*(0.189791303-0.5)
 Parameter: YPOS <- "-24.8642788"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.110758984"
Evaluating: (89.1533903-9.0)*(0.110758984-0.5)
 Parameter: ZPOS <- "-31.1989871"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.8127776"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -11.8127776-44.5766951
 Parameter: XTRAN <- "-56.3894727"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-24.8642788"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -24.8642788-44.5766951
 Parameter: YTRAN <- "-69.4409739"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.1989871"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -31.1989871-44.5766951
 Parameter: ZTRAN <- "-75.7756822"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-56.3894727"
 Parameter: YTRAN -> "-69.4409739"
 Parameter: ZTRAN -> "-75.7756822"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -56.389473  -69.440974  -75.775682
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.713293398"
Evaluating: 0.713293398*360.0
 Parameter: XPHI <- "256.785623"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.193346188"
Evaluating: 0.193346188*360.0
 Parameter: YPHI <- "69.6046277"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.501526299"
Evaluating: 0.501526299*360.0
 Parameter: ZPHI <- "180.549468"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.8127776"
 Parameter: YPOS -> "-24.8642788"
 Parameter: ZPOS -> "-31.1989871"
 Parameter: XPHI -> "256.785623"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.228595   -0.973522
    0.000000    0.973522   -0.228595

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  103.21

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.8127776"
 Parameter: YPOS -> "-24.8642788"
 Parameter: ZPOS -> "-31.1989871"
 Parameter: YPHI -> "69.6046277"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.348496    0.000000   -0.937310
    0.000000    1.000000    0.000000
    0.937310    0.000000    0.348496

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   69.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.8127776"
 Parameter: YPOS -> "-24.8642788"
 Parameter: ZPOS -> "-31.1989871"
 Parameter: ZPHI -> "180.549468"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.999954   -0.009590    0.000000
    0.009590   -0.999954    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  179.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.812778 XMAX =  -11.812778 XAVE =  -11.812778
    YMIN =  -24.864279 YMAX =  -24.864279 YAVE =  -24.864279
    ZMIN =  -31.198987 ZMAX =  -31.198987 ZAVE =  -31.198987
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.8127776"
Evaluating: -11.8127776+3.5
 Parameter: XMAX <- "-8.3127776"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-24.8642788"
Evaluating: -24.8642788+3.5
 Parameter: YMAX <- "-21.3642788"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.1989871"
Evaluating: -31.1989871+3.5
 Parameter: ZMAX <- "-27.6989871"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.8127776"
Evaluating: -11.8127776-3.5
 Parameter: XMIN <- "-15.3127776"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-24.8642788"
Evaluating: -24.8642788-3.5
 Parameter: YMIN <- "-28.3642788"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.1989871"
Evaluating: -31.1989871-3.5
 Parameter: ZMIN <- "-34.6989871"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.3127776"
 Parameter: XMIN -> "-15.3127776"
 Parameter: YMAX -> "-21.3642788"
 Parameter: YMIN -> "-28.3642788"
 Parameter: ZMAX -> "-27.6989871"
 Parameter: ZMIN -> "-34.6989871"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "85"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "85" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "85"
Evaluating: 85
 Parameter: J <- "85"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "85" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "85"
 Parameter: NPOS -> "80"
Evaluating: 85-80
 Parameter: J <- "5"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "5"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.277522317"
Evaluating: (89.1533903-9.0)*(0.277522317-0.5)
 Parameter: XPOS <- "-17.8323406"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.242841252"
Evaluating: (89.1533903-9.0)*(0.242841252-0.5)
 Parameter: YPOS <- "-20.6121455"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.694413657"
Evaluating: (89.1533903-9.0)*(0.694413657-0.5)
 Parameter: ZPOS <- "15.5829137"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.8323406"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -17.8323406-44.5766951
 Parameter: XTRAN <- "-62.4090357"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-20.6121455"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -20.6121455-44.5766951
 Parameter: YTRAN <- "-65.1888406"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "15.5829137"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 15.5829137-44.5766951
 Parameter: ZTRAN <- "-28.9937814"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-62.4090357"
 Parameter: YTRAN -> "-65.1888406"
 Parameter: ZTRAN -> "-28.9937814"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -62.409036  -65.188841  -28.993781
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.300620145"
Evaluating: 0.300620145*360.0
 Parameter: XPHI <- "108.223252"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.228950634"
Evaluating: 0.228950634*360.0
 Parameter: YPHI <- "82.4222282"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.613660804"
Evaluating: 0.613660804*360.0
 Parameter: ZPHI <- "220.917889"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.8323406"
 Parameter: YPOS -> "-20.6121455"
 Parameter: ZPOS -> "15.5829137"
 Parameter: XPHI -> "108.223252"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.312720    0.949845
    0.000000   -0.949845   -0.312720

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  108.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.8323406"
 Parameter: YPOS -> "-20.6121455"
 Parameter: ZPOS -> "15.5829137"
 Parameter: YPHI -> "82.4222282"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.131872    0.000000   -0.991267
    0.000000    1.000000    0.000000
    0.991267    0.000000    0.131872

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   82.42

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.8323406"
 Parameter: YPOS -> "-20.6121455"
 Parameter: ZPOS -> "15.5829137"
 Parameter: ZPHI -> "220.917889"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.755649   -0.654977    0.000000
    0.654977   -0.755649    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  139.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.832341 XMAX =  -17.832341 XAVE =  -17.832341
    YMIN =  -20.612146 YMAX =  -20.612146 YAVE =  -20.612146
    ZMIN =   15.582914 ZMAX =   15.582914 ZAVE =   15.582914
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.8323406"
Evaluating: -17.8323406+3.5
 Parameter: XMAX <- "-14.3323406"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-20.6121455"
Evaluating: -20.6121455+3.5
 Parameter: YMAX <- "-17.1121455"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "15.5829137"
Evaluating: 15.5829137+3.5
 Parameter: ZMAX <- "19.0829137"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.8323406"
Evaluating: -17.8323406-3.5
 Parameter: XMIN <- "-21.3323406"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-20.6121455"
Evaluating: -20.6121455-3.5
 Parameter: YMIN <- "-24.1121455"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "15.5829137"
Evaluating: 15.5829137-3.5
 Parameter: ZMIN <- "12.0829137"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.3323406"
 Parameter: XMIN -> "-21.3323406"
 Parameter: YMAX -> "-17.1121455"
 Parameter: YMIN -> "-24.1121455"
 Parameter: ZMAX -> "19.0829137"
 Parameter: ZMIN -> "12.0829137"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "86"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "86" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "86"
Evaluating: 86
 Parameter: J <- "86"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "86" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "86"
 Parameter: NPOS -> "80"
Evaluating: 86-80
 Parameter: J <- "6"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "6"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "5.06880069E-02"
Evaluating: (89.1533903-9.0)*(5.06880069E-02-0.5)
 Parameter: XPOS <- "-36.0138795"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.274656198"
Evaluating: (89.1533903-9.0)*(0.274656198-0.5)
 Parameter: YPOS <- "-18.0620697"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.436796686"
Evaluating: (89.1533903-9.0)*(0.436796686-0.5)
 Parameter: ZPOS <- "-5.0659599"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-36.0138795"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -36.0138795-44.5766951
 Parameter: XTRAN <- "-80.5905746"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-18.0620697"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -18.0620697-44.5766951
 Parameter: YTRAN <- "-62.6387648"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-5.0659599"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -5.0659599-44.5766951
 Parameter: ZTRAN <- "-49.642655"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-80.5905746"
 Parameter: YTRAN -> "-62.6387648"
 Parameter: ZTRAN -> "-49.642655"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -80.590575  -62.638765  -49.642655
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.677997375"
Evaluating: 0.677997375*360.0
 Parameter: XPHI <- "244.079055"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.954739178"
Evaluating: 0.954739178*360.0
 Parameter: YPHI <- "343.706104"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.833165656"
Evaluating: 0.833165656*360.0
 Parameter: ZPHI <- "299.939636"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-36.0138795"
 Parameter: YPOS -> "-18.0620697"
 Parameter: ZPOS -> "-5.0659599"
 Parameter: XPHI -> "244.079055"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.437131   -0.899398
    0.000000    0.899398   -0.437131

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  115.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-36.0138795"
 Parameter: YPOS -> "-18.0620697"
 Parameter: ZPOS -> "-5.0659599"
 Parameter: YPHI -> "343.706104"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.959835    0.000000    0.280564
    0.000000    1.000000    0.000000
   -0.280564    0.000000    0.959835

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   16.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-36.0138795"
 Parameter: YPOS -> "-18.0620697"
 Parameter: ZPOS -> "-5.0659599"
 Parameter: ZPHI -> "299.939636"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.499087   -0.866552    0.000000
    0.866552    0.499087    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   60.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -36.013879 XMAX =  -36.013879 XAVE =  -36.013879
    YMIN =  -18.062070 YMAX =  -18.062070 YAVE =  -18.062070
    ZMIN =   -5.065960 ZMAX =   -5.065960 ZAVE =   -5.065960
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-36.0138795"
Evaluating: -36.0138795+3.5
 Parameter: XMAX <- "-32.5138795"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-18.0620697"
Evaluating: -18.0620697+3.5
 Parameter: YMAX <- "-14.5620697"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-5.0659599"
Evaluating: -5.0659599+3.5
 Parameter: ZMAX <- "-1.5659599"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-36.0138795"
Evaluating: -36.0138795-3.5
 Parameter: XMIN <- "-39.5138795"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-18.0620697"
Evaluating: -18.0620697-3.5
 Parameter: YMIN <- "-21.5620697"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-5.0659599"
Evaluating: -5.0659599-3.5
 Parameter: ZMIN <- "-8.5659599"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.5138795"
 Parameter: XMIN -> "-39.5138795"
 Parameter: YMAX -> "-14.5620697"
 Parameter: YMIN -> "-21.5620697"
 Parameter: ZMAX -> "-1.5659599"
 Parameter: ZMIN -> "-8.5659599"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "87"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "87" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "87"
Evaluating: 87
 Parameter: J <- "87"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "87" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "87"
 Parameter: NPOS -> "80"
Evaluating: 87-80
 Parameter: J <- "7"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "7"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "5.46593712E-02"
Evaluating: (89.1533903-9.0)*(5.46593712E-02-0.5)
 Parameter: XPOS <- "-35.6955612"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.379825921"
Evaluating: (89.1533903-9.0)*(0.379825921-0.5)
 Parameter: YPOS <- "-9.63235986"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.358925278"
Evaluating: (89.1533903-9.0)*(0.358925278-0.5)
 Parameter: ZPOS <- "-11.3076173"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.6955612"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -35.6955612-44.5766951
 Parameter: XTRAN <- "-80.2722563"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.63235986"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -9.63235986-44.5766951
 Parameter: YTRAN <- "-54.209055"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-11.3076173"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -11.3076173-44.5766951
 Parameter: ZTRAN <- "-55.8843124"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-80.2722563"
 Parameter: YTRAN -> "-54.209055"
 Parameter: ZTRAN -> "-55.8843124"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -80.272256  -54.209055  -55.884312
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.538236825"
Evaluating: 0.538236825*360.0
 Parameter: XPHI <- "193.765257"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.510477029"
Evaluating: 0.510477029*360.0
 Parameter: YPHI <- "183.77173"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.49882937"
Evaluating: 0.49882937*360.0
 Parameter: ZPHI <- "179.578573"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.6955612"
 Parameter: YPOS -> "-9.63235986"
 Parameter: ZPOS -> "-11.3076173"
 Parameter: XPHI -> "193.765257"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.971279   -0.237945
    0.000000    0.237945   -0.971279

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  166.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.6955612"
 Parameter: YPOS -> "-9.63235986"
 Parameter: ZPOS -> "-11.3076173"
 Parameter: YPHI -> "183.77173"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.997834    0.000000    0.065782
    0.000000    1.000000    0.000000
   -0.065782    0.000000   -0.997834

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  176.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.6955612"
 Parameter: YPOS -> "-9.63235986"
 Parameter: ZPOS -> "-11.3076173"
 Parameter: ZPHI -> "179.578573"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.999973    0.007355    0.000000
   -0.007355   -0.999973    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  179.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.695561 XMAX =  -35.695561 XAVE =  -35.695561
    YMIN =   -9.632360 YMAX =   -9.632360 YAVE =   -9.632360
    ZMIN =  -11.307617 ZMAX =  -11.307617 ZAVE =  -11.307617
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.6955612"
Evaluating: -35.6955612+3.5
 Parameter: XMAX <- "-32.1955612"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.6323599"
Evaluating: -9.6323599+3.5
 Parameter: YMAX <- "-6.1323599"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-11.3076173"
Evaluating: -11.3076173+3.5
 Parameter: ZMAX <- "-7.8076173"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.6955612"
Evaluating: -35.6955612-3.5
 Parameter: XMIN <- "-39.1955612"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.6323599"
Evaluating: -9.6323599-3.5
 Parameter: YMIN <- "-13.1323599"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-11.3076173"
Evaluating: -11.3076173-3.5
 Parameter: ZMIN <- "-14.8076173"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.1955612"
 Parameter: XMIN -> "-39.1955612"
 Parameter: YMAX -> "-6.1323599"
 Parameter: YMIN -> "-13.1323599"
 Parameter: ZMAX -> "-7.8076173"
 Parameter: ZMIN -> "-14.8076173"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "88"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "88" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "88"
Evaluating: 88
 Parameter: J <- "88"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "88" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "88"
 Parameter: NPOS -> "80"
Evaluating: 88-80
 Parameter: J <- "8"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "8"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.87682929"
Evaluating: (89.1533903-9.0)*(0.87682929-0.5)
 Parameter: XPOS <- "30.2041452"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.817462775"
Evaluating: (89.1533903-9.0)*(0.817462775-0.5)
 Parameter: YPOS <- "25.4457177"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "6.56377985E-02"
Evaluating: (89.1533903-9.0)*(6.56377985E-02-0.5)
 Parameter: ZPOS <- "-34.8156031"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.2041452"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 30.2041452-44.5766951
 Parameter: XTRAN <- "-14.3725499"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "25.4457177"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 25.4457177-44.5766951
 Parameter: YTRAN <- "-19.1309774"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.8156031"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -34.8156031-44.5766951
 Parameter: ZTRAN <- "-79.3922982"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-14.3725499"
 Parameter: YTRAN -> "-19.1309774"
 Parameter: ZTRAN -> "-79.3922982"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -14.372550  -19.130977  -79.392298
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.65237424"
Evaluating: 0.65237424*360.0
 Parameter: XPHI <- "234.854726"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.910132705"
Evaluating: 0.910132705*360.0
 Parameter: YPHI <- "327.647774"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.874111998"
Evaluating: 0.874111998*360.0
 Parameter: ZPHI <- "314.680319"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.2041452"
 Parameter: YPOS -> "25.4457177"
 Parameter: ZPOS -> "-34.8156031"
 Parameter: XPHI -> "234.854726"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.575652   -0.817695
    0.000000    0.817695   -0.575652

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  125.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.2041452"
 Parameter: YPOS -> "25.4457177"
 Parameter: ZPOS -> "-34.8156031"
 Parameter: YPHI -> "327.647774"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.844774    0.000000    0.535123
    0.000000    1.000000    0.000000
   -0.535123    0.000000    0.844774

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   32.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.2041452"
 Parameter: YPOS -> "25.4457177"
 Parameter: ZPOS -> "-34.8156031"
 Parameter: ZPHI -> "314.680319"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.703151   -0.711041    0.000000
    0.711041    0.703151    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   45.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.204145 XMAX =   30.204145 XAVE =   30.204145
    YMIN =   25.445718 YMAX =   25.445718 YAVE =   25.445718
    ZMIN =  -34.815603 ZMAX =  -34.815603 ZAVE =  -34.815603
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.2041452"
Evaluating: 30.2041452+3.5
 Parameter: XMAX <- "33.7041452"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "25.4457177"
Evaluating: 25.4457177+3.5
 Parameter: YMAX <- "28.9457177"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.8156031"
Evaluating: -34.8156031+3.5
 Parameter: ZMAX <- "-31.3156031"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.2041452"
Evaluating: 30.2041452-3.5
 Parameter: XMIN <- "26.7041452"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "25.4457177"
Evaluating: 25.4457177-3.5
 Parameter: YMIN <- "21.9457177"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.8156031"
Evaluating: -34.8156031-3.5
 Parameter: ZMIN <- "-38.3156031"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "33.7041452"
 Parameter: XMIN -> "26.7041452"
 Parameter: YMAX -> "28.9457177"
 Parameter: YMIN -> "21.9457177"
 Parameter: ZMAX -> "-31.3156031"
 Parameter: ZMIN -> "-38.3156031"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "89"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "89" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "89"
Evaluating: 89
 Parameter: J <- "89"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "89" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "89"
 Parameter: NPOS -> "80"
Evaluating: 89-80
 Parameter: J <- "9"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "9"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.819542543"
Evaluating: (89.1533903-9.0)*(0.819542543-0.5)
 Parameter: XPOS <- "25.6124182"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "5.096186338E-03"
Evaluating: (89.1533903-9.0)*(5.096186338E-03-0.5)
 Parameter: YPOS <- "-39.6682185"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.308434918"
Evaluating: (89.1533903-9.0)*(0.308434918-0.5)
 Parameter: ZPOS <- "-15.3545908"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.6124182"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 25.6124182-44.5766951
 Parameter: XTRAN <- "-18.9642769"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-39.6682185"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -39.6682185-44.5766951
 Parameter: YTRAN <- "-84.2449136"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.3545908"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -15.3545908-44.5766951
 Parameter: ZTRAN <- "-59.9312859"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.9642769"
 Parameter: YTRAN -> "-84.2449136"
 Parameter: ZTRAN -> "-59.9312859"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -18.964277  -84.244914  -59.931286
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.425117472"
Evaluating: 0.425117472*360.0
 Parameter: XPHI <- "153.04229"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.395189826"
Evaluating: 0.395189826*360.0
 Parameter: YPHI <- "142.268337"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.27077085"
Evaluating: 0.27077085*360.0
 Parameter: ZPHI <- "97.477506"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.6124182"
 Parameter: YPOS -> "-39.6682185"
 Parameter: ZPOS -> "-15.3545908"
 Parameter: XPHI -> "153.04229"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.891341    0.453333
    0.000000   -0.453333   -0.891341

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  153.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.6124182"
 Parameter: YPOS -> "-39.6682185"
 Parameter: ZPOS -> "-15.3545908"
 Parameter: YPHI -> "142.268337"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.790885    0.000000   -0.611964
    0.000000    1.000000    0.000000
    0.611964    0.000000   -0.790885

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  142.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.6124182"
 Parameter: YPOS -> "-39.6682185"
 Parameter: ZPOS -> "-15.3545908"
 Parameter: ZPHI -> "97.477506"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.130137    0.991496    0.000000
   -0.991496   -0.130137    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   97.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.612418 XMAX =   25.612418 XAVE =   25.612418
    YMIN =  -39.668219 YMAX =  -39.668219 YAVE =  -39.668219
    ZMIN =  -15.354591 ZMAX =  -15.354591 ZAVE =  -15.354591
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.6124182"
Evaluating: 25.6124182+3.5
 Parameter: XMAX <- "29.1124182"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-39.6682185"
Evaluating: -39.6682185+3.5
 Parameter: YMAX <- "-36.1682185"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.3545908"
Evaluating: -15.3545908+3.5
 Parameter: ZMAX <- "-11.8545908"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.6124182"
Evaluating: 25.6124182-3.5
 Parameter: XMIN <- "22.1124182"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-39.6682185"
Evaluating: -39.6682185-3.5
 Parameter: YMIN <- "-43.1682185"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.3545908"
Evaluating: -15.3545908-3.5
 Parameter: ZMIN <- "-18.8545908"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.1124182"
 Parameter: XMIN -> "22.1124182"
 Parameter: YMAX -> "-36.1682185"
 Parameter: YMIN -> "-43.1682185"
 Parameter: ZMAX -> "-11.8545908"
 Parameter: ZMIN -> "-18.8545908"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "90"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "90" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "90"
Evaluating: 90
 Parameter: J <- "90"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "90" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "90"
 Parameter: NPOS -> "80"
Evaluating: 90-80
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.144604183"
Evaluating: (89.1533903-9.0)*(0.144604183-0.5)
 Parameter: XPOS <- "-28.4861796"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.774942127"
Evaluating: (89.1533903-9.0)*(0.774942127-0.5)
 Parameter: YPOS <- "22.0375436"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.894735158"
Evaluating: (89.1533903-9.0)*(0.894735158-0.5)
 Parameter: ZPOS <- "31.6393612"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.4861796"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -28.4861796-44.5766951
 Parameter: XTRAN <- "-73.0628747"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.0375436"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 22.0375436-44.5766951
 Parameter: YTRAN <- "-22.5391515"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.6393612"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 31.6393612-44.5766951
 Parameter: ZTRAN <- "-12.9373339"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-73.0628747"
 Parameter: YTRAN -> "-22.5391515"
 Parameter: ZTRAN -> "-12.9373339"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -73.062875  -22.539151  -12.937334
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.643095214"
Evaluating: 0.643095214*360.0
 Parameter: XPHI <- "231.514277"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.977800815"
Evaluating: 0.977800815*360.0
 Parameter: YPHI <- "352.008293"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.53304536"
Evaluating: 0.53304536*360.0
 Parameter: ZPHI <- "191.89633"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.4861796"
 Parameter: YPOS -> "22.0375436"
 Parameter: ZPOS -> "31.6393612"
 Parameter: XPHI -> "231.514277"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.622320   -0.782763
    0.000000    0.782763   -0.622320

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  128.49

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.4861796"
 Parameter: YPOS -> "22.0375436"
 Parameter: ZPOS -> "31.6393612"
 Parameter: YPHI -> "352.008293"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.990288    0.000000    0.139030
    0.000000    1.000000    0.000000
   -0.139030    0.000000    0.990288

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    7.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.4861796"
 Parameter: YPOS -> "22.0375436"
 Parameter: ZPOS -> "31.6393612"
 Parameter: ZPHI -> "191.89633"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.978522   -0.206142    0.000000
    0.206142   -0.978522    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  168.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.486180 XMAX =  -28.486180 XAVE =  -28.486180
    YMIN =   22.037544 YMAX =   22.037544 YAVE =   22.037544
    ZMIN =   31.639361 ZMAX =   31.639361 ZAVE =   31.639361
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.4861796"
Evaluating: -28.4861796+3.5
 Parameter: XMAX <- "-24.9861796"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.0375436"
Evaluating: 22.0375436+3.5
 Parameter: YMAX <- "25.5375436"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.6393612"
Evaluating: 31.6393612+3.5
 Parameter: ZMAX <- "35.1393612"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.4861796"
Evaluating: -28.4861796-3.5
 Parameter: XMIN <- "-31.9861796"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.0375436"
Evaluating: 22.0375436-3.5
 Parameter: YMIN <- "18.5375436"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.6393612"
Evaluating: 31.6393612-3.5
 Parameter: ZMIN <- "28.1393612"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.9861796"
 Parameter: XMIN -> "-31.9861796"
 Parameter: YMAX -> "25.5375436"
 Parameter: YMIN -> "18.5375436"
 Parameter: ZMAX -> "35.1393612"
 Parameter: ZMIN -> "28.1393612"
 SELRPN>     19 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "19"
 Comparing "19" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     11 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9192 NEG      CLA      10       CLA     -7692 PAA2     ALA      242      O             4.3561
 9192 NEG      CLA      10       CLA     -7726 PAA2     ALA      246      N             3.3585
 9192 NEG      CLA      10       CLA     -7728 PAA2     ALA      246      CA            2.1803
 9192 NEG      CLA      10       CLA     -7730 PAA2     ALA      246      CB            1.4310
 9192 NEG      CLA      10       CLA     -7734 PAA2     ALA      246      C             3.0815
 9192 NEG      CLA      10       CLA     -7735 PAA2     ALA      246      O             3.4043
 9192 NEG      CLA      10       CLA     -7736 PAA2     GLY      247      N             4.1293
 9192 NEG      CLA      10       CLA     -7762 PAA2     TYR      249      CD1           3.4604
 9192 NEG      CLA      10       CLA     -7764 PAA2     TYR      249      CE1           2.3455
 9192 NEG      CLA      10       CLA     -7766 PAA2     TYR      249      CZ            2.7182
 9192 NEG      CLA      10       CLA     -7767 PAA2     TYR      249      OH            2.5105
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        11
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "90"
Evaluating: 90
 Parameter: J <- "90"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "90" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "90"
 Parameter: NPOS -> "80"
Evaluating: 90-80
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.40635996"
Evaluating: (89.1533903-9.0)*(0.40635996-0.5)
 Parameter: XPOS <- "-7.50556667"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.553758049"
Evaluating: (89.1533903-9.0)*(0.553758049-0.5)
 Parameter: YPOS <- "4.30888988"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.710884344"
Evaluating: (89.1533903-9.0)*(0.710884344-0.5)
 Parameter: ZPOS <- "16.9030951"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.486180 XMAX =  -28.486180 XAVE =  -28.486180
    YMIN =   22.037544 YMAX =   22.037544 YAVE =   22.037544
    ZMIN =   31.639361 ZMAX =   31.639361 ZAVE =   31.639361
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.50556667"
 RDCMND substituted energy or value "?XAVE" to "-28.4861796"
Evaluating: -7.50556667--28.4861796
 Parameter: XTRAN <- "20.9806129"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.30888988"
 RDCMND substituted energy or value "?YAVE" to "22.0375436"
Evaluating: 4.30888988-22.0375436
 Parameter: YTRAN <- "-17.7286537"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.9030951"
 RDCMND substituted energy or value "?ZAVE" to "31.6393612"
Evaluating: 16.9030951-31.6393612
 Parameter: ZTRAN <- "-14.7362661"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "20.9806129"
 Parameter: YTRAN -> "-17.7286537"
 Parameter: ZTRAN -> "-14.7362661"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    20.980613  -17.728654  -14.736266
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.476381106"
Evaluating: 0.476381106*360.0
 Parameter: XPHI <- "171.497198"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.736589753"
Evaluating: 0.736589753*360.0
 Parameter: YPHI <- "265.172311"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.100706022"
Evaluating: 0.100706022*360.0
 Parameter: ZPHI <- "36.2541679"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.50556667"
 Parameter: YPOS -> "4.30888988"
 Parameter: ZPOS -> "16.9030951"
 Parameter: XPHI -> "171.497198"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.989009    0.147858
    0.000000   -0.147858   -0.989009

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  171.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.50556667"
 Parameter: YPOS -> "4.30888988"
 Parameter: ZPOS -> "16.9030951"
 Parameter: YPHI -> "265.172311"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.084159    0.000000    0.996452
    0.000000    1.000000    0.000000
   -0.996452    0.000000   -0.084159

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   94.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.50556667"
 Parameter: YPOS -> "4.30888988"
 Parameter: ZPOS -> "16.9030951"
 Parameter: ZPHI -> "36.2541679"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.806402    0.591368    0.000000
   -0.591368    0.806402    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   36.25

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.505567 XMAX =   -7.505567 XAVE =   -7.505567
    YMIN =    4.308890 YMAX =    4.308890 YAVE =    4.308890
    ZMIN =   16.903095 ZMAX =   16.903095 ZAVE =   16.903095
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.50556668"
Evaluating: -7.50556668+3.5
 Parameter: XMAX <- "-4.00556668"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.30888986"
Evaluating: 4.30888986+3.5
 Parameter: YMAX <- "7.80888986"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.9030951"
Evaluating: 16.9030951+3.5
 Parameter: ZMAX <- "20.4030951"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.50556668"
Evaluating: -7.50556668-3.5
 Parameter: XMIN <- "-11.0055667"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.30888986"
Evaluating: 4.30888986-3.5
 Parameter: YMIN <- "0.80888986"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.9030951"
Evaluating: 16.9030951-3.5
 Parameter: ZMIN <- "13.4030951"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.00556668"
 Parameter: XMIN -> "-11.0055667"
 Parameter: YMAX -> "7.80888986"
 Parameter: YMIN -> "0.80888986"
 Parameter: ZMAX -> "20.4030951"
 Parameter: ZMIN -> "13.4030951"
 SELRPN>     35 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "35"
 Comparing "35" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     16 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9192 NEG      CLA      10       CLA     - 559 PAA1     PHE      38       CE1           3.2689
 9192 NEG      CLA      10       CLA     - 561 PAA1     PHE      38       CZ            4.3780
 9192 NEG      CLA      10       CLA     - 614 PAA1     GLN      42       CD            3.6777
 9192 NEG      CLA      10       CLA     - 615 PAA1     GLN      42       OE1           4.2219
 9192 NEG      CLA      10       CLA     - 616 PAA1     GLN      42       NE2           3.1520
 9192 NEG      CLA      10       CLA     -1250 PAA1     ILE      85       C             2.7812
 9192 NEG      CLA      10       CLA     -1251 PAA1     ILE      85       O             2.0261
 9192 NEG      CLA      10       CLA     -1252 PAA1     ALA      86       N             2.9285
 9192 NEG      CLA      10       CLA     -1254 PAA1     ALA      86       CA            2.3990
 9192 NEG      CLA      10       CLA     -1256 PAA1     ALA      86       CB            3.6234
 9192 NEG      CLA      10       CLA     -1260 PAA1     ALA      86       C             2.9159
 9192 NEG      CLA      10       CLA     -1261 PAA1     ALA      86       O             2.9126
 9192 NEG      CLA      10       CLA     -1262 PAA1     ALA      87       N             4.0276
 9192 NEG      CLA      10       CLA     -1279 PAA1     SER      88       OG            4.1499
 9192 NEG      CLA      10       CLA     -1399 PAA1     LYS      98       CD            3.2908
 9192 NEG      CLA      10       CLA     -1405 PAA1     LYS      98       NZ            3.0849
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        16
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "16"
 Comparing "16" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "90"
Evaluating: 90
 Parameter: J <- "90"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "90" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "90"
 Parameter: NPOS -> "80"
Evaluating: 90-80
 Parameter: J <- "10"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "10"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.505653686"
Evaluating: (89.1533903-9.0)*(0.505653686-0.5)
 Parameter: XPOS <- "0.453162101"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.947415051"
Evaluating: (89.1533903-9.0)*(0.947415051-0.5)
 Parameter: YPOS <- "35.8618332"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.468808836"
Evaluating: (89.1533903-9.0)*(0.468808836-0.5)
 Parameter: ZPOS <- "-2.50007754"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.505567 XMAX =   -7.505567 XAVE =   -7.505567
    YMIN =    4.308890 YMAX =    4.308890 YAVE =    4.308890
    ZMIN =   16.903095 ZMAX =   16.903095 ZAVE =   16.903095
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.453162101"
 RDCMND substituted energy or value "?XAVE" to "-7.50556668"
Evaluating: 0.453162101--7.50556668
 Parameter: XTRAN <- "7.95872878"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "35.8618332"
 RDCMND substituted energy or value "?YAVE" to "4.30888986"
Evaluating: 35.8618332-4.30888986
 Parameter: YTRAN <- "31.5529433"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-2.50007754"
 RDCMND substituted energy or value "?ZAVE" to "16.9030951"
Evaluating: -2.50007754-16.9030951
 Parameter: ZTRAN <- "-19.4031726"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "7.95872878"
 Parameter: YTRAN -> "31.5529433"
 Parameter: ZTRAN -> "-19.4031726"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR     7.958729   31.552943  -19.403173
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.94180577"
Evaluating: 0.94180577*360.0
 Parameter: XPHI <- "339.050077"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "2.519477455E-02"
Evaluating: 2.519477455E-02*360.0
 Parameter: YPHI <- "9.07011884"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.89735009"
Evaluating: 0.89735009*360.0
 Parameter: ZPHI <- "323.046032"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.453162101"
 Parameter: YPOS -> "35.8618332"
 Parameter: ZPOS -> "-2.50007754"
 Parameter: XPHI -> "339.050077"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.933893   -0.357552
    0.000000    0.357552    0.933893

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   20.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.453162101"
 Parameter: YPOS -> "35.8618332"
 Parameter: ZPOS -> "-2.50007754"
 Parameter: YPHI -> "9.07011884"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.987496    0.000000   -0.157643
    0.000000    1.000000    0.000000
    0.157643    0.000000    0.987496

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS    9.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.453162101"
 Parameter: YPOS -> "35.8618332"
 Parameter: ZPOS -> "-2.50007754"
 Parameter: ZPHI -> "323.046032"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.799119   -0.601173    0.000000
    0.601173    0.799119    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   36.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.453162 XMAX =    0.453162 XAVE =    0.453162
    YMIN =   35.861833 YMAX =   35.861833 YAVE =   35.861833
    ZMIN =   -2.500077 ZMAX =   -2.500077 ZAVE =   -2.500077
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.453162127"
Evaluating: 0.453162127+3.5
 Parameter: XMAX <- "3.95316213"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "35.8618331"
Evaluating: 35.8618331+3.5
 Parameter: YMAX <- "39.3618331"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-2.50007749"
Evaluating: -2.50007749+3.5
 Parameter: ZMAX <- "0.99992251"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.453162127"
Evaluating: 0.453162127-3.5
 Parameter: XMIN <- "-3.04683787"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "35.8618331"
Evaluating: 35.8618331-3.5
 Parameter: YMIN <- "32.3618331"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-2.50007749"
Evaluating: -2.50007749-3.5
 Parameter: ZMIN <- "-6.00007749"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.95316213"
 Parameter: XMIN -> "-3.04683787"
 Parameter: YMAX -> "39.3618331"
 Parameter: YMIN -> "32.3618331"
 Parameter: ZMAX -> "0.99992251"
 Parameter: ZMIN -> "-6.00007749"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "91"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "91" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "91"
Evaluating: 91
 Parameter: J <- "91"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "91" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "91"
 Parameter: NPOS -> "80"
Evaluating: 91-80
 Parameter: J <- "11"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "11"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.102660346"
Evaluating: (89.1533903-9.0)*(0.102660346-0.5)
 Parameter: XPOS <- "-31.8481204"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.184293678"
Evaluating: (89.1533903-9.0)*(0.184293678-0.5)
 Parameter: YPOS <- "-25.304932"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "1.567411566E-03"
Evaluating: (89.1533903-9.0)*(1.567411566E-03-0.5)
 Parameter: ZPOS <- "-39.9510618"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.8481204"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -31.8481204-44.5766951
 Parameter: XTRAN <- "-76.4248155"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.304932"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -25.304932-44.5766951
 Parameter: YTRAN <- "-69.8816271"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.9510618"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -39.9510618-44.5766951
 Parameter: ZTRAN <- "-84.5277569"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-76.4248155"
 Parameter: YTRAN -> "-69.8816271"
 Parameter: ZTRAN -> "-84.5277569"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -76.424815  -69.881627  -84.527757
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.383146632"
Evaluating: 0.383146632*360.0
 Parameter: XPHI <- "137.932788"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.160832889"
Evaluating: 0.160832889*360.0
 Parameter: YPHI <- "57.89984"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "8.261842744E-02"
Evaluating: 8.261842744E-02*360.0
 Parameter: ZPHI <- "29.7426339"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.8481204"
 Parameter: YPOS -> "-25.304932"
 Parameter: ZPOS -> "-39.9510618"
 Parameter: XPHI -> "137.932788"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.742359    0.670002
    0.000000   -0.670002   -0.742359

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  137.93

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.8481204"
 Parameter: YPOS -> "-25.304932"
 Parameter: ZPOS -> "-39.9510618"
 Parameter: YPHI -> "57.89984"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.531401    0.000000   -0.847120
    0.000000    1.000000    0.000000
    0.847120    0.000000    0.531401

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   57.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.8481204"
 Parameter: YPOS -> "-25.304932"
 Parameter: ZPOS -> "-39.9510618"
 Parameter: ZPHI -> "29.7426339"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.868263    0.496105    0.000000
   -0.496105    0.868263    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   29.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.848120 XMAX =  -31.848120 XAVE =  -31.848120
    YMIN =  -25.304932 YMAX =  -25.304932 YAVE =  -25.304932
    ZMIN =  -39.951062 ZMAX =  -39.951062 ZAVE =  -39.951062
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.8481204"
Evaluating: -31.8481204+3.5
 Parameter: XMAX <- "-28.3481204"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.304932"
Evaluating: -25.304932+3.5
 Parameter: YMAX <- "-21.804932"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.9510618"
Evaluating: -39.9510618+3.5
 Parameter: ZMAX <- "-36.4510618"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.8481204"
Evaluating: -31.8481204-3.5
 Parameter: XMIN <- "-35.3481204"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.304932"
Evaluating: -25.304932-3.5
 Parameter: YMIN <- "-28.804932"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.9510618"
Evaluating: -39.9510618-3.5
 Parameter: ZMIN <- "-43.4510618"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-28.3481204"
 Parameter: XMIN -> "-35.3481204"
 Parameter: YMAX -> "-21.804932"
 Parameter: YMIN -> "-28.804932"
 Parameter: ZMAX -> "-36.4510618"
 Parameter: ZMIN -> "-43.4510618"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "92"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "92" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "92"
Evaluating: 92
 Parameter: J <- "92"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "92" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "92"
 Parameter: NPOS -> "80"
Evaluating: 92-80
 Parameter: J <- "12"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.263037123"
Evaluating: (89.1533903-9.0)*(0.263037123-0.5)
 Parameter: XPOS <- "-18.993378"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.896992472"
Evaluating: (89.1533903-9.0)*(0.896992472-0.5)
 Parameter: YPOS <- "31.8202926"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.801469229"
Evaluating: (89.1533903-9.0)*(0.801469229-0.5)
 Parameter: ZPOS <- "24.1637808"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.993378"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -18.993378-44.5766951
 Parameter: XTRAN <- "-63.5700731"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.8202926"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 31.8202926-44.5766951
 Parameter: YTRAN <- "-12.7564025"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "24.1637808"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 24.1637808-44.5766951
 Parameter: ZTRAN <- "-20.4129143"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-63.5700731"
 Parameter: YTRAN -> "-12.7564025"
 Parameter: ZTRAN -> "-20.4129143"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -63.570073  -12.756403  -20.412914
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.643503052"
Evaluating: 0.643503052*360.0
 Parameter: XPHI <- "231.661099"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.666595731"
Evaluating: 0.666595731*360.0
 Parameter: YPHI <- "239.974463"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.876255425"
Evaluating: 0.876255425*360.0
 Parameter: ZPHI <- "315.451953"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.993378"
 Parameter: YPOS -> "31.8202926"
 Parameter: ZPOS -> "24.1637808"
 Parameter: XPHI -> "231.661099"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.620312   -0.784355
    0.000000    0.784355   -0.620312

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  128.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.993378"
 Parameter: YPOS -> "31.8202926"
 Parameter: ZPOS -> "24.1637808"
 Parameter: YPHI -> "239.974463"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.500386    0.000000    0.865802
    0.000000    1.000000    0.000000
   -0.865802    0.000000   -0.500386

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  120.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.993378"
 Parameter: YPOS -> "31.8202926"
 Parameter: ZPOS -> "24.1637808"
 Parameter: ZPHI -> "315.451953"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.712662   -0.701507    0.000000
    0.701507    0.712662    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   44.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.993378 XMAX =  -18.993378 XAVE =  -18.993378
    YMIN =   31.820293 YMAX =   31.820293 YAVE =   31.820293
    ZMIN =   24.163781 ZMAX =   24.163781 ZAVE =   24.163781
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.993378"
Evaluating: -18.993378+3.5
 Parameter: XMAX <- "-15.493378"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.8202926"
Evaluating: 31.8202926+3.5
 Parameter: YMAX <- "35.3202926"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "24.1637808"
Evaluating: 24.1637808+3.5
 Parameter: ZMAX <- "27.6637808"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.993378"
Evaluating: -18.993378-3.5
 Parameter: XMIN <- "-22.493378"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.8202926"
Evaluating: 31.8202926-3.5
 Parameter: YMIN <- "28.3202926"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "24.1637808"
Evaluating: 24.1637808-3.5
 Parameter: ZMIN <- "20.6637808"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.493378"
 Parameter: XMIN -> "-22.493378"
 Parameter: YMAX -> "35.3202926"
 Parameter: YMIN -> "28.3202926"
 Parameter: ZMAX -> "27.6637808"
 Parameter: ZMIN -> "20.6637808"
 SELRPN>      7 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      4 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9194 NEG      CLA      12       CLA     -5780 PAA2     GLU      84       OE1           4.2610
 9194 NEG      CLA      12       CLA     -6762 PAA2     GLY      157      C             4.3497
 9194 NEG      CLA      12       CLA     -6764 PAA2     GLY      158      N             3.3971
 9194 NEG      CLA      12       CLA     -6766 PAA2     GLY      158      CA            2.7187
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "92"
Evaluating: 92
 Parameter: J <- "92"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "92" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "92"
 Parameter: NPOS -> "80"
Evaluating: 92-80
 Parameter: J <- "12"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "12"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.881352198"
Evaluating: (89.1533903-9.0)*(0.881352198-0.5)
 Parameter: XPOS <- "30.5666716"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.506973688"
Evaluating: (89.1533903-9.0)*(0.506973688-0.5)
 Parameter: YPOS <- "0.558964736"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.845738928"
Evaluating: (89.1533903-9.0)*(0.845738928-0.5)
 Parameter: ZPOS <- "27.7121472"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.993378 XMAX =  -18.993378 XAVE =  -18.993378
    YMIN =   31.820293 YMAX =   31.820293 YAVE =   31.820293
    ZMIN =   24.163781 ZMAX =   24.163781 ZAVE =   24.163781
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "30.5666716"
 RDCMND substituted energy or value "?XAVE" to "-18.993378"
Evaluating: 30.5666716--18.993378
 Parameter: XTRAN <- "49.5600496"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "0.558964736"
 RDCMND substituted energy or value "?YAVE" to "31.8202926"
Evaluating: 0.558964736-31.8202926
 Parameter: YTRAN <- "-31.2613279"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.7121472"
 RDCMND substituted energy or value "?ZAVE" to "24.1637808"
Evaluating: 27.7121472-24.1637808
 Parameter: ZTRAN <- "3.5483664"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "49.5600496"
 Parameter: YTRAN -> "-31.2613279"
 Parameter: ZTRAN -> "3.5483664"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    49.560050  -31.261328    3.548366
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.929056363"
Evaluating: 0.929056363*360.0
 Parameter: XPHI <- "334.460291"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.395538835"
Evaluating: 0.395538835*360.0
 Parameter: YPHI <- "142.393981"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.978734193"
Evaluating: 0.978734193*360.0
 Parameter: ZPHI <- "352.344309"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "30.5666716"
 Parameter: YPOS -> "0.558964736"
 Parameter: ZPOS -> "27.7121472"
 Parameter: XPHI -> "334.460291"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.902287   -0.431137
    0.000000    0.431137    0.902287

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   25.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "30.5666716"
 Parameter: YPOS -> "0.558964736"
 Parameter: ZPOS -> "27.7121472"
 Parameter: YPHI -> "142.393981"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.792226    0.000000   -0.610228
    0.000000    1.000000    0.000000
    0.610228    0.000000   -0.792226

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  142.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "30.5666716"
 Parameter: YPOS -> "0.558964736"
 Parameter: ZPOS -> "27.7121472"
 Parameter: ZPHI -> "352.344309"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.991087   -0.133220    0.000000
    0.133220    0.991087    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    7.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   30.566672 XMAX =   30.566672 XAVE =   30.566672
    YMIN =    0.558965 YMAX =    0.558965 YAVE =    0.558965
    ZMIN =   27.712147 ZMAX =   27.712147 ZAVE =   27.712147
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "30.5666716"
Evaluating: 30.5666716+3.5
 Parameter: XMAX <- "34.0666716"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "0.558964705"
Evaluating: 0.558964705+3.5
 Parameter: YMAX <- "4.05896471"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.7121472"
Evaluating: 27.7121472+3.5
 Parameter: ZMAX <- "31.2121472"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "30.5666716"
Evaluating: 30.5666716-3.5
 Parameter: XMIN <- "27.0666716"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "0.558964705"
Evaluating: 0.558964705-3.5
 Parameter: YMIN <- "-2.94103529"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.7121472"
Evaluating: 27.7121472-3.5
 Parameter: ZMIN <- "24.2121472"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "34.0666716"
 Parameter: XMIN -> "27.0666716"
 Parameter: YMAX -> "4.05896471"
 Parameter: YMIN -> "-2.94103529"
 Parameter: ZMAX -> "31.2121472"
 Parameter: ZMIN -> "24.2121472"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "93"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "93" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "93" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "93"
 Parameter: NPOS -> "80"
Evaluating: 93-80
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.275062185"
Evaluating: (89.1533903-9.0)*(0.275062185-0.5)
 Parameter: XPOS <- "-18.0295285"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.960988127"
Evaluating: (89.1533903-9.0)*(0.960988127-0.5)
 Parameter: YPOS <- "36.9497613"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.463532342"
Evaluating: (89.1533903-9.0)*(0.463532342-0.5)
 Parameter: ZPOS <- "-2.92300643"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.0295285"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -18.0295285-44.5766951
 Parameter: XTRAN <- "-62.6062236"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "36.9497613"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 36.9497613-44.5766951
 Parameter: YTRAN <- "-7.6269338"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-2.92300643"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -2.92300643-44.5766951
 Parameter: ZTRAN <- "-47.4997015"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-62.6062236"
 Parameter: YTRAN -> "-7.6269338"
 Parameter: ZTRAN -> "-47.4997015"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -62.606224   -7.626934  -47.499702
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.245929473"
Evaluating: 0.245929473*360.0
 Parameter: XPHI <- "88.5346103"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.393957483"
Evaluating: 0.393957483*360.0
 Parameter: YPHI <- "141.824694"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.921357761"
Evaluating: 0.921357761*360.0
 Parameter: ZPHI <- "331.688794"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.0295285"
 Parameter: YPOS -> "36.9497613"
 Parameter: ZPOS -> "-2.92300643"
 Parameter: XPHI -> "88.5346103"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.025573    0.999673
    0.000000   -0.999673    0.025573

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   88.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.0295285"
 Parameter: YPOS -> "36.9497613"
 Parameter: ZPOS -> "-2.92300643"
 Parameter: YPHI -> "141.824694"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.786123    0.000000   -0.618070
    0.000000    1.000000    0.000000
    0.618070    0.000000   -0.786123

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  141.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.0295285"
 Parameter: YPOS -> "36.9497613"
 Parameter: ZPOS -> "-2.92300643"
 Parameter: ZPHI -> "331.688794"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.880385   -0.474260    0.000000
    0.474260    0.880385    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   28.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.029529 XMAX =  -18.029529 XAVE =  -18.029529
    YMIN =   36.949761 YMAX =   36.949761 YAVE =   36.949761
    ZMIN =   -2.923006 ZMAX =   -2.923006 ZAVE =   -2.923006
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.0295285"
Evaluating: -18.0295285+3.5
 Parameter: XMAX <- "-14.5295285"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "36.9497613"
Evaluating: 36.9497613+3.5
 Parameter: YMAX <- "40.4497613"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-2.92300643"
Evaluating: -2.92300643+3.5
 Parameter: ZMAX <- "0.57699357"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.0295285"
Evaluating: -18.0295285-3.5
 Parameter: XMIN <- "-21.5295285"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "36.9497613"
Evaluating: 36.9497613-3.5
 Parameter: YMIN <- "33.4497613"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-2.92300643"
Evaluating: -2.92300643-3.5
 Parameter: ZMIN <- "-6.42300643"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-14.5295285"
 Parameter: XMIN -> "-21.5295285"
 Parameter: YMAX -> "40.4497613"
 Parameter: YMIN -> "33.4497613"
 Parameter: ZMAX -> "0.57699357"
 Parameter: ZMIN -> "-6.42300643"
 SELRPN>     11 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      6 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9195 NEG      CLA      13       CLA     -5013 PAA2     GLN      30       O             3.5559
 9195 NEG      CLA      13       CLA     -5047 PAA2     SER      33       OG            3.3854
 9195 NEG      CLA      13       CLA     -5053 PAA2     SER      34       CA            3.9431
 9195 NEG      CLA      13       CLA     -5055 PAA2     SER      34       CB            3.4126
 9195 NEG      CLA      13       CLA     -5058 PAA2     SER      34       OG            4.3887
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         5
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "93" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "93"
 Parameter: NPOS -> "80"
Evaluating: 93-80
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.98411321"
Evaluating: (89.1533903-9.0)*(0.98411321-0.5)
 Parameter: XPOS <- "38.8033151"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.888773065"
Evaluating: (89.1533903-9.0)*(0.888773065-0.5)
 Parameter: YPOS <- "31.1614792"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.497575865"
Evaluating: (89.1533903-9.0)*(0.497575865-0.5)
 Parameter: ZPOS <- "-0.194302639"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.029529 XMAX =  -18.029529 XAVE =  -18.029529
    YMIN =   36.949761 YMAX =   36.949761 YAVE =   36.949761
    ZMIN =   -2.923006 ZMAX =   -2.923006 ZAVE =   -2.923006
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "38.8033151"
 RDCMND substituted energy or value "?XAVE" to "-18.0295285"
Evaluating: 38.8033151--18.0295285
 Parameter: XTRAN <- "56.8328436"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "31.1614792"
 RDCMND substituted energy or value "?YAVE" to "36.9497613"
Evaluating: 31.1614792-36.9497613
 Parameter: YTRAN <- "-5.7882821"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-0.194302639"
 RDCMND substituted energy or value "?ZAVE" to "-2.92300643"
Evaluating: -0.194302639--2.92300643
 Parameter: ZTRAN <- "2.72870379"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "56.8328436"
 Parameter: YTRAN -> "-5.7882821"
 Parameter: ZTRAN -> "2.72870379"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    56.832844   -5.788282    2.728704
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.171762749"
Evaluating: 0.171762749*360.0
 Parameter: XPHI <- "61.8345896"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.354880283"
Evaluating: 0.354880283*360.0
 Parameter: YPHI <- "127.756902"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.246046575"
Evaluating: 0.246046575*360.0
 Parameter: ZPHI <- "88.576767"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "38.8033151"
 Parameter: YPOS -> "31.1614792"
 Parameter: ZPOS -> "-0.194302639"
 Parameter: XPHI -> "61.8345896"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.472019    0.881589
    0.000000   -0.881589    0.472019

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   61.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "38.8033151"
 Parameter: YPOS -> "31.1614792"
 Parameter: ZPOS -> "-0.194302639"
 Parameter: YPHI -> "127.756902"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.612313    0.000000   -0.790616
    0.000000    1.000000    0.000000
    0.790616    0.000000   -0.612313

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  127.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "38.8033151"
 Parameter: YPOS -> "31.1614792"
 Parameter: ZPOS -> "-0.194302639"
 Parameter: ZPHI -> "88.576767"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.024838    0.999692    0.000000
   -0.999692    0.024838    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   88.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.803315 XMAX =   38.803315 XAVE =   38.803315
    YMIN =   31.161479 YMAX =   31.161479 YAVE =   31.161479
    ZMIN =   -0.194303 ZMAX =   -0.194303 ZAVE =   -0.194303
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "38.8033151"
Evaluating: 38.8033151+3.5
 Parameter: XMAX <- "42.3033151"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "31.1614792"
Evaluating: 31.1614792+3.5
 Parameter: YMAX <- "34.6614792"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-0.194302636"
Evaluating: -0.194302636+3.5
 Parameter: ZMAX <- "3.30569736"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "38.8033151"
Evaluating: 38.8033151-3.5
 Parameter: XMIN <- "35.3033151"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "31.1614792"
Evaluating: 31.1614792-3.5
 Parameter: YMIN <- "27.6614792"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-0.194302636"
Evaluating: -0.194302636-3.5
 Parameter: ZMIN <- "-3.69430264"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "42.3033151"
 Parameter: XMIN -> "35.3033151"
 Parameter: YMAX -> "34.6614792"
 Parameter: YMIN -> "27.6614792"
 Parameter: ZMAX -> "3.30569736"
 Parameter: ZMIN -> "-3.69430264"
 SELRPN>      9 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "9"
 Comparing "9" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      5 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9195 NEG      CLA      13       CLA     -4667 PAA2     HSD      8        CB            3.8436
 9195 NEG      CLA      13       CLA     -4679 PAA2     HSD      8        O             3.7816
 9195 NEG      CLA      13       CLA     -4701 PAA2     SER      10       CB            4.2792
 9195 NEG      CLA      13       CLA     -4704 PAA2     SER      10       OG            3.8610
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "93"
Evaluating: 93
 Parameter: J <- "93"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "93" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "93"
 Parameter: NPOS -> "80"
Evaluating: 93-80
 Parameter: J <- "13"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "13"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.357572295"
Evaluating: (89.1533903-9.0)*(0.357572295-0.5)
 Parameter: XPOS <- "-11.4160634"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.763584844"
Evaluating: (89.1533903-9.0)*(0.763584844-0.5)
 Parameter: YPOS <- "21.1272189"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.229655252"
Evaluating: (89.1533903-9.0)*(0.229655252-0.5)
 Parameter: ZPOS <- "-21.6690481"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   38.803315 XMAX =   38.803315 XAVE =   38.803315
    YMIN =   31.161479 YMAX =   31.161479 YAVE =   31.161479
    ZMIN =   -0.194303 ZMAX =   -0.194303 ZAVE =   -0.194303
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.4160634"
 RDCMND substituted energy or value "?XAVE" to "38.8033151"
Evaluating: -11.4160634-38.8033151
 Parameter: XTRAN <- "-50.2193785"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "21.1272189"
 RDCMND substituted energy or value "?YAVE" to "31.1614792"
Evaluating: 21.1272189-31.1614792
 Parameter: YTRAN <- "-10.0342603"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.6690481"
 RDCMND substituted energy or value "?ZAVE" to "-0.194302636"
Evaluating: -21.6690481--0.194302636
 Parameter: ZTRAN <- "-21.4747455"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-50.2193785"
 Parameter: YTRAN -> "-10.0342603"
 Parameter: ZTRAN -> "-21.4747455"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -50.219378  -10.034260  -21.474746
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.500243965"
Evaluating: 0.500243965*360.0
 Parameter: XPHI <- "180.087827"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.568025965"
Evaluating: 0.568025965*360.0
 Parameter: YPHI <- "204.489347"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.858241202"
Evaluating: 0.858241202*360.0
 Parameter: ZPHI <- "308.966833"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.4160634"
 Parameter: YPOS -> "21.1272189"
 Parameter: ZPOS -> "-21.6690481"
 Parameter: XPHI -> "180.087827"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.999999   -0.001533
    0.000000    0.001533   -0.999999

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  179.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.4160634"
 Parameter: YPOS -> "21.1272189"
 Parameter: ZPOS -> "-21.6690481"
 Parameter: YPHI -> "204.489347"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.910038    0.000000    0.414524
    0.000000    1.000000    0.000000
   -0.414524    0.000000   -0.910038

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  155.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.4160634"
 Parameter: YPOS -> "21.1272189"
 Parameter: ZPOS -> "-21.6690481"
 Parameter: ZPHI -> "308.966833"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.628870   -0.777510    0.000000
    0.777510    0.628870    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   51.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.416063 XMAX =  -11.416063 XAVE =  -11.416063
    YMIN =   21.127219 YMAX =   21.127219 YAVE =   21.127219
    ZMIN =  -21.669048 ZMAX =  -21.669048 ZAVE =  -21.669048
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.4160634"
Evaluating: -11.4160634+3.5
 Parameter: XMAX <- "-7.9160634"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "21.1272189"
Evaluating: 21.1272189+3.5
 Parameter: YMAX <- "24.6272189"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.6690481"
Evaluating: -21.6690481+3.5
 Parameter: ZMAX <- "-18.1690481"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.4160634"
Evaluating: -11.4160634-3.5
 Parameter: XMIN <- "-14.9160634"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "21.1272189"
Evaluating: 21.1272189-3.5
 Parameter: YMIN <- "17.6272189"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.6690481"
Evaluating: -21.6690481-3.5
 Parameter: ZMIN <- "-25.1690481"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-7.9160634"
 Parameter: XMIN -> "-14.9160634"
 Parameter: YMAX -> "24.6272189"
 Parameter: YMIN -> "17.6272189"
 Parameter: ZMAX -> "-18.1690481"
 Parameter: ZMIN -> "-25.1690481"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "94"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "94" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "94"
Evaluating: 94
 Parameter: J <- "94"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "94" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "94"
 Parameter: NPOS -> "80"
Evaluating: 94-80
 Parameter: J <- "14"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "14"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "8.545590964E-02"
Evaluating: (89.1533903-9.0)*(8.545590964E-02-0.5)
 Parameter: XPOS <- "-33.2271143"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.623894805"
Evaluating: (89.1533903-9.0)*(0.623894805-0.5)
 Parameter: YPOS <- "9.93058866"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "1.664071689E-02"
Evaluating: (89.1533903-9.0)*(1.664071689E-02-0.5)
 Parameter: ZPOS <- "-38.7428853"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.2271143"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -33.2271143-44.5766951
 Parameter: XTRAN <- "-77.8038094"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.93058866"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 9.93058866-44.5766951
 Parameter: YTRAN <- "-34.6461064"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.7428853"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -38.7428853-44.5766951
 Parameter: ZTRAN <- "-83.3195804"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-77.8038094"
 Parameter: YTRAN -> "-34.6461064"
 Parameter: ZTRAN -> "-83.3195804"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -77.803809  -34.646106  -83.319580
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.26473128"
Evaluating: 0.26473128*360.0
 Parameter: XPHI <- "95.3032608"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.529413661"
Evaluating: 0.529413661*360.0
 Parameter: YPHI <- "190.588918"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.704086994E-04"
Evaluating: 9.704086994E-04*360.0
 Parameter: ZPHI <- "0.349347132"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.2271143"
 Parameter: YPOS -> "9.93058866"
 Parameter: ZPOS -> "-38.7428853"
 Parameter: XPHI -> "95.3032608"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.092427    0.995719
    0.000000   -0.995719   -0.092427

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   95.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.2271143"
 Parameter: YPOS -> "9.93058866"
 Parameter: ZPOS -> "-38.7428853"
 Parameter: YPHI -> "190.588918"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.982971    0.000000    0.183761
    0.000000    1.000000    0.000000
   -0.183761    0.000000   -0.982971

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  169.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.2271143"
 Parameter: YPOS -> "9.93058866"
 Parameter: ZPOS -> "-38.7428853"
 Parameter: ZPHI -> "0.349347132"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.999981    0.006097    0.000000
   -0.006097    0.999981    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    0.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.227114 XMAX =  -33.227114 XAVE =  -33.227114
    YMIN =    9.930589 YMAX =    9.930589 YAVE =    9.930589
    ZMIN =  -38.742885 ZMAX =  -38.742885 ZAVE =  -38.742885
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.2271143"
Evaluating: -33.2271143+3.5
 Parameter: XMAX <- "-29.7271143"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.93058866"
Evaluating: 9.93058866+3.5
 Parameter: YMAX <- "13.4305887"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.7428853"
Evaluating: -38.7428853+3.5
 Parameter: ZMAX <- "-35.2428853"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.2271143"
Evaluating: -33.2271143-3.5
 Parameter: XMIN <- "-36.7271143"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.93058866"
Evaluating: 9.93058866-3.5
 Parameter: YMIN <- "6.43058866"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.7428853"
Evaluating: -38.7428853-3.5
 Parameter: ZMIN <- "-42.2428853"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.7271143"
 Parameter: XMIN -> "-36.7271143"
 Parameter: YMAX -> "13.4305887"
 Parameter: YMIN -> "6.43058866"
 Parameter: ZMAX -> "-35.2428853"
 Parameter: ZMIN -> "-42.2428853"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "95"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "95" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "95"
Evaluating: 95
 Parameter: J <- "95"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "95" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "95"
 Parameter: NPOS -> "80"
Evaluating: 95-80
 Parameter: J <- "15"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "15"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.551747466"
Evaluating: (89.1533903-9.0)*(0.551747466-0.5)
 Parameter: XPOS <- "4.14773484"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "3.723568624E-02"
Evaluating: (89.1533903-9.0)*(3.723568624E-02-0.5)
 Parameter: YPOS <- "-37.0921287"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "8.08911629E-02"
Evaluating: (89.1533903-9.0)*(8.08911629E-02-0.5)
 Parameter: ZPOS <- "-33.5929942"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.14773484"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 4.14773484-44.5766951
 Parameter: XTRAN <- "-40.4289603"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-37.0921287"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -37.0921287-44.5766951
 Parameter: YTRAN <- "-81.6688238"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-33.5929942"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -33.5929942-44.5766951
 Parameter: ZTRAN <- "-78.1696893"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-40.4289603"
 Parameter: YTRAN -> "-81.6688238"
 Parameter: ZTRAN -> "-78.1696893"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -40.428960  -81.668824  -78.169689
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.608989206E-02"
Evaluating: 9.608989206E-02*360.0
 Parameter: XPHI <- "34.5923611"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.18674493"
Evaluating: 0.18674493*360.0
 Parameter: YPHI <- "67.2281748"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.894793227"
Evaluating: 0.894793227*360.0
 Parameter: ZPHI <- "322.125562"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.14773484"
 Parameter: YPOS -> "-37.0921287"
 Parameter: ZPOS -> "-33.5929942"
 Parameter: XPHI -> "34.5923611"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.823212    0.567734
    0.000000   -0.567734    0.823212

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   34.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.14773484"
 Parameter: YPOS -> "-37.0921287"
 Parameter: ZPOS -> "-33.5929942"
 Parameter: YPHI -> "67.2281748"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.387062    0.000000   -0.922054
    0.000000    1.000000    0.000000
    0.922054    0.000000    0.387062

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   67.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.14773484"
 Parameter: YPOS -> "-37.0921287"
 Parameter: ZPOS -> "-33.5929942"
 Parameter: ZPHI -> "322.125562"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.789358   -0.613933    0.000000
    0.613933    0.789358    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   37.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.147735 XMAX =    4.147735 XAVE =    4.147735
    YMIN =  -37.092129 YMAX =  -37.092129 YAVE =  -37.092129
    ZMIN =  -33.592994 ZMAX =  -33.592994 ZAVE =  -33.592994
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.14773483"
Evaluating: 4.14773483+3.5
 Parameter: XMAX <- "7.64773483"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-37.0921287"
Evaluating: -37.0921287+3.5
 Parameter: YMAX <- "-33.5921287"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-33.5929942"
Evaluating: -33.5929942+3.5
 Parameter: ZMAX <- "-30.0929942"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.14773483"
Evaluating: 4.14773483-3.5
 Parameter: XMIN <- "0.64773483"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-37.0921287"
Evaluating: -37.0921287-3.5
 Parameter: YMIN <- "-40.5921287"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-33.5929942"
Evaluating: -33.5929942-3.5
 Parameter: ZMIN <- "-37.0929942"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.64773483"
 Parameter: XMIN -> "0.64773483"
 Parameter: YMAX -> "-33.5921287"
 Parameter: YMIN -> "-40.5921287"
 Parameter: ZMAX -> "-30.0929942"
 Parameter: ZMIN -> "-37.0929942"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "96"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "96" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "96"
Evaluating: 96
 Parameter: J <- "96"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "96" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "96"
 Parameter: NPOS -> "80"
Evaluating: 96-80
 Parameter: J <- "16"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "16"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.403527172"
Evaluating: (89.1533903-9.0)*(0.403527172-0.5)
 Parameter: XPOS <- "-7.73262424"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "6.771313806E-02"
Evaluating: (89.1533903-9.0)*(6.771313806E-02-0.5)
 Parameter: YPOS <- "-34.6492576"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.543033164"
Evaluating: (89.1533903-9.0)*(0.543033164-0.5)
 Parameter: ZPOS <- "3.44925399"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-7.73262424"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -7.73262424-44.5766951
 Parameter: XTRAN <- "-52.3093193"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.6492576"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -34.6492576-44.5766951
 Parameter: YTRAN <- "-79.2259527"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "3.44925399"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 3.44925399-44.5766951
 Parameter: ZTRAN <- "-41.1274411"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-52.3093193"
 Parameter: YTRAN -> "-79.2259527"
 Parameter: ZTRAN -> "-41.1274411"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -52.309319  -79.225953  -41.127441
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.273360848"
Evaluating: 0.273360848*360.0
 Parameter: XPHI <- "98.4099053"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.887204013E-02"
Evaluating: 5.887204013E-02*360.0
 Parameter: YPHI <- "21.1939344"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.963587011"
Evaluating: 0.963587011*360.0
 Parameter: ZPHI <- "346.891324"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-7.73262424"
 Parameter: YPOS -> "-34.6492576"
 Parameter: ZPOS -> "3.44925399"
 Parameter: XPHI -> "98.4099053"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.146254    0.989247
    0.000000   -0.989247   -0.146254

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   98.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-7.73262424"
 Parameter: YPOS -> "-34.6492576"
 Parameter: ZPOS -> "3.44925399"
 Parameter: YPHI -> "21.1939344"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.932362    0.000000   -0.361526
    0.000000    1.000000    0.000000
    0.361526    0.000000    0.932362

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   21.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-7.73262424"
 Parameter: YPOS -> "-34.6492576"
 Parameter: ZPOS -> "3.44925399"
 Parameter: ZPHI -> "346.891324"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.973942   -0.226799    0.000000
    0.226799    0.973942    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   13.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -7.732624 XMAX =   -7.732624 XAVE =   -7.732624
    YMIN =  -34.649258 YMAX =  -34.649258 YAVE =  -34.649258
    ZMIN =    3.449254 ZMAX =    3.449254 ZAVE =    3.449254
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-7.73262421"
Evaluating: -7.73262421+3.5
 Parameter: XMAX <- "-4.23262421"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.6492576"
Evaluating: -34.6492576+3.5
 Parameter: YMAX <- "-31.1492576"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "3.449254"
Evaluating: 3.449254+3.5
 Parameter: ZMAX <- "6.949254"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-7.73262421"
Evaluating: -7.73262421-3.5
 Parameter: XMIN <- "-11.2326242"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.6492576"
Evaluating: -34.6492576-3.5
 Parameter: YMIN <- "-38.1492576"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "3.449254"
Evaluating: 3.449254-3.5
 Parameter: ZMIN <- "-5.0746E-02"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-4.23262421"
 Parameter: XMIN -> "-11.2326242"
 Parameter: YMAX -> "-31.1492576"
 Parameter: YMIN -> "-38.1492576"
 Parameter: ZMAX -> "6.949254"
 Parameter: ZMIN -> "-5.0746E-02"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "97"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "97" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "97"
Evaluating: 97
 Parameter: J <- "97"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "97" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "97"
 Parameter: NPOS -> "80"
Evaluating: 97-80
 Parameter: J <- "17"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "17"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.265100566"
Evaluating: (89.1533903-9.0)*(0.265100566-0.5)
 Parameter: XPOS <- "-18.827986"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.276900627"
Evaluating: (89.1533903-9.0)*(0.276900627-0.5)
 Parameter: YPOS <- "-17.8821711"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.258388551"
Evaluating: (89.1533903-9.0)*(0.258388551-0.5)
 Parameter: ZPOS <- "-19.3659768"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-18.827986"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -18.827986-44.5766951
 Parameter: XTRAN <- "-63.4046811"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-17.8821711"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -17.8821711-44.5766951
 Parameter: YTRAN <- "-62.4588662"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.3659768"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -19.3659768-44.5766951
 Parameter: ZTRAN <- "-63.9426719"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-63.4046811"
 Parameter: YTRAN -> "-62.4588662"
 Parameter: ZTRAN -> "-63.9426719"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -63.404681  -62.458866  -63.942672
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.728055273"
Evaluating: 0.728055273*360.0
 Parameter: XPHI <- "262.099898"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.833569669"
Evaluating: 0.833569669*360.0
 Parameter: YPHI <- "300.085081"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.711005034"
Evaluating: 0.711005034*360.0
 Parameter: ZPHI <- "255.961812"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-18.827986"
 Parameter: YPOS -> "-17.8821711"
 Parameter: ZPOS -> "-19.3659768"
 Parameter: XPHI -> "262.099898"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.137446   -0.990509
    0.000000    0.990509   -0.137446

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   97.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-18.827986"
 Parameter: YPOS -> "-17.8821711"
 Parameter: ZPOS -> "-19.3659768"
 Parameter: YPHI -> "300.085081"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.501285    0.000000    0.865282
    0.000000    1.000000    0.000000
   -0.865282    0.000000    0.501285

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   59.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-18.827986"
 Parameter: YPOS -> "-17.8821711"
 Parameter: ZPOS -> "-19.3659768"
 Parameter: ZPHI -> "255.961812"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.242569   -0.970134    0.000000
    0.970134   -0.242569    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  104.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -18.827986 XMAX =  -18.827986 XAVE =  -18.827986
    YMIN =  -17.882171 YMAX =  -17.882171 YAVE =  -17.882171
    ZMIN =  -19.365977 ZMAX =  -19.365977 ZAVE =  -19.365977
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-18.827986"
Evaluating: -18.827986+3.5
 Parameter: XMAX <- "-15.327986"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-17.8821711"
Evaluating: -17.8821711+3.5
 Parameter: YMAX <- "-14.3821711"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.3659768"
Evaluating: -19.3659768+3.5
 Parameter: ZMAX <- "-15.8659768"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-18.827986"
Evaluating: -18.827986-3.5
 Parameter: XMIN <- "-22.327986"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-17.8821711"
Evaluating: -17.8821711-3.5
 Parameter: YMIN <- "-21.3821711"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.3659768"
Evaluating: -19.3659768-3.5
 Parameter: ZMIN <- "-22.8659768"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-15.327986"
 Parameter: XMIN -> "-22.327986"
 Parameter: YMAX -> "-14.3821711"
 Parameter: YMIN -> "-21.3821711"
 Parameter: ZMAX -> "-15.8659768"
 Parameter: ZMIN -> "-22.8659768"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "98"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "98" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "98"
Evaluating: 98
 Parameter: J <- "98"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "98" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "98"
 Parameter: NPOS -> "80"
Evaluating: 98-80
 Parameter: J <- "18"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "18"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "5.186972537E-02"
Evaluating: (89.1533903-9.0)*(5.186972537E-02-0.5)
 Parameter: XPOS <- "-35.9191608"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.471982835"
Evaluating: (89.1533903-9.0)*(0.471982835-0.5)
 Parameter: YPOS <- "-2.24567076"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.357428659"
Evaluating: (89.1533903-9.0)*(0.357428659-0.5)
 Parameter: ZPOS <- "-11.4275763"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.9191608"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -35.9191608-44.5766951
 Parameter: XTRAN <- "-80.4958559"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-2.24567076"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -2.24567076-44.5766951
 Parameter: YTRAN <- "-46.8223659"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-11.4275763"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -11.4275763-44.5766951
 Parameter: ZTRAN <- "-56.0042714"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-80.4958559"
 Parameter: YTRAN -> "-46.8223659"
 Parameter: ZTRAN -> "-56.0042714"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -80.495856  -46.822366  -56.004271
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.178988351"
Evaluating: 0.178988351*360.0
 Parameter: XPHI <- "64.4358064"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.143090127"
Evaluating: 0.143090127*360.0
 Parameter: YPHI <- "51.5124457"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.178524249"
Evaluating: 0.178524249*360.0
 Parameter: ZPHI <- "64.2687296"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.9191608"
 Parameter: YPOS -> "-2.24567076"
 Parameter: ZPOS -> "-11.4275763"
 Parameter: XPHI -> "64.4358064"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.431522    0.902102
    0.000000   -0.902102    0.431522

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   64.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.9191608"
 Parameter: YPOS -> "-2.24567076"
 Parameter: ZPOS -> "-11.4275763"
 Parameter: YPHI -> "51.5124457"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.622345    0.000000   -0.782743
    0.000000    1.000000    0.000000
    0.782743    0.000000    0.622345

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   51.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.9191608"
 Parameter: YPOS -> "-2.24567076"
 Parameter: ZPOS -> "-11.4275763"
 Parameter: ZPHI -> "64.2687296"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.434151    0.900840    0.000000
   -0.900840    0.434151    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   64.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.919161 XMAX =  -35.919161 XAVE =  -35.919161
    YMIN =   -2.245671 YMAX =   -2.245671 YAVE =   -2.245671
    ZMIN =  -11.427576 ZMAX =  -11.427576 ZAVE =  -11.427576
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.9191608"
Evaluating: -35.9191608+3.5
 Parameter: XMAX <- "-32.4191608"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-2.24567074"
Evaluating: -2.24567074+3.5
 Parameter: YMAX <- "1.25432926"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-11.4275763"
Evaluating: -11.4275763+3.5
 Parameter: ZMAX <- "-7.9275763"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.9191608"
Evaluating: -35.9191608-3.5
 Parameter: XMIN <- "-39.4191608"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-2.24567074"
Evaluating: -2.24567074-3.5
 Parameter: YMIN <- "-5.74567074"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-11.4275763"
Evaluating: -11.4275763-3.5
 Parameter: ZMIN <- "-14.9275763"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.4191608"
 Parameter: XMIN -> "-39.4191608"
 Parameter: YMAX -> "1.25432926"
 Parameter: YMIN -> "-5.74567074"
 Parameter: ZMAX -> "-7.9275763"
 Parameter: ZMIN -> "-14.9275763"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "99"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "99" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "99"
Evaluating: 99
 Parameter: J <- "99"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "99" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "99"
 Parameter: NPOS -> "80"
Evaluating: 99-80
 Parameter: J <- "19"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "19"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.138860161"
Evaluating: (89.1533903-9.0)*(0.138860161-0.5)
 Parameter: XPOS <- "-28.9465825"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.785306073"
Evaluating: (89.1533903-9.0)*(0.785306073-0.5)
 Parameter: YPOS <- "22.868249"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.254291557"
Evaluating: (89.1533903-9.0)*(0.254291557-0.5)
 Parameter: ZPOS <- "-19.6943647"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-28.9465825"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -28.9465825-44.5766951
 Parameter: XTRAN <- "-73.5232776"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.868249"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 22.868249-44.5766951
 Parameter: YTRAN <- "-21.7084461"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-19.6943647"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -19.6943647-44.5766951
 Parameter: ZTRAN <- "-64.2710598"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-73.5232776"
 Parameter: YTRAN -> "-21.7084461"
 Parameter: ZTRAN -> "-64.2710598"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -73.523278  -21.708446  -64.271060
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.159752861"
Evaluating: 0.159752861*360.0
 Parameter: XPHI <- "57.51103"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.7454951"
Evaluating: 0.7454951*360.0
 Parameter: YPHI <- "268.378236"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.325757266"
Evaluating: 0.325757266*360.0
 Parameter: ZPHI <- "117.272616"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-28.9465825"
 Parameter: YPOS -> "22.868249"
 Parameter: ZPOS -> "-19.6943647"
 Parameter: XPHI -> "57.51103"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.537137    0.843495
    0.000000   -0.843495    0.537137

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   57.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-28.9465825"
 Parameter: YPOS -> "22.868249"
 Parameter: ZPOS -> "-19.6943647"
 Parameter: YPHI -> "268.378236"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.028301    0.000000    0.999599
    0.000000    1.000000    0.000000
   -0.999599    0.000000   -0.028301

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   91.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-28.9465825"
 Parameter: YPOS -> "22.868249"
 Parameter: ZPOS -> "-19.6943647"
 Parameter: ZPHI -> "117.272616"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.458225    0.888836    0.000000
   -0.888836   -0.458225    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  117.27

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -28.946582 XMAX =  -28.946582 XAVE =  -28.946582
    YMIN =   22.868249 YMAX =   22.868249 YAVE =   22.868249
    ZMIN =  -19.694365 ZMAX =  -19.694365 ZAVE =  -19.694365
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-28.9465825"
Evaluating: -28.9465825+3.5
 Parameter: XMAX <- "-25.4465825"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.868249"
Evaluating: 22.868249+3.5
 Parameter: YMAX <- "26.368249"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-19.6943647"
Evaluating: -19.6943647+3.5
 Parameter: ZMAX <- "-16.1943647"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-28.9465825"
Evaluating: -28.9465825-3.5
 Parameter: XMIN <- "-32.4465825"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.868249"
Evaluating: 22.868249-3.5
 Parameter: YMIN <- "19.368249"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-19.6943647"
Evaluating: -19.6943647-3.5
 Parameter: ZMIN <- "-23.1943647"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.4465825"
 Parameter: XMIN -> "-32.4465825"
 Parameter: YMAX -> "26.368249"
 Parameter: YMIN -> "19.368249"
 Parameter: ZMAX -> "-16.1943647"
 Parameter: ZMIN -> "-23.1943647"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "100"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "100" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "100"
Evaluating: 100
 Parameter: J <- "100"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "100" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "100"
 Parameter: NPOS -> "80"
Evaluating: 100-80
 Parameter: J <- "20"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "20"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.702772244"
Evaluating: (89.1533903-9.0)*(0.702772244-0.5)
 Parameter: XPOS <- "16.2528828"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.301438868"
Evaluating: (89.1533903-9.0)*(0.301438868-0.5)
 Parameter: YPOS <- "-15.9153479"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.541901423"
Evaluating: (89.1533903-9.0)*(0.541901423-0.5)
 Parameter: ZPOS <- "3.35854111"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "16.2528828"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 16.2528828-44.5766951
 Parameter: XTRAN <- "-28.3238123"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-15.9153479"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -15.9153479-44.5766951
 Parameter: YTRAN <- "-60.492043"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "3.35854111"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 3.35854111-44.5766951
 Parameter: ZTRAN <- "-41.218154"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-28.3238123"
 Parameter: YTRAN -> "-60.492043"
 Parameter: ZTRAN -> "-41.218154"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -28.323812  -60.492043  -41.218154
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.663565559"
Evaluating: 0.663565559*360.0
 Parameter: XPHI <- "238.883601"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.825065806"
Evaluating: 0.825065806*360.0
 Parameter: YPHI <- "297.02369"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.722401293"
Evaluating: 0.722401293*360.0
 Parameter: ZPHI <- "260.064465"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "16.2528828"
 Parameter: YPOS -> "-15.9153479"
 Parameter: ZPOS -> "3.35854111"
 Parameter: XPHI -> "238.883601"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.516778   -0.856119
    0.000000    0.856119   -0.516778

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  121.12

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "16.2528828"
 Parameter: YPOS -> "-15.9153479"
 Parameter: ZPOS -> "3.35854111"
 Parameter: YPHI -> "297.02369"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.454359    0.000000    0.890819
    0.000000    1.000000    0.000000
   -0.890819    0.000000    0.454359

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   62.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "16.2528828"
 Parameter: YPOS -> "-15.9153479"
 Parameter: ZPOS -> "3.35854111"
 Parameter: ZPHI -> "260.064465"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.172540   -0.985003    0.000000
    0.985003   -0.172540    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   99.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   16.252883 XMAX =   16.252883 XAVE =   16.252883
    YMIN =  -15.915348 YMAX =  -15.915348 YAVE =  -15.915348
    ZMIN =    3.358541 ZMAX =    3.358541 ZAVE =    3.358541
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "16.2528828"
Evaluating: 16.2528828+3.5
 Parameter: XMAX <- "19.7528828"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-15.9153479"
Evaluating: -15.9153479+3.5
 Parameter: YMAX <- "-12.4153479"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "3.35854111"
Evaluating: 3.35854111+3.5
 Parameter: ZMAX <- "6.85854111"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "16.2528828"
Evaluating: 16.2528828-3.5
 Parameter: XMIN <- "12.7528828"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-15.9153479"
Evaluating: -15.9153479-3.5
 Parameter: YMIN <- "-19.4153479"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "3.35854111"
Evaluating: 3.35854111-3.5
 Parameter: ZMIN <- "-0.14145889"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.7528828"
 Parameter: XMIN -> "12.7528828"
 Parameter: YMAX -> "-12.4153479"
 Parameter: YMIN -> "-19.4153479"
 Parameter: ZMAX -> "6.85854111"
 Parameter: ZMIN -> "-0.14145889"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "101"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "101" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "101"
Evaluating: 101
 Parameter: J <- "101"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "101" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "101"
 Parameter: NPOS -> "80"
Evaluating: 101-80
 Parameter: J <- "21"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "21"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "2.940447662E-02"
Evaluating: (89.1533903-9.0)*(2.940447662E-02-0.5)
 Parameter: XPOS <- "-37.7198267"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.152748256"
Evaluating: (89.1533903-9.0)*(0.152748256-0.5)
 Parameter: YPOS <- "-27.8334046"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.739670943"
Evaluating: (89.1533903-9.0)*(0.739670943-0.5)
 Parameter: ZPOS <- "19.2104386"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-37.7198267"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -37.7198267-44.5766951
 Parameter: XTRAN <- "-82.2965218"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-27.8334046"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -27.8334046-44.5766951
 Parameter: YTRAN <- "-72.4100997"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "19.2104386"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 19.2104386-44.5766951
 Parameter: ZTRAN <- "-25.3662565"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-82.2965218"
 Parameter: YTRAN -> "-72.4100997"
 Parameter: ZTRAN -> "-25.3662565"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -82.296522  -72.410100  -25.366256
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.363553701"
Evaluating: 0.363553701*360.0
 Parameter: XPHI <- "130.879332"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.957384857"
Evaluating: 0.957384857*360.0
 Parameter: YPHI <- "344.658549"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.191042618E-02"
Evaluating: 1.191042618E-02*360.0
 Parameter: ZPHI <- "4.28775342"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-37.7198267"
 Parameter: YPOS -> "-27.8334046"
 Parameter: ZPOS -> "19.2104386"
 Parameter: XPHI -> "130.879332"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.654468    0.756090
    0.000000   -0.756090   -0.654468

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  130.88

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-37.7198267"
 Parameter: YPOS -> "-27.8334046"
 Parameter: ZPOS -> "19.2104386"
 Parameter: YPHI -> "344.658549"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.964366    0.000000    0.264571
    0.000000    1.000000    0.000000
   -0.264571    0.000000    0.964366

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   15.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-37.7198267"
 Parameter: YPOS -> "-27.8334046"
 Parameter: ZPOS -> "19.2104386"
 Parameter: ZPHI -> "4.28775342"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.997201    0.074766    0.000000
   -0.074766    0.997201    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS    4.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -37.719827 XMAX =  -37.719827 XAVE =  -37.719827
    YMIN =  -27.833405 YMAX =  -27.833405 YAVE =  -27.833405
    ZMIN =   19.210439 ZMAX =   19.210439 ZAVE =   19.210439
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-37.7198267"
Evaluating: -37.7198267+3.5
 Parameter: XMAX <- "-34.2198267"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-27.8334046"
Evaluating: -27.8334046+3.5
 Parameter: YMAX <- "-24.3334046"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "19.2104386"
Evaluating: 19.2104386+3.5
 Parameter: ZMAX <- "22.7104386"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-37.7198267"
Evaluating: -37.7198267-3.5
 Parameter: XMIN <- "-41.2198267"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-27.8334046"
Evaluating: -27.8334046-3.5
 Parameter: YMIN <- "-31.3334046"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "19.2104386"
Evaluating: 19.2104386-3.5
 Parameter: ZMIN <- "15.7104386"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-34.2198267"
 Parameter: XMIN -> "-41.2198267"
 Parameter: YMAX -> "-24.3334046"
 Parameter: YMIN -> "-31.3334046"
 Parameter: ZMAX -> "22.7104386"
 Parameter: ZMIN -> "15.7104386"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "102"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "102" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "102"
Evaluating: 102
 Parameter: J <- "102"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "102" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "102"
 Parameter: NPOS -> "80"
Evaluating: 102-80
 Parameter: J <- "22"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "22"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.83978115"
Evaluating: (89.1533903-9.0)*(0.83978115-0.5)
 Parameter: XPOS <- "27.2346111"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.233748641"
Evaluating: (89.1533903-9.0)*(0.233748641-0.5)
 Parameter: YPOS <- "-21.3409491"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.584769652"
Evaluating: (89.1533903-9.0)*(0.584769652-0.5)
 Parameter: ZPOS <- "6.794575"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "27.2346111"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 27.2346111-44.5766951
 Parameter: XTRAN <- "-17.342084"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.3409491"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -21.3409491-44.5766951
 Parameter: YTRAN <- "-65.9176442"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "6.794575"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 6.794575-44.5766951
 Parameter: ZTRAN <- "-37.7821201"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.342084"
 Parameter: YTRAN -> "-65.9176442"
 Parameter: ZTRAN -> "-37.7821201"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -17.342084  -65.917644  -37.782120
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.883623047"
Evaluating: 0.883623047*360.0
 Parameter: XPHI <- "318.104297"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.695346588"
Evaluating: 0.695346588*360.0
 Parameter: YPHI <- "250.324772"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.409905805"
Evaluating: 0.409905805*360.0
 Parameter: ZPHI <- "147.56609"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "27.2346111"
 Parameter: YPOS -> "-21.3409491"
 Parameter: ZPOS -> "6.794575"
 Parameter: XPHI -> "318.104297"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.744362   -0.667777
    0.000000    0.667777    0.744362

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   41.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "27.2346111"
 Parameter: YPOS -> "-21.3409491"
 Parameter: ZPOS -> "6.794575"
 Parameter: YPHI -> "250.324772"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.336688    0.000000    0.941616
    0.000000    1.000000    0.000000
   -0.941616    0.000000   -0.336688

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  109.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "27.2346111"
 Parameter: YPOS -> "-21.3409491"
 Parameter: ZPOS -> "6.794575"
 Parameter: ZPHI -> "147.56609"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.844011    0.536326    0.000000
   -0.536326   -0.844011    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  147.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.234611 XMAX =   27.234611 XAVE =   27.234611
    YMIN =  -21.340949 YMAX =  -21.340949 YAVE =  -21.340949
    ZMIN =    6.794575 ZMAX =    6.794575 ZAVE =    6.794575
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "27.2346111"
Evaluating: 27.2346111+3.5
 Parameter: XMAX <- "30.7346111"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.3409491"
Evaluating: -21.3409491+3.5
 Parameter: YMAX <- "-17.8409491"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "6.794575"
Evaluating: 6.794575+3.5
 Parameter: ZMAX <- "10.294575"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "27.2346111"
Evaluating: 27.2346111-3.5
 Parameter: XMIN <- "23.7346111"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.3409491"
Evaluating: -21.3409491-3.5
 Parameter: YMIN <- "-24.8409491"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "6.794575"
Evaluating: 6.794575-3.5
 Parameter: ZMIN <- "3.294575"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.7346111"
 Parameter: XMIN -> "23.7346111"
 Parameter: YMAX -> "-17.8409491"
 Parameter: YMIN -> "-24.8409491"
 Parameter: ZMAX -> "10.294575"
 Parameter: ZMIN -> "3.294575"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      0 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "103"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "103" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "103"
Evaluating: 103
 Parameter: J <- "103"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "103" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "103"
 Parameter: NPOS -> "80"
Evaluating: 103-80
 Parameter: J <- "23"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "23"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.644902098"
Evaluating: (89.1533903-9.0)*(0.644902098-0.5)
 Parameter: XPOS <- "11.6143944"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.402005315"
Evaluating: (89.1533903-9.0)*(0.402005315-0.5)
 Parameter: YPOS <- "-7.85460623"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.84016874"
Evaluating: (89.1533903-9.0)*(0.84016874-0.5)
 Parameter: ZPOS <- "27.2656778"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.6143944"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 11.6143944-44.5766951
 Parameter: XTRAN <- "-32.9623007"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.85460623"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -7.85460623-44.5766951
 Parameter: YTRAN <- "-52.4313013"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "27.2656778"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 27.2656778-44.5766951
 Parameter: ZTRAN <- "-17.3110173"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-32.9623007"
 Parameter: YTRAN -> "-52.4313013"
 Parameter: ZTRAN -> "-17.3110173"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -32.962301  -52.431301  -17.311017
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.636661837"
Evaluating: 0.636661837*360.0
 Parameter: XPHI <- "229.198261"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.710205896"
Evaluating: 0.710205896*360.0
 Parameter: YPHI <- "255.674123"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.752367241"
Evaluating: 0.752367241*360.0
 Parameter: ZPHI <- "270.852207"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.6143944"
 Parameter: YPOS -> "-7.85460623"
 Parameter: ZPOS -> "27.2656778"
 Parameter: XPHI -> "229.198261"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.653444   -0.756975
    0.000000    0.756975   -0.653444

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  130.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.6143944"
 Parameter: YPOS -> "-7.85460623"
 Parameter: ZPOS -> "27.2656778"
 Parameter: YPHI -> "255.674123"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.247437    0.000000    0.968904
    0.000000    1.000000    0.000000
   -0.968904    0.000000   -0.247437

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  104.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.6143944"
 Parameter: YPOS -> "-7.85460623"
 Parameter: ZPOS -> "27.2656778"
 Parameter: ZPHI -> "270.852207"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.014873   -0.999889    0.000000
    0.999889    0.014873    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   89.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.614394 XMAX =   11.614394 XAVE =   11.614394
    YMIN =   -7.854606 YMAX =   -7.854606 YAVE =   -7.854606
    ZMIN =   27.265678 ZMAX =   27.265678 ZAVE =   27.265678
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.6143944"
Evaluating: 11.6143944+3.5
 Parameter: XMAX <- "15.1143944"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.85460621"
Evaluating: -7.85460621+3.5
 Parameter: YMAX <- "-4.35460621"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "27.2656778"
Evaluating: 27.2656778+3.5
 Parameter: ZMAX <- "30.7656778"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.6143944"
Evaluating: 11.6143944-3.5
 Parameter: XMIN <- "8.1143944"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.85460621"
Evaluating: -7.85460621-3.5
 Parameter: YMIN <- "-11.3546062"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "27.2656778"
Evaluating: 27.2656778-3.5
 Parameter: ZMIN <- "23.7656778"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "15.1143944"
 Parameter: XMIN -> "8.1143944"
 Parameter: YMAX -> "-4.35460621"
 Parameter: YMIN -> "-11.3546062"
 Parameter: ZMAX -> "30.7656778"
 Parameter: ZMIN -> "23.7656778"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "104"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "104" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "104"
Evaluating: 104
 Parameter: J <- "104"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "104" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "104"
 Parameter: NPOS -> "80"
Evaluating: 104-80
 Parameter: J <- "24"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "24"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.637333387"
Evaluating: (89.1533903-9.0)*(0.637333387-0.5)
 Parameter: XPOS <- "11.0077366"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.337528892"
Evaluating: (89.1533903-9.0)*(0.337528892-0.5)
 Parameter: YPOS <- "-13.0226101"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.156261956"
Evaluating: (89.1533903-9.0)*(0.156261956-0.5)
 Parameter: ZPOS <- "-27.5517696"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "11.0077366"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 11.0077366-44.5766951
 Parameter: XTRAN <- "-33.5689585"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-13.0226101"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -13.0226101-44.5766951
 Parameter: YTRAN <- "-57.5993052"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-27.5517696"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -27.5517696-44.5766951
 Parameter: ZTRAN <- "-72.1284647"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.5689585"
 Parameter: YTRAN -> "-57.5993052"
 Parameter: ZTRAN -> "-72.1284647"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -33.568959  -57.599305  -72.128465
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.168541385"
Evaluating: 0.168541385*360.0
 Parameter: XPHI <- "60.6748986"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.731595255"
Evaluating: 0.731595255*360.0
 Parameter: YPHI <- "263.374292"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.588026045"
Evaluating: 0.588026045*360.0
 Parameter: ZPHI <- "211.689376"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "11.0077366"
 Parameter: YPOS -> "-13.0226101"
 Parameter: ZPOS -> "-27.5517696"
 Parameter: XPHI -> "60.6748986"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.489764    0.871855
    0.000000   -0.871855    0.489764

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   60.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "11.0077366"
 Parameter: YPOS -> "-13.0226101"
 Parameter: ZPOS -> "-27.5517696"
 Parameter: YPHI -> "263.374292"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.115383    0.000000    0.993321
    0.000000    1.000000    0.000000
   -0.993321    0.000000   -0.115383

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   96.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "11.0077366"
 Parameter: YPOS -> "-13.0226101"
 Parameter: ZPOS -> "-27.5517696"
 Parameter: ZPHI -> "211.689376"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.850909   -0.525314    0.000000
    0.525314   -0.850909    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  148.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   11.007737 XMAX =   11.007737 XAVE =   11.007737
    YMIN =  -13.022610 YMAX =  -13.022610 YAVE =  -13.022610
    ZMIN =  -27.551770 ZMAX =  -27.551770 ZAVE =  -27.551770
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "11.0077366"
Evaluating: 11.0077366+3.5
 Parameter: XMAX <- "14.5077366"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-13.0226101"
Evaluating: -13.0226101+3.5
 Parameter: YMAX <- "-9.5226101"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-27.5517696"
Evaluating: -27.5517696+3.5
 Parameter: ZMAX <- "-24.0517696"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "11.0077366"
Evaluating: 11.0077366-3.5
 Parameter: XMIN <- "7.5077366"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-13.0226101"
Evaluating: -13.0226101-3.5
 Parameter: YMIN <- "-16.5226101"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-27.5517696"
Evaluating: -27.5517696-3.5
 Parameter: ZMIN <- "-31.0517696"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.5077366"
 Parameter: XMIN -> "7.5077366"
 Parameter: YMAX -> "-9.5226101"
 Parameter: YMIN -> "-16.5226101"
 Parameter: ZMAX -> "-24.0517696"
 Parameter: ZMIN -> "-31.0517696"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "105"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "105" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "105"
Evaluating: 105
 Parameter: J <- "105"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "105" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "105"
 Parameter: NPOS -> "80"
Evaluating: 105-80
 Parameter: J <- "25"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "25"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.865620936"
Evaluating: (89.1533903-9.0)*(0.865620936-0.5)
 Parameter: XPOS <- "29.3057576"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.971359377"
Evaluating: (89.1533903-9.0)*(0.971359377-0.5)
 Parameter: YPOS <- "37.7810521"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.795054711"
Evaluating: (89.1533903-9.0)*(0.795054711-0.5)
 Parameter: ZPOS <- "23.6496354"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "29.3057576"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 29.3057576-44.5766951
 Parameter: XTRAN <- "-15.2709375"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "37.7810521"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 37.7810521-44.5766951
 Parameter: YTRAN <- "-6.795643"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "23.6496354"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 23.6496354-44.5766951
 Parameter: ZTRAN <- "-20.9270597"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-15.2709375"
 Parameter: YTRAN -> "-6.795643"
 Parameter: ZTRAN -> "-20.9270597"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -15.270938   -6.795643  -20.927060
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.993846407"
Evaluating: 0.993846407*360.0
 Parameter: XPHI <- "357.784707"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.13886666"
Evaluating: 0.13886666*360.0
 Parameter: YPHI <- "49.9919976"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.745750819"
Evaluating: 0.745750819*360.0
 Parameter: ZPHI <- "268.470295"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "29.3057576"
 Parameter: YPOS -> "37.7810521"
 Parameter: ZPOS -> "23.6496354"
 Parameter: XPHI -> "357.784707"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.999253   -0.038655
    0.000000    0.038655    0.999253

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    2.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "29.3057576"
 Parameter: YPOS -> "37.7810521"
 Parameter: ZPOS -> "23.6496354"
 Parameter: YPHI -> "49.9919976"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.642895    0.000000   -0.765955
    0.000000    1.000000    0.000000
    0.765955    0.000000    0.642895

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   49.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "29.3057576"
 Parameter: YPOS -> "37.7810521"
 Parameter: ZPOS -> "23.6496354"
 Parameter: ZPHI -> "268.470295"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.026695   -0.999644    0.000000
    0.999644   -0.026695    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   91.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   29.305758 XMAX =   29.305758 XAVE =   29.305758
    YMIN =   37.781052 YMAX =   37.781052 YAVE =   37.781052
    ZMIN =   23.649635 ZMAX =   23.649635 ZAVE =   23.649635
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "29.3057576"
Evaluating: 29.3057576+3.5
 Parameter: XMAX <- "32.8057576"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "37.7810521"
Evaluating: 37.7810521+3.5
 Parameter: YMAX <- "41.2810521"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "23.6496354"
Evaluating: 23.6496354+3.5
 Parameter: ZMAX <- "27.1496354"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "29.3057576"
Evaluating: 29.3057576-3.5
 Parameter: XMIN <- "25.8057576"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "37.7810521"
Evaluating: 37.7810521-3.5
 Parameter: YMIN <- "34.2810521"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "23.6496354"
Evaluating: 23.6496354-3.5
 Parameter: ZMIN <- "20.1496354"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.8057576"
 Parameter: XMIN -> "25.8057576"
 Parameter: YMAX -> "41.2810521"
 Parameter: YMIN -> "34.2810521"
 Parameter: ZMAX -> "27.1496354"
 Parameter: ZMIN -> "20.1496354"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "106"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "106" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "106"
Evaluating: 106
 Parameter: J <- "106"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "106" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "106"
 Parameter: NPOS -> "80"
Evaluating: 106-80
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.857640601"
Evaluating: (89.1533903-9.0)*(0.857640601-0.5)
 Parameter: XPOS <- "28.6661067"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.577166825"
Evaluating: (89.1533903-9.0)*(0.577166825-0.5)
 Parameter: YPOS <- "6.18518264"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.508700336"
Evaluating: (89.1533903-9.0)*(0.508700336-0.5)
 Parameter: ZPOS <- "0.697361427"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.6661067"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 28.6661067-44.5766951
 Parameter: XTRAN <- "-15.9105884"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "6.18518264"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 6.18518264-44.5766951
 Parameter: YTRAN <- "-38.3915125"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "0.697361427"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 0.697361427-44.5766951
 Parameter: ZTRAN <- "-43.8793337"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-15.9105884"
 Parameter: YTRAN -> "-38.3915125"
 Parameter: ZTRAN -> "-43.8793337"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -15.910588  -38.391512  -43.879334
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.348023202"
Evaluating: 0.348023202*360.0
 Parameter: XPHI <- "125.288353"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.600554795"
Evaluating: 0.600554795*360.0
 Parameter: YPHI <- "216.199726"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.212569148"
Evaluating: 0.212569148*360.0
 Parameter: ZPHI <- "76.5248933"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.6661067"
 Parameter: YPOS -> "6.18518264"
 Parameter: ZPOS -> "0.697361427"
 Parameter: XPHI -> "125.288353"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.577692    0.816255
    0.000000   -0.816255   -0.577692

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  125.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.6661067"
 Parameter: YPOS -> "6.18518264"
 Parameter: ZPOS -> "0.697361427"
 Parameter: YPHI -> "216.199726"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.806963    0.000000    0.590602
    0.000000    1.000000    0.000000
   -0.590602    0.000000   -0.806963

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  143.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.6661067"
 Parameter: YPOS -> "6.18518264"
 Parameter: ZPOS -> "0.697361427"
 Parameter: ZPHI -> "76.5248933"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.233023    0.972471    0.000000
   -0.972471    0.233023    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   76.52

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.666107 XMAX =   28.666107 XAVE =   28.666107
    YMIN =    6.185183 YMAX =    6.185183 YAVE =    6.185183
    ZMIN =    0.697361 ZMAX =    0.697361 ZAVE =    0.697361
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.6661067"
Evaluating: 28.6661067+3.5
 Parameter: XMAX <- "32.1661067"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "6.18518261"
Evaluating: 6.18518261+3.5
 Parameter: YMAX <- "9.68518261"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "0.697361388"
Evaluating: 0.697361388+3.5
 Parameter: ZMAX <- "4.19736139"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.6661067"
Evaluating: 28.6661067-3.5
 Parameter: XMIN <- "25.1661067"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "6.18518261"
Evaluating: 6.18518261-3.5
 Parameter: YMIN <- "2.68518261"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "0.697361388"
Evaluating: 0.697361388-3.5
 Parameter: ZMIN <- "-2.80263861"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.1661067"
 Parameter: XMIN -> "25.1661067"
 Parameter: YMAX -> "9.68518261"
 Parameter: YMIN -> "2.68518261"
 Parameter: ZMAX -> "4.19736139"
 Parameter: ZMIN -> "-2.80263861"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      1 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9208 NEG      CLA      26       CLA     -9170 POS      SOD      68       SOD           2.6656
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "106"
Evaluating: 106
 Parameter: J <- "106"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "106" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "106"
 Parameter: NPOS -> "80"
Evaluating: 106-80
 Parameter: J <- "26"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "26"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.287373381"
Evaluating: (89.1533903-9.0)*(0.287373381-0.5)
 Parameter: XPOS <- "-17.0427444"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.514466307"
Evaluating: (89.1533903-9.0)*(0.514466307-0.5)
 Parameter: YPOS <- "1.15952355"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "1.285350443E-03"
Evaluating: (89.1533903-9.0)*(1.285350443E-03-0.5)
 Parameter: ZPOS <- "-39.97367"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.666107 XMAX =   28.666107 XAVE =   28.666107
    YMIN =    6.185183 YMAX =    6.185183 YAVE =    6.185183
    ZMIN =    0.697361 ZMAX =    0.697361 ZAVE =    0.697361
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-17.0427444"
 RDCMND substituted energy or value "?XAVE" to "28.6661067"
Evaluating: -17.0427444-28.6661067
 Parameter: XTRAN <- "-45.7088511"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.15952355"
 RDCMND substituted energy or value "?YAVE" to "6.18518261"
Evaluating: 1.15952355-6.18518261
 Parameter: YTRAN <- "-5.02565906"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-39.97367"
 RDCMND substituted energy or value "?ZAVE" to "0.697361388"
Evaluating: -39.97367-0.697361388
 Parameter: ZTRAN <- "-40.6710314"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-45.7088511"
 Parameter: YTRAN -> "-5.02565906"
 Parameter: ZTRAN -> "-40.6710314"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -45.708851   -5.025659  -40.671031
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.317799312"
Evaluating: 0.317799312*360.0
 Parameter: XPHI <- "114.407752"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.148792991"
Evaluating: 0.148792991*360.0
 Parameter: YPHI <- "53.5654768"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.896855781"
Evaluating: 0.896855781*360.0
 Parameter: ZPHI <- "322.868081"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-17.0427444"
 Parameter: YPOS -> "1.15952355"
 Parameter: ZPOS -> "-39.97367"
 Parameter: XPHI -> "114.407752"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.413228    0.910628
    0.000000   -0.910628   -0.413228

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  114.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-17.0427444"
 Parameter: YPOS -> "1.15952355"
 Parameter: ZPOS -> "-39.97367"
 Parameter: YPHI -> "53.5654768"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.593904    0.000000   -0.804536
    0.000000    1.000000    0.000000
    0.804536    0.000000    0.593904

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   53.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-17.0427444"
 Parameter: YPOS -> "1.15952355"
 Parameter: ZPOS -> "-39.97367"
 Parameter: ZPHI -> "322.868081"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.797248   -0.603652    0.000000
    0.603652    0.797248    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   37.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -17.042744 XMAX =  -17.042744 XAVE =  -17.042744
    YMIN =    1.159524 YMAX =    1.159524 YAVE =    1.159524
    ZMIN =  -39.973670 ZMAX =  -39.973670 ZAVE =  -39.973670
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-17.0427444"
Evaluating: -17.0427444+3.5
 Parameter: XMAX <- "-13.5427444"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.15952354"
Evaluating: 1.15952354+3.5
 Parameter: YMAX <- "4.65952354"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-39.97367"
Evaluating: -39.97367+3.5
 Parameter: ZMAX <- "-36.47367"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-17.0427444"
Evaluating: -17.0427444-3.5
 Parameter: XMIN <- "-20.5427444"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.15952354"
Evaluating: 1.15952354-3.5
 Parameter: YMIN <- "-2.34047646"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-39.97367"
Evaluating: -39.97367-3.5
 Parameter: ZMIN <- "-43.47367"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.5427444"
 Parameter: XMIN -> "-20.5427444"
 Parameter: YMAX -> "4.65952354"
 Parameter: YMIN -> "-2.34047646"
 Parameter: ZMAX -> "-36.47367"
 Parameter: ZMIN -> "-43.47367"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "107"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "107" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "107"
Evaluating: 107
 Parameter: J <- "107"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "107" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "107"
 Parameter: NPOS -> "80"
Evaluating: 107-80
 Parameter: J <- "27"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.595117891"
Evaluating: (89.1533903-9.0)*(0.595117891-0.5)
 Parameter: XPOS <- "7.62402144"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.686828175"
Evaluating: (89.1533903-9.0)*(0.686828175-0.5)
 Parameter: YPOS <- "14.9749116"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.237722632"
Evaluating: (89.1533903-9.0)*(0.237722632-0.5)
 Parameter: ZPOS <- "-21.0224202"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.62402144"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 7.62402144-44.5766951
 Parameter: XTRAN <- "-36.9526737"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "14.9749116"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 14.9749116-44.5766951
 Parameter: YTRAN <- "-29.6017835"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.0224202"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -21.0224202-44.5766951
 Parameter: ZTRAN <- "-65.5991153"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.9526737"
 Parameter: YTRAN -> "-29.6017835"
 Parameter: ZTRAN -> "-65.5991153"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -36.952674  -29.601783  -65.599115
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.848348296"
Evaluating: 0.848348296*360.0
 Parameter: XPHI <- "305.405387"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.780340395"
Evaluating: 0.780340395*360.0
 Parameter: YPHI <- "280.922542"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.315624188"
Evaluating: 0.315624188*360.0
 Parameter: ZPHI <- "113.624708"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.62402144"
 Parameter: YPOS -> "14.9749116"
 Parameter: ZPOS -> "-21.0224202"
 Parameter: XPHI -> "305.405387"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.579358   -0.815073
    0.000000    0.815073    0.579358

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   54.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.62402144"
 Parameter: YPOS -> "14.9749116"
 Parameter: ZPOS -> "-21.0224202"
 Parameter: YPHI -> "280.922542"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.189482    0.000000    0.981884
    0.000000    1.000000    0.000000
   -0.981884    0.000000    0.189482

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   79.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.62402144"
 Parameter: YPOS -> "14.9749116"
 Parameter: ZPOS -> "-21.0224202"
 Parameter: ZPHI -> "113.624708"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.400744    0.916190    0.000000
   -0.916190   -0.400744    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  113.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.624021 XMAX =    7.624021 XAVE =    7.624021
    YMIN =   14.974912 YMAX =   14.974912 YAVE =   14.974912
    ZMIN =  -21.022420 ZMAX =  -21.022420 ZAVE =  -21.022420
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.62402144"
Evaluating: 7.62402144+3.5
 Parameter: XMAX <- "11.1240214"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "14.9749116"
Evaluating: 14.9749116+3.5
 Parameter: YMAX <- "18.4749116"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.0224202"
Evaluating: -21.0224202+3.5
 Parameter: ZMAX <- "-17.5224202"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.62402144"
Evaluating: 7.62402144-3.5
 Parameter: XMIN <- "4.12402144"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "14.9749116"
Evaluating: 14.9749116-3.5
 Parameter: YMIN <- "11.4749116"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.0224202"
Evaluating: -21.0224202-3.5
 Parameter: ZMIN <- "-24.5224202"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.1240214"
 Parameter: XMIN -> "4.12402144"
 Parameter: YMAX -> "18.4749116"
 Parameter: YMIN -> "11.4749116"
 Parameter: ZMAX -> "-17.5224202"
 Parameter: ZMIN -> "-24.5224202"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      1 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9209 NEG      CLA      27       CLA     -9115 POS      SOD      13       SOD           2.2409
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "107"
Evaluating: 107
 Parameter: J <- "107"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "107" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "107"
 Parameter: NPOS -> "80"
Evaluating: 107-80
 Parameter: J <- "27"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "27"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.745879763"
Evaluating: (89.1533903-9.0)*(0.745879763-0.5)
 Parameter: XPOS <- "19.7080966"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.880556648"
Evaluating: (89.1533903-9.0)*(0.880556648-0.5)
 Parameter: YPOS <- "30.5029055"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.735601695"
Evaluating: (89.1533903-9.0)*(0.735601695-0.5)
 Parameter: ZPOS <- "18.8842746"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.624021 XMAX =    7.624021 XAVE =    7.624021
    YMIN =   14.974912 YMAX =   14.974912 YAVE =   14.974912
    ZMIN =  -21.022420 ZMAX =  -21.022420 ZAVE =  -21.022420
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.7080966"
 RDCMND substituted energy or value "?XAVE" to "7.62402144"
Evaluating: 19.7080966-7.62402144
 Parameter: XTRAN <- "12.0840752"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "30.5029055"
 RDCMND substituted energy or value "?YAVE" to "14.9749116"
Evaluating: 30.5029055-14.9749116
 Parameter: YTRAN <- "15.5279939"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "18.8842746"
 RDCMND substituted energy or value "?ZAVE" to "-21.0224202"
Evaluating: 18.8842746--21.0224202
 Parameter: ZTRAN <- "39.9066948"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "12.0840752"
 Parameter: YTRAN -> "15.5279939"
 Parameter: ZTRAN -> "39.9066948"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    12.084075   15.527994   39.906695
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.179363814"
Evaluating: 0.179363814*360.0
 Parameter: XPHI <- "64.570973"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.466608015"
Evaluating: 0.466608015*360.0
 Parameter: YPHI <- "167.978885"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.788949505"
Evaluating: 0.788949505*360.0
 Parameter: ZPHI <- "284.021822"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.7080966"
 Parameter: YPOS -> "30.5029055"
 Parameter: ZPOS -> "18.8842746"
 Parameter: XPHI -> "64.570973"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.429393    0.903118
    0.000000   -0.903118    0.429393

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   64.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.7080966"
 Parameter: YPOS -> "30.5029055"
 Parameter: ZPOS -> "18.8842746"
 Parameter: YPHI -> "167.978885"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.978071    0.000000   -0.208272
    0.000000    1.000000    0.000000
    0.208272    0.000000   -0.978071

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  167.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.7080966"
 Parameter: YPOS -> "30.5029055"
 Parameter: ZPOS -> "18.8842746"
 Parameter: ZPHI -> "284.021822"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.242291   -0.970204    0.000000
    0.970204    0.242291    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   75.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.708097 XMAX =   19.708097 XAVE =   19.708097
    YMIN =   30.502905 YMAX =   30.502905 YAVE =   30.502905
    ZMIN =   18.884275 ZMAX =   18.884275 ZAVE =   18.884275
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.7080966"
Evaluating: 19.7080966+3.5
 Parameter: XMAX <- "23.2080966"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "30.5029055"
Evaluating: 30.5029055+3.5
 Parameter: YMAX <- "34.0029055"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "18.8842746"
Evaluating: 18.8842746+3.5
 Parameter: ZMAX <- "22.3842746"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.7080966"
Evaluating: 19.7080966-3.5
 Parameter: XMIN <- "16.2080966"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "30.5029055"
Evaluating: 30.5029055-3.5
 Parameter: YMIN <- "27.0029055"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "18.8842746"
Evaluating: 18.8842746-3.5
 Parameter: ZMIN <- "15.3842746"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "23.2080966"
 Parameter: XMIN -> "16.2080966"
 Parameter: YMAX -> "34.0029055"
 Parameter: YMIN -> "27.0029055"
 Parameter: ZMAX -> "22.3842746"
 Parameter: ZMIN -> "15.3842746"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "108"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "108" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "108"
Evaluating: 108
 Parameter: J <- "108"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "108" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "108"
 Parameter: NPOS -> "80"
Evaluating: 108-80
 Parameter: J <- "28"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "28"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.209374585"
Evaluating: (89.1533903-9.0)*(0.209374585-0.5)
 Parameter: XPOS <- "-23.2946123"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.561693559"
Evaluating: (89.1533903-9.0)*(0.561693559-0.5)
 Parameter: YPOS <- "4.94494791"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "9.969272374E-02"
Evaluating: (89.1533903-9.0)*(9.969272374E-02-0.5)
 Parameter: ZPOS <- "-32.0859854"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-23.2946123"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -23.2946123-44.5766951
 Parameter: XTRAN <- "-67.8713074"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.94494791"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 4.94494791-44.5766951
 Parameter: YTRAN <- "-39.6317472"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.0859854"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -32.0859854-44.5766951
 Parameter: ZTRAN <- "-76.6626805"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-67.8713074"
 Parameter: YTRAN -> "-39.6317472"
 Parameter: ZTRAN -> "-76.6626805"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -67.871307  -39.631747  -76.662680
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.33554418"
Evaluating: 0.33554418*360.0
 Parameter: XPHI <- "120.795905"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.102394024"
Evaluating: 0.102394024*360.0
 Parameter: YPHI <- "36.8618486"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.53613292E-02"
Evaluating: 3.53613292E-02*360.0
 Parameter: ZPHI <- "12.7300785"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-23.2946123"
 Parameter: YPOS -> "4.94494791"
 Parameter: ZPOS -> "-32.0859854"
 Parameter: XPHI -> "120.795905"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.511981    0.858996
    0.000000   -0.858996   -0.511981

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  120.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-23.2946123"
 Parameter: YPOS -> "4.94494791"
 Parameter: ZPOS -> "-32.0859854"
 Parameter: YPHI -> "36.8618486"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.800084    0.000000   -0.599888
    0.000000    1.000000    0.000000
    0.599888    0.000000    0.800084

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   36.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-23.2946123"
 Parameter: YPOS -> "4.94494791"
 Parameter: ZPOS -> "-32.0859854"
 Parameter: ZPHI -> "12.7300785"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.975419    0.220358    0.000000
   -0.220358    0.975419    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   12.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -23.294612 XMAX =  -23.294612 XAVE =  -23.294612
    YMIN =    4.944948 YMAX =    4.944948 YAVE =    4.944948
    ZMIN =  -32.085985 ZMAX =  -32.085985 ZAVE =  -32.085985
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-23.2946123"
Evaluating: -23.2946123+3.5
 Parameter: XMAX <- "-19.7946123"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.94494792"
Evaluating: 4.94494792+3.5
 Parameter: YMAX <- "8.44494792"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.0859854"
Evaluating: -32.0859854+3.5
 Parameter: ZMAX <- "-28.5859854"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-23.2946123"
Evaluating: -23.2946123-3.5
 Parameter: XMIN <- "-26.7946123"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.94494792"
Evaluating: 4.94494792-3.5
 Parameter: YMIN <- "1.44494792"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.0859854"
Evaluating: -32.0859854-3.5
 Parameter: ZMIN <- "-35.5859854"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-19.7946123"
 Parameter: XMIN -> "-26.7946123"
 Parameter: YMAX -> "8.44494792"
 Parameter: YMIN -> "1.44494792"
 Parameter: ZMAX -> "-28.5859854"
 Parameter: ZMIN -> "-35.5859854"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "109"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "109" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "109"
Evaluating: 109
 Parameter: J <- "109"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "109" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "109"
 Parameter: NPOS -> "80"
Evaluating: 109-80
 Parameter: J <- "29"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "29"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.742732071"
Evaluating: (89.1533903-9.0)*(0.742732071-0.5)
 Parameter: XPOS <- "19.4557984"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.786896266"
Evaluating: (89.1533903-9.0)*(0.786896266-0.5)
 Parameter: YPOS <- "22.9957084"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.988287071"
Evaluating: (89.1533903-9.0)*(0.988287071-0.5)
 Parameter: ZPOS <- "39.1378642"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "19.4557984"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 19.4557984-44.5766951
 Parameter: XTRAN <- "-25.1208967"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.9957084"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 22.9957084-44.5766951
 Parameter: YTRAN <- "-21.5809867"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "39.1378642"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 39.1378642-44.5766951
 Parameter: ZTRAN <- "-5.4388309"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-25.1208967"
 Parameter: YTRAN -> "-21.5809867"
 Parameter: ZTRAN -> "-5.4388309"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -25.120897  -21.580987   -5.438831
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.297053903"
Evaluating: 0.297053903*360.0
 Parameter: XPHI <- "106.939405"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.206807156"
Evaluating: 0.206807156*360.0
 Parameter: YPHI <- "74.4505762"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.100811486"
Evaluating: 0.100811486*360.0
 Parameter: ZPHI <- "36.292135"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "19.4557984"
 Parameter: YPOS -> "22.9957084"
 Parameter: ZPOS -> "39.1378642"
 Parameter: XPHI -> "106.939405"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.291360    0.956613
    0.000000   -0.956613   -0.291360

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  106.94

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "19.4557984"
 Parameter: YPOS -> "22.9957084"
 Parameter: ZPOS -> "39.1378642"
 Parameter: YPHI -> "74.4505762"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.268070    0.000000   -0.963400
    0.000000    1.000000    0.000000
    0.963400    0.000000    0.268070

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   74.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "19.4557984"
 Parameter: YPOS -> "22.9957084"
 Parameter: ZPOS -> "39.1378642"
 Parameter: ZPHI -> "36.292135"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.806010    0.591903    0.000000
   -0.591903    0.806010    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   36.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   19.455798 XMAX =   19.455798 XAVE =   19.455798
    YMIN =   22.995708 YMAX =   22.995708 YAVE =   22.995708
    ZMIN =   39.137864 ZMAX =   39.137864 ZAVE =   39.137864
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "19.4557984"
Evaluating: 19.4557984+3.5
 Parameter: XMAX <- "22.9557984"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.9957084"
Evaluating: 22.9957084+3.5
 Parameter: YMAX <- "26.4957084"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "39.1378642"
Evaluating: 39.1378642+3.5
 Parameter: ZMAX <- "42.6378642"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "19.4557984"
Evaluating: 19.4557984-3.5
 Parameter: XMIN <- "15.9557984"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.9957084"
Evaluating: 22.9957084-3.5
 Parameter: YMIN <- "19.4957084"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "39.1378642"
Evaluating: 39.1378642-3.5
 Parameter: ZMIN <- "35.6378642"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "22.9557984"
 Parameter: XMIN -> "15.9557984"
 Parameter: YMAX -> "26.4957084"
 Parameter: YMIN -> "19.4957084"
 Parameter: ZMAX -> "42.6378642"
 Parameter: ZMIN -> "35.6378642"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "110"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "110" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "110"
Evaluating: 110
 Parameter: J <- "110"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "110" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "110"
 Parameter: NPOS -> "80"
Evaluating: 110-80
 Parameter: J <- "30"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.462278235"
Evaluating: (89.1533903-9.0)*(0.462278235-0.5)
 Parameter: XPOS <- "-3.02352735"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.733148314"
Evaluating: (89.1533903-9.0)*(0.733148314-0.5)
 Parameter: YPOS <- "18.6876278"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.784100882"
Evaluating: (89.1533903-9.0)*(0.784100882-0.5)
 Parameter: ZPOS <- "22.7716489"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-3.02352735"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -3.02352735-44.5766951
 Parameter: XTRAN <- "-47.6002225"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "18.6876278"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 18.6876278-44.5766951
 Parameter: YTRAN <- "-25.8890673"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.7716489"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 22.7716489-44.5766951
 Parameter: ZTRAN <- "-21.8050462"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-47.6002225"
 Parameter: YTRAN -> "-25.8890673"
 Parameter: ZTRAN -> "-21.8050462"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -47.600223  -25.889067  -21.805046
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.840716774"
Evaluating: 0.840716774*360.0
 Parameter: XPHI <- "302.658039"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.225917242"
Evaluating: 0.225917242*360.0
 Parameter: YPHI <- "81.3302071"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.184824257"
Evaluating: 0.184824257*360.0
 Parameter: ZPHI <- "66.5367325"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-3.02352735"
 Parameter: YPOS -> "18.6876278"
 Parameter: ZPOS -> "22.7716489"
 Parameter: XPHI -> "302.658039"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.539624   -0.841906
    0.000000    0.841906    0.539624

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   57.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-3.02352735"
 Parameter: YPOS -> "18.6876278"
 Parameter: ZPOS -> "22.7716489"
 Parameter: YPHI -> "81.3302071"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.150740    0.000000   -0.988573
    0.000000    1.000000    0.000000
    0.988573    0.000000    0.150740

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   81.33

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-3.02352735"
 Parameter: YPOS -> "18.6876278"
 Parameter: ZPOS -> "22.7716489"
 Parameter: ZPHI -> "66.5367325"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.398161    0.917316    0.000000
   -0.917316    0.398161    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   66.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.023527 XMAX =   -3.023527 XAVE =   -3.023527
    YMIN =   18.687628 YMAX =   18.687628 YAVE =   18.687628
    ZMIN =   22.771649 ZMAX =   22.771649 ZAVE =   22.771649
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-3.02352735"
Evaluating: -3.02352735+3.5
 Parameter: XMAX <- "0.47647265"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "18.6876278"
Evaluating: 18.6876278+3.5
 Parameter: YMAX <- "22.1876278"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.7716489"
Evaluating: 22.7716489+3.5
 Parameter: ZMAX <- "26.2716489"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-3.02352735"
Evaluating: -3.02352735-3.5
 Parameter: XMIN <- "-6.52352735"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "18.6876278"
Evaluating: 18.6876278-3.5
 Parameter: YMIN <- "15.1876278"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.7716489"
Evaluating: 22.7716489-3.5
 Parameter: ZMIN <- "19.2716489"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "0.47647265"
 Parameter: XMIN -> "-6.52352735"
 Parameter: YMAX -> "22.1876278"
 Parameter: YMIN -> "15.1876278"
 Parameter: ZMAX -> "26.2716489"
 Parameter: ZMIN -> "19.2716489"
 SELRPN>      7 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "7"
 Comparing "7" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      4 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9212 NEG      CLA      30       CLA     -7318 PAA2     GLY      210      N             2.8861
 9212 NEG      CLA      30       CLA     -7320 PAA2     GLY      210      CA            2.2543
 9212 NEG      CLA      30       CLA     -7323 PAA2     GLY      210      C             3.1155
 9212 NEG      CLA      30       CLA     -7324 PAA2     GLY      210      O             3.0960
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "110"
Evaluating: 110
 Parameter: J <- "110"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "110" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "110"
 Parameter: NPOS -> "80"
Evaluating: 110-80
 Parameter: J <- "30"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.482134986"
Evaluating: (89.1533903-9.0)*(0.482134986-0.5)
 Parameter: XPOS <- "-1.43194144"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.990293627"
Evaluating: (89.1533903-9.0)*(0.990293627-0.5)
 Parameter: YPOS <- "39.2986964"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.895396664"
Evaluating: (89.1533903-9.0)*(0.895396664-0.5)
 Parameter: ZPOS <- "31.6923831"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -3.023527 XMAX =   -3.023527 XAVE =   -3.023527
    YMIN =   18.687628 YMAX =   18.687628 YAVE =   18.687628
    ZMIN =   22.771649 ZMAX =   22.771649 ZAVE =   22.771649
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-1.43194144"
 RDCMND substituted energy or value "?XAVE" to "-3.02352735"
Evaluating: -1.43194144--3.02352735
 Parameter: XTRAN <- "1.59158591"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.2986964"
 RDCMND substituted energy or value "?YAVE" to "18.6876278"
Evaluating: 39.2986964-18.6876278
 Parameter: YTRAN <- "20.6110686"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "31.6923831"
 RDCMND substituted energy or value "?ZAVE" to "22.7716489"
Evaluating: 31.6923831-22.7716489
 Parameter: ZTRAN <- "8.9207342"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "1.59158591"
 Parameter: YTRAN -> "20.6110686"
 Parameter: ZTRAN -> "8.9207342"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR     1.591586   20.611069    8.920734
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.976175378"
Evaluating: 0.976175378*360.0
 Parameter: XPHI <- "351.423136"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.449536019"
Evaluating: 0.449536019*360.0
 Parameter: YPHI <- "161.832967"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.301762715"
Evaluating: 0.301762715*360.0
 Parameter: ZPHI <- "108.634577"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-1.43194144"
 Parameter: YPOS -> "39.2986964"
 Parameter: ZPOS -> "31.6923831"
 Parameter: XPHI -> "351.423136"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.988817   -0.149136
    0.000000    0.149136    0.988817

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    8.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-1.43194144"
 Parameter: YPOS -> "39.2986964"
 Parameter: ZPOS -> "31.6923831"
 Parameter: YPHI -> "161.832967"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.950152    0.000000   -0.311788
    0.000000    1.000000    0.000000
    0.311788    0.000000   -0.950152

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  161.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-1.43194144"
 Parameter: YPOS -> "39.2986964"
 Parameter: ZPOS -> "31.6923831"
 Parameter: ZPHI -> "108.634577"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.319531    0.947576    0.000000
   -0.947576   -0.319531    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  108.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.431941 XMAX =   -1.431941 XAVE =   -1.431941
    YMIN =   39.298696 YMAX =   39.298696 YAVE =   39.298696
    ZMIN =   31.692383 ZMAX =   31.692383 ZAVE =   31.692383
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-1.43194143"
Evaluating: -1.43194143+3.5
 Parameter: XMAX <- "2.06805857"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.2986964"
Evaluating: 39.2986964+3.5
 Parameter: YMAX <- "42.7986964"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "31.6923831"
Evaluating: 31.6923831+3.5
 Parameter: ZMAX <- "35.1923831"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-1.43194143"
Evaluating: -1.43194143-3.5
 Parameter: XMIN <- "-4.93194143"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.2986964"
Evaluating: 39.2986964-3.5
 Parameter: YMIN <- "35.7986964"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "31.6923831"
Evaluating: 31.6923831-3.5
 Parameter: ZMIN <- "28.1923831"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "2.06805857"
 Parameter: XMIN -> "-4.93194143"
 Parameter: YMAX -> "42.7986964"
 Parameter: YMIN -> "35.7986964"
 Parameter: ZMAX -> "35.1923831"
 Parameter: ZMIN -> "28.1923831"
 SELRPN>     19 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "19"
 Comparing "19" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     12 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9212 NEG      CLA      30       CLA     -6685 PAA2     GLY      150      C             3.8816
 9212 NEG      CLA      30       CLA     -6687 PAA2     GLY      151      N             2.7905
 9212 NEG      CLA      30       CLA     -6689 PAA2     GLY      151      CA            3.1440
 9212 NEG      CLA      30       CLA     -6692 PAA2     GLY      151      C             3.5218
 9212 NEG      CLA      30       CLA     -6694 PAA2     TYR      152      N             3.0754
 9212 NEG      CLA      30       CLA     -6696 PAA2     TYR      152      CA            4.2193
 9212 NEG      CLA      30       CLA     -6698 PAA2     TYR      152      CB            4.1631
 9212 NEG      CLA      30       CLA     -6701 PAA2     TYR      152      CG            3.4437
 9212 NEG      CLA      30       CLA     -6702 PAA2     TYR      152      CD1           2.3131
 9212 NEG      CLA      30       CLA     -6704 PAA2     TYR      152      CE1           2.3571
 9212 NEG      CLA      30       CLA     -6706 PAA2     TYR      152      CZ            3.5150
 9212 NEG      CLA      30       CLA     -6707 PAA2     TYR      152      OH            4.2569
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "110"
Evaluating: 110
 Parameter: J <- "110"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "110" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "110"
 Parameter: NPOS -> "80"
Evaluating: 110-80
 Parameter: J <- "30"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "30"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.188539854"
Evaluating: (89.1533903-9.0)*(0.188539854-0.5)
 Parameter: XPOS <- "-24.9645866"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.852724007"
Evaluating: (89.1533903-9.0)*(0.852724007-0.5)
 Parameter: YPOS <- "28.272025"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "9.460741657E-02"
Evaluating: (89.1533903-9.0)*(9.460741657E-02-0.5)
 Parameter: ZPOS <- "-32.49359"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -1.431941 XMAX =   -1.431941 XAVE =   -1.431941
    YMIN =   39.298696 YMAX =   39.298696 YAVE =   39.298696
    ZMIN =   31.692383 ZMAX =   31.692383 ZAVE =   31.692383
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-24.9645866"
 RDCMND substituted energy or value "?XAVE" to "-1.43194143"
Evaluating: -24.9645866--1.43194143
 Parameter: XTRAN <- "-23.5326452"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "28.272025"
 RDCMND substituted energy or value "?YAVE" to "39.2986964"
Evaluating: 28.272025-39.2986964
 Parameter: YTRAN <- "-11.0266714"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-32.49359"
 RDCMND substituted energy or value "?ZAVE" to "31.6923831"
Evaluating: -32.49359-31.6923831
 Parameter: ZTRAN <- "-64.1859731"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-23.5326452"
 Parameter: YTRAN -> "-11.0266714"
 Parameter: ZTRAN -> "-64.1859731"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -23.532645  -11.026671  -64.185973
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.720450187"
Evaluating: 0.720450187*360.0
 Parameter: XPHI <- "259.362067"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.207480542"
Evaluating: 0.207480542*360.0
 Parameter: YPHI <- "74.6929951"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.216856454E-02"
Evaluating: 7.216856454E-02*360.0
 Parameter: ZPHI <- "25.9806832"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-24.9645866"
 Parameter: YPOS -> "28.272025"
 Parameter: ZPOS -> "-32.49359"
 Parameter: XPHI -> "259.362067"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.184602   -0.982813
    0.000000    0.982813   -0.184602

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  100.64

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-24.9645866"
 Parameter: YPOS -> "28.272025"
 Parameter: ZPOS -> "-32.49359"
 Parameter: YPHI -> "74.6929951"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.263991    0.000000   -0.964525
    0.000000    1.000000    0.000000
    0.964525    0.000000    0.263991

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   74.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-24.9645866"
 Parameter: YPOS -> "28.272025"
 Parameter: ZPOS -> "-32.49359"
 Parameter: ZPHI -> "25.9806832"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.898942    0.438068    0.000000
   -0.438068    0.898942    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   25.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -24.964587 XMAX =  -24.964587 XAVE =  -24.964587
    YMIN =   28.272025 YMAX =   28.272025 YAVE =   28.272025
    ZMIN =  -32.493590 ZMAX =  -32.493590 ZAVE =  -32.493590
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-24.9645866"
Evaluating: -24.9645866+3.5
 Parameter: XMAX <- "-21.4645866"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "28.272025"
Evaluating: 28.272025+3.5
 Parameter: YMAX <- "31.772025"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-32.49359"
Evaluating: -32.49359+3.5
 Parameter: ZMAX <- "-28.99359"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-24.9645866"
Evaluating: -24.9645866-3.5
 Parameter: XMIN <- "-28.4645866"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "28.272025"
Evaluating: 28.272025-3.5
 Parameter: YMIN <- "24.772025"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-32.49359"
Evaluating: -32.49359-3.5
 Parameter: ZMIN <- "-35.99359"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-21.4645866"
 Parameter: XMIN -> "-28.4645866"
 Parameter: YMAX -> "31.772025"
 Parameter: YMIN -> "24.772025"
 Parameter: ZMAX -> "-28.99359"
 Parameter: ZMIN -> "-35.99359"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "111"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "111" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "111"
Evaluating: 111
 Parameter: J <- "111"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "111" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "111"
 Parameter: NPOS -> "80"
Evaluating: 111-80
 Parameter: J <- "31"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "31"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.967799458"
Evaluating: (89.1533903-9.0)*(0.967799458-0.5)
 Parameter: XPOS <- "37.4957125"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.338022519"
Evaluating: (89.1533903-9.0)*(0.338022519-0.5)
 Parameter: YPOS <- "-12.9830443"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.125245692"
Evaluating: (89.1533903-9.0)*(0.125245692-0.5)
 Parameter: ZPOS <- "-30.0378283"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "37.4957125"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 37.4957125-44.5766951
 Parameter: XTRAN <- "-7.0809826"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-12.9830443"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -12.9830443-44.5766951
 Parameter: YTRAN <- "-57.5597394"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.0378283"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -30.0378283-44.5766951
 Parameter: ZTRAN <- "-74.6145234"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.0809826"
 Parameter: YTRAN -> "-57.5597394"
 Parameter: ZTRAN -> "-74.6145234"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    -7.080983  -57.559739  -74.614523
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.534271445"
Evaluating: 0.534271445*360.0
 Parameter: XPHI <- "192.33772"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.252998698"
Evaluating: 0.252998698*360.0
 Parameter: YPHI <- "91.0795313"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.214169295"
Evaluating: 0.214169295*360.0
 Parameter: ZPHI <- "77.1009462"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "37.4957125"
 Parameter: YPOS -> "-12.9830443"
 Parameter: ZPOS -> "-30.0378283"
 Parameter: XPHI -> "192.33772"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.976905   -0.213674
    0.000000    0.213674   -0.976905

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  167.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "37.4957125"
 Parameter: YPOS -> "-12.9830443"
 Parameter: ZPOS -> "-30.0378283"
 Parameter: YPHI -> "91.0795313"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.018840    0.000000   -0.999823
    0.000000    1.000000    0.000000
    0.999823    0.000000   -0.018840

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   91.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "37.4957125"
 Parameter: YPOS -> "-12.9830443"
 Parameter: ZPOS -> "-30.0378283"
 Parameter: ZPHI -> "77.1009462"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.223234    0.974765    0.000000
   -0.974765    0.223234    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   77.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   37.495712 XMAX =   37.495712 XAVE =   37.495712
    YMIN =  -12.983044 YMAX =  -12.983044 YAVE =  -12.983044
    ZMIN =  -30.037828 ZMAX =  -30.037828 ZAVE =  -30.037828
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "37.4957125"
Evaluating: 37.4957125+3.5
 Parameter: XMAX <- "40.9957125"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-12.9830443"
Evaluating: -12.9830443+3.5
 Parameter: YMAX <- "-9.4830443"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.0378283"
Evaluating: -30.0378283+3.5
 Parameter: ZMAX <- "-26.5378283"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "37.4957125"
Evaluating: 37.4957125-3.5
 Parameter: XMIN <- "33.9957125"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-12.9830443"
Evaluating: -12.9830443-3.5
 Parameter: YMIN <- "-16.4830443"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.0378283"
Evaluating: -30.0378283-3.5
 Parameter: ZMIN <- "-33.5378283"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.9957125"
 Parameter: XMIN -> "33.9957125"
 Parameter: YMAX -> "-9.4830443"
 Parameter: YMIN -> "-16.4830443"
 Parameter: ZMAX -> "-26.5378283"
 Parameter: ZMIN -> "-33.5378283"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "112"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "112" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "112"
Evaluating: 112
 Parameter: J <- "112"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "112" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "112"
 Parameter: NPOS -> "80"
Evaluating: 112-80
 Parameter: J <- "32"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "32"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.605805945"
Evaluating: (89.1533903-9.0)*(0.605805945-0.5)
 Parameter: XPOS <- "8.48070521"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.55911573"
Evaluating: (89.1533903-9.0)*(0.55911573-0.5)
 Parameter: YPOS <- "4.73832618"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.568301868"
Evaluating: (89.1533903-9.0)*(0.568301868-0.5)
 Parameter: ZPOS <- "5.47462628"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.48070521"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 8.48070521-44.5766951
 Parameter: XTRAN <- "-36.0959899"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.73832618"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 4.73832618-44.5766951
 Parameter: YTRAN <- "-39.8383689"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "5.47462628"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 5.47462628-44.5766951
 Parameter: ZTRAN <- "-39.1020688"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.0959899"
 Parameter: YTRAN -> "-39.8383689"
 Parameter: ZTRAN -> "-39.1020688"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -36.095990  -39.838369  -39.102069
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.819508943E-03"
Evaluating: 9.819508943E-03*360.0
 Parameter: XPHI <- "3.53502322"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.887497679"
Evaluating: 0.887497679*360.0
 Parameter: YPHI <- "319.499164"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.926713172"
Evaluating: 0.926713172*360.0
 Parameter: ZPHI <- "333.616742"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.48070521"
 Parameter: YPOS -> "4.73832618"
 Parameter: ZPOS -> "5.47462628"
 Parameter: XPHI -> "3.53502322"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.998097    0.061659
    0.000000   -0.061659    0.998097

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    3.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.48070521"
 Parameter: YPOS -> "4.73832618"
 Parameter: ZPOS -> "5.47462628"
 Parameter: YPHI -> "319.499164"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.760396    0.000000    0.649459
    0.000000    1.000000    0.000000
   -0.649459    0.000000    0.760396

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   40.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.48070521"
 Parameter: YPOS -> "4.73832618"
 Parameter: ZPOS -> "5.47462628"
 Parameter: ZPHI -> "333.616742"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.895842   -0.444373    0.000000
    0.444373    0.895842    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   26.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.480705 XMAX =    8.480705 XAVE =    8.480705
    YMIN =    4.738326 YMAX =    4.738326 YAVE =    4.738326
    ZMIN =    5.474626 ZMAX =    5.474626 ZAVE =    5.474626
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.4807052"
Evaluating: 8.4807052+3.5
 Parameter: XMAX <- "11.9807052"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.7383262"
Evaluating: 4.7383262+3.5
 Parameter: YMAX <- "8.2383262"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "5.4746263"
Evaluating: 5.4746263+3.5
 Parameter: ZMAX <- "8.9746263"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.4807052"
Evaluating: 8.4807052-3.5
 Parameter: XMIN <- "4.9807052"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.7383262"
Evaluating: 4.7383262-3.5
 Parameter: YMIN <- "1.2383262"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "5.4746263"
Evaluating: 5.4746263-3.5
 Parameter: ZMIN <- "1.9746263"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.9807052"
 Parameter: XMIN -> "4.9807052"
 Parameter: YMAX -> "8.2383262"
 Parameter: YMIN -> "1.2383262"
 Parameter: ZMAX -> "8.9746263"
 Parameter: ZMIN -> "1.9746263"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "113"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "113" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "113"
Evaluating: 113
 Parameter: J <- "113"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "113" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "113"
 Parameter: NPOS -> "80"
Evaluating: 113-80
 Parameter: J <- "33"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "33"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "1.829309059E-02"
Evaluating: (89.1533903-9.0)*(1.829309059E-02-0.5)
 Parameter: XPOS <- "-38.6104419"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.404325"
Evaluating: (89.1533903-9.0)*(0.404325-0.5)
 Parameter: YPOS <- "-7.66867562"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.491763244"
Evaluating: (89.1533903-9.0)*(0.491763244-0.5)
 Parameter: ZPOS <- "-0.660203918"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-38.6104419"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -38.6104419-44.5766951
 Parameter: XTRAN <- "-83.187137"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-7.66867562"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -7.66867562-44.5766951
 Parameter: YTRAN <- "-52.2453707"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-0.660203918"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -0.660203918-44.5766951
 Parameter: ZTRAN <- "-45.236899"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-83.187137"
 Parameter: YTRAN -> "-52.2453707"
 Parameter: ZTRAN -> "-45.236899"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -83.187137  -52.245371  -45.236899
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.697894828"
Evaluating: 0.697894828*360.0
 Parameter: XPHI <- "251.242138"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.97458191"
Evaluating: 0.97458191*360.0
 Parameter: YPHI <- "350.849488"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.238033384"
Evaluating: 0.238033384*360.0
 Parameter: ZPHI <- "85.6920182"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-38.6104419"
 Parameter: YPOS -> "-7.66867562"
 Parameter: ZPOS -> "-0.660203918"
 Parameter: XPHI -> "251.242138"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.321569   -0.946886
    0.000000    0.946886   -0.321569

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  108.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-38.6104419"
 Parameter: YPOS -> "-7.66867562"
 Parameter: ZPOS -> "-0.660203918"
 Parameter: YPHI -> "350.849488"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.987274    0.000000    0.159029
    0.000000    1.000000    0.000000
   -0.159029    0.000000    0.987274

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    9.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-38.6104419"
 Parameter: YPOS -> "-7.66867562"
 Parameter: ZPOS -> "-0.660203918"
 Parameter: ZPHI -> "85.6920182"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.075118    0.997175    0.000000
   -0.997175    0.075118    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   85.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -38.610442 XMAX =  -38.610442 XAVE =  -38.610442
    YMIN =   -7.668676 YMAX =   -7.668676 YAVE =   -7.668676
    ZMIN =   -0.660204 ZMAX =   -0.660204 ZAVE =   -0.660204
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-38.6104419"
Evaluating: -38.6104419+3.5
 Parameter: XMAX <- "-35.1104419"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-7.66867562"
Evaluating: -7.66867562+3.5
 Parameter: YMAX <- "-4.16867562"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-0.660203905"
Evaluating: -0.660203905+3.5
 Parameter: ZMAX <- "2.8397961"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-38.6104419"
Evaluating: -38.6104419-3.5
 Parameter: XMIN <- "-42.1104419"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-7.66867562"
Evaluating: -7.66867562-3.5
 Parameter: YMIN <- "-11.1686756"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-0.660203905"
Evaluating: -0.660203905-3.5
 Parameter: ZMIN <- "-4.16020391"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.1104419"
 Parameter: XMIN -> "-42.1104419"
 Parameter: YMAX -> "-4.16867562"
 Parameter: YMIN -> "-11.1686756"
 Parameter: ZMAX -> "2.8397961"
 Parameter: ZMIN -> "-4.16020391"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "114"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "114" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "114"
Evaluating: 114
 Parameter: J <- "114"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "114" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "114"
 Parameter: NPOS -> "80"
Evaluating: 114-80
 Parameter: J <- "34"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "34"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.35160684"
Evaluating: (89.1533903-9.0)*(0.35160684-0.5)
 Parameter: XPOS <- "-11.8942149"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.997504754"
Evaluating: (89.1533903-9.0)*(0.997504754-0.5)
 Parameter: YPOS <- "39.8766927"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.111392573"
Evaluating: (89.1533903-9.0)*(0.111392573-0.5)
 Parameter: ZPOS <- "-31.1482028"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-11.8942149"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -11.8942149-44.5766951
 Parameter: XTRAN <- "-56.47091"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.8766927"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 39.8766927-44.5766951
 Parameter: YTRAN <- "-4.7000024"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.1482028"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -31.1482028-44.5766951
 Parameter: ZTRAN <- "-75.7248979"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-56.47091"
 Parameter: YTRAN -> "-4.7000024"
 Parameter: ZTRAN -> "-75.7248979"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -56.470910   -4.700002  -75.724898
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "1.073282105E-02"
Evaluating: 1.073282105E-02*360.0
 Parameter: XPHI <- "3.86381558"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.893333561"
Evaluating: 0.893333561*360.0
 Parameter: YPHI <- "321.600082"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.970343359"
Evaluating: 0.970343359*360.0
 Parameter: ZPHI <- "349.323609"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-11.8942149"
 Parameter: YPOS -> "39.8766927"
 Parameter: ZPOS -> "-31.1482028"
 Parameter: XPHI -> "3.86381558"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.997727    0.067385
    0.000000   -0.067385    0.997727

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS    3.86

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-11.8942149"
 Parameter: YPOS -> "39.8766927"
 Parameter: ZPOS -> "-31.1482028"
 Parameter: YPHI -> "321.600082"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.783694    0.000000    0.621147
    0.000000    1.000000    0.000000
   -0.621147    0.000000    0.783694

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   38.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-11.8942149"
 Parameter: YPOS -> "39.8766927"
 Parameter: ZPOS -> "-31.1482028"
 Parameter: ZPHI -> "349.323609"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.982689   -0.185262    0.000000
    0.185262    0.982689    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   10.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -11.894215 XMAX =  -11.894215 XAVE =  -11.894215
    YMIN =   39.876693 YMAX =   39.876693 YAVE =   39.876693
    ZMIN =  -31.148203 ZMAX =  -31.148203 ZAVE =  -31.148203
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-11.8942149"
Evaluating: -11.8942149+3.5
 Parameter: XMAX <- "-8.3942149"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.8766927"
Evaluating: 39.8766927+3.5
 Parameter: YMAX <- "43.3766927"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.1482028"
Evaluating: -31.1482028+3.5
 Parameter: ZMAX <- "-27.6482028"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-11.8942149"
Evaluating: -11.8942149-3.5
 Parameter: XMIN <- "-15.3942149"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.8766927"
Evaluating: 39.8766927-3.5
 Parameter: YMIN <- "36.3766927"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.1482028"
Evaluating: -31.1482028-3.5
 Parameter: ZMIN <- "-34.6482028"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-8.3942149"
 Parameter: XMIN -> "-15.3942149"
 Parameter: YMAX -> "43.3766927"
 Parameter: YMIN -> "36.3766927"
 Parameter: ZMAX -> "-27.6482028"
 Parameter: ZMIN -> "-34.6482028"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "115"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "115" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "115"
Evaluating: 115
 Parameter: J <- "115"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "115" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "115"
 Parameter: NPOS -> "80"
Evaluating: 115-80
 Parameter: J <- "35"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.555262734"
Evaluating: (89.1533903-9.0)*(0.555262734-0.5)
 Parameter: XPOS <- "4.42949549"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.865620855"
Evaluating: (89.1533903-9.0)*(0.865620855-0.5)
 Parameter: YPOS <- "29.3057511"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.301949267"
Evaluating: (89.1533903-9.0)*(0.301949267-0.5)
 Parameter: ZPOS <- "-15.8744377"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "4.42949549"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 4.42949549-44.5766951
 Parameter: XTRAN <- "-40.1471996"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.3057511"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 29.3057511-44.5766951
 Parameter: YTRAN <- "-15.270944"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.8744377"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -15.8744377-44.5766951
 Parameter: ZTRAN <- "-60.4511328"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-40.1471996"
 Parameter: YTRAN -> "-15.270944"
 Parameter: ZTRAN -> "-60.4511328"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -40.147200  -15.270944  -60.451133
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.449683837"
Evaluating: 0.449683837*360.0
 Parameter: XPHI <- "161.886181"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.322176126"
Evaluating: 0.322176126*360.0
 Parameter: YPHI <- "115.983405"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.382644647"
Evaluating: 0.382644647*360.0
 Parameter: ZPHI <- "137.752073"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "4.42949549"
 Parameter: YPOS -> "29.3057511"
 Parameter: ZPOS -> "-15.8744377"
 Parameter: XPHI -> "161.886181"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.950441    0.310906
    0.000000   -0.310906   -0.950441

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  161.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "4.42949549"
 Parameter: YPOS -> "29.3057511"
 Parameter: ZPOS -> "-15.8744377"
 Parameter: YPHI -> "115.983405"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.438111    0.000000   -0.898921
    0.000000    1.000000    0.000000
    0.898921    0.000000   -0.438111

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  115.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "4.42949549"
 Parameter: YPOS -> "29.3057511"
 Parameter: ZPOS -> "-15.8744377"
 Parameter: ZPHI -> "137.752073"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.740242    0.672340    0.000000
   -0.672340   -0.740242    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  137.75

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.429495 XMAX =    4.429495 XAVE =    4.429495
    YMIN =   29.305751 YMAX =   29.305751 YAVE =   29.305751
    ZMIN =  -15.874438 ZMAX =  -15.874438 ZAVE =  -15.874438
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "4.42949549"
Evaluating: 4.42949549+3.5
 Parameter: XMAX <- "7.92949549"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.3057511"
Evaluating: 29.3057511+3.5
 Parameter: YMAX <- "32.8057511"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.8744377"
Evaluating: -15.8744377+3.5
 Parameter: ZMAX <- "-12.3744377"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "4.42949549"
Evaluating: 4.42949549-3.5
 Parameter: XMIN <- "0.92949549"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.3057511"
Evaluating: 29.3057511-3.5
 Parameter: YMIN <- "25.8057511"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.8744377"
Evaluating: -15.8744377-3.5
 Parameter: ZMIN <- "-19.3744377"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "7.92949549"
 Parameter: XMIN -> "0.92949549"
 Parameter: YMAX -> "32.8057511"
 Parameter: YMIN -> "25.8057511"
 Parameter: ZMAX -> "-12.3744377"
 Parameter: ZMIN -> "-19.3744377"
 SELRPN>      3 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      2 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9217 NEG      CLA      35       CLA     -2942 PAA1     ASN      225      OD1           3.6208
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "115"
Evaluating: 115
 Parameter: J <- "115"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "115" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "115"
 Parameter: NPOS -> "80"
Evaluating: 115-80
 Parameter: J <- "35"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "35"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.591082199"
Evaluating: (89.1533903-9.0)*(0.591082199-0.5)
 Parameter: XPOS <- "7.30054705"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.918785046"
Evaluating: (89.1533903-9.0)*(0.918785046-0.5)
 Parameter: YPOS <- "33.5670412"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.913688185"
Evaluating: (89.1533903-9.0)*(0.913688185-0.5)
 Parameter: ZPOS <- "33.1585106"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    4.429495 XMAX =    4.429495 XAVE =    4.429495
    YMIN =   29.305751 YMAX =   29.305751 YAVE =   29.305751
    ZMIN =  -15.874438 ZMAX =  -15.874438 ZAVE =  -15.874438
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "7.30054705"
 RDCMND substituted energy or value "?XAVE" to "4.42949549"
Evaluating: 7.30054705-4.42949549
 Parameter: XTRAN <- "2.87105156"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.5670412"
 RDCMND substituted energy or value "?YAVE" to "29.3057511"
Evaluating: 33.5670412-29.3057511
 Parameter: YTRAN <- "4.2612901"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "33.1585106"
 RDCMND substituted energy or value "?ZAVE" to "-15.8744377"
Evaluating: 33.1585106--15.8744377
 Parameter: ZTRAN <- "49.0329483"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "2.87105156"
 Parameter: YTRAN -> "4.2612901"
 Parameter: ZTRAN -> "49.0329483"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR     2.871052    4.261290   49.032948
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.947531714"
Evaluating: 0.947531714*360.0
 Parameter: XPHI <- "341.111417"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.973944097"
Evaluating: 0.973944097*360.0
 Parameter: YPHI <- "350.619875"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.603328788"
Evaluating: 0.603328788*360.0
 Parameter: ZPHI <- "217.198364"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "7.30054705"
 Parameter: YPOS -> "33.5670412"
 Parameter: ZPOS -> "33.1585106"
 Parameter: XPHI -> "341.111417"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.946150   -0.323729
    0.000000    0.323729    0.946150

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   18.89

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "7.30054705"
 Parameter: YPOS -> "33.5670412"
 Parameter: ZPOS -> "33.1585106"
 Parameter: YPHI -> "350.619875"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.986629    0.000000    0.162984
    0.000000    1.000000    0.000000
   -0.162984    0.000000    0.986629

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    9.38

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "7.30054705"
 Parameter: YPOS -> "33.5670412"
 Parameter: ZPOS -> "33.1585106"
 Parameter: ZPHI -> "217.198364"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.796547   -0.604576    0.000000
    0.604576   -0.796547    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  142.80

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    7.300547 XMAX =    7.300547 XAVE =    7.300547
    YMIN =   33.567041 YMAX =   33.567041 YAVE =   33.567041
    ZMIN =   33.158511 ZMAX =   33.158511 ZAVE =   33.158511
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "7.30054705"
Evaluating: 7.30054705+3.5
 Parameter: XMAX <- "10.800547"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.5670412"
Evaluating: 33.5670412+3.5
 Parameter: YMAX <- "37.0670412"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "33.1585106"
Evaluating: 33.1585106+3.5
 Parameter: ZMAX <- "36.6585106"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "7.30054705"
Evaluating: 7.30054705-3.5
 Parameter: XMIN <- "3.80054705"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.5670412"
Evaluating: 33.5670412-3.5
 Parameter: YMIN <- "30.0670412"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "33.1585106"
Evaluating: 33.1585106-3.5
 Parameter: ZMIN <- "29.6585106"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "10.800547"
 Parameter: XMIN -> "3.80054705"
 Parameter: YMAX -> "37.0670412"
 Parameter: YMIN -> "30.0670412"
 Parameter: ZMAX -> "36.6585106"
 Parameter: ZMIN -> "29.6585106"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "116"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "116" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "116"
Evaluating: 116
 Parameter: J <- "116"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "116" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "116"
 Parameter: NPOS -> "80"
Evaluating: 116-80
 Parameter: J <- "36"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "36"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.634937317"
Evaluating: (89.1533903-9.0)*(0.634937317-0.5)
 Parameter: XPOS <- "10.8156834"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.539709311"
Evaluating: (89.1533903-9.0)*(0.539709311-0.5)
 Parameter: YPOS <- "3.1828359"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "2.886780653E-02"
Evaluating: (89.1533903-9.0)*(2.886780653E-02-0.5)
 Parameter: ZPOS <- "-37.7628426"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.8156834"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 10.8156834-44.5766951
 Parameter: XTRAN <- "-33.7610117"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.1828359"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 3.1828359-44.5766951
 Parameter: YTRAN <- "-41.3938592"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.7628426"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -37.7628426-44.5766951
 Parameter: ZTRAN <- "-82.3395377"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-33.7610117"
 Parameter: YTRAN -> "-41.3938592"
 Parameter: ZTRAN -> "-82.3395377"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -33.761012  -41.393859  -82.339538
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.28411634"
Evaluating: 0.28411634*360.0
 Parameter: XPHI <- "102.281882"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.215020695"
Evaluating: 0.215020695*360.0
 Parameter: YPHI <- "77.4074502"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.905440407"
Evaluating: 0.905440407*360.0
 Parameter: ZPHI <- "325.958547"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.8156834"
 Parameter: YPOS -> "3.1828359"
 Parameter: ZPOS -> "-37.7628426"
 Parameter: XPHI -> "102.281882"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.212721    0.977113
    0.000000   -0.977113   -0.212721

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  102.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.8156834"
 Parameter: YPOS -> "3.1828359"
 Parameter: ZPOS -> "-37.7628426"
 Parameter: YPHI -> "77.4074502"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.218016    0.000000   -0.975945
    0.000000    1.000000    0.000000
    0.975945    0.000000    0.218016

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   77.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.8156834"
 Parameter: YPOS -> "3.1828359"
 Parameter: ZPOS -> "-37.7628426"
 Parameter: ZPHI -> "325.958547"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.828633   -0.559793    0.000000
    0.559793    0.828633    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   34.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.815683 XMAX =   10.815683 XAVE =   10.815683
    YMIN =    3.182836 YMAX =    3.182836 YAVE =    3.182836
    ZMIN =  -37.762843 ZMAX =  -37.762843 ZAVE =  -37.762843
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.8156834"
Evaluating: 10.8156834+3.5
 Parameter: XMAX <- "14.3156834"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.1828359"
Evaluating: 3.1828359+3.5
 Parameter: YMAX <- "6.6828359"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.7628426"
Evaluating: -37.7628426+3.5
 Parameter: ZMAX <- "-34.2628426"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.8156834"
Evaluating: 10.8156834-3.5
 Parameter: XMIN <- "7.3156834"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.1828359"
Evaluating: 3.1828359-3.5
 Parameter: YMIN <- "-0.3171641"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.7628426"
Evaluating: -37.7628426-3.5
 Parameter: ZMIN <- "-41.2628426"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.3156834"
 Parameter: XMIN -> "7.3156834"
 Parameter: YMAX -> "6.6828359"
 Parameter: YMIN -> "-0.3171641"
 Parameter: ZMAX -> "-34.2628426"
 Parameter: ZMIN -> "-41.2628426"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "117"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "117" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "117"
Evaluating: 117
 Parameter: J <- "117"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "117" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "117"
 Parameter: NPOS -> "80"
Evaluating: 117-80
 Parameter: J <- "37"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "9.040381826E-02"
Evaluating: (89.1533903-9.0)*(9.040381826E-02-0.5)
 Parameter: XPOS <- "-32.8305226"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.866139242"
Evaluating: (89.1533903-9.0)*(0.866139242-0.5)
 Parameter: YPOS <- "29.3473016"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "4.906204623E-02"
Evaluating: (89.1533903-9.0)*(4.906204623E-02-0.5)
 Parameter: ZPOS <- "-36.1442058"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-32.8305226"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -32.8305226-44.5766951
 Parameter: XTRAN <- "-77.4072177"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "29.3473016"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 29.3473016-44.5766951
 Parameter: YTRAN <- "-15.2293935"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-36.1442058"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -36.1442058-44.5766951
 Parameter: ZTRAN <- "-80.7209009"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-77.4072177"
 Parameter: YTRAN -> "-15.2293935"
 Parameter: ZTRAN -> "-80.7209009"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -77.407218  -15.229394  -80.720901
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.687209886"
Evaluating: 0.687209886*360.0
 Parameter: XPHI <- "247.395559"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.515280725"
Evaluating: 0.515280725*360.0
 Parameter: YPHI <- "185.501061"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.514399134"
Evaluating: 0.514399134*360.0
 Parameter: ZPHI <- "185.183688"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-32.8305226"
 Parameter: YPOS -> "29.3473016"
 Parameter: ZPOS -> "-36.1442058"
 Parameter: XPHI -> "247.395559"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.384367   -0.923180
    0.000000    0.923180   -0.384367

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  112.60

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-32.8305226"
 Parameter: YPOS -> "29.3473016"
 Parameter: ZPOS -> "-36.1442058"
 Parameter: YPHI -> "185.501061"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.995394    0.000000    0.095864
    0.000000    1.000000    0.000000
   -0.095864    0.000000   -0.995394

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  174.50

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-32.8305226"
 Parameter: YPOS -> "29.3473016"
 Parameter: ZPOS -> "-36.1442058"
 Parameter: ZPHI -> "185.183688"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.995910   -0.090349    0.000000
    0.090349   -0.995910    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  174.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.830523 XMAX =  -32.830523 XAVE =  -32.830523
    YMIN =   29.347302 YMAX =   29.347302 YAVE =   29.347302
    ZMIN =  -36.144206 ZMAX =  -36.144206 ZAVE =  -36.144206
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-32.8305226"
Evaluating: -32.8305226+3.5
 Parameter: XMAX <- "-29.3305226"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "29.3473016"
Evaluating: 29.3473016+3.5
 Parameter: YMAX <- "32.8473016"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-36.1442058"
Evaluating: -36.1442058+3.5
 Parameter: ZMAX <- "-32.6442058"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-32.8305226"
Evaluating: -32.8305226-3.5
 Parameter: XMIN <- "-36.3305226"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "29.3473016"
Evaluating: 29.3473016-3.5
 Parameter: YMIN <- "25.8473016"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-36.1442058"
Evaluating: -36.1442058-3.5
 Parameter: ZMIN <- "-39.6442058"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.3305226"
 Parameter: XMIN -> "-36.3305226"
 Parameter: YMAX -> "32.8473016"
 Parameter: YMIN -> "25.8473016"
 Parameter: ZMAX -> "-32.6442058"
 Parameter: ZMIN -> "-39.6442058"
 SELRPN>      3 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      1 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9219 NEG      CLA      37       CLA     -9057 PAA2     GLN      343      O             3.3446
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "117"
Evaluating: 117
 Parameter: J <- "117"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "117" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "117"
 Parameter: NPOS -> "80"
Evaluating: 117-80
 Parameter: J <- "37"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.679174186"
Evaluating: (89.1533903-9.0)*(0.679174186-0.5)
 Parameter: XPOS <- "14.3614185"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.22463857"
Evaluating: (89.1533903-9.0)*(0.22463857-0.5)
 Parameter: YPOS <- "-22.0711522"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.2942322"
Evaluating: (89.1533903-9.0)*(0.2942322-0.5)
 Parameter: ZPOS <- "-16.4929868"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -32.830523 XMAX =  -32.830523 XAVE =  -32.830523
    YMIN =   29.347302 YMAX =   29.347302 YAVE =   29.347302
    ZMIN =  -36.144206 ZMAX =  -36.144206 ZAVE =  -36.144206
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "14.3614185"
 RDCMND substituted energy or value "?XAVE" to "-32.8305226"
Evaluating: 14.3614185--32.8305226
 Parameter: XTRAN <- "47.1919411"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-22.0711522"
 RDCMND substituted energy or value "?YAVE" to "29.3473016"
Evaluating: -22.0711522-29.3473016
 Parameter: YTRAN <- "-51.4184538"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-16.4929868"
 RDCMND substituted energy or value "?ZAVE" to "-36.1442058"
Evaluating: -16.4929868--36.1442058
 Parameter: ZTRAN <- "19.651219"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "47.1919411"
 Parameter: YTRAN -> "-51.4184538"
 Parameter: ZTRAN -> "19.651219"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    47.191941  -51.418454   19.651219
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.836219849"
Evaluating: 0.836219849*360.0
 Parameter: XPHI <- "301.039146"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.555535101"
Evaluating: 0.555535101*360.0
 Parameter: YPHI <- "199.992636"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.938768976"
Evaluating: 0.938768976*360.0
 Parameter: ZPHI <- "337.956831"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "14.3614185"
 Parameter: YPOS -> "-22.0711522"
 Parameter: ZPOS -> "-16.4929868"
 Parameter: XPHI -> "301.039146"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.515624   -0.856815
    0.000000    0.856815    0.515624

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   58.96

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "14.3614185"
 Parameter: YPOS -> "-22.0711522"
 Parameter: ZPOS -> "-16.4929868"
 Parameter: YPHI -> "199.992636"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.939737    0.000000    0.341899
    0.000000    1.000000    0.000000
   -0.341899    0.000000   -0.939737

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  160.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "14.3614185"
 Parameter: YPOS -> "-22.0711522"
 Parameter: ZPOS -> "-16.4929868"
 Parameter: ZPHI -> "337.956831"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.926901   -0.375305    0.000000
    0.375305    0.926901    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   22.04

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.361418 XMAX =   14.361418 XAVE =   14.361418
    YMIN =  -22.071152 YMAX =  -22.071152 YAVE =  -22.071152
    ZMIN =  -16.492987 ZMAX =  -16.492987 ZAVE =  -16.492987
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "14.3614185"
Evaluating: 14.3614185+3.5
 Parameter: XMAX <- "17.8614185"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-22.0711522"
Evaluating: -22.0711522+3.5
 Parameter: YMAX <- "-18.5711522"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-16.4929868"
Evaluating: -16.4929868+3.5
 Parameter: ZMAX <- "-12.9929868"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "14.3614185"
Evaluating: 14.3614185-3.5
 Parameter: XMIN <- "10.8614185"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-22.0711522"
Evaluating: -22.0711522-3.5
 Parameter: YMIN <- "-25.5711522"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-16.4929868"
Evaluating: -16.4929868-3.5
 Parameter: ZMIN <- "-19.9929868"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "17.8614185"
 Parameter: XMIN -> "10.8614185"
 Parameter: YMAX -> "-18.5711522"
 Parameter: YMIN -> "-25.5711522"
 Parameter: ZMAX -> "-12.9929868"
 Parameter: ZMIN -> "-19.9929868"
 SELRPN>      3 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      2 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9219 NEG      CLA      37       CLA     -4123 PAA1     HSD      315      CE1           3.9564
 9219 NEG      CLA      37       CLA     -4125 PAA1     HSD      315      NE2           3.4864
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "117"
Evaluating: 117
 Parameter: J <- "117"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "117" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "117"
 Parameter: NPOS -> "80"
Evaluating: 117-80
 Parameter: J <- "37"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "37"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.860913106"
Evaluating: (89.1533903-9.0)*(0.860913106-0.5)
 Parameter: XPOS <- "28.928409"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.483809606"
Evaluating: (89.1533903-9.0)*(0.483809606-0.5)
 Parameter: YPOS <- "-1.29771497"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.650889623"
Evaluating: (89.1533903-9.0)*(0.650889623-0.5)
 Parameter: ZPOS <- "12.0943148"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   14.361418 XMAX =   14.361418 XAVE =   14.361418
    YMIN =  -22.071152 YMAX =  -22.071152 YAVE =  -22.071152
    ZMIN =  -16.492987 ZMAX =  -16.492987 ZAVE =  -16.492987
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "28.928409"
 RDCMND substituted energy or value "?XAVE" to "14.3614185"
Evaluating: 28.928409-14.3614185
 Parameter: XTRAN <- "14.5669905"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.29771497"
 RDCMND substituted energy or value "?YAVE" to "-22.0711522"
Evaluating: -1.29771497--22.0711522
 Parameter: YTRAN <- "20.7734372"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "12.0943148"
 RDCMND substituted energy or value "?ZAVE" to "-16.4929868"
Evaluating: 12.0943148--16.4929868
 Parameter: ZTRAN <- "28.5873016"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "14.5669905"
 Parameter: YTRAN -> "20.7734372"
 Parameter: ZTRAN -> "28.5873016"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    14.566990   20.773437   28.587302
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.178578833E-02"
Evaluating: 7.178578833E-02*360.0
 Parameter: XPHI <- "25.8428838"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.79261769"
Evaluating: 0.79261769*360.0
 Parameter: YPHI <- "285.342368"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.29461968"
Evaluating: 0.29461968*360.0
 Parameter: ZPHI <- "106.063085"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "28.928409"
 Parameter: YPOS -> "-1.29771497"
 Parameter: ZPOS -> "12.0943148"
 Parameter: XPHI -> "25.8428838"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.899993    0.435905
    0.000000   -0.435905    0.899993

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   25.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "28.928409"
 Parameter: YPOS -> "-1.29771497"
 Parameter: ZPOS -> "12.0943148"
 Parameter: YPHI -> "285.342368"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.264586    0.000000    0.964362
    0.000000    1.000000    0.000000
   -0.964362    0.000000    0.264586

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   74.66

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "28.928409"
 Parameter: YPOS -> "-1.29771497"
 Parameter: ZPOS -> "12.0943148"
 Parameter: ZPHI -> "106.063085"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.276696    0.960958    0.000000
   -0.960958   -0.276696    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  106.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   28.928409 XMAX =   28.928409 XAVE =   28.928409
    YMIN =   -1.297715 YMAX =   -1.297715 YAVE =   -1.297715
    ZMIN =   12.094315 ZMAX =   12.094315 ZAVE =   12.094315
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "28.928409"
Evaluating: 28.928409+3.5
 Parameter: XMAX <- "32.428409"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.29771497"
Evaluating: -1.29771497+3.5
 Parameter: YMAX <- "2.20228503"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "12.0943148"
Evaluating: 12.0943148+3.5
 Parameter: ZMAX <- "15.5943148"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "28.928409"
Evaluating: 28.928409-3.5
 Parameter: XMIN <- "25.428409"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.29771497"
Evaluating: -1.29771497-3.5
 Parameter: YMIN <- "-4.79771497"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "12.0943148"
Evaluating: 12.0943148-3.5
 Parameter: ZMIN <- "8.5943148"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "32.428409"
 Parameter: XMIN -> "25.428409"
 Parameter: YMAX -> "2.20228503"
 Parameter: YMIN -> "-4.79771497"
 Parameter: ZMAX -> "15.5943148"
 Parameter: ZMIN -> "8.5943148"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "118"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "118" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "118"
Evaluating: 118
 Parameter: J <- "118"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "118" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "118"
 Parameter: NPOS -> "80"
Evaluating: 118-80
 Parameter: J <- "38"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "38"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "1.714036096E-03"
Evaluating: (89.1533903-9.0)*(1.714036096E-03-0.5)
 Parameter: XPOS <- "-39.9393093"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.455228645"
Evaluating: (89.1533903-9.0)*(0.455228645-0.5)
 Parameter: YPOS <- "-3.58857589"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.116295469"
Evaluating: (89.1533903-9.0)*(0.116295469-0.5)
 Parameter: ZPOS <- "-30.755219"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.9393093"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -39.9393093-44.5766951
 Parameter: XTRAN <- "-84.5160044"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-3.58857589"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -3.58857589-44.5766951
 Parameter: YTRAN <- "-48.165271"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-30.755219"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -30.755219-44.5766951
 Parameter: ZTRAN <- "-75.3319141"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-84.5160044"
 Parameter: YTRAN -> "-48.165271"
 Parameter: ZTRAN -> "-75.3319141"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -84.516004  -48.165271  -75.331914
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.882438359"
Evaluating: 0.882438359*360.0
 Parameter: XPHI <- "317.677809"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.159514172"
Evaluating: 0.159514172*360.0
 Parameter: YPHI <- "57.4251019"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.123870603E-02"
Evaluating: 5.123870603E-02*360.0
 Parameter: ZPHI <- "18.4459342"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.9393093"
 Parameter: YPOS -> "-3.58857589"
 Parameter: ZPOS -> "-30.755219"
 Parameter: XPHI -> "317.677809"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.739370   -0.673299
    0.000000    0.673299    0.739370

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   42.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.9393093"
 Parameter: YPOS -> "-3.58857589"
 Parameter: ZPOS -> "-30.755219"
 Parameter: YPHI -> "57.4251019"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.538402    0.000000   -0.842688
    0.000000    1.000000    0.000000
    0.842688    0.000000    0.538402

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   57.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.9393093"
 Parameter: YPOS -> "-3.58857589"
 Parameter: ZPOS -> "-30.755219"
 Parameter: ZPHI -> "18.4459342"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.948623    0.316410    0.000000
   -0.316410    0.948623    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   18.45

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.939309 XMAX =  -39.939309 XAVE =  -39.939309
    YMIN =   -3.588576 YMAX =   -3.588576 YAVE =   -3.588576
    ZMIN =  -30.755219 ZMAX =  -30.755219 ZAVE =  -30.755219
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.9393093"
Evaluating: -39.9393093+3.5
 Parameter: XMAX <- "-36.4393093"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-3.5885759"
Evaluating: -3.5885759+3.5
 Parameter: YMAX <- "-8.85759E-02"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-30.755219"
Evaluating: -30.755219+3.5
 Parameter: ZMAX <- "-27.255219"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.9393093"
Evaluating: -39.9393093-3.5
 Parameter: XMIN <- "-43.4393093"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-3.5885759"
Evaluating: -3.5885759-3.5
 Parameter: YMIN <- "-7.0885759"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-30.755219"
Evaluating: -30.755219-3.5
 Parameter: ZMIN <- "-34.255219"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-36.4393093"
 Parameter: XMIN -> "-43.4393093"
 Parameter: YMAX -> "-8.85759E-02"
 Parameter: YMIN -> "-7.0885759"
 Parameter: ZMAX -> "-27.255219"
 Parameter: ZMIN -> "-34.255219"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "119"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "119" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "119"
Evaluating: 119
 Parameter: J <- "119"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "119" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "119"
 Parameter: NPOS -> "80"
Evaluating: 119-80
 Parameter: J <- "39"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "1.321898594E-02"
Evaluating: (89.1533903-9.0)*(1.321898594E-02-0.5)
 Parameter: XPOS <- "-39.0171486"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.956400485"
Evaluating: (89.1533903-9.0)*(0.956400485-0.5)
 Parameter: YPOS <- "36.5820462"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.814283392"
Evaluating: (89.1533903-9.0)*(0.814283392-0.5)
 Parameter: ZPOS <- "25.1908794"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-39.0171486"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -39.0171486-44.5766951
 Parameter: XTRAN <- "-83.5938437"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "36.5820462"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 36.5820462-44.5766951
 Parameter: YTRAN <- "-7.9946489"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.1908794"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 25.1908794-44.5766951
 Parameter: ZTRAN <- "-19.3858157"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-83.5938437"
 Parameter: YTRAN -> "-7.9946489"
 Parameter: ZTRAN -> "-19.3858157"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -83.593844   -7.994649  -19.385816
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.500128189"
Evaluating: 0.500128189*360.0
 Parameter: XPHI <- "180.046148"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "3.851957691E-02"
Evaluating: 3.851957691E-02*360.0
 Parameter: YPHI <- "13.8670477"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.52996256E-02"
Evaluating: 5.52996256E-02*360.0
 Parameter: ZPHI <- "19.9078652"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-39.0171486"
 Parameter: YPOS -> "36.5820462"
 Parameter: ZPOS -> "25.1908794"
 Parameter: XPHI -> "180.046148"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -1.000000   -0.000805
    0.000000    0.000805   -1.000000

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  179.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-39.0171486"
 Parameter: YPOS -> "36.5820462"
 Parameter: ZPOS -> "25.1908794"
 Parameter: YPHI -> "13.8670477"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.970854    0.000000   -0.239670
    0.000000    1.000000    0.000000
    0.239670    0.000000    0.970854

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   13.87

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-39.0171486"
 Parameter: YPOS -> "36.5820462"
 Parameter: ZPOS -> "25.1908794"
 Parameter: ZPHI -> "19.9078652"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.940241    0.340509    0.000000
   -0.340509    0.940241    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   19.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.017149 XMAX =  -39.017149 XAVE =  -39.017149
    YMIN =   36.582046 YMAX =   36.582046 YAVE =   36.582046
    ZMIN =   25.190879 ZMAX =   25.190879 ZAVE =   25.190879
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-39.0171486"
Evaluating: -39.0171486+3.5
 Parameter: XMAX <- "-35.5171486"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "36.5820462"
Evaluating: 36.5820462+3.5
 Parameter: YMAX <- "40.0820462"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.1908794"
Evaluating: 25.1908794+3.5
 Parameter: ZMAX <- "28.6908794"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-39.0171486"
Evaluating: -39.0171486-3.5
 Parameter: XMIN <- "-42.5171486"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "36.5820462"
Evaluating: 36.5820462-3.5
 Parameter: YMIN <- "33.0820462"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.1908794"
Evaluating: 25.1908794-3.5
 Parameter: ZMIN <- "21.6908794"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-35.5171486"
 Parameter: XMIN -> "-42.5171486"
 Parameter: YMAX -> "40.0820462"
 Parameter: YMIN -> "33.0820462"
 Parameter: ZMAX -> "28.6908794"
 Parameter: ZMIN -> "21.6908794"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      1 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9221 NEG      CLA      39       CLA     -9112 POS      SOD      10       SOD           1.8256
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "119"
Evaluating: 119
 Parameter: J <- "119"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "119" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "119"
 Parameter: NPOS -> "80"
Evaluating: 119-80
 Parameter: J <- "39"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "39"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.70475158"
Evaluating: (89.1533903-9.0)*(0.70475158-0.5)
 Parameter: XPOS <- "16.4115333"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.538011739"
Evaluating: (89.1533903-9.0)*(0.538011739-0.5)
 Parameter: YPOS <- "3.04676975"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.109444679"
Evaluating: (89.1533903-9.0)*(0.109444679-0.5)
 Parameter: ZPOS <- "-31.3043331"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -39.017149 XMAX =  -39.017149 XAVE =  -39.017149
    YMIN =   36.582046 YMAX =   36.582046 YAVE =   36.582046
    ZMIN =   25.190879 ZMAX =   25.190879 ZAVE =   25.190879
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "16.4115333"
 RDCMND substituted energy or value "?XAVE" to "-39.0171486"
Evaluating: 16.4115333--39.0171486
 Parameter: XTRAN <- "55.4286819"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "3.04676975"
 RDCMND substituted energy or value "?YAVE" to "36.5820462"
Evaluating: 3.04676975-36.5820462
 Parameter: YTRAN <- "-33.5352764"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-31.3043331"
 RDCMND substituted energy or value "?ZAVE" to "25.1908794"
Evaluating: -31.3043331-25.1908794
 Parameter: ZTRAN <- "-56.4952125"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "55.4286819"
 Parameter: YTRAN -> "-33.5352764"
 Parameter: ZTRAN -> "-56.4952125"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    55.428682  -33.535276  -56.495213
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.254503325"
Evaluating: 0.254503325*360.0
 Parameter: XPHI <- "91.621197"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.624138132"
Evaluating: 0.624138132*360.0
 Parameter: YPHI <- "224.689728"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.0879143E-02"
Evaluating: 5.0879143E-02*360.0
 Parameter: ZPHI <- "18.3164915"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "16.4115333"
 Parameter: YPOS -> "3.04676975"
 Parameter: ZPOS -> "-31.3043331"
 Parameter: XPHI -> "91.621197"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.028291    0.999600
    0.000000   -0.999600   -0.028291

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   91.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "16.4115333"
 Parameter: YPOS -> "3.04676975"
 Parameter: ZPOS -> "-31.3043331"
 Parameter: YPHI -> "224.689728"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.710926    0.000000    0.703267
    0.000000    1.000000    0.000000
   -0.703267    0.000000   -0.710926

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  135.31

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "16.4115333"
 Parameter: YPOS -> "3.04676975"
 Parameter: ZPOS -> "-31.3043331"
 Parameter: ZPHI -> "18.3164915"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.949335    0.314266    0.000000
   -0.314266    0.949335    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   18.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   16.411533 XMAX =   16.411533 XAVE =   16.411533
    YMIN =    3.046770 YMAX =    3.046770 YAVE =    3.046770
    ZMIN =  -31.304333 ZMAX =  -31.304333 ZAVE =  -31.304333
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "16.4115333"
Evaluating: 16.4115333+3.5
 Parameter: XMAX <- "19.9115333"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "3.04676976"
Evaluating: 3.04676976+3.5
 Parameter: YMAX <- "6.54676976"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-31.3043331"
Evaluating: -31.3043331+3.5
 Parameter: ZMAX <- "-27.8043331"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "16.4115333"
Evaluating: 16.4115333-3.5
 Parameter: XMIN <- "12.9115333"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "3.04676976"
Evaluating: 3.04676976-3.5
 Parameter: YMIN <- "-0.45323024"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-31.3043331"
Evaluating: -31.3043331-3.5
 Parameter: ZMIN <- "-34.8043331"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "19.9115333"
 Parameter: XMIN -> "12.9115333"
 Parameter: YMAX -> "6.54676976"
 Parameter: YMIN -> "-0.45323024"
 Parameter: ZMAX -> "-27.8043331"
 Parameter: ZMIN -> "-34.8043331"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "120"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "120" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "120"
Evaluating: 120
 Parameter: J <- "120"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "120" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "120"
 Parameter: NPOS -> "80"
Evaluating: 120-80
 Parameter: J <- "40"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "40"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.61061743"
Evaluating: (89.1533903-9.0)*(0.61061743-0.5)
 Parameter: XPOS <- "8.86636204"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.670618458"
Evaluating: (89.1533903-9.0)*(0.670618458-0.5)
 Parameter: YPOS <- "13.6756479"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "2.858348102E-02"
Evaluating: (89.1533903-9.0)*(2.858348102E-02-0.5)
 Parameter: ZPOS <- "-37.7856322"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.86636204"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 8.86636204-44.5766951
 Parameter: XTRAN <- "-35.7103331"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.6756479"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 13.6756479-44.5766951
 Parameter: YTRAN <- "-30.9010472"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-37.7856322"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -37.7856322-44.5766951
 Parameter: ZTRAN <- "-82.3623273"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-35.7103331"
 Parameter: YTRAN -> "-30.9010472"
 Parameter: ZTRAN -> "-82.3623273"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -35.710333  -30.901047  -82.362327
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.46830577"
Evaluating: 0.46830577*360.0
 Parameter: XPHI <- "168.590077"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.225216736"
Evaluating: 0.225216736*360.0
 Parameter: YPHI <- "81.078025"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.192081942"
Evaluating: 0.192081942*360.0
 Parameter: ZPHI <- "69.1494991"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.86636204"
 Parameter: YPOS -> "13.6756479"
 Parameter: ZPOS -> "-37.7856322"
 Parameter: XPHI -> "168.590077"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.980237    0.197827
    0.000000   -0.197827   -0.980237

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  168.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.86636204"
 Parameter: YPOS -> "13.6756479"
 Parameter: ZPOS -> "-37.7856322"
 Parameter: YPHI -> "81.078025"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.155089    0.000000   -0.987900
    0.000000    1.000000    0.000000
    0.987900    0.000000    0.155089

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   81.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.86636204"
 Parameter: YPOS -> "13.6756479"
 Parameter: ZPOS -> "-37.7856322"
 Parameter: ZPHI -> "69.1494991"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.355931    0.934512    0.000000
   -0.934512    0.355931    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   69.15

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.866362 XMAX =    8.866362 XAVE =    8.866362
    YMIN =   13.675648 YMAX =   13.675648 YAVE =   13.675648
    ZMIN =  -37.785632 ZMAX =  -37.785632 ZAVE =  -37.785632
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.86636204"
Evaluating: 8.86636204+3.5
 Parameter: XMAX <- "12.366362"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.6756479"
Evaluating: 13.6756479+3.5
 Parameter: YMAX <- "17.1756479"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-37.7856322"
Evaluating: -37.7856322+3.5
 Parameter: ZMAX <- "-34.2856322"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.86636204"
Evaluating: 8.86636204-3.5
 Parameter: XMIN <- "5.36636204"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.6756479"
Evaluating: 13.6756479-3.5
 Parameter: YMIN <- "10.1756479"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-37.7856322"
Evaluating: -37.7856322-3.5
 Parameter: ZMIN <- "-41.2856322"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "12.366362"
 Parameter: XMIN -> "5.36636204"
 Parameter: YMAX -> "17.1756479"
 Parameter: YMIN -> "10.1756479"
 Parameter: ZMAX -> "-34.2856322"
 Parameter: ZMIN -> "-41.2856322"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      1 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "121"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "121" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "121"
Evaluating: 121
 Parameter: J <- "121"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "121" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "121"
 Parameter: NPOS -> "80"
Evaluating: 121-80
 Parameter: J <- "41"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.391894454"
Evaluating: (89.1533903-9.0)*(0.391894454-0.5)
 Parameter: XPOS <- "-8.66502602"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.611010622"
Evaluating: (89.1533903-9.0)*(0.611010622-0.5)
 Parameter: YPOS <- "8.89787771"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.274523144"
Evaluating: (89.1533903-9.0)*(0.274523144-0.5)
 Parameter: ZPOS <- "-18.0727344"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-8.66502602"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -8.66502602-44.5766951
 Parameter: XTRAN <- "-53.2417211"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "8.89787771"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 8.89787771-44.5766951
 Parameter: YTRAN <- "-35.6788174"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-18.0727344"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -18.0727344-44.5766951
 Parameter: ZTRAN <- "-62.6494295"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-53.2417211"
 Parameter: YTRAN -> "-35.6788174"
 Parameter: ZTRAN -> "-62.6494295"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -53.241721  -35.678817  -62.649429
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.721264683"
Evaluating: 0.721264683*360.0
 Parameter: XPHI <- "259.655286"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.742829859"
Evaluating: 0.742829859*360.0
 Parameter: YPHI <- "267.418749"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.811961507E-02"
Evaluating: 5.811961507E-02*360.0
 Parameter: ZPHI <- "20.9230614"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-8.66502602"
 Parameter: YPOS -> "8.89787771"
 Parameter: ZPOS -> "-18.0727344"
 Parameter: XPHI -> "259.655286"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.179570   -0.983745
    0.000000    0.983745   -0.179570

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  100.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-8.66502602"
 Parameter: YPOS -> "8.89787771"
 Parameter: ZPOS -> "-18.0727344"
 Parameter: YPHI -> "267.418749"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.045036    0.000000    0.998985
    0.000000    1.000000    0.000000
   -0.998985    0.000000   -0.045036

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   92.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-8.66502602"
 Parameter: YPOS -> "8.89787771"
 Parameter: ZPOS -> "-18.0727344"
 Parameter: ZPHI -> "20.9230614"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.934061    0.357114    0.000000
   -0.357114    0.934061    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   20.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.665026 XMAX =   -8.665026 XAVE =   -8.665026
    YMIN =    8.897878 YMAX =    8.897878 YAVE =    8.897878
    ZMIN =  -18.072734 ZMAX =  -18.072734 ZAVE =  -18.072734
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-8.66502603"
Evaluating: -8.66502603+3.5
 Parameter: XMAX <- "-5.16502603"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "8.89787772"
Evaluating: 8.89787772+3.5
 Parameter: YMAX <- "12.3978777"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-18.0727344"
Evaluating: -18.0727344+3.5
 Parameter: ZMAX <- "-14.5727344"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-8.66502603"
Evaluating: -8.66502603-3.5
 Parameter: XMIN <- "-12.165026"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "8.89787772"
Evaluating: 8.89787772-3.5
 Parameter: YMIN <- "5.39787772"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-18.0727344"
Evaluating: -18.0727344-3.5
 Parameter: ZMIN <- "-21.5727344"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-5.16502603"
 Parameter: XMIN -> "-12.165026"
 Parameter: YMAX -> "12.3978777"
 Parameter: YMIN -> "5.39787772"
 Parameter: ZMAX -> "-14.5727344"
 Parameter: ZMIN -> "-21.5727344"
 SELRPN>     10 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      5 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9223 NEG      CLA      41       CLA     -2376 PAA1     ALA      174      CA            4.4626
 9223 NEG      CLA      41       CLA     -2378 PAA1     ALA      174      CB            3.8226
 9223 NEG      CLA      41       CLA     -2567 PAA1     GLY      190      N             4.1648
 9223 NEG      CLA      41       CLA     -2569 PAA1     GLY      190      CA            3.2008
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         4
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "121"
Evaluating: 121
 Parameter: J <- "121"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "121" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "121"
 Parameter: NPOS -> "80"
Evaluating: 121-80
 Parameter: J <- "41"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.231861983"
Evaluating: (89.1533903-9.0)*(0.231861983-0.5)
 Parameter: XPOS <- "-21.4921711"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.984374908"
Evaluating: (89.1533903-9.0)*(0.984374908-0.5)
 Parameter: YPOS <- "38.8242911"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.934993808"
Evaluating: (89.1533903-9.0)*(0.934993808-0.5)
 Parameter: ZPOS <- "34.8662285"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -8.665026 XMAX =   -8.665026 XAVE =   -8.665026
    YMIN =    8.897878 YMAX =    8.897878 YAVE =    8.897878
    ZMIN =  -18.072734 ZMAX =  -18.072734 ZAVE =  -18.072734
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-21.4921711"
 RDCMND substituted energy or value "?XAVE" to "-8.66502603"
Evaluating: -21.4921711--8.66502603
 Parameter: XTRAN <- "-12.8271451"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "38.8242911"
 RDCMND substituted energy or value "?YAVE" to "8.89787772"
Evaluating: 38.8242911-8.89787772
 Parameter: YTRAN <- "29.9264134"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "34.8662285"
 RDCMND substituted energy or value "?ZAVE" to "-18.0727344"
Evaluating: 34.8662285--18.0727344
 Parameter: ZTRAN <- "52.9389629"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-12.8271451"
 Parameter: YTRAN -> "29.9264134"
 Parameter: ZTRAN -> "52.9389629"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -12.827145   29.926413   52.938963
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.841490022"
Evaluating: 0.841490022*360.0
 Parameter: XPHI <- "302.936408"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.32038291"
Evaluating: 0.32038291*360.0
 Parameter: YPHI <- "115.337848"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.262222838"
Evaluating: 0.262222838*360.0
 Parameter: ZPHI <- "94.4002217"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-21.4921711"
 Parameter: YPOS -> "38.8242911"
 Parameter: ZPOS -> "34.8662285"
 Parameter: XPHI -> "302.936408"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.543708   -0.839275
    0.000000    0.839275    0.543708

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   57.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-21.4921711"
 Parameter: YPOS -> "38.8242911"
 Parameter: ZPOS -> "34.8662285"
 Parameter: YPHI -> "115.337848"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.427955    0.000000   -0.903800
    0.000000    1.000000    0.000000
    0.903800    0.000000   -0.427955

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  115.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-21.4921711"
 Parameter: YPOS -> "38.8242911"
 Parameter: ZPOS -> "34.8662285"
 Parameter: ZPHI -> "94.4002217"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.076723    0.997052    0.000000
   -0.997052   -0.076723    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   94.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.492171 XMAX =  -21.492171 XAVE =  -21.492171
    YMIN =   38.824291 YMAX =   38.824291 YAVE =   38.824291
    ZMIN =   34.866228 ZMAX =   34.866228 ZAVE =   34.866228
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-21.4921711"
Evaluating: -21.4921711+3.5
 Parameter: XMAX <- "-17.9921711"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "38.8242911"
Evaluating: 38.8242911+3.5
 Parameter: YMAX <- "42.3242911"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "34.8662285"
Evaluating: 34.8662285+3.5
 Parameter: ZMAX <- "38.3662285"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-21.4921711"
Evaluating: -21.4921711-3.5
 Parameter: XMIN <- "-24.9921711"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "38.8242911"
Evaluating: 38.8242911-3.5
 Parameter: YMIN <- "35.3242911"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "34.8662285"
Evaluating: 34.8662285-3.5
 Parameter: ZMIN <- "31.3662285"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-17.9921711"
 Parameter: XMIN -> "-24.9921711"
 Parameter: YMAX -> "42.3242911"
 Parameter: YMIN -> "35.3242911"
 Parameter: ZMAX -> "38.3662285"
 Parameter: ZMIN -> "31.3662285"
 SELRPN>     10 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      7 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9223 NEG      CLA      41       CLA     -6546 PAA2     ASP      139      CA            3.6009
 9223 NEG      CLA      41       CLA     -6551 PAA2     ASP      139      CG            3.2976
 9223 NEG      CLA      41       CLA     -6552 PAA2     ASP      139      OD1           3.8120
 9223 NEG      CLA      41       CLA     -6553 PAA2     ASP      139      OD2           2.8592
 9223 NEG      CLA      41       CLA     -6554 PAA2     ASP      139      C             4.3185
 9223 NEG      CLA      41       CLA     -6555 PAA2     ASP      139      O             4.0319
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "121"
Evaluating: 121
 Parameter: J <- "121"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "121" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "121"
 Parameter: NPOS -> "80"
Evaluating: 121-80
 Parameter: J <- "41"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "41"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.124710177"
Evaluating: (89.1533903-9.0)*(0.124710177-0.5)
 Parameter: XPOS <- "-30.0807517"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "7.091146333E-02"
Evaluating: (89.1533903-9.0)*(7.091146333E-02-0.5)
 Parameter: YPOS <- "-34.392901"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.681780854"
Evaluating: (89.1533903-9.0)*(0.681780854-0.5)
 Parameter: ZPOS <- "14.5703517"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -21.492171 XMAX =  -21.492171 XAVE =  -21.492171
    YMIN =   38.824291 YMAX =   38.824291 YAVE =   38.824291
    ZMIN =   34.866228 ZMAX =   34.866228 ZAVE =   34.866228
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-30.0807517"
 RDCMND substituted energy or value "?XAVE" to "-21.4921711"
Evaluating: -30.0807517--21.4921711
 Parameter: XTRAN <- "-8.5885806"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.392901"
 RDCMND substituted energy or value "?YAVE" to "38.8242911"
Evaluating: -34.392901-38.8242911
 Parameter: YTRAN <- "-73.2171921"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "14.5703517"
 RDCMND substituted energy or value "?ZAVE" to "34.8662285"
Evaluating: 14.5703517-34.8662285
 Parameter: ZTRAN <- "-20.2958768"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.5885806"
 Parameter: YTRAN -> "-73.2171921"
 Parameter: ZTRAN -> "-20.2958768"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    -8.588581  -73.217192  -20.295877
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.682857944"
Evaluating: 0.682857944*360.0
 Parameter: XPHI <- "245.82886"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.991726789"
Evaluating: 0.991726789*360.0
 Parameter: YPHI <- "357.021644"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.451484851"
Evaluating: 0.451484851*360.0
 Parameter: ZPHI <- "162.534546"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-30.0807517"
 Parameter: YPOS -> "-34.392901"
 Parameter: ZPOS -> "14.5703517"
 Parameter: XPHI -> "245.82886"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.409464   -0.912326
    0.000000    0.912326   -0.409464

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  114.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-30.0807517"
 Parameter: YPOS -> "-34.392901"
 Parameter: ZPOS -> "14.5703517"
 Parameter: YPHI -> "357.021644"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.998649    0.000000    0.051959
    0.000000    1.000000    0.000000
   -0.051959    0.000000    0.998649

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    2.98

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-30.0807517"
 Parameter: YPOS -> "-34.392901"
 Parameter: ZPOS -> "14.5703517"
 Parameter: ZPHI -> "162.534546"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.953898    0.300131    0.000000
   -0.300131   -0.953898    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  162.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -30.080752 XMAX =  -30.080752 XAVE =  -30.080752
    YMIN =  -34.392901 YMAX =  -34.392901 YAVE =  -34.392901
    ZMIN =   14.570352 ZMAX =   14.570352 ZAVE =   14.570352
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-30.0807517"
Evaluating: -30.0807517+3.5
 Parameter: XMAX <- "-26.5807517"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.392901"
Evaluating: -34.392901+3.5
 Parameter: YMAX <- "-30.892901"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "14.5703517"
Evaluating: 14.5703517+3.5
 Parameter: ZMAX <- "18.0703517"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-30.0807517"
Evaluating: -30.0807517-3.5
 Parameter: XMIN <- "-33.5807517"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.392901"
Evaluating: -34.392901-3.5
 Parameter: YMIN <- "-37.892901"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "14.5703517"
Evaluating: 14.5703517-3.5
 Parameter: ZMIN <- "11.0703517"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.5807517"
 Parameter: XMIN -> "-33.5807517"
 Parameter: YMAX -> "-30.892901"
 Parameter: YMIN -> "-37.892901"
 Parameter: ZMAX -> "18.0703517"
 Parameter: ZMIN -> "11.0703517"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "122"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "122" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "122"
Evaluating: 122
 Parameter: J <- "122"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "122" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "122"
 Parameter: NPOS -> "80"
Evaluating: 122-80
 Parameter: J <- "42"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "42"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.565237631"
Evaluating: (89.1533903-9.0)*(0.565237631-0.5)
 Parameter: XPOS <- "5.2290173"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.126806023"
Evaluating: (89.1533903-9.0)*(0.126806023-0.5)
 Parameter: YPOS <- "-29.9127625"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.148838887"
Evaluating: (89.1533903-9.0)*(0.148838887-0.5)
 Parameter: ZPOS <- "-28.1467537"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "5.2290173"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 5.2290173-44.5766951
 Parameter: XTRAN <- "-39.3476778"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-29.9127625"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -29.9127625-44.5766951
 Parameter: YTRAN <- "-74.4894576"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.1467537"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -28.1467537-44.5766951
 Parameter: ZTRAN <- "-72.7234488"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-39.3476778"
 Parameter: YTRAN -> "-74.4894576"
 Parameter: ZTRAN -> "-72.7234488"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -39.347678  -74.489458  -72.723449
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.881810431"
Evaluating: 0.881810431*360.0
 Parameter: XPHI <- "317.451755"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.236109711"
Evaluating: 0.236109711*360.0
 Parameter: YPHI <- "84.999496"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.473940274"
Evaluating: 0.473940274*360.0
 Parameter: ZPHI <- "170.618499"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "5.2290173"
 Parameter: YPOS -> "-29.9127625"
 Parameter: ZPOS -> "-28.1467537"
 Parameter: XPHI -> "317.451755"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.736708   -0.676211
    0.000000    0.676211    0.736708

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   42.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "5.2290173"
 Parameter: YPOS -> "-29.9127625"
 Parameter: ZPOS -> "-28.1467537"
 Parameter: YPHI -> "84.999496"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.087165    0.000000   -0.996194
    0.000000    1.000000    0.000000
    0.996194    0.000000    0.087165

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   85.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "5.2290173"
 Parameter: YPOS -> "-29.9127625"
 Parameter: ZPOS -> "-28.1467537"
 Parameter: ZPHI -> "170.618499"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.986625    0.163007    0.000000
   -0.163007   -0.986625    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  170.62

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    5.229017 XMAX =    5.229017 XAVE =    5.229017
    YMIN =  -29.912763 YMAX =  -29.912763 YAVE =  -29.912763
    ZMIN =  -28.146754 ZMAX =  -28.146754 ZAVE =  -28.146754
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "5.2290173"
Evaluating: 5.2290173+3.5
 Parameter: XMAX <- "8.7290173"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-29.9127625"
Evaluating: -29.9127625+3.5
 Parameter: YMAX <- "-26.4127625"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.1467537"
Evaluating: -28.1467537+3.5
 Parameter: ZMAX <- "-24.6467537"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "5.2290173"
Evaluating: 5.2290173-3.5
 Parameter: XMIN <- "1.7290173"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-29.9127625"
Evaluating: -29.9127625-3.5
 Parameter: YMIN <- "-33.4127625"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.1467537"
Evaluating: -28.1467537-3.5
 Parameter: ZMIN <- "-31.6467537"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "8.7290173"
 Parameter: XMIN -> "1.7290173"
 Parameter: YMAX -> "-26.4127625"
 Parameter: YMIN -> "-33.4127625"
 Parameter: ZMAX -> "-24.6467537"
 Parameter: ZMIN -> "-31.6467537"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "123"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "123" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "123"
Evaluating: 123
 Parameter: J <- "123"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "123" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "123"
 Parameter: NPOS -> "80"
Evaluating: 123-80
 Parameter: J <- "43"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "43"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.93817676"
Evaluating: (89.1533903-9.0)*(0.93817676-0.5)
 Parameter: XPOS <- "35.1213529"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.834981577"
Evaluating: (89.1533903-9.0)*(0.834981577-0.5)
 Parameter: YPOS <- "26.8499091"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.879784446"
Evaluating: (89.1533903-9.0)*(0.879784446-0.5)
 Parameter: ZPOS <- "30.4410109"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "35.1213529"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 35.1213529-44.5766951
 Parameter: XTRAN <- "-9.4553422"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "26.8499091"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 26.8499091-44.5766951
 Parameter: YTRAN <- "-17.726786"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.4410109"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 30.4410109-44.5766951
 Parameter: ZTRAN <- "-14.1356842"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-9.4553422"
 Parameter: YTRAN -> "-17.726786"
 Parameter: ZTRAN -> "-14.1356842"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    -9.455342  -17.726786  -14.135684
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.28560848"
Evaluating: 0.28560848*360.0
 Parameter: XPHI <- "102.819053"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.476641627"
Evaluating: 0.476641627*360.0
 Parameter: YPHI <- "171.590986"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.471980315"
Evaluating: 0.471980315*360.0
 Parameter: ZPHI <- "169.912913"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "35.1213529"
 Parameter: YPOS -> "26.8499091"
 Parameter: ZPOS -> "30.4410109"
 Parameter: XPHI -> "102.819053"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.221873    0.975076
    0.000000   -0.975076   -0.221873

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  102.82

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "35.1213529"
 Parameter: YPOS -> "26.8499091"
 Parameter: ZPOS -> "30.4410109"
 Parameter: YPHI -> "171.590986"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.989249    0.000000   -0.146239
    0.000000    1.000000    0.000000
    0.146239    0.000000   -0.989249

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  171.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "35.1213529"
 Parameter: YPOS -> "26.8499091"
 Parameter: ZPOS -> "30.4410109"
 Parameter: ZPHI -> "169.912913"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.984543    0.175145    0.000000
   -0.175145   -0.984543    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  169.91

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.121353 XMAX =   35.121353 XAVE =   35.121353
    YMIN =   26.849909 YMAX =   26.849909 YAVE =   26.849909
    ZMIN =   30.441011 ZMAX =   30.441011 ZAVE =   30.441011
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "35.1213529"
Evaluating: 35.1213529+3.5
 Parameter: XMAX <- "38.6213529"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "26.8499091"
Evaluating: 26.8499091+3.5
 Parameter: YMAX <- "30.3499091"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.4410109"
Evaluating: 30.4410109+3.5
 Parameter: ZMAX <- "33.9410109"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "35.1213529"
Evaluating: 35.1213529-3.5
 Parameter: XMIN <- "31.6213529"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "26.8499091"
Evaluating: 26.8499091-3.5
 Parameter: YMIN <- "23.3499091"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.4410109"
Evaluating: 30.4410109-3.5
 Parameter: ZMIN <- "26.9410109"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "38.6213529"
 Parameter: XMIN -> "31.6213529"
 Parameter: YMAX -> "30.3499091"
 Parameter: YMIN -> "23.3499091"
 Parameter: ZMAX -> "33.9410109"
 Parameter: ZMIN -> "26.9410109"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "124"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "124" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "124"
Evaluating: 124
 Parameter: J <- "124"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "124" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "124"
 Parameter: NPOS -> "80"
Evaluating: 124-80
 Parameter: J <- "44"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "44"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.89310941"
Evaluating: (89.1533903-9.0)*(0.89310941-0.5)
 Parameter: XPOS <- "31.509052"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.648975301"
Evaluating: (89.1533903-9.0)*(0.648975301-0.5)
 Parameter: YPOS <- "11.9408754"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "7.081319577E-02"
Evaluating: (89.1533903-9.0)*(7.081319577E-02-0.5)
 Parameter: ZPOS <- "-34.4007774"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "31.509052"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 31.509052-44.5766951
 Parameter: XTRAN <- "-13.0676431"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "11.9408754"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 11.9408754-44.5766951
 Parameter: YTRAN <- "-32.6358197"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-34.4007774"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -34.4007774-44.5766951
 Parameter: ZTRAN <- "-78.9774725"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.0676431"
 Parameter: YTRAN -> "-32.6358197"
 Parameter: ZTRAN -> "-78.9774725"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -13.067643  -32.635820  -78.977473
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.770240273"
Evaluating: 0.770240273*360.0
 Parameter: XPHI <- "277.286498"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.329976461"
Evaluating: 0.329976461*360.0
 Parameter: YPHI <- "118.791526"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.842407498"
Evaluating: 0.842407498*360.0
 Parameter: ZPHI <- "303.266699"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "31.509052"
 Parameter: YPOS -> "11.9408754"
 Parameter: ZPOS -> "-34.4007774"
 Parameter: XPHI -> "277.286498"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.126831   -0.991924
    0.000000    0.991924    0.126831

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   82.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "31.509052"
 Parameter: YPOS -> "11.9408754"
 Parameter: ZPOS -> "-34.4007774"
 Parameter: YPHI -> "118.791526"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.481624    0.000000   -0.876378
    0.000000    1.000000    0.000000
    0.876378    0.000000   -0.481624

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  118.79

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "31.509052"
 Parameter: YPOS -> "11.9408754"
 Parameter: ZPOS -> "-34.4007774"
 Parameter: ZPHI -> "303.266699"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.548537   -0.836126    0.000000
    0.836126    0.548537    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   56.73

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   31.509052 XMAX =   31.509052 XAVE =   31.509052
    YMIN =   11.940875 YMAX =   11.940875 YAVE =   11.940875
    ZMIN =  -34.400777 ZMAX =  -34.400777 ZAVE =  -34.400777
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "31.509052"
Evaluating: 31.509052+3.5
 Parameter: XMAX <- "35.009052"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "11.9408754"
Evaluating: 11.9408754+3.5
 Parameter: YMAX <- "15.4408754"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-34.4007774"
Evaluating: -34.4007774+3.5
 Parameter: ZMAX <- "-30.9007774"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "31.509052"
Evaluating: 31.509052-3.5
 Parameter: XMIN <- "28.009052"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "11.9408754"
Evaluating: 11.9408754-3.5
 Parameter: YMIN <- "8.4408754"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-34.4007774"
Evaluating: -34.4007774-3.5
 Parameter: ZMIN <- "-37.9007774"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "35.009052"
 Parameter: XMIN -> "28.009052"
 Parameter: YMAX -> "15.4408754"
 Parameter: YMIN -> "8.4408754"
 Parameter: ZMAX -> "-30.9007774"
 Parameter: ZMIN -> "-37.9007774"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "125"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "125" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "125"
Evaluating: 125
 Parameter: J <- "125"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "125" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "125"
 Parameter: NPOS -> "80"
Evaluating: 125-80
 Parameter: J <- "45"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "45"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.288106329"
Evaluating: (89.1533903-9.0)*(0.288106329-0.5)
 Parameter: XPOS <- "-16.9839961"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.18755013"
Evaluating: (89.1533903-9.0)*(0.18755013-0.5)
 Parameter: YPOS <- "-25.0439164"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.834652156"
Evaluating: (89.1533903-9.0)*(0.834652156-0.5)
 Parameter: ZPOS <- "26.8235049"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-16.9839961"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -16.9839961-44.5766951
 Parameter: XTRAN <- "-61.5606912"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.0439164"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -25.0439164-44.5766951
 Parameter: YTRAN <- "-69.6206115"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.8235049"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 26.8235049-44.5766951
 Parameter: ZTRAN <- "-17.7531902"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-61.5606912"
 Parameter: YTRAN -> "-69.6206115"
 Parameter: ZTRAN -> "-17.7531902"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -61.560691  -69.620611  -17.753190
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.306192397"
Evaluating: 0.306192397*360.0
 Parameter: XPHI <- "110.229263"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.826281657"
Evaluating: 0.826281657*360.0
 Parameter: YPHI <- "297.461397"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.850874024"
Evaluating: 0.850874024*360.0
 Parameter: ZPHI <- "306.314649"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-16.9839961"
 Parameter: YPOS -> "-25.0439164"
 Parameter: ZPOS -> "26.8235049"
 Parameter: XPHI -> "110.229263"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.345777    0.938317
    0.000000   -0.938317   -0.345777

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  110.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-16.9839961"
 Parameter: YPOS -> "-25.0439164"
 Parameter: ZPOS -> "26.8235049"
 Parameter: YPHI -> "297.461397"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.461151    0.000000    0.887322
    0.000000    1.000000    0.000000
   -0.887322    0.000000    0.461151

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   62.54

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-16.9839961"
 Parameter: YPOS -> "-25.0439164"
 Parameter: ZPOS -> "26.8235049"
 Parameter: ZPHI -> "306.314649"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.592219   -0.805777    0.000000
    0.805777    0.592219    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   53.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -16.983996 XMAX =  -16.983996 XAVE =  -16.983996
    YMIN =  -25.043916 YMAX =  -25.043916 YAVE =  -25.043916
    ZMIN =   26.823505 ZMAX =   26.823505 ZAVE =   26.823505
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-16.9839961"
Evaluating: -16.9839961+3.5
 Parameter: XMAX <- "-13.4839961"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.0439164"
Evaluating: -25.0439164+3.5
 Parameter: YMAX <- "-21.5439164"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.8235049"
Evaluating: 26.8235049+3.5
 Parameter: ZMAX <- "30.3235049"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-16.9839961"
Evaluating: -16.9839961-3.5
 Parameter: XMIN <- "-20.4839961"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.0439164"
Evaluating: -25.0439164-3.5
 Parameter: YMIN <- "-28.5439164"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.8235049"
Evaluating: 26.8235049-3.5
 Parameter: ZMIN <- "23.3235049"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-13.4839961"
 Parameter: XMIN -> "-20.4839961"
 Parameter: YMAX -> "-21.5439164"
 Parameter: YMIN -> "-28.5439164"
 Parameter: ZMAX -> "30.3235049"
 Parameter: ZMIN -> "23.3235049"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "126"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "126" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "126"
Evaluating: 126
 Parameter: J <- "126"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "126" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "126"
 Parameter: NPOS -> "80"
Evaluating: 126-80
 Parameter: J <- "46"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "46"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.777549983"
Evaluating: (89.1533903-9.0)*(0.777549983-0.5)
 Parameter: XPOS <- "22.2465721"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.987472921"
Evaluating: (89.1533903-9.0)*(0.987472921-0.5)
 Parameter: YPOS <- "39.0726073"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.417621328"
Evaluating: (89.1533903-9.0)*(0.417621328-0.5)
 Parameter: ZPOS <- "-6.60292985"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "22.2465721"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 22.2465721-44.5766951
 Parameter: XTRAN <- "-22.330123"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "39.0726073"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 39.0726073-44.5766951
 Parameter: YTRAN <- "-5.5040878"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-6.60292985"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -6.60292985-44.5766951
 Parameter: ZTRAN <- "-51.179625"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-22.330123"
 Parameter: YTRAN -> "-5.5040878"
 Parameter: ZTRAN -> "-51.179625"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -22.330123   -5.504088  -51.179625
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.300371832"
Evaluating: 0.300371832*360.0
 Parameter: XPHI <- "108.13386"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.124588971"
Evaluating: 0.124588971*360.0
 Parameter: YPHI <- "44.8520296"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.888528181"
Evaluating: 0.888528181*360.0
 Parameter: ZPHI <- "319.870145"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "22.2465721"
 Parameter: YPOS -> "39.0726073"
 Parameter: ZPOS -> "-6.60292985"
 Parameter: XPHI -> "108.13386"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.311238    0.950332
    0.000000   -0.950332   -0.311238

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  108.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "22.2465721"
 Parameter: YPOS -> "39.0726073"
 Parameter: ZPOS -> "-6.60292985"
 Parameter: YPHI -> "44.8520296"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.708931    0.000000   -0.705278
    0.000000    1.000000    0.000000
    0.705278    0.000000    0.708931

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   44.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "22.2465721"
 Parameter: YPOS -> "39.0726073"
 Parameter: ZPOS -> "-6.60292985"
 Parameter: ZPHI -> "319.870145"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.764586   -0.644522    0.000000
    0.644522    0.764586    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   40.13

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   22.246572 XMAX =   22.246572 XAVE =   22.246572
    YMIN =   39.072607 YMAX =   39.072607 YAVE =   39.072607
    ZMIN =   -6.602930 ZMAX =   -6.602930 ZAVE =   -6.602930
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "22.2465721"
Evaluating: 22.2465721+3.5
 Parameter: XMAX <- "25.7465721"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "39.0726073"
Evaluating: 39.0726073+3.5
 Parameter: YMAX <- "42.5726073"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-6.60292984"
Evaluating: -6.60292984+3.5
 Parameter: ZMAX <- "-3.10292984"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "22.2465721"
Evaluating: 22.2465721-3.5
 Parameter: XMIN <- "18.7465721"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "39.0726073"
Evaluating: 39.0726073-3.5
 Parameter: YMIN <- "35.5726073"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-6.60292984"
Evaluating: -6.60292984-3.5
 Parameter: ZMIN <- "-10.1029298"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "25.7465721"
 Parameter: XMIN -> "18.7465721"
 Parameter: YMAX -> "42.5726073"
 Parameter: YMIN -> "35.5726073"
 Parameter: ZMAX -> "-3.10292984"
 Parameter: ZMIN -> "-10.1029298"
 SELRPN>      3 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      0 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "127"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "127" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "127"
Evaluating: 127
 Parameter: J <- "127"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "127" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "127"
 Parameter: NPOS -> "80"
Evaluating: 127-80
 Parameter: J <- "47"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "47"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.713458691"
Evaluating: (89.1533903-9.0)*(0.713458691-0.5)
 Parameter: XPOS <- "17.1094378"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.477873972"
Evaluating: (89.1533903-9.0)*(0.477873972-0.5)
 Parameter: YPOS <- "-1.77347616"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.88655252"
Evaluating: (89.1533903-9.0)*(0.88655252-0.5)
 Parameter: ZPOS <- "30.983495"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "17.1094378"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 17.1094378-44.5766951
 Parameter: XTRAN <- "-27.4672573"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.77347616"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -1.77347616-44.5766951
 Parameter: YTRAN <- "-46.3501713"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.983495"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 30.983495-44.5766951
 Parameter: ZTRAN <- "-13.5932001"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-27.4672573"
 Parameter: YTRAN -> "-46.3501713"
 Parameter: ZTRAN -> "-13.5932001"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -27.467257  -46.350171  -13.593200
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.597256679"
Evaluating: 0.597256679*360.0
 Parameter: XPHI <- "215.012404"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.492463331"
Evaluating: 0.492463331*360.0
 Parameter: YPHI <- "177.286799"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.94621487"
Evaluating: 0.94621487*360.0
 Parameter: ZPHI <- "340.637353"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "17.1094378"
 Parameter: YPOS -> "-1.77347616"
 Parameter: ZPOS -> "30.983495"
 Parameter: XPHI -> "215.012404"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.819028   -0.573754
    0.000000    0.573754   -0.819028

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  144.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "17.1094378"
 Parameter: YPOS -> "-1.77347616"
 Parameter: ZPOS -> "30.983495"
 Parameter: YPHI -> "177.286799"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.998879    0.000000   -0.047337
    0.000000    1.000000    0.000000
    0.047337    0.000000   -0.998879

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  177.29

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "17.1094378"
 Parameter: YPOS -> "-1.77347616"
 Parameter: ZPOS -> "30.983495"
 Parameter: ZPHI -> "340.637353"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.943439   -0.331546    0.000000
    0.331546    0.943439    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   19.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   17.109438 XMAX =   17.109438 XAVE =   17.109438
    YMIN =   -1.773476 YMAX =   -1.773476 YAVE =   -1.773476
    ZMIN =   30.983495 ZMAX =   30.983495 ZAVE =   30.983495
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "17.1094378"
Evaluating: 17.1094378+3.5
 Parameter: XMAX <- "20.6094378"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.77347613"
Evaluating: -1.77347613+3.5
 Parameter: YMAX <- "1.72652387"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.983495"
Evaluating: 30.983495+3.5
 Parameter: ZMAX <- "34.483495"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "17.1094378"
Evaluating: 17.1094378-3.5
 Parameter: XMIN <- "13.6094378"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.77347613"
Evaluating: -1.77347613-3.5
 Parameter: YMIN <- "-5.27347613"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.983495"
Evaluating: 30.983495-3.5
 Parameter: ZMIN <- "27.483495"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "20.6094378"
 Parameter: XMIN -> "13.6094378"
 Parameter: YMAX -> "1.72652387"
 Parameter: YMIN -> "-5.27347613"
 Parameter: ZMAX -> "34.483495"
 Parameter: ZMIN -> "27.483495"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "128"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "128" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "128"
Evaluating: 128
 Parameter: J <- "128"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "128" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "128"
 Parameter: NPOS -> "80"
Evaluating: 128-80
 Parameter: J <- "48"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "48"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.429351652"
Evaluating: (89.1533903-9.0)*(0.429351652-0.5)
 Parameter: XPOS <- "-5.66270461"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "6.73451183E-02"
Evaluating: (89.1533903-9.0)*(6.73451183E-02-0.5)
 Parameter: YPOS <- "-34.6787556"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.313923024"
Evaluating: (89.1533903-9.0)*(0.313923024-0.5)
 Parameter: ZPOS <- "-14.9147005"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.66270461"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -5.66270461-44.5766951
 Parameter: XTRAN <- "-50.2393997"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-34.6787556"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -34.6787556-44.5766951
 Parameter: YTRAN <- "-79.2554507"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-14.9147005"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -14.9147005-44.5766951
 Parameter: ZTRAN <- "-59.4913956"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-50.2393997"
 Parameter: YTRAN -> "-79.2554507"
 Parameter: ZTRAN -> "-59.4913956"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -50.239400  -79.255451  -59.491396
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.594879798"
Evaluating: 0.594879798*360.0
 Parameter: XPHI <- "214.156727"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.90135776"
Evaluating: 0.90135776*360.0
 Parameter: YPHI <- "324.488794"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.905291796"
Evaluating: 0.905291796*360.0
 Parameter: ZPHI <- "325.905047"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.66270461"
 Parameter: YPOS -> "-34.6787556"
 Parameter: ZPOS -> "-14.9147005"
 Parameter: XPHI -> "214.156727"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.827505   -0.561459
    0.000000    0.561459   -0.827505

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  145.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.66270461"
 Parameter: YPOS -> "-34.6787556"
 Parameter: ZPOS -> "-14.9147005"
 Parameter: YPHI -> "324.488794"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.814002    0.000000    0.580862
    0.000000    1.000000    0.000000
   -0.580862    0.000000    0.814002

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   35.51

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.66270461"
 Parameter: YPOS -> "-34.6787556"
 Parameter: ZPOS -> "-14.9147005"
 Parameter: ZPHI -> "325.905047"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.828110   -0.560566    0.000000
    0.560566    0.828110    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   34.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.662705 XMAX =   -5.662705 XAVE =   -5.662705
    YMIN =  -34.678756 YMAX =  -34.678756 YAVE =  -34.678756
    ZMIN =  -14.914701 ZMAX =  -14.914701 ZAVE =  -14.914701
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.6627046"
Evaluating: -5.6627046+3.5
 Parameter: XMAX <- "-2.1627046"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-34.6787556"
Evaluating: -34.6787556+3.5
 Parameter: YMAX <- "-31.1787556"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-14.9147005"
Evaluating: -14.9147005+3.5
 Parameter: ZMAX <- "-11.4147005"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.6627046"
Evaluating: -5.6627046-3.5
 Parameter: XMIN <- "-9.1627046"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-34.6787556"
Evaluating: -34.6787556-3.5
 Parameter: YMIN <- "-38.1787556"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-14.9147005"
Evaluating: -14.9147005-3.5
 Parameter: ZMIN <- "-18.4147005"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-2.1627046"
 Parameter: XMIN -> "-9.1627046"
 Parameter: YMAX -> "-31.1787556"
 Parameter: YMIN -> "-38.1787556"
 Parameter: ZMAX -> "-11.4147005"
 Parameter: ZMIN -> "-18.4147005"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "129"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "129" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "129"
Evaluating: 129
 Parameter: J <- "129"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "129" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "129"
 Parameter: NPOS -> "80"
Evaluating: 129-80
 Parameter: J <- "49"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.504026516"
Evaluating: (89.1533903-9.0)*(0.504026516-0.5)
 Parameter: XPOS <- "0.322738908"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.837325385"
Evaluating: (89.1533903-9.0)*(0.837325385-0.5)
 Parameter: YPOS <- "27.0377732"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.867402452"
Evaluating: (89.1533903-9.0)*(0.867402452-0.5)
 Parameter: ZPOS <- "29.4485521"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.322738908"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 0.322738908-44.5766951
 Parameter: XTRAN <- "-44.2539562"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "27.0377732"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 27.0377732-44.5766951
 Parameter: YTRAN <- "-17.5389219"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "29.4485521"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 29.4485521-44.5766951
 Parameter: ZTRAN <- "-15.128143"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-44.2539562"
 Parameter: YTRAN -> "-17.5389219"
 Parameter: ZTRAN -> "-15.128143"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -44.253956  -17.538922  -15.128143
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.984924643"
Evaluating: 0.984924643*360.0
 Parameter: XPHI <- "354.572871"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.50122635"
Evaluating: 0.50122635*360.0
 Parameter: YPHI <- "180.441486"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.613614431"
Evaluating: 0.613614431*360.0
 Parameter: ZPHI <- "220.901195"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.322738908"
 Parameter: YPOS -> "27.0377732"
 Parameter: ZPOS -> "29.4485521"
 Parameter: XPHI -> "354.572871"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.995517   -0.094580
    0.000000    0.094580    0.995517

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS    5.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.322738908"
 Parameter: YPOS -> "27.0377732"
 Parameter: ZPOS -> "29.4485521"
 Parameter: YPHI -> "180.441486"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.999970    0.000000    0.007705
    0.000000    1.000000    0.000000
   -0.007705    0.000000   -0.999970

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  179.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.322738908"
 Parameter: YPOS -> "27.0377732"
 Parameter: ZPOS -> "29.4485521"
 Parameter: ZPHI -> "220.901195"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.755840   -0.654757    0.000000
    0.654757   -0.755840    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  139.10

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.322739 XMAX =    0.322739 XAVE =    0.322739
    YMIN =   27.037773 YMAX =   27.037773 YAVE =   27.037773
    ZMIN =   29.448552 ZMAX =   29.448552 ZAVE =   29.448552
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.322738902"
Evaluating: 0.322738902+3.5
 Parameter: XMAX <- "3.8227389"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "27.0377732"
Evaluating: 27.0377732+3.5
 Parameter: YMAX <- "30.5377732"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "29.4485521"
Evaluating: 29.4485521+3.5
 Parameter: ZMAX <- "32.9485521"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.322738902"
Evaluating: 0.322738902-3.5
 Parameter: XMIN <- "-3.1772611"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "27.0377732"
Evaluating: 27.0377732-3.5
 Parameter: YMIN <- "23.5377732"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "29.4485521"
Evaluating: 29.4485521-3.5
 Parameter: ZMIN <- "25.9485521"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.8227389"
 Parameter: XMIN -> "-3.1772611"
 Parameter: YMAX -> "30.5377732"
 Parameter: YMIN -> "23.5377732"
 Parameter: ZMAX -> "32.9485521"
 Parameter: ZMIN -> "25.9485521"
 SELRPN>      4 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "4"
 Comparing "4" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      2 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9231 NEG      CLA      49       CLA     -7345 PAA2     TYR      212      OH            3.5915
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         1
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "129"
Evaluating: 129
 Parameter: J <- "129"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "129" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "129"
 Parameter: NPOS -> "80"
Evaluating: 129-80
 Parameter: J <- "49"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.82809705"
Evaluating: (89.1533903-9.0)*(0.82809705-0.5)
 Parameter: XPOS <- "26.2980909"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.521673593"
Evaluating: (89.1533903-9.0)*(0.521673593-0.5)
 Parameter: YPOS <- "1.73721196"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.490248987"
Evaluating: (89.1533903-9.0)*(0.490248987-0.5)
 Parameter: ZPOS <- "-0.781576751"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.322739 XMAX =    0.322739 XAVE =    0.322739
    YMIN =   27.037773 YMAX =   27.037773 YAVE =   27.037773
    ZMIN =   29.448552 ZMAX =   29.448552 ZAVE =   29.448552
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "26.2980909"
 RDCMND substituted energy or value "?XAVE" to "0.322738902"
Evaluating: 26.2980909-0.322738902
 Parameter: XTRAN <- "25.975352"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "1.73721196"
 RDCMND substituted energy or value "?YAVE" to "27.0377732"
Evaluating: 1.73721196-27.0377732
 Parameter: YTRAN <- "-25.3005612"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-0.781576751"
 RDCMND substituted energy or value "?ZAVE" to "29.4485521"
Evaluating: -0.781576751-29.4485521
 Parameter: ZTRAN <- "-30.2301289"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "25.975352"
 Parameter: YTRAN -> "-25.3005612"
 Parameter: ZTRAN -> "-30.2301289"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    25.975352  -25.300561  -30.230129
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.830363633"
Evaluating: 0.830363633*360.0
 Parameter: XPHI <- "298.930908"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.940114888"
Evaluating: 0.940114888*360.0
 Parameter: YPHI <- "338.44136"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "7.490886543E-02"
Evaluating: 7.490886543E-02*360.0
 Parameter: ZPHI <- "26.9671916"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "26.2980909"
 Parameter: YPOS -> "1.73721196"
 Parameter: ZPOS -> "-0.781576751"
 Parameter: XPHI -> "298.930908"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.483755   -0.875204
    0.000000    0.875204    0.483755

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   61.07

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "26.2980909"
 Parameter: YPOS -> "1.73721196"
 Parameter: ZPOS -> "-0.781576751"
 Parameter: YPHI -> "338.44136"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.930042    0.000000    0.367453
    0.000000    1.000000    0.000000
   -0.367453    0.000000    0.930042

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   21.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "26.2980909"
 Parameter: YPOS -> "1.73721196"
 Parameter: ZPOS -> "-0.781576751"
 Parameter: ZPHI -> "26.9671916"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.891266    0.453480    0.000000
   -0.453480    0.891266    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   26.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.298091 XMAX =   26.298091 XAVE =   26.298091
    YMIN =    1.737212 YMAX =    1.737212 YAVE =    1.737212
    ZMIN =   -0.781577 ZMAX =   -0.781577 ZAVE =   -0.781577
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "26.2980909"
Evaluating: 26.2980909+3.5
 Parameter: XMAX <- "29.7980909"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "1.73721201"
Evaluating: 1.73721201+3.5
 Parameter: YMAX <- "5.23721201"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-0.781576737"
Evaluating: -0.781576737+3.5
 Parameter: ZMAX <- "2.71842326"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "26.2980909"
Evaluating: 26.2980909-3.5
 Parameter: XMIN <- "22.7980909"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "1.73721201"
Evaluating: 1.73721201-3.5
 Parameter: YMIN <- "-1.76278799"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-0.781576737"
Evaluating: -0.781576737-3.5
 Parameter: ZMIN <- "-4.28157674"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.7980909"
 Parameter: XMIN -> "22.7980909"
 Parameter: YMAX -> "5.23721201"
 Parameter: YMIN -> "-1.76278799"
 Parameter: ZMAX -> "2.71842326"
 Parameter: ZMIN -> "-4.28157674"
 SELRPN>     28 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "28"
 Comparing "28" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     19 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9231 NEG      CLA      49       CLA     -4482 PAA1     VAL      341      O             3.6624
 9231 NEG      CLA      49       CLA     -4485 PAA1     GLY      342      CA            3.6878
 9231 NEG      CLA      49       CLA     -4488 PAA1     GLY      342      C             2.4703
 9231 NEG      CLA      49       CLA     -4489 PAA1     GLY      342      O             1.7384
 9231 NEG      CLA      49       CLA     -4490 PAA1     GLN      343      N             2.8594
 9231 NEG      CLA      49       CLA     -4492 PAA1     GLN      343      CA            2.7104
 9231 NEG      CLA      49       CLA     -4494 PAA1     GLN      343      CB            4.1921
 9231 NEG      CLA      49       CLA     -4505 PAA1     GLN      343      C             2.0564
 9231 NEG      CLA      49       CLA     -4506 PAA1     GLN      343      O             2.7431
 9231 NEG      CLA      49       CLA     -4507 PAA1     TYR      344      N             1.8777
 9231 NEG      CLA      49       CLA     -4509 PAA1     TYR      344      CA            2.6261
 9231 NEG      CLA      49       CLA     -4511 PAA1     TYR      344      CB            3.9773
 9231 NEG      CLA      49       CLA     -4526 PAA1     TYR      344      C             2.7285
 9231 NEG      CLA      49       CLA     -4527 PAA1     TYR      344      O             3.7270
 9231 NEG      CLA      49       CLA     -4528 PAA1     VAL      345      N             2.5213
 9231 NEG      CLA      49       CLA     -4530 PAA1     VAL      345      CA            3.5377
 9231 NEG      CLA      49       CLA     -4542 PAA1     VAL      345      C             3.4128
 9231 NEG      CLA      49       CLA     -4543 PAA1     VAL      345      O             3.2565
 9231 NEG      CLA      49       CLA     -4544 PAA1     GLY      346      N             4.1063
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        19
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "19"
 Comparing "19" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "129"
Evaluating: 129
 Parameter: J <- "129"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "129" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "129"
 Parameter: NPOS -> "80"
Evaluating: 129-80
 Parameter: J <- "49"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "49"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.248136335"
Evaluating: (89.1533903-9.0)*(0.248136335-0.5)
 Parameter: XPOS <- "-20.1877266"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "8.92797022E-04"
Evaluating: (89.1533903-9.0)*(8.92797022E-04-0.5)
 Parameter: YPOS <- "-40.0051344"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.229004374"
Evaluating: (89.1533903-9.0)*(0.229004374-0.5)
 Parameter: ZPOS <- "-21.7212182"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   26.298091 XMAX =   26.298091 XAVE =   26.298091
    YMIN =    1.737212 YMAX =    1.737212 YAVE =    1.737212
    ZMIN =   -0.781577 ZMAX =   -0.781577 ZAVE =   -0.781577
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-20.1877266"
 RDCMND substituted energy or value "?XAVE" to "26.2980909"
Evaluating: -20.1877266-26.2980909
 Parameter: XTRAN <- "-46.4858175"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-40.0051344"
 RDCMND substituted energy or value "?YAVE" to "1.73721201"
Evaluating: -40.0051344-1.73721201
 Parameter: YTRAN <- "-41.7423464"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-21.7212182"
 RDCMND substituted energy or value "?ZAVE" to "-0.781576737"
Evaluating: -21.7212182--0.781576737
 Parameter: ZTRAN <- "-20.9396415"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-46.4858175"
 Parameter: YTRAN -> "-41.7423464"
 Parameter: ZTRAN -> "-20.9396415"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -46.485818  -41.742346  -20.939642
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.856173561"
Evaluating: 0.856173561*360.0
 Parameter: XPHI <- "308.222482"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.397738363"
Evaluating: 0.397738363*360.0
 Parameter: YPHI <- "143.185811"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.291381324"
Evaluating: 0.291381324*360.0
 Parameter: ZPHI <- "104.897277"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-20.1877266"
 Parameter: YPOS -> "-40.0051344"
 Parameter: ZPOS -> "-21.7212182"
 Parameter: XPHI -> "308.222482"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.618717   -0.785614
    0.000000    0.785614    0.618717

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   51.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-20.1877266"
 Parameter: YPOS -> "-40.0051344"
 Parameter: ZPOS -> "-21.7212182"
 Parameter: YPHI -> "143.185811"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.800583    0.000000   -0.599222
    0.000000    1.000000    0.000000
    0.599222    0.000000   -0.800583

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  143.19

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-20.1877266"
 Parameter: YPOS -> "-40.0051344"
 Parameter: ZPOS -> "-21.7212182"
 Parameter: ZPHI -> "104.897277"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.257087    0.966388    0.000000
   -0.966388   -0.257087    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  104.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -20.187727 XMAX =  -20.187727 XAVE =  -20.187727
    YMIN =  -40.005134 YMAX =  -40.005134 YAVE =  -40.005134
    ZMIN =  -21.721218 ZMAX =  -21.721218 ZAVE =  -21.721218
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-20.1877266"
Evaluating: -20.1877266+3.5
 Parameter: XMAX <- "-16.6877266"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-40.0051344"
Evaluating: -40.0051344+3.5
 Parameter: YMAX <- "-36.5051344"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-21.7212182"
Evaluating: -21.7212182+3.5
 Parameter: ZMAX <- "-18.2212182"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-20.1877266"
Evaluating: -20.1877266-3.5
 Parameter: XMIN <- "-23.6877266"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-40.0051344"
Evaluating: -40.0051344-3.5
 Parameter: YMIN <- "-43.5051344"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-21.7212182"
Evaluating: -21.7212182-3.5
 Parameter: ZMIN <- "-25.2212182"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-16.6877266"
 Parameter: XMIN -> "-23.6877266"
 Parameter: YMAX -> "-36.5051344"
 Parameter: YMIN -> "-43.5051344"
 Parameter: ZMAX -> "-18.2212182"
 Parameter: ZMIN -> "-25.2212182"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "130"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "130" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "130"
Evaluating: 130
 Parameter: J <- "130"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "130" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "130"
 Parameter: NPOS -> "80"
Evaluating: 130-80
 Parameter: J <- "50"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "50"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.795598607"
Evaluating: (89.1533903-9.0)*(0.795598607-0.5)
 Parameter: XPOS <- "23.6932305"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.665831353"
Evaluating: (89.1533903-9.0)*(0.665831353-0.5)
 Parameter: YPOS <- "13.2919452"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.244036675"
Evaluating: (89.1533903-9.0)*(0.244036675-0.5)
 Parameter: ZPOS <- "-20.5163283"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "23.6932305"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 23.6932305-44.5766951
 Parameter: XTRAN <- "-20.8834646"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "13.2919452"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 13.2919452-44.5766951
 Parameter: YTRAN <- "-31.2847499"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.5163283"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -20.5163283-44.5766951
 Parameter: ZTRAN <- "-65.0930234"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-20.8834646"
 Parameter: YTRAN -> "-31.2847499"
 Parameter: ZTRAN -> "-65.0930234"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -20.883465  -31.284750  -65.093023
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.911381565"
Evaluating: 0.911381565*360.0
 Parameter: XPHI <- "328.097363"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.334518872"
Evaluating: 0.334518872*360.0
 Parameter: YPHI <- "120.426794"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.291208992"
Evaluating: 0.291208992*360.0
 Parameter: ZPHI <- "104.835237"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "23.6932305"
 Parameter: YPOS -> "13.2919452"
 Parameter: ZPOS -> "-20.5163283"
 Parameter: XPHI -> "328.097363"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.848947   -0.528477
    0.000000    0.528477    0.848947

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   31.90

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "23.6932305"
 Parameter: YPOS -> "13.2919452"
 Parameter: ZPOS -> "-20.5163283"
 Parameter: YPHI -> "120.426794"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.506437    0.000000   -0.862277
    0.000000    1.000000    0.000000
    0.862277    0.000000   -0.506437

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  120.43

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "23.6932305"
 Parameter: YPOS -> "13.2919452"
 Parameter: ZPOS -> "-20.5163283"
 Parameter: ZPHI -> "104.835237"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.256040    0.966666    0.000000
   -0.966666   -0.256040    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  104.84

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   23.693230 XMAX =   23.693230 XAVE =   23.693230
    YMIN =   13.291945 YMAX =   13.291945 YAVE =   13.291945
    ZMIN =  -20.516328 ZMAX =  -20.516328 ZAVE =  -20.516328
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "23.6932305"
Evaluating: 23.6932305+3.5
 Parameter: XMAX <- "27.1932305"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "13.2919452"
Evaluating: 13.2919452+3.5
 Parameter: YMAX <- "16.7919452"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.5163283"
Evaluating: -20.5163283+3.5
 Parameter: ZMAX <- "-17.0163283"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "23.6932305"
Evaluating: 23.6932305-3.5
 Parameter: XMIN <- "20.1932305"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "13.2919452"
Evaluating: 13.2919452-3.5
 Parameter: YMIN <- "9.7919452"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.5163283"
Evaluating: -20.5163283-3.5
 Parameter: ZMIN <- "-24.0163283"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "27.1932305"
 Parameter: XMIN -> "20.1932305"
 Parameter: YMAX -> "16.7919452"
 Parameter: YMIN -> "9.7919452"
 Parameter: ZMAX -> "-17.0163283"
 Parameter: ZMIN -> "-24.0163283"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "131"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "131" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "131"
Evaluating: 131
 Parameter: J <- "131"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "131" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "131"
 Parameter: NPOS -> "80"
Evaluating: 131-80
 Parameter: J <- "51"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.65768837"
Evaluating: (89.1533903-9.0)*(0.65768837-0.5)
 Parameter: XPOS <- "12.6392575"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.49498707"
Evaluating: (89.1533903-9.0)*(0.49498707-0.5)
 Parameter: YPOS <- "-0.401803335"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.677491077"
Evaluating: (89.1533903-9.0)*(0.677491077-0.5)
 Parameter: ZPOS <- "14.2265116"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "12.6392575"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 12.6392575-44.5766951
 Parameter: XTRAN <- "-31.9374376"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-0.401803335"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -0.401803335-44.5766951
 Parameter: YTRAN <- "-44.9784984"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "14.2265116"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 14.2265116-44.5766951
 Parameter: ZTRAN <- "-30.3501835"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-31.9374376"
 Parameter: YTRAN -> "-44.9784984"
 Parameter: ZTRAN -> "-30.3501835"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -31.937438  -44.978498  -30.350183
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.759875239"
Evaluating: 0.759875239*360.0
 Parameter: XPHI <- "273.555086"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.156431784"
Evaluating: 0.156431784*360.0
 Parameter: YPHI <- "56.3154422"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.832838439"
Evaluating: 0.832838439*360.0
 Parameter: ZPHI <- "299.821838"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "12.6392575"
 Parameter: YPOS -> "-0.401803335"
 Parameter: ZPOS -> "14.2265116"
 Parameter: XPHI -> "273.555086"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.062008   -0.998076
    0.000000    0.998076    0.062008

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   86.44

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "12.6392575"
 Parameter: YPOS -> "-0.401803335"
 Parameter: ZPOS -> "14.2265116"
 Parameter: YPHI -> "56.3154422"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.554620    0.000000   -0.832104
    0.000000    1.000000    0.000000
    0.832104    0.000000    0.554620

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   56.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "12.6392575"
 Parameter: YPOS -> "-0.401803335"
 Parameter: ZPOS -> "14.2265116"
 Parameter: ZPHI -> "299.821838"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.497305   -0.867576    0.000000
    0.867576    0.497305    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   60.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.639257 XMAX =   12.639257 XAVE =   12.639257
    YMIN =   -0.401803 YMAX =   -0.401803 YAVE =   -0.401803
    ZMIN =   14.226512 ZMAX =   14.226512 ZAVE =   14.226512
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "12.6392575"
Evaluating: 12.6392575+3.5
 Parameter: XMAX <- "16.1392575"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-0.401803359"
Evaluating: -0.401803359+3.5
 Parameter: YMAX <- "3.09819664"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "14.2265116"
Evaluating: 14.2265116+3.5
 Parameter: ZMAX <- "17.7265116"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "12.6392575"
Evaluating: 12.6392575-3.5
 Parameter: XMIN <- "9.1392575"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-0.401803359"
Evaluating: -0.401803359-3.5
 Parameter: YMIN <- "-3.90180336"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "14.2265116"
Evaluating: 14.2265116-3.5
 Parameter: ZMIN <- "10.7265116"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "16.1392575"
 Parameter: XMIN -> "9.1392575"
 Parameter: YMAX -> "3.09819664"
 Parameter: YMIN -> "-3.90180336"
 Parameter: ZMAX -> "17.7265116"
 Parameter: ZMIN -> "10.7265116"
 SELRPN>     11 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "11"
 Comparing "11" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      6 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9233 NEG      CLA      51       CLA     -1981 PAA1     ASN      138      CA            4.0925
 9233 NEG      CLA      51       CLA     -1983 PAA1     ASN      138      CB            3.0436
 9233 NEG      CLA      51       CLA     -1986 PAA1     ASN      138      CG            1.8361
 9233 NEG      CLA      51       CLA     -1987 PAA1     ASN      138      OD1           2.1345
 9233 NEG      CLA      51       CLA     -1988 PAA1     ASN      138      ND2           1.5370
 9233 NEG      CLA      51       CLA     -1991 PAA1     ASN      138      C             4.3687
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         6
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "6"
 Comparing "6" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "131"
Evaluating: 131
 Parameter: J <- "131"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "131" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "131"
 Parameter: NPOS -> "80"
Evaluating: 131-80
 Parameter: J <- "51"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.494704524"
Evaluating: (89.1533903-9.0)*(0.494704524-0.5)
 Parameter: XPOS <- "-0.424450355"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.556754181"
Evaluating: (89.1533903-9.0)*(0.556754181-0.5)
 Parameter: YPOS <- "4.54904002"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.516444607"
Evaluating: (89.1533903-9.0)*(0.516444607-0.5)
 Parameter: ZPOS <- "1.318091"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   12.639257 XMAX =   12.639257 XAVE =   12.639257
    YMIN =   -0.401803 YMAX =   -0.401803 YAVE =   -0.401803
    ZMIN =   14.226512 ZMAX =   14.226512 ZAVE =   14.226512
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.424450355"
 RDCMND substituted energy or value "?XAVE" to "12.6392575"
Evaluating: -0.424450355-12.6392575
 Parameter: XTRAN <- "-13.0637079"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.54904002"
 RDCMND substituted energy or value "?YAVE" to "-0.401803359"
Evaluating: 4.54904002--0.401803359
 Parameter: YTRAN <- "4.95084338"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "1.318091"
 RDCMND substituted energy or value "?ZAVE" to "14.2265116"
Evaluating: 1.318091-14.2265116
 Parameter: ZTRAN <- "-12.9084206"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-13.0637079"
 Parameter: YTRAN -> "4.95084338"
 Parameter: ZTRAN -> "-12.9084206"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -13.063708    4.950843  -12.908421
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.376605225"
Evaluating: 0.376605225*360.0
 Parameter: XPHI <- "135.577881"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.783331198"
Evaluating: 0.783331198*360.0
 Parameter: YPHI <- "281.999231"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.906156855"
Evaluating: 0.906156855*360.0
 Parameter: ZPHI <- "326.216468"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.424450355"
 Parameter: YPOS -> "4.54904002"
 Parameter: ZPOS -> "1.318091"
 Parameter: XPHI -> "135.577881"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.714203    0.699939
    0.000000   -0.699939   -0.714203

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  135.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.424450355"
 Parameter: YPOS -> "4.54904002"
 Parameter: ZPOS -> "1.318091"
 Parameter: YPHI -> "281.999231"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.207899    0.000000    0.978150
    0.000000    1.000000    0.000000
   -0.978150    0.000000    0.207899

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   78.00

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.424450355"
 Parameter: YPOS -> "4.54904002"
 Parameter: ZPOS -> "1.318091"
 Parameter: ZPHI -> "326.216468"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.831144   -0.556057    0.000000
    0.556057    0.831144    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   33.78

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.424450 XMAX =   -0.424450 XAVE =   -0.424450
    YMIN =    4.549040 YMAX =    4.549040 YAVE =    4.549040
    ZMIN =    1.318091 ZMAX =    1.318091 ZAVE =    1.318091
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.424450385"
Evaluating: -0.424450385+3.5
 Parameter: XMAX <- "3.07554961"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.54904002"
Evaluating: 4.54904002+3.5
 Parameter: YMAX <- "8.04904002"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "1.31809106"
Evaluating: 1.31809106+3.5
 Parameter: ZMAX <- "4.81809106"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.424450385"
Evaluating: -0.424450385-3.5
 Parameter: XMIN <- "-3.92445039"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.54904002"
Evaluating: 4.54904002-3.5
 Parameter: YMIN <- "1.04904002"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "1.31809106"
Evaluating: 1.31809106-3.5
 Parameter: ZMIN <- "-2.18190894"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.07554961"
 Parameter: XMIN -> "-3.92445039"
 Parameter: YMAX -> "8.04904002"
 Parameter: YMIN -> "1.04904002"
 Parameter: ZMAX -> "4.81809106"
 Parameter: ZMIN -> "-2.18190894"
 SELRPN>      8 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      4 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9233 NEG      CLA      51       CLA     -2286 PAA1     ALA      165      CA            4.4793
 9233 NEG      CLA      51       CLA     -2288 PAA1     ALA      165      CB            3.5590
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "2"
Evaluating: 2+1
 Parameter: CNTRAND <- "3"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "3" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "131"
Evaluating: 131
 Parameter: J <- "131"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "131" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "131"
 Parameter: NPOS -> "80"
Evaluating: 131-80
 Parameter: J <- "51"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "51"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.623083183"
Evaluating: (89.1533903-9.0)*(0.623083183-0.5)
 Parameter: XPOS <- "9.86553441"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.714618218"
Evaluating: (89.1533903-9.0)*(0.714618218-0.5)
 Parameter: YPOS <- "17.2023778"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "1.367178548E-02"
Evaluating: (89.1533903-9.0)*(1.367178548E-02-0.5)
 Parameter: ZPOS <- "-38.9808552"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.424450 XMAX =   -0.424450 XAVE =   -0.424450
    YMIN =    4.549040 YMAX =    4.549040 YAVE =    4.549040
    ZMIN =    1.318091 ZMAX =    1.318091 ZAVE =    1.318091
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.86553441"
 RDCMND substituted energy or value "?XAVE" to "-0.424450385"
Evaluating: 9.86553441--0.424450385
 Parameter: XTRAN <- "10.2899848"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "17.2023778"
 RDCMND substituted energy or value "?YAVE" to "4.54904002"
Evaluating: 17.2023778-4.54904002
 Parameter: YTRAN <- "12.6533378"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.9808552"
 RDCMND substituted energy or value "?ZAVE" to "1.31809106"
Evaluating: -38.9808552-1.31809106
 Parameter: ZTRAN <- "-40.2989463"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "10.2899848"
 Parameter: YTRAN -> "12.6533378"
 Parameter: ZTRAN -> "-40.2989463"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    10.289985   12.653338  -40.298946
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.115877539"
Evaluating: 0.115877539*360.0
 Parameter: XPHI <- "41.715914"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.189718981"
Evaluating: 0.189718981*360.0
 Parameter: YPHI <- "68.2988332"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.406449431"
Evaluating: 0.406449431*360.0
 Parameter: ZPHI <- "146.321795"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.86553441"
 Parameter: YPOS -> "17.2023778"
 Parameter: ZPOS -> "-38.9808552"
 Parameter: XPHI -> "41.715914"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.746453    0.665438
    0.000000   -0.665438    0.746453

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   41.72

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.86553441"
 Parameter: YPOS -> "17.2023778"
 Parameter: ZPOS -> "-38.9808552"
 Parameter: YPHI -> "68.2988332"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.369766    0.000000   -0.929125
    0.000000    1.000000    0.000000
    0.929125    0.000000    0.369766

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   68.30

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.86553441"
 Parameter: YPOS -> "17.2023778"
 Parameter: ZPOS -> "-38.9808552"
 Parameter: ZPHI -> "146.321795"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.832165    0.554528    0.000000
   -0.554528   -0.832165    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  146.32

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.865534 XMAX =    9.865534 XAVE =    9.865534
    YMIN =   17.202378 YMAX =   17.202378 YAVE =   17.202378
    ZMIN =  -38.980855 ZMAX =  -38.980855 ZAVE =  -38.980855
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.86553437"
Evaluating: 9.86553437+3.5
 Parameter: XMAX <- "13.3655344"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "17.2023778"
Evaluating: 17.2023778+3.5
 Parameter: YMAX <- "20.7023778"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.9808552"
Evaluating: -38.9808552+3.5
 Parameter: ZMAX <- "-35.4808552"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.86553437"
Evaluating: 9.86553437-3.5
 Parameter: XMIN <- "6.36553437"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "17.2023778"
Evaluating: 17.2023778-3.5
 Parameter: YMIN <- "13.7023778"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.9808552"
Evaluating: -38.9808552-3.5
 Parameter: ZMIN <- "-42.4808552"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.3655344"
 Parameter: XMIN -> "6.36553437"
 Parameter: YMAX -> "20.7023778"
 Parameter: YMIN -> "13.7023778"
 Parameter: ZMAX -> "-35.4808552"
 Parameter: ZMIN -> "-42.4808552"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "132"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "132" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "132"
Evaluating: 132
 Parameter: J <- "132"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "132" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "132"
 Parameter: NPOS -> "80"
Evaluating: 132-80
 Parameter: J <- "52"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "52"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.108383991"
Evaluating: (89.1533903-9.0)*(0.108383991-0.5)
 Parameter: XPOS <- "-31.3893508"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.926390103"
Evaluating: (89.1533903-9.0)*(0.926390103-0.5)
 Parameter: YPOS <- "34.1766123"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.884690159"
Evaluating: (89.1533903-9.0)*(0.884690159-0.5)
 Parameter: ZPOS <- "30.8342205"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-31.3893508"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -31.3893508-44.5766951
 Parameter: XTRAN <- "-75.9660459"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.1766123"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 34.1766123-44.5766951
 Parameter: YTRAN <- "-10.4000828"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "30.8342205"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 30.8342205-44.5766951
 Parameter: ZTRAN <- "-13.7424746"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-75.9660459"
 Parameter: YTRAN -> "-10.4000828"
 Parameter: ZTRAN -> "-13.7424746"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -75.966046  -10.400083  -13.742475
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.652926649"
Evaluating: 0.652926649*360.0
 Parameter: XPHI <- "235.053594"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.291456382"
Evaluating: 0.291456382*360.0
 Parameter: YPHI <- "104.924298"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.562034702"
Evaluating: 0.562034702*360.0
 Parameter: ZPHI <- "202.332493"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-31.3893508"
 Parameter: YPOS -> "34.1766123"
 Parameter: ZPOS -> "30.8342205"
 Parameter: XPHI -> "235.053594"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.572810   -0.819688
    0.000000    0.819688   -0.572810

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  124.95

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-31.3893508"
 Parameter: YPOS -> "34.1766123"
 Parameter: ZPOS -> "30.8342205"
 Parameter: YPHI -> "104.924298"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.257543    0.000000   -0.966267
    0.000000    1.000000    0.000000
    0.966267    0.000000   -0.257543

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  104.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-31.3893508"
 Parameter: YPOS -> "34.1766123"
 Parameter: ZPOS -> "30.8342205"
 Parameter: ZPHI -> "202.332493"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.924994   -0.379981    0.000000
    0.379981   -0.924994    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  157.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -31.389351 XMAX =  -31.389351 XAVE =  -31.389351
    YMIN =   34.176612 YMAX =   34.176612 YAVE =   34.176612
    ZMIN =   30.834221 ZMAX =   30.834221 ZAVE =   30.834221
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-31.3893508"
Evaluating: -31.3893508+3.5
 Parameter: XMAX <- "-27.8893508"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.1766123"
Evaluating: 34.1766123+3.5
 Parameter: YMAX <- "37.6766123"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "30.8342205"
Evaluating: 30.8342205+3.5
 Parameter: ZMAX <- "34.3342205"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-31.3893508"
Evaluating: -31.3893508-3.5
 Parameter: XMIN <- "-34.8893508"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.1766123"
Evaluating: 34.1766123-3.5
 Parameter: YMIN <- "30.6766123"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "30.8342205"
Evaluating: 30.8342205-3.5
 Parameter: ZMIN <- "27.3342205"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-27.8893508"
 Parameter: XMIN -> "-34.8893508"
 Parameter: YMAX -> "37.6766123"
 Parameter: YMIN -> "30.6766123"
 Parameter: ZMAX -> "34.3342205"
 Parameter: ZMIN -> "27.3342205"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "133"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "133" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "133"
Evaluating: 133
 Parameter: J <- "133"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "133" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "133"
 Parameter: NPOS -> "80"
Evaluating: 133-80
 Parameter: J <- "53"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "53"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.948625817"
Evaluating: (89.1533903-9.0)*(0.948625817-0.5)
 Parameter: XPOS <- "35.9588802"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.560413853"
Evaluating: (89.1533903-9.0)*(0.560413853-0.5)
 Parameter: YPOS <- "4.84237514"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.449424418"
Evaluating: (89.1533903-9.0)*(0.449424418-0.5)
 Parameter: ZPOS <- "-4.05380436"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "35.9588802"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 35.9588802-44.5766951
 Parameter: XTRAN <- "-8.6178149"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "4.84237514"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 4.84237514-44.5766951
 Parameter: YTRAN <- "-39.73432"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-4.05380436"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -4.05380436-44.5766951
 Parameter: ZTRAN <- "-48.6304995"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.6178149"
 Parameter: YTRAN -> "-39.73432"
 Parameter: ZTRAN -> "-48.6304995"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    -8.617815  -39.734320  -48.630499
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.291887334"
Evaluating: 0.291887334*360.0
 Parameter: XPHI <- "105.07944"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.64589801"
Evaluating: 0.64589801*360.0
 Parameter: YPHI <- "232.523284"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "6.300520667E-02"
Evaluating: 6.300520667E-02*360.0
 Parameter: ZPHI <- "22.6818744"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "35.9588802"
 Parameter: YPOS -> "4.84237514"
 Parameter: ZPOS -> "-4.05380436"
 Parameter: XPHI -> "105.07944"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.260158    0.965566
    0.000000   -0.965566   -0.260158

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  105.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "35.9588802"
 Parameter: YPOS -> "4.84237514"
 Parameter: ZPOS -> "-4.05380436"
 Parameter: YPHI -> "232.523284"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.608439    0.000000    0.793601
    0.000000    1.000000    0.000000
   -0.793601    0.000000   -0.608439

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  127.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "35.9588802"
 Parameter: YPOS -> "4.84237514"
 Parameter: ZPOS -> "-4.05380436"
 Parameter: ZPHI -> "22.6818744"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.922660    0.385614    0.000000
   -0.385614    0.922660    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   22.68

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   35.958880 XMAX =   35.958880 XAVE =   35.958880
    YMIN =    4.842375 YMAX =    4.842375 YAVE =    4.842375
    ZMIN =   -4.053804 ZMAX =   -4.053804 ZAVE =   -4.053804
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "35.9588802"
Evaluating: 35.9588802+3.5
 Parameter: XMAX <- "39.4588802"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "4.8423751"
Evaluating: 4.8423751+3.5
 Parameter: YMAX <- "8.3423751"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-4.05380439"
Evaluating: -4.05380439+3.5
 Parameter: ZMAX <- "-0.55380439"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "35.9588802"
Evaluating: 35.9588802-3.5
 Parameter: XMIN <- "32.4588802"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "4.8423751"
Evaluating: 4.8423751-3.5
 Parameter: YMIN <- "1.3423751"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-4.05380439"
Evaluating: -4.05380439-3.5
 Parameter: ZMIN <- "-7.55380439"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.4588802"
 Parameter: XMIN -> "32.4588802"
 Parameter: YMAX -> "8.3423751"
 Parameter: YMIN -> "1.3423751"
 Parameter: ZMAX -> "-0.55380439"
 Parameter: ZMIN -> "-7.55380439"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "134"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "134" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "134"
Evaluating: 134
 Parameter: J <- "134"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "134" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "134"
 Parameter: NPOS -> "80"
Evaluating: 134-80
 Parameter: J <- "54"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "54"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.959302215"
Evaluating: (89.1533903-9.0)*(0.959302215-0.5)
 Parameter: XPOS <- "36.8146297"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.704454818"
Evaluating: (89.1533903-9.0)*(0.704454818-0.5)
 Parameter: YPOS <- "16.3877468"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.374646494"
Evaluating: (89.1533903-9.0)*(0.374646494-0.5)
 Parameter: ZPOS <- "-10.0475085"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.8146297"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 36.8146297-44.5766951
 Parameter: XTRAN <- "-7.7620654"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "16.3877468"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 16.3877468-44.5766951
 Parameter: YTRAN <- "-28.1889483"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-10.0475085"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -10.0475085-44.5766951
 Parameter: ZTRAN <- "-54.6242036"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-7.7620654"
 Parameter: YTRAN -> "-28.1889483"
 Parameter: ZTRAN -> "-54.6242036"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    -7.762065  -28.188948  -54.624204
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.103278743"
Evaluating: 0.103278743*360.0
 Parameter: XPHI <- "37.1803475"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.965032115"
Evaluating: 0.965032115*360.0
 Parameter: YPHI <- "347.411561"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.867907771"
Evaluating: 0.867907771*360.0
 Parameter: ZPHI <- "312.446798"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.8146297"
 Parameter: YPOS -> "16.3877468"
 Parameter: ZPOS -> "-10.0475085"
 Parameter: XPHI -> "37.1803475"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.796737    0.604326
    0.000000   -0.604326    0.796737

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   37.18

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.8146297"
 Parameter: YPOS -> "16.3877468"
 Parameter: ZPOS -> "-10.0475085"
 Parameter: YPHI -> "347.411561"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.975961    0.000000    0.217946
    0.000000    1.000000    0.000000
   -0.217946    0.000000    0.975961

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   12.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.8146297"
 Parameter: YPOS -> "16.3877468"
 Parameter: ZPOS -> "-10.0475085"
 Parameter: ZPHI -> "312.446798"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.674905   -0.737904    0.000000
    0.737904    0.674905    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   47.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.814630 XMAX =   36.814630 XAVE =   36.814630
    YMIN =   16.387747 YMAX =   16.387747 YAVE =   16.387747
    ZMIN =  -10.047509 ZMAX =  -10.047509 ZAVE =  -10.047509
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.8146297"
Evaluating: 36.8146297+3.5
 Parameter: XMAX <- "40.3146297"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "16.3877468"
Evaluating: 16.3877468+3.5
 Parameter: YMAX <- "19.8877468"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-10.0475085"
Evaluating: -10.0475085+3.5
 Parameter: ZMAX <- "-6.5475085"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.8146297"
Evaluating: 36.8146297-3.5
 Parameter: XMIN <- "33.3146297"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "16.3877468"
Evaluating: 16.3877468-3.5
 Parameter: YMIN <- "12.8877468"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-10.0475085"
Evaluating: -10.0475085-3.5
 Parameter: ZMIN <- "-13.5475085"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "40.3146297"
 Parameter: XMIN -> "33.3146297"
 Parameter: YMAX -> "19.8877468"
 Parameter: YMIN -> "12.8877468"
 Parameter: ZMAX -> "-6.5475085"
 Parameter: ZMIN -> "-13.5475085"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "135"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "135" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "135"
Evaluating: 135
 Parameter: J <- "135"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "135" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "135"
 Parameter: NPOS -> "80"
Evaluating: 135-80
 Parameter: J <- "55"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "55"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.631478669"
Evaluating: (89.1533903-9.0)*(0.631478669-0.5)
 Parameter: XPOS <- "10.5384611"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.440255932"
Evaluating: (89.1533903-9.0)*(0.440255932-0.5)
 Parameter: YPOS <- "-4.7886896"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.675028112"
Evaluating: (89.1533903-9.0)*(0.675028112-0.5)
 Parameter: ZPOS <- "14.0290966"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.5384611"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 10.5384611-44.5766951
 Parameter: XTRAN <- "-34.038234"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-4.7886896"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -4.7886896-44.5766951
 Parameter: YTRAN <- "-49.3653847"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "14.0290966"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 14.0290966-44.5766951
 Parameter: ZTRAN <- "-30.5475985"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.038234"
 Parameter: YTRAN -> "-49.3653847"
 Parameter: ZTRAN -> "-30.5475985"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -34.038234  -49.365385  -30.547598
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.85168152"
Evaluating: 0.85168152*360.0
 Parameter: XPHI <- "306.605347"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.659249399"
Evaluating: 0.659249399*360.0
 Parameter: YPHI <- "237.329784"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.443425307"
Evaluating: 0.443425307*360.0
 Parameter: ZPHI <- "159.633111"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.5384611"
 Parameter: YPOS -> "-4.7886896"
 Parameter: ZPOS -> "14.0290966"
 Parameter: XPHI -> "306.605347"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.596300   -0.802762
    0.000000    0.802762    0.596300

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   53.39

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.5384611"
 Parameter: YPOS -> "-4.7886896"
 Parameter: ZPOS -> "14.0290966"
 Parameter: YPHI -> "237.329784"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.539803    0.000000    0.841792
    0.000000    1.000000    0.000000
   -0.841792    0.000000   -0.539803

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  122.67

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.5384611"
 Parameter: YPOS -> "-4.7886896"
 Parameter: ZPOS -> "14.0290966"
 Parameter: ZPHI -> "159.633111"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.937483    0.348030    0.000000
   -0.348030   -0.937483    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  159.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.538461 XMAX =   10.538461 XAVE =   10.538461
    YMIN =   -4.788690 YMAX =   -4.788690 YAVE =   -4.788690
    ZMIN =   14.029097 ZMAX =   14.029097 ZAVE =   14.029097
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.5384611"
Evaluating: 10.5384611+3.5
 Parameter: XMAX <- "14.0384611"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-4.7886896"
Evaluating: -4.7886896+3.5
 Parameter: YMAX <- "-1.2886896"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "14.0290966"
Evaluating: 14.0290966+3.5
 Parameter: ZMAX <- "17.5290966"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.5384611"
Evaluating: 10.5384611-3.5
 Parameter: XMIN <- "7.0384611"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-4.7886896"
Evaluating: -4.7886896-3.5
 Parameter: YMIN <- "-8.2886896"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "14.0290966"
Evaluating: 14.0290966-3.5
 Parameter: ZMIN <- "10.5290966"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "14.0384611"
 Parameter: XMIN -> "7.0384611"
 Parameter: YMAX -> "-1.2886896"
 Parameter: YMIN -> "-8.2886896"
 Parameter: ZMAX -> "17.5290966"
 Parameter: ZMIN -> "10.5290966"
 SELRPN>      2 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      0 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
            ONLY ONE SELECTION SET SPECIFIED, A COMPARISON WILL BE DONE
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "136"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "136" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "136"
Evaluating: 136
 Parameter: J <- "136"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "136" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "136"
 Parameter: NPOS -> "80"
Evaluating: 136-80
 Parameter: J <- "56"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "56"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.311082144"
Evaluating: (89.1533903-9.0)*(0.311082144-0.5)
 Parameter: XPOS <- "-15.1424066"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "5.379355216E-02"
Evaluating: (89.1533903-9.0)*(5.379355216E-02-0.5)
 Parameter: YPOS <- "-35.7649596"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.684108039"
Evaluating: (89.1533903-9.0)*(0.684108039-0.5)
 Parameter: ZPOS <- "14.7568835"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-15.1424066"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -15.1424066-44.5766951
 Parameter: XTRAN <- "-59.7191017"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-35.7649596"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -35.7649596-44.5766951
 Parameter: YTRAN <- "-80.3416547"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "14.7568835"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 14.7568835-44.5766951
 Parameter: ZTRAN <- "-29.8198116"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-59.7191017"
 Parameter: YTRAN -> "-80.3416547"
 Parameter: ZTRAN -> "-29.8198116"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -59.719102  -80.341655  -29.819812
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.708250123"
Evaluating: 0.708250123*360.0
 Parameter: XPHI <- "254.970044"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.204691033"
Evaluating: 0.204691033*360.0
 Parameter: YPHI <- "73.6887719"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.964873619"
Evaluating: 0.964873619*360.0
 Parameter: ZPHI <- "347.354503"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-15.1424066"
 Parameter: YPOS -> "-35.7649596"
 Parameter: ZPOS -> "14.7568835"
 Parameter: XPHI -> "254.970044"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.259324   -0.965790
    0.000000    0.965790   -0.259324

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  105.03

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-15.1424066"
 Parameter: YPOS -> "-35.7649596"
 Parameter: ZPOS -> "14.7568835"
 Parameter: YPHI -> "73.6887719"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.280855    0.000000   -0.959750
    0.000000    1.000000    0.000000
    0.959750    0.000000    0.280855

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   73.69

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-15.1424066"
 Parameter: YPOS -> "-35.7649596"
 Parameter: ZPOS -> "14.7568835"
 Parameter: ZPHI -> "347.354503"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.975743   -0.218918    0.000000
    0.218918    0.975743    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   12.65

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -15.142407 XMAX =  -15.142407 XAVE =  -15.142407
    YMIN =  -35.764960 YMAX =  -35.764960 YAVE =  -35.764960
    ZMIN =   14.756883 ZMAX =   14.756883 ZAVE =   14.756883
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-15.1424066"
Evaluating: -15.1424066+3.5
 Parameter: XMAX <- "-11.6424066"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-35.7649596"
Evaluating: -35.7649596+3.5
 Parameter: YMAX <- "-32.2649596"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "14.7568835"
Evaluating: 14.7568835+3.5
 Parameter: ZMAX <- "18.2568835"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-15.1424066"
Evaluating: -15.1424066-3.5
 Parameter: XMIN <- "-18.6424066"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-35.7649596"
Evaluating: -35.7649596-3.5
 Parameter: YMIN <- "-39.2649596"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "14.7568835"
Evaluating: 14.7568835-3.5
 Parameter: ZMIN <- "11.2568835"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-11.6424066"
 Parameter: XMIN -> "-18.6424066"
 Parameter: YMAX -> "-32.2649596"
 Parameter: YMIN -> "-39.2649596"
 Parameter: ZMAX -> "18.2568835"
 Parameter: ZMIN -> "11.2568835"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "137"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "137" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "137"
Evaluating: 137
 Parameter: J <- "137"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "137" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "137"
 Parameter: NPOS -> "80"
Evaluating: 137-80
 Parameter: J <- "57"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.838058362"
Evaluating: (89.1533903-9.0)*(0.838058362-0.5)
 Parameter: XPOS <- "27.0965238"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.928499662"
Evaluating: (89.1533903-9.0)*(0.928499662-0.5)
 Parameter: YPOS <- "34.3457007"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.947771335"
Evaluating: (89.1533903-9.0)*(0.947771335-0.5)
 Parameter: ZPOS <- "35.8903906"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "27.0965238"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 27.0965238-44.5766951
 Parameter: XTRAN <- "-17.4801713"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "34.3457007"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 34.3457007-44.5766951
 Parameter: YTRAN <- "-10.2309944"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "35.8903906"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 35.8903906-44.5766951
 Parameter: ZTRAN <- "-8.6863045"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-17.4801713"
 Parameter: YTRAN -> "-10.2309944"
 Parameter: ZTRAN -> "-8.6863045"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -17.480171  -10.230994   -8.686305
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.149919874"
Evaluating: 0.149919874*360.0
 Parameter: XPHI <- "53.9711546"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.429462621"
Evaluating: 0.429462621*360.0
 Parameter: YPHI <- "154.606544"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "9.782517146E-02"
Evaluating: 9.782517146E-02*360.0
 Parameter: ZPHI <- "35.2170617"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "27.0965238"
 Parameter: YPOS -> "34.3457007"
 Parameter: ZPOS -> "35.8903906"
 Parameter: XPHI -> "53.9711546"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.588192    0.808721
    0.000000   -0.808721    0.588192

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   53.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "27.0965238"
 Parameter: YPOS -> "34.3457007"
 Parameter: ZPOS -> "35.8903906"
 Parameter: YPHI -> "154.606544"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.903384    0.000000   -0.428832
    0.000000    1.000000    0.000000
    0.428832    0.000000   -0.903384

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  154.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "27.0965238"
 Parameter: YPOS -> "34.3457007"
 Parameter: ZPOS -> "35.8903906"
 Parameter: ZPHI -> "35.2170617"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.816973    0.576676    0.000000
   -0.576676    0.816973    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   35.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.096524 XMAX =   27.096524 XAVE =   27.096524
    YMIN =   34.345701 YMAX =   34.345701 YAVE =   34.345701
    ZMIN =   35.890391 ZMAX =   35.890391 ZAVE =   35.890391
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "27.0965238"
Evaluating: 27.0965238+3.5
 Parameter: XMAX <- "30.5965238"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "34.3457007"
Evaluating: 34.3457007+3.5
 Parameter: YMAX <- "37.8457007"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "35.8903906"
Evaluating: 35.8903906+3.5
 Parameter: ZMAX <- "39.3903906"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "27.0965238"
Evaluating: 27.0965238-3.5
 Parameter: XMIN <- "23.5965238"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "34.3457007"
Evaluating: 34.3457007-3.5
 Parameter: YMIN <- "30.8457007"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "35.8903906"
Evaluating: 35.8903906-3.5
 Parameter: ZMIN <- "32.3903906"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "30.5965238"
 Parameter: XMIN -> "23.5965238"
 Parameter: YMAX -> "37.8457007"
 Parameter: YMIN -> "30.8457007"
 Parameter: ZMAX -> "39.3903906"
 Parameter: ZMIN -> "32.3903906"
 SELRPN>      5 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "5"
 Comparing "5" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      3 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9239 NEG      CLA      57       CLA     -8731 PAA2     SER      319      CB            3.7657
 9239 NEG      CLA      57       CLA     -8737 PAA2     SER      319      O             4.2301
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "137"
Evaluating: 137
 Parameter: J <- "137"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "137" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "137"
 Parameter: NPOS -> "80"
Evaluating: 137-80
 Parameter: J <- "57"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "57"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.152118179"
Evaluating: (89.1533903-9.0)*(0.152118179-0.5)
 Parameter: XPOS <- "-27.8839074"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "7.697930704E-02"
Evaluating: (89.1533903-9.0)*(7.697930704E-02-0.5)
 Parameter: YPOS <- "-33.9065427"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.138963434"
Evaluating: (89.1533903-9.0)*(0.138963434-0.5)
 Parameter: ZPOS <- "-28.9383048"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   27.096524 XMAX =   27.096524 XAVE =   27.096524
    YMIN =   34.345701 YMAX =   34.345701 YAVE =   34.345701
    ZMIN =   35.890391 ZMAX =   35.890391 ZAVE =   35.890391
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-27.8839074"
 RDCMND substituted energy or value "?XAVE" to "27.0965238"
Evaluating: -27.8839074-27.0965238
 Parameter: XTRAN <- "-54.9804312"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-33.9065427"
 RDCMND substituted energy or value "?YAVE" to "34.3457007"
Evaluating: -33.9065427-34.3457007
 Parameter: YTRAN <- "-68.2522434"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.9383048"
 RDCMND substituted energy or value "?ZAVE" to "35.8903906"
Evaluating: -28.9383048-35.8903906
 Parameter: ZTRAN <- "-64.8286954"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-54.9804312"
 Parameter: YTRAN -> "-68.2522434"
 Parameter: ZTRAN -> "-64.8286954"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -54.980431  -68.252243  -64.828695
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.750714909"
Evaluating: 0.750714909*360.0
 Parameter: XPHI <- "270.257367"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.612286789"
Evaluating: 0.612286789*360.0
 Parameter: YPHI <- "220.423244"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.258316645"
Evaluating: 0.258316645*360.0
 Parameter: ZPHI <- "92.9939922"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-27.8839074"
 Parameter: YPOS -> "-33.9065427"
 Parameter: ZPOS -> "-28.9383048"
 Parameter: XPHI -> "270.257367"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.004492   -0.999990
    0.000000    0.999990    0.004492

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   89.74

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-27.8839074"
 Parameter: YPOS -> "-33.9065427"
 Parameter: ZPOS -> "-28.9383048"
 Parameter: YPHI -> "220.423244"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.761275    0.000000    0.648429
    0.000000    1.000000    0.000000
   -0.648429    0.000000   -0.761275

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  139.58

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-27.8839074"
 Parameter: YPOS -> "-33.9065427"
 Parameter: ZPOS -> "-28.9383048"
 Parameter: ZPHI -> "92.9939922"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.052231    0.998635    0.000000
   -0.998635   -0.052231    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   92.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -27.883907 XMAX =  -27.883907 XAVE =  -27.883907
    YMIN =  -33.906543 YMAX =  -33.906543 YAVE =  -33.906543
    ZMIN =  -28.938305 ZMAX =  -28.938305 ZAVE =  -28.938305
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-27.8839074"
Evaluating: -27.8839074+3.5
 Parameter: XMAX <- "-24.3839074"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-33.9065427"
Evaluating: -33.9065427+3.5
 Parameter: YMAX <- "-30.4065427"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.9383048"
Evaluating: -28.9383048+3.5
 Parameter: ZMAX <- "-25.4383048"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-27.8839074"
Evaluating: -27.8839074-3.5
 Parameter: XMIN <- "-31.3839074"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-33.9065427"
Evaluating: -33.9065427-3.5
 Parameter: YMIN <- "-37.4065427"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.9383048"
Evaluating: -28.9383048-3.5
 Parameter: ZMIN <- "-32.4383048"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-24.3839074"
 Parameter: XMIN -> "-31.3839074"
 Parameter: YMAX -> "-30.4065427"
 Parameter: YMIN -> "-37.4065427"
 Parameter: ZMAX -> "-25.4383048"
 Parameter: ZMIN -> "-32.4383048"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "138"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "138" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "138"
Evaluating: 138
 Parameter: J <- "138"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "138" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "138"
 Parameter: NPOS -> "80"
Evaluating: 138-80
 Parameter: J <- "58"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "58"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.952582373"
Evaluating: (89.1533903-9.0)*(0.952582373-0.5)
 Parameter: XPOS <- "36.2760116"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.43728643"
Evaluating: (89.1533903-9.0)*(0.43728643-0.5)
 Parameter: YPOS <- "-5.02670525"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.402077487"
Evaluating: (89.1533903-9.0)*(0.402077487-0.5)
 Parameter: ZPOS <- "-7.8488214"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "36.2760116"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 36.2760116-44.5766951
 Parameter: XTRAN <- "-8.3006835"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-5.02670525"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -5.02670525-44.5766951
 Parameter: YTRAN <- "-49.6034004"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-7.8488214"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -7.8488214-44.5766951
 Parameter: ZTRAN <- "-52.4255165"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-8.3006835"
 Parameter: YTRAN -> "-49.6034004"
 Parameter: ZTRAN -> "-52.4255165"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    -8.300683  -49.603400  -52.425517
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.85458655"
Evaluating: 0.85458655*360.0
 Parameter: XPHI <- "307.651158"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "5.811195437E-02"
Evaluating: 5.811195437E-02*360.0
 Parameter: YPHI <- "20.9203036"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.693503813"
Evaluating: 0.693503813*360.0
 Parameter: ZPHI <- "249.661373"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "36.2760116"
 Parameter: YPOS -> "-5.02670525"
 Parameter: ZPOS -> "-7.8488214"
 Parameter: XPHI -> "307.651158"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.610852   -0.791745
    0.000000    0.791745    0.610852

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   52.35

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "36.2760116"
 Parameter: YPOS -> "-5.02670525"
 Parameter: ZPOS -> "-7.8488214"
 Parameter: YPHI -> "20.9203036"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.934078    0.000000   -0.357069
    0.000000    1.000000    0.000000
    0.357069    0.000000    0.934078

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   20.92

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "36.2760116"
 Parameter: YPOS -> "-5.02670525"
 Parameter: ZPOS -> "-7.8488214"
 Parameter: ZPHI -> "249.661373"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.347568   -0.937655    0.000000
    0.937655   -0.347568    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  110.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   36.276012 XMAX =   36.276012 XAVE =   36.276012
    YMIN =   -5.026705 YMAX =   -5.026705 YAVE =   -5.026705
    ZMIN =   -7.848821 ZMAX =   -7.848821 ZAVE =   -7.848821
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "36.2760116"
Evaluating: 36.2760116+3.5
 Parameter: XMAX <- "39.7760116"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-5.02670523"
Evaluating: -5.02670523+3.5
 Parameter: YMAX <- "-1.52670523"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-7.84882144"
Evaluating: -7.84882144+3.5
 Parameter: ZMAX <- "-4.34882144"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "36.2760116"
Evaluating: 36.2760116-3.5
 Parameter: XMIN <- "32.7760116"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-5.02670523"
Evaluating: -5.02670523-3.5
 Parameter: YMIN <- "-8.52670523"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-7.84882144"
Evaluating: -7.84882144-3.5
 Parameter: ZMIN <- "-11.3488214"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "39.7760116"
 Parameter: XMIN -> "32.7760116"
 Parameter: YMAX -> "-1.52670523"
 Parameter: YMIN -> "-8.52670523"
 Parameter: ZMAX -> "-4.34882144"
 Parameter: ZMIN -> "-11.3488214"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "1"
 Comparing "1" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      1 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         0
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "139"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "139" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "139"
Evaluating: 139
 Parameter: J <- "139"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "139" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "139"
 Parameter: NPOS -> "80"
Evaluating: 139-80
 Parameter: J <- "59"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.134291515"
Evaluating: (89.1533903-9.0)*(0.134291515-0.5)
 Parameter: XPOS <- "-29.3127749"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.751133025"
Evaluating: (89.1533903-9.0)*(0.751133025-0.5)
 Parameter: YPOS <- "20.1291634"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.856083887"
Evaluating: (89.1533903-9.0)*(0.856083887-0.5)
 Parameter: ZPOS <- "28.5413308"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.3127749"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -29.3127749-44.5766951
 Parameter: XTRAN <- "-73.88947"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "20.1291634"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 20.1291634-44.5766951
 Parameter: YTRAN <- "-24.4475317"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "28.5413308"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 28.5413308-44.5766951
 Parameter: ZTRAN <- "-16.0353643"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-73.88947"
 Parameter: YTRAN -> "-24.4475317"
 Parameter: ZTRAN -> "-16.0353643"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -73.889470  -24.447532  -16.035364
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.966631123"
Evaluating: 0.966631123*360.0
 Parameter: XPHI <- "347.987204"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.425467309"
Evaluating: 0.425467309*360.0
 Parameter: YPHI <- "153.168231"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.251462415"
Evaluating: 0.251462415*360.0
 Parameter: ZPHI <- "90.5264694"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.3127749"
 Parameter: YPOS -> "20.1291634"
 Parameter: ZPOS -> "28.5413308"
 Parameter: XPHI -> "347.987204"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.978101   -0.208130
    0.000000    0.208130    0.978101

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   12.01

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.3127749"
 Parameter: YPOS -> "20.1291634"
 Parameter: ZPOS -> "28.5413308"
 Parameter: YPHI -> "153.168231"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.892336    0.000000   -0.451372
    0.000000    1.000000    0.000000
    0.451372    0.000000   -0.892336

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  153.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.3127749"
 Parameter: YPOS -> "20.1291634"
 Parameter: ZPOS -> "28.5413308"
 Parameter: ZPHI -> "90.5264694"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.009188    0.999958    0.000000
   -0.999958   -0.009188    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   90.53

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.312775 XMAX =  -29.312775 XAVE =  -29.312775
    YMIN =   20.129163 YMAX =   20.129163 YAVE =   20.129163
    ZMIN =   28.541331 ZMAX =   28.541331 ZAVE =   28.541331
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.3127749"
Evaluating: -29.3127749+3.5
 Parameter: XMAX <- "-25.8127749"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "20.1291634"
Evaluating: 20.1291634+3.5
 Parameter: YMAX <- "23.6291634"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "28.5413308"
Evaluating: 28.5413308+3.5
 Parameter: ZMAX <- "32.0413308"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.3127749"
Evaluating: -29.3127749-3.5
 Parameter: XMIN <- "-32.8127749"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "20.1291634"
Evaluating: 20.1291634-3.5
 Parameter: YMIN <- "16.6291634"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "28.5413308"
Evaluating: 28.5413308-3.5
 Parameter: ZMIN <- "25.0413308"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.8127749"
 Parameter: XMIN -> "-32.8127749"
 Parameter: YMAX -> "23.6291634"
 Parameter: YMIN -> "16.6291634"
 Parameter: ZMAX -> "32.0413308"
 Parameter: ZMIN -> "25.0413308"
 SELRPN>      8 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "8"
 Comparing "8" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      4 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9241 NEG      CLA      59       CLA     -7766 PAA2     TYR      249      CZ            3.5076
 9241 NEG      CLA      59       CLA     -7767 PAA2     TYR      249      OH            2.1776
 9241 NEG      CLA      59       CLA     -7771 PAA2     TYR      249      CE2           4.2499
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "139"
Evaluating: 139
 Parameter: J <- "139"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "139" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "139"
 Parameter: NPOS -> "80"
Evaluating: 139-80
 Parameter: J <- "59"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "59"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.630568224"
Evaluating: (89.1533903-9.0)*(0.630568224-0.5)
 Parameter: XPOS <- "10.4654858"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.92296489"
Evaluating: (89.1533903-9.0)*(0.92296489-0.5)
 Parameter: YPOS <- "33.9020699"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "2.426114485E-02"
Evaluating: (89.1533903-9.0)*(2.426114485E-02-0.5)
 Parameter: ZPOS <- "-38.1320821"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.312775 XMAX =  -29.312775 XAVE =  -29.312775
    YMIN =   20.129163 YMAX =   20.129163 YAVE =   20.129163
    ZMIN =   28.541331 ZMAX =   28.541331 ZAVE =   28.541331
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "10.4654858"
 RDCMND substituted energy or value "?XAVE" to "-29.3127749"
Evaluating: 10.4654858--29.3127749
 Parameter: XTRAN <- "39.7782607"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "33.9020699"
 RDCMND substituted energy or value "?YAVE" to "20.1291634"
Evaluating: 33.9020699-20.1291634
 Parameter: YTRAN <- "13.7729065"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-38.1320821"
 RDCMND substituted energy or value "?ZAVE" to "28.5413308"
Evaluating: -38.1320821-28.5413308
 Parameter: ZTRAN <- "-66.6734129"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "39.7782607"
 Parameter: YTRAN -> "13.7729065"
 Parameter: ZTRAN -> "-66.6734129"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    39.778261   13.772906  -66.673413
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.883023501"
Evaluating: 0.883023501*360.0
 Parameter: XPHI <- "317.88846"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.140041345"
Evaluating: 0.140041345*360.0
 Parameter: YPHI <- "50.4148842"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.554430815"
Evaluating: 0.554430815*360.0
 Parameter: ZPHI <- "199.595093"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "10.4654858"
 Parameter: YPOS -> "33.9020699"
 Parameter: ZPOS -> "-38.1320821"
 Parameter: XPHI -> "317.88846"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.741841   -0.670576
    0.000000    0.670576    0.741841

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   42.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "10.4654858"
 Parameter: YPOS -> "33.9020699"
 Parameter: ZPOS -> "-38.1320821"
 Parameter: YPHI -> "50.4148842"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.637224    0.000000   -0.770679
    0.000000    1.000000    0.000000
    0.770679    0.000000    0.637224

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   50.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "10.4654858"
 Parameter: YPOS -> "33.9020699"
 Parameter: ZPOS -> "-38.1320821"
 Parameter: ZPHI -> "199.595093"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.942086   -0.335371    0.000000
    0.335371   -0.942086    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  160.40

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   10.465486 XMAX =   10.465486 XAVE =   10.465486
    YMIN =   33.902070 YMAX =   33.902070 YAVE =   33.902070
    ZMIN =  -38.132082 ZMAX =  -38.132082 ZAVE =  -38.132082
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "10.4654858"
Evaluating: 10.4654858+3.5
 Parameter: XMAX <- "13.9654858"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "33.9020699"
Evaluating: 33.9020699+3.5
 Parameter: YMAX <- "37.4020699"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-38.1320821"
Evaluating: -38.1320821+3.5
 Parameter: ZMAX <- "-34.6320821"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "10.4654858"
Evaluating: 10.4654858-3.5
 Parameter: XMIN <- "6.9654858"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "33.9020699"
Evaluating: 33.9020699-3.5
 Parameter: YMIN <- "30.4020699"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-38.1320821"
Evaluating: -38.1320821-3.5
 Parameter: ZMIN <- "-41.6320821"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.9654858"
 Parameter: XMIN -> "6.9654858"
 Parameter: YMAX -> "37.4020699"
 Parameter: YMIN -> "30.4020699"
 Parameter: ZMAX -> "-34.6320821"
 Parameter: ZMIN -> "-41.6320821"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "140"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "140" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "140"
Evaluating: 140
 Parameter: J <- "140"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "140" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "140"
 Parameter: NPOS -> "80"
Evaluating: 140-80
 Parameter: J <- "60"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.624013949"
Evaluating: (89.1533903-9.0)*(0.624013949-0.5)
 Parameter: XPOS <- "9.94013846"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.3757913"
Evaluating: (89.1533903-9.0)*(0.3757913-0.5)
 Parameter: YPOS <- "-9.95574841"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.301532136"
Evaluating: (89.1533903-9.0)*(0.301532136-0.5)
 Parameter: ZPOS <- "-15.9078722"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "9.94013846"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 9.94013846-44.5766951
 Parameter: XTRAN <- "-34.6365566"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-9.95574841"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -9.95574841-44.5766951
 Parameter: YTRAN <- "-54.5324435"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-15.9078722"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -15.9078722-44.5766951
 Parameter: ZTRAN <- "-60.4845673"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-34.6365566"
 Parameter: YTRAN -> "-54.5324435"
 Parameter: ZTRAN -> "-60.4845673"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -34.636557  -54.532443  -60.484567
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.289901752"
Evaluating: 0.289901752*360.0
 Parameter: XPHI <- "104.364631"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.851082854"
Evaluating: 0.851082854*360.0
 Parameter: YPHI <- "306.389827"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.817075867"
Evaluating: 0.817075867*360.0
 Parameter: ZPHI <- "294.147312"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "9.94013846"
 Parameter: YPOS -> "-9.95574841"
 Parameter: ZPOS -> "-15.9078722"
 Parameter: XPHI -> "104.364631"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.248092    0.968736
    0.000000   -0.968736   -0.248092

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  104.36

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "9.94013846"
 Parameter: YPOS -> "-9.95574841"
 Parameter: ZPOS -> "-15.9078722"
 Parameter: YPHI -> "306.389827"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.593276    0.000000    0.804999
    0.000000    1.000000    0.000000
   -0.804999    0.000000    0.593276

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   53.61

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "9.94013846"
 Parameter: YPOS -> "-9.95574841"
 Parameter: ZPOS -> "-15.9078722"
 Parameter: ZPHI -> "294.147312"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.409084   -0.912497    0.000000
    0.912497    0.409084    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   65.85

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.940138 XMAX =    9.940138 XAVE =    9.940138
    YMIN =   -9.955748 YMAX =   -9.955748 YAVE =   -9.955748
    ZMIN =  -15.907872 ZMAX =  -15.907872 ZAVE =  -15.907872
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "9.94013847"
Evaluating: 9.94013847+3.5
 Parameter: XMAX <- "13.4401385"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-9.9557484"
Evaluating: -9.9557484+3.5
 Parameter: YMAX <- "-6.4557484"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-15.9078722"
Evaluating: -15.9078722+3.5
 Parameter: ZMAX <- "-12.4078722"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "9.94013847"
Evaluating: 9.94013847-3.5
 Parameter: XMIN <- "6.44013847"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-9.9557484"
Evaluating: -9.9557484-3.5
 Parameter: YMIN <- "-13.4557484"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-15.9078722"
Evaluating: -15.9078722-3.5
 Parameter: ZMIN <- "-19.4078722"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "13.4401385"
 Parameter: XMIN -> "6.44013847"
 Parameter: YMAX -> "-6.4557484"
 Parameter: YMIN -> "-13.4557484"
 Parameter: ZMAX -> "-12.4078722"
 Parameter: ZMIN -> "-19.4078722"
 SELRPN>     10 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "10"
 Comparing "10" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      4 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9242 NEG      CLA      60       CLA     -3323 PAA1     LEU      256      O             3.0424
 9242 NEG      CLA      60       CLA     -3385 PAA1     ALA      262      CB            4.3155
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         2
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "2"
 Comparing "2" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "140"
Evaluating: 140
 Parameter: J <- "140"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "140" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "140"
 Parameter: NPOS -> "80"
Evaluating: 140-80
 Parameter: J <- "60"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "60"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.494064842"
Evaluating: (89.1533903-9.0)*(0.494064842-0.5)
 Parameter: XPOS <- "-0.475723036"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.777082966"
Evaluating: (89.1533903-9.0)*(0.777082966-0.5)
 Parameter: YPOS <- "22.2091391"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.141621488"
Evaluating: (89.1533903-9.0)*(0.141621488-0.5)
 Parameter: ZPOS <- "-28.7252527"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    9.940138 XMAX =    9.940138 XAVE =    9.940138
    YMIN =   -9.955748 YMAX =   -9.955748 YAVE =   -9.955748
    ZMIN =  -15.907872 ZMAX =  -15.907872 ZAVE =  -15.907872
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-0.475723036"
 RDCMND substituted energy or value "?XAVE" to "9.94013847"
Evaluating: -0.475723036-9.94013847
 Parameter: XTRAN <- "-10.4158615"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "22.2091391"
 RDCMND substituted energy or value "?YAVE" to "-9.9557484"
Evaluating: 22.2091391--9.9557484
 Parameter: YTRAN <- "32.1648875"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-28.7252527"
 RDCMND substituted energy or value "?ZAVE" to "-15.9078722"
Evaluating: -28.7252527--15.9078722
 Parameter: ZTRAN <- "-12.8173805"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-10.4158615"
 Parameter: YTRAN -> "32.1648875"
 Parameter: ZTRAN -> "-12.8173805"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -10.415862   32.164887  -12.817381
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.33775182"
Evaluating: 0.33775182*360.0
 Parameter: XPHI <- "121.590655"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.976237433"
Evaluating: 0.976237433*360.0
 Parameter: YPHI <- "351.445476"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.905652562"
Evaluating: 0.905652562*360.0
 Parameter: ZPHI <- "326.034922"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-0.475723036"
 Parameter: YPOS -> "22.2091391"
 Parameter: ZPOS -> "-28.7252527"
 Parameter: XPHI -> "121.590655"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.523847    0.851812
    0.000000   -0.851812   -0.523847

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  121.59

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-0.475723036"
 Parameter: YPOS -> "22.2091391"
 Parameter: ZPOS -> "-28.7252527"
 Parameter: YPHI -> "351.445476"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.988875    0.000000    0.148751
    0.000000    1.000000    0.000000
   -0.148751    0.000000    0.988875

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    8.55

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-0.475723036"
 Parameter: YPOS -> "22.2091391"
 Parameter: ZPOS -> "-28.7252527"
 Parameter: ZPHI -> "326.034922"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.829378   -0.558687    0.000000
    0.558687    0.829378    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   33.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -0.475723 XMAX =   -0.475723 XAVE =   -0.475723
    YMIN =   22.209139 YMAX =   22.209139 YAVE =   22.209139
    ZMIN =  -28.725253 ZMAX =  -28.725253 ZAVE =  -28.725253
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-0.475723011"
Evaluating: -0.475723011+3.5
 Parameter: XMAX <- "3.02427699"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "22.2091391"
Evaluating: 22.2091391+3.5
 Parameter: YMAX <- "25.7091391"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-28.7252527"
Evaluating: -28.7252527+3.5
 Parameter: ZMAX <- "-25.2252527"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-0.475723011"
Evaluating: -0.475723011-3.5
 Parameter: XMIN <- "-3.97572301"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "22.2091391"
Evaluating: 22.2091391-3.5
 Parameter: YMIN <- "18.7091391"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-28.7252527"
Evaluating: -28.7252527-3.5
 Parameter: ZMIN <- "-32.2252527"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "3.02427699"
 Parameter: XMIN -> "-3.97572301"
 Parameter: YMAX -> "25.7091391"
 Parameter: YMIN -> "18.7091391"
 Parameter: ZMAX -> "-25.2252527"
 Parameter: ZMIN -> "-32.2252527"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "141"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "141" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "141"
Evaluating: 141
 Parameter: J <- "141"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "141" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "141"
 Parameter: NPOS -> "80"
Evaluating: 141-80
 Parameter: J <- "61"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "61"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.604802849"
Evaluating: (89.1533903-9.0)*(0.604802849-0.5)
 Parameter: XPOS <- "8.40030366"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.614484214"
Evaluating: (89.1533903-9.0)*(0.614484214-0.5)
 Parameter: YPOS <- "9.17629789"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.579125837"
Evaluating: (89.1533903-9.0)*(0.579125837-0.5)
 Parameter: ZPOS <- "6.3422041"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "8.40030366"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 8.40030366-44.5766951
 Parameter: XTRAN <- "-36.1763914"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "9.17629789"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 9.17629789-44.5766951
 Parameter: YTRAN <- "-35.4003972"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "6.3422041"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 6.3422041-44.5766951
 Parameter: ZTRAN <- "-38.234491"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-36.1763914"
 Parameter: YTRAN -> "-35.4003972"
 Parameter: ZTRAN -> "-38.234491"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -36.176391  -35.400397  -38.234491
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.549692081"
Evaluating: 0.549692081*360.0
 Parameter: XPHI <- "197.889149"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.924378472"
Evaluating: 0.924378472*360.0
 Parameter: YPHI <- "332.77625"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.990102635"
Evaluating: 0.990102635*360.0
 Parameter: ZPHI <- "356.436949"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "8.40030366"
 Parameter: YPOS -> "9.17629789"
 Parameter: ZPOS -> "6.3422041"
 Parameter: XPHI -> "197.889149"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.951653   -0.307176
    0.000000    0.307176   -0.951653

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  162.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "8.40030366"
 Parameter: YPOS -> "9.17629789"
 Parameter: ZPOS -> "6.3422041"
 Parameter: YPHI -> "332.77625"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.889227    0.000000    0.457467
    0.000000    1.000000    0.000000
   -0.457467    0.000000    0.889227

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   27.22

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "8.40030366"
 Parameter: YPOS -> "9.17629789"
 Parameter: ZPOS -> "6.3422041"
 Parameter: ZPHI -> "356.436949"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.998067   -0.062147    0.000000
    0.062147    0.998067    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS    3.56

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    8.400304 XMAX =    8.400304 XAVE =    8.400304
    YMIN =    9.176298 YMAX =    9.176298 YAVE =    9.176298
    ZMIN =    6.342204 ZMAX =    6.342204 ZAVE =    6.342204
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "8.4003037"
Evaluating: 8.4003037+3.5
 Parameter: XMAX <- "11.9003037"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "9.17629788"
Evaluating: 9.17629788+3.5
 Parameter: YMAX <- "12.6762979"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "6.34220408"
Evaluating: 6.34220408+3.5
 Parameter: ZMAX <- "9.84220408"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "8.4003037"
Evaluating: 8.4003037-3.5
 Parameter: XMIN <- "4.9003037"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "9.17629788"
Evaluating: 9.17629788-3.5
 Parameter: YMIN <- "5.67629788"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "6.34220408"
Evaluating: 6.34220408-3.5
 Parameter: ZMIN <- "2.84220408"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "11.9003037"
 Parameter: XMIN -> "4.9003037"
 Parameter: YMAX -> "12.6762979"
 Parameter: YMIN -> "5.67629788"
 Parameter: ZMAX -> "9.84220408"
 Parameter: ZMIN -> "2.84220408"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "142"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "142" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "142"
Evaluating: 142
 Parameter: J <- "142"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "142" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "142"
 Parameter: NPOS -> "80"
Evaluating: 142-80
 Parameter: J <- "62"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "5.61702776E-02"
Evaluating: (89.1533903-9.0)*(5.61702776E-02-0.5)
 Parameter: XPOS <- "-35.574457"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.484644971"
Evaluating: (89.1533903-9.0)*(0.484644971-0.5)
 Parameter: YPOS <- "-1.23075763"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.824278282"
Evaluating: (89.1533903-9.0)*(0.824278282-0.5)
 Parameter: ZPOS <- "25.9920037"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-35.574457"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -35.574457-44.5766951
 Parameter: XTRAN <- "-80.1511521"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-1.23075763"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -1.23075763-44.5766951
 Parameter: YTRAN <- "-45.8074527"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "25.9920037"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 25.9920037-44.5766951
 Parameter: ZTRAN <- "-18.5846914"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-80.1511521"
 Parameter: YTRAN -> "-45.8074527"
 Parameter: ZTRAN -> "-18.5846914"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -80.151152  -45.807453  -18.584691
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.392336814"
Evaluating: 0.392336814*360.0
 Parameter: XPHI <- "141.241253"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.485432873"
Evaluating: 0.485432873*360.0
 Parameter: YPHI <- "174.755834"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.888320872"
Evaluating: 0.888320872*360.0
 Parameter: ZPHI <- "319.795514"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-35.574457"
 Parameter: YPOS -> "-1.23075763"
 Parameter: ZPOS -> "25.9920037"
 Parameter: XPHI -> "141.241253"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.779789    0.626043
    0.000000   -0.626043   -0.779789

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS  141.24

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-35.574457"
 Parameter: YPOS -> "-1.23075763"
 Parameter: ZPOS -> "25.9920037"
 Parameter: YPHI -> "174.755834"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.995814    0.000000   -0.091400
    0.000000    1.000000    0.000000
    0.091400    0.000000   -0.995814

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  174.76

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-35.574457"
 Parameter: YPOS -> "-1.23075763"
 Parameter: ZPOS -> "25.9920037"
 Parameter: ZPHI -> "319.795514"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.763745   -0.645517    0.000000
    0.645517    0.763745    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   40.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.574457 XMAX =  -35.574457 XAVE =  -35.574457
    YMIN =   -1.230758 YMAX =   -1.230758 YAVE =   -1.230758
    ZMIN =   25.992004 ZMAX =   25.992004 ZAVE =   25.992004
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-35.574457"
Evaluating: -35.574457+3.5
 Parameter: XMAX <- "-32.074457"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-1.23075765"
Evaluating: -1.23075765+3.5
 Parameter: YMAX <- "2.26924235"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "25.9920037"
Evaluating: 25.9920037+3.5
 Parameter: ZMAX <- "29.4920037"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-35.574457"
Evaluating: -35.574457-3.5
 Parameter: XMIN <- "-39.074457"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-1.23075765"
Evaluating: -1.23075765-3.5
 Parameter: YMIN <- "-4.73075765"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "25.9920037"
Evaluating: 25.9920037-3.5
 Parameter: ZMIN <- "22.4920037"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-32.074457"
 Parameter: XMIN -> "-39.074457"
 Parameter: YMAX -> "2.26924235"
 Parameter: YMIN -> "-4.73075765"
 Parameter: ZMAX -> "29.4920037"
 Parameter: ZMIN -> "22.4920037"
 SELRPN>     22 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "22"
 Comparing "22" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>     13 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9244 NEG      CLA      62       CLA     -7075 PAA2     SER      186      CA            3.9750
 9244 NEG      CLA      62       CLA     -7082 PAA2     SER      186      C             3.4616
 9244 NEG      CLA      62       CLA     -7083 PAA2     SER      186      O             3.9744
 9244 NEG      CLA      62       CLA     -7084 PAA2     GLN      187      N             3.1512
 9244 NEG      CLA      62       CLA     -7086 PAA2     GLN      187      CA            3.4547
 9244 NEG      CLA      62       CLA     -7088 PAA2     GLN      187      CB            4.3641
 9244 NEG      CLA      62       CLA     -7099 PAA2     GLN      187      C             2.7339
 9244 NEG      CLA      62       CLA     -7101 PAA2     GLY      188      N             1.5053
 9244 NEG      CLA      62       CLA     -7103 PAA2     GLY      188      CA            1.9945
 9244 NEG      CLA      62       CLA     -7106 PAA2     GLY      188      C             3.0987
 9244 NEG      CLA      62       CLA     -7107 PAA2     GLY      188      O             4.1390
 9244 NEG      CLA      62       CLA     -7108 PAA2     ALA      189      N             3.4133
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =        12
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "142"
Evaluating: 142
 Parameter: J <- "142"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "142" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "142"
 Parameter: NPOS -> "80"
Evaluating: 142-80
 Parameter: J <- "62"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "62"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "8.310601881E-02"
Evaluating: (89.1533903-9.0)*(8.310601881E-02-0.5)
 Parameter: XPOS <- "-33.415466"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.688392518"
Evaluating: (89.1533903-9.0)*(0.688392518-0.5)
 Parameter: YPOS <- "15.100299"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.20441882"
Evaluating: (89.1533903-9.0)*(0.20441882-0.5)
 Parameter: ZPOS <- "-23.6918337"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -35.574457 XMAX =  -35.574457 XAVE =  -35.574457
    YMIN =   -1.230758 YMAX =   -1.230758 YAVE =   -1.230758
    ZMIN =   25.992004 ZMAX =   25.992004 ZAVE =   25.992004
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-33.415466"
 RDCMND substituted energy or value "?XAVE" to "-35.574457"
Evaluating: -33.415466--35.574457
 Parameter: XTRAN <- "2.158991"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "15.100299"
 RDCMND substituted energy or value "?YAVE" to "-1.23075765"
Evaluating: 15.100299--1.23075765
 Parameter: YTRAN <- "16.3310567"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-23.6918337"
 RDCMND substituted energy or value "?ZAVE" to "25.9920037"
Evaluating: -23.6918337-25.9920037
 Parameter: ZTRAN <- "-49.6838374"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "2.158991"
 Parameter: YTRAN -> "16.3310567"
 Parameter: ZTRAN -> "-49.6838374"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR     2.158991   16.331057  -49.683837
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.589734202"
Evaluating: 0.589734202*360.0
 Parameter: XPHI <- "212.304313"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.772238864"
Evaluating: 0.772238864*360.0
 Parameter: YPHI <- "278.005991"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.918898033"
Evaluating: 0.918898033*360.0
 Parameter: ZPHI <- "330.803292"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-33.415466"
 Parameter: YPOS -> "15.100299"
 Parameter: ZPOS -> "-23.6918337"
 Parameter: XPHI -> "212.304313"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.845222   -0.534416
    0.000000    0.534416   -0.845222

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  147.70

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-33.415466"
 Parameter: YPOS -> "15.100299"
 Parameter: ZPOS -> "-23.6918337"
 Parameter: YPHI -> "278.005991"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.139277    0.000000    0.990254
    0.000000    1.000000    0.000000
   -0.990254    0.000000    0.139277

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS   81.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-33.415466"
 Parameter: YPOS -> "15.100299"
 Parameter: ZPOS -> "-23.6918337"
 Parameter: ZPHI -> "330.803292"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.872950   -0.487810    0.000000
    0.487810    0.872950    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   29.20

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -33.415466 XMAX =  -33.415466 XAVE =  -33.415466
    YMIN =   15.100299 YMAX =   15.100299 YAVE =   15.100299
    ZMIN =  -23.691834 ZMAX =  -23.691834 ZAVE =  -23.691834
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-33.415466"
Evaluating: -33.415466+3.5
 Parameter: XMAX <- "-29.915466"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "15.100299"
Evaluating: 15.100299+3.5
 Parameter: YMAX <- "18.600299"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-23.6918337"
Evaluating: -23.6918337+3.5
 Parameter: ZMAX <- "-20.1918337"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-33.415466"
Evaluating: -33.415466-3.5
 Parameter: XMIN <- "-36.915466"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "15.100299"
Evaluating: 15.100299-3.5
 Parameter: YMIN <- "11.600299"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-23.6918337"
Evaluating: -23.6918337-3.5
 Parameter: ZMIN <- "-27.1918337"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-29.915466"
 Parameter: XMIN -> "-36.915466"
 Parameter: YMAX -> "18.600299"
 Parameter: YMIN -> "11.600299"
 Parameter: ZMAX -> "-20.1918337"
 Parameter: ZMIN -> "-27.1918337"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "143"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "143" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "143"
Evaluating: 143
 Parameter: J <- "143"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "143" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "143"
 Parameter: NPOS -> "80"
Evaluating: 143-80
 Parameter: J <- "63"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "63"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.809899496"
Evaluating: (89.1533903-9.0)*(0.809899496-0.5)
 Parameter: XPOS <- "24.8394953"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.89986152"
Evaluating: (89.1533903-9.0)*(0.89986152-0.5)
 Parameter: YPOS <- "32.0502565"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.548098363"
Evaluating: (89.1533903-9.0)*(0.548098363-0.5)
 Parameter: ZPOS <- "3.85524686"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "24.8394953"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 24.8394953-44.5766951
 Parameter: XTRAN <- "-19.7371998"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "32.0502565"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: 32.0502565-44.5766951
 Parameter: YTRAN <- "-12.5264386"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "3.85524686"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 3.85524686-44.5766951
 Parameter: ZTRAN <- "-40.7214482"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-19.7371998"
 Parameter: YTRAN -> "-12.5264386"
 Parameter: ZTRAN -> "-40.7214482"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -19.737200  -12.526439  -40.721448
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.141637203"
Evaluating: 0.141637203*360.0
 Parameter: XPHI <- "50.9893931"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.662956171"
Evaluating: 0.662956171*360.0
 Parameter: YPHI <- "238.664222"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.68103873"
Evaluating: 0.68103873*360.0
 Parameter: ZPHI <- "245.173943"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "24.8394953"
 Parameter: YPOS -> "32.0502565"
 Parameter: ZPOS -> "3.85524686"
 Parameter: XPHI -> "50.9893931"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.629464    0.777029
    0.000000   -0.777029    0.629464

 AXIS OF ROTATION IS  1.000000  0.000000  0.000000  ANGLE IS   50.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "24.8394953"
 Parameter: YPOS -> "32.0502565"
 Parameter: ZPOS -> "3.85524686"
 Parameter: YPHI -> "238.664222"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.520053    0.000000    0.854134
    0.000000    1.000000    0.000000
   -0.854134    0.000000   -0.520053

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  121.34

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "24.8394953"
 Parameter: YPOS -> "32.0502565"
 Parameter: ZPOS -> "3.85524686"
 Parameter: ZPHI -> "245.173943"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.419865   -0.907587    0.000000
    0.907587   -0.419865    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  114.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   24.839495 XMAX =   24.839495 XAVE =   24.839495
    YMIN =   32.050257 YMAX =   32.050257 YAVE =   32.050257
    ZMIN =    3.855247 ZMAX =    3.855247 ZAVE =    3.855247
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "24.8394953"
Evaluating: 24.8394953+3.5
 Parameter: XMAX <- "28.3394953"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "32.0502565"
Evaluating: 32.0502565+3.5
 Parameter: YMAX <- "35.5502565"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "3.85524685"
Evaluating: 3.85524685+3.5
 Parameter: ZMAX <- "7.35524685"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "24.8394953"
Evaluating: 24.8394953-3.5
 Parameter: XMIN <- "21.3394953"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "32.0502565"
Evaluating: 32.0502565-3.5
 Parameter: YMIN <- "28.5502565"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "3.85524685"
Evaluating: 3.85524685-3.5
 Parameter: ZMIN <- "0.35524685"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "28.3394953"
 Parameter: XMIN -> "21.3394953"
 Parameter: YMAX -> "35.5502565"
 Parameter: YMIN -> "28.5502565"
 Parameter: ZMAX -> "7.35524685"
 Parameter: ZMIN -> "0.35524685"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "144"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "144" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "144"
Evaluating: 144
 Parameter: J <- "144"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "144" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "144"
 Parameter: NPOS -> "80"
Evaluating: 144-80
 Parameter: J <- "64"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "64"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.821928659"
Evaluating: (89.1533903-9.0)*(0.821928659-0.5)
 Parameter: XPOS <- "25.8036735"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.294068259"
Evaluating: (89.1533903-9.0)*(0.294068259-0.5)
 Parameter: YPOS <- "-16.5061272"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.781864206"
Evaluating: (89.1533903-9.0)*(0.781864206-0.5)
 Parameter: ZPOS <- "22.5923717"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "25.8036735"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 25.8036735-44.5766951
 Parameter: XTRAN <- "-18.7730216"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-16.5061272"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -16.5061272-44.5766951
 Parameter: YTRAN <- "-61.0828223"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "22.5923717"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 22.5923717-44.5766951
 Parameter: ZTRAN <- "-21.9843234"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-18.7730216"
 Parameter: YTRAN -> "-61.0828223"
 Parameter: ZTRAN -> "-21.9843234"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -18.773022  -61.082822  -21.984323
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.910867886"
Evaluating: 0.910867886*360.0
 Parameter: XPHI <- "327.912439"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.598678913"
Evaluating: 0.598678913*360.0
 Parameter: YPHI <- "215.524409"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.295086199"
Evaluating: 0.295086199*360.0
 Parameter: ZPHI <- "106.231032"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "25.8036735"
 Parameter: YPOS -> "-16.5061272"
 Parameter: ZPOS -> "22.5923717"
 Parameter: XPHI -> "327.912439"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.847237   -0.531215
    0.000000    0.531215    0.847237

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   32.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "25.8036735"
 Parameter: YPOS -> "-16.5061272"
 Parameter: ZPOS -> "22.5923717"
 Parameter: YPHI -> "215.524409"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.813868    0.000000    0.581050
    0.000000    1.000000    0.000000
   -0.581050    0.000000   -0.813868

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  144.48

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "25.8036735"
 Parameter: YPOS -> "-16.5061272"
 Parameter: ZPOS -> "22.5923717"
 Parameter: ZPHI -> "106.231032"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.279511    0.960142    0.000000
   -0.960142   -0.279511    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  106.23

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   25.803674 XMAX =   25.803674 XAVE =   25.803674
    YMIN =  -16.506127 YMAX =  -16.506127 YAVE =  -16.506127
    ZMIN =   22.592372 ZMAX =   22.592372 ZAVE =   22.592372
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "25.8036735"
Evaluating: 25.8036735+3.5
 Parameter: XMAX <- "29.3036735"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-16.5061272"
Evaluating: -16.5061272+3.5
 Parameter: YMAX <- "-13.0061272"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "22.5923717"
Evaluating: 22.5923717+3.5
 Parameter: ZMAX <- "26.0923717"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "25.8036735"
Evaluating: 25.8036735-3.5
 Parameter: XMIN <- "22.3036735"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-16.5061272"
Evaluating: -16.5061272-3.5
 Parameter: YMIN <- "-20.0061272"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "22.5923717"
Evaluating: 22.5923717-3.5
 Parameter: ZMIN <- "19.0923717"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "29.3036735"
 Parameter: XMIN -> "22.3036735"
 Parameter: YMAX -> "-13.0061272"
 Parameter: YMIN -> "-20.0061272"
 Parameter: ZMAX -> "26.0923717"
 Parameter: ZMIN -> "19.0923717"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "145"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "145" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "145"
Evaluating: 145
 Parameter: J <- "145"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "145" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "145"
 Parameter: NPOS -> "80"
Evaluating: 145-80
 Parameter: J <- "65"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "65"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.136930037"
Evaluating: (89.1533903-9.0)*(0.136930037-0.5)
 Parameter: XPOS <- "-29.1012885"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.231704468"
Evaluating: (89.1533903-9.0)*(0.231704468-0.5)
 Parameter: YPOS <- "-21.5047965"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.250242019"
Evaluating: (89.1533903-9.0)*(0.250242019-0.5)
 Parameter: ZPOS <- "-20.0189489"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.1012885"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -29.1012885-44.5766951
 Parameter: XTRAN <- "-73.6779836"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-21.5047965"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -21.5047965-44.5766951
 Parameter: YTRAN <- "-66.0814916"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-20.0189489"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -20.0189489-44.5766951
 Parameter: ZTRAN <- "-64.595644"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-73.6779836"
 Parameter: YTRAN -> "-66.0814916"
 Parameter: ZTRAN -> "-64.595644"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -73.677984  -66.081492  -64.595644
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.704408374"
Evaluating: 0.704408374*360.0
 Parameter: XPHI <- "253.587015"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.227993302"
Evaluating: 0.227993302*360.0
 Parameter: YPHI <- "82.0775887"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.349966034"
Evaluating: 0.349966034*360.0
 Parameter: ZPHI <- "125.987772"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.1012885"
 Parameter: YPOS -> "-21.5047965"
 Parameter: ZPOS -> "-20.0189489"
 Parameter: XPHI -> "253.587015"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.282559   -0.959250
    0.000000    0.959250   -0.282559

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  106.41

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.1012885"
 Parameter: YPOS -> "-21.5047965"
 Parameter: ZPOS -> "-20.0189489"
 Parameter: YPHI -> "82.0775887"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.137832    0.000000   -0.990456
    0.000000    1.000000    0.000000
    0.990456    0.000000    0.137832

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS   82.08

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.1012885"
 Parameter: YPOS -> "-21.5047965"
 Parameter: ZPOS -> "-20.0189489"
 Parameter: ZPHI -> "125.987772"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.587613    0.809142    0.000000
   -0.809142   -0.587613    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  125.99

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.101289 XMAX =  -29.101289 XAVE =  -29.101289
    YMIN =  -21.504797 YMAX =  -21.504797 YAVE =  -21.504797
    ZMIN =  -20.018949 ZMAX =  -20.018949 ZAVE =  -20.018949
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.1012885"
Evaluating: -29.1012885+3.5
 Parameter: XMAX <- "-25.6012885"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-21.5047965"
Evaluating: -21.5047965+3.5
 Parameter: YMAX <- "-18.0047965"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-20.0189489"
Evaluating: -20.0189489+3.5
 Parameter: ZMAX <- "-16.5189489"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.1012885"
Evaluating: -29.1012885-3.5
 Parameter: XMIN <- "-32.6012885"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-21.5047965"
Evaluating: -21.5047965-3.5
 Parameter: YMIN <- "-25.0047965"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-20.0189489"
Evaluating: -20.0189489-3.5
 Parameter: ZMIN <- "-23.5189489"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-25.6012885"
 Parameter: XMIN -> "-32.6012885"
 Parameter: YMAX -> "-18.0047965"
 Parameter: YMIN -> "-25.0047965"
 Parameter: ZMAX -> "-16.5189489"
 Parameter: ZMIN -> "-23.5189489"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "146"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "146" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "146"
Evaluating: 146
 Parameter: J <- "146"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "146" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "146"
 Parameter: NPOS -> "80"
Evaluating: 146-80
 Parameter: J <- "66"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.51170597"
Evaluating: (89.1533903-9.0)*(0.51170597-0.5)
 Parameter: XPOS <- "0.938273182"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.388972429"
Evaluating: (89.1533903-9.0)*(0.388972429-0.5)
 Parameter: YPOS <- "-8.89923623"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.70173215"
Evaluating: (89.1533903-9.0)*(0.70173215-0.5)
 Parameter: ZPOS <- "16.1695158"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "0.938273182"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 0.938273182-44.5766951
 Parameter: XTRAN <- "-43.6384219"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-8.89923623"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -8.89923623-44.5766951
 Parameter: YTRAN <- "-53.4759313"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "16.1695158"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 16.1695158-44.5766951
 Parameter: ZTRAN <- "-28.4071793"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-43.6384219"
 Parameter: YTRAN -> "-53.4759313"
 Parameter: ZTRAN -> "-28.4071793"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -43.638422  -53.475931  -28.407179
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.780309191"
Evaluating: 0.780309191*360.0
 Parameter: XPHI <- "280.911309"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.978246468"
Evaluating: 0.978246468*360.0
 Parameter: YPHI <- "352.168728"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.598424896"
Evaluating: 0.598424896*360.0
 Parameter: ZPHI <- "215.432963"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "0.938273182"
 Parameter: YPOS -> "-8.89923623"
 Parameter: ZPOS -> "16.1695158"
 Parameter: XPHI -> "280.911309"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.189289   -0.981921
    0.000000    0.981921    0.189289

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   79.09

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "0.938273182"
 Parameter: YPOS -> "-8.89923623"
 Parameter: ZPOS -> "16.1695158"
 Parameter: YPHI -> "352.168728"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.990674    0.000000    0.136256
    0.000000    1.000000    0.000000
   -0.136256    0.000000    0.990674

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS    7.83

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "0.938273182"
 Parameter: YPOS -> "-8.89923623"
 Parameter: ZPOS -> "16.1695158"
 Parameter: ZPHI -> "215.432963"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.814794   -0.579750    0.000000
    0.579750   -0.814794    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS  144.57

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.938273 XMAX =    0.938273 XAVE =    0.938273
    YMIN =   -8.899236 YMAX =   -8.899236 YAVE =   -8.899236
    ZMIN =   16.169516 ZMAX =   16.169516 ZAVE =   16.169516
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "0.938273161"
Evaluating: 0.938273161+3.5
 Parameter: XMAX <- "4.43827316"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-8.89923622"
Evaluating: -8.89923622+3.5
 Parameter: YMAX <- "-5.39923622"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "16.1695158"
Evaluating: 16.1695158+3.5
 Parameter: ZMAX <- "19.6695158"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "0.938273161"
Evaluating: 0.938273161-3.5
 Parameter: XMIN <- "-2.56172684"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-8.89923622"
Evaluating: -8.89923622-3.5
 Parameter: YMIN <- "-12.3992362"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "16.1695158"
Evaluating: 16.1695158-3.5
 Parameter: ZMIN <- "12.6695158"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "4.43827316"
 Parameter: XMIN -> "-2.56172684"
 Parameter: YMAX -> "-5.39923622"
 Parameter: YMIN -> "-12.3992362"
 Parameter: ZMAX -> "19.6695158"
 Parameter: ZMIN -> "12.6695158"
 SELRPN>     12 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "12"
 Comparing "12" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>               coor dist cut 4.5 sele target end sele JUNK .and. .not. hydrogen end image
 SELRPN>      1 atoms have been selected out of  14712
 SELRPN>      5 atoms have been selected out of  14712

            DISTANCES FOR SELECTED ATOMS
 9248 NEG      CLA      66       CLA     -1834 PAA1     GLN      127      O             4.4730
 9248 NEG      CLA      66       CLA     -1874 PAA1     SER      130      CB            3.3071
 9248 NEG      CLA      66       CLA     -1877 PAA1     SER      130      OG            3.8062
 TOTAL EXCLUSION COUNT =         0
 TOTAL 1-4 EXCLUSIONS  =         0
 TOTAL NON-EXCLUSIONS  =         3
  
 CHARMM>               if ?npair .gt. 0 goto doinit
 RDCMND substituted energy or value "?NPAIR" to "3"
 Comparing "3" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "1"
Evaluating: 1+1
 Parameter: CNTRAND <- "2"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "2" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "146"
Evaluating: 146
 Parameter: J <- "146"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "146" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "146"
 Parameter: NPOS -> "80"
Evaluating: 146-80
 Parameter: J <- "66"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "66"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.435998599"
Evaluating: (89.1533903-9.0)*(0.435998599-0.5)
 Parameter: XPOS <- "-5.12992927"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.313654072"
Evaluating: (89.1533903-9.0)*(0.313654072-0.5)
 Parameter: YPOS <- "-14.9362579"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.829052437"
Evaluating: (89.1533903-9.0)*(0.829052437-0.5)
 Parameter: ZPOS <- "26.3746684"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    0.938273 XMAX =    0.938273 XAVE =    0.938273
    YMIN =   -8.899236 YMAX =   -8.899236 YAVE =   -8.899236
    ZMIN =   16.169516 ZMAX =   16.169516 ZAVE =   16.169516
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-5.12992927"
 RDCMND substituted energy or value "?XAVE" to "0.938273161"
Evaluating: -5.12992927-0.938273161
 Parameter: XTRAN <- "-6.06820243"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-14.9362579"
 RDCMND substituted energy or value "?YAVE" to "-8.89923622"
Evaluating: -14.9362579--8.89923622
 Parameter: YTRAN <- "-6.03702168"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "26.3746684"
 RDCMND substituted energy or value "?ZAVE" to "16.1695158"
Evaluating: 26.3746684-16.1695158
 Parameter: ZTRAN <- "10.2051526"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-6.06820243"
 Parameter: YTRAN -> "-6.03702168"
 Parameter: ZTRAN -> "10.2051526"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR    -6.068202   -6.037022   10.205153
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.843142776"
Evaluating: 0.843142776*360.0
 Parameter: XPHI <- "303.531399"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.286285915"
Evaluating: 0.286285915*360.0
 Parameter: YPHI <- "103.062929"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.843967798"
Evaluating: 0.843967798*360.0
 Parameter: ZPHI <- "303.828407"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-5.12992927"
 Parameter: YPOS -> "-14.9362579"
 Parameter: ZPOS -> "26.3746684"
 Parameter: XPHI -> "303.531399"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.552394   -0.833583
    0.000000    0.833583    0.552394

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   56.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-5.12992927"
 Parameter: YPOS -> "-14.9362579"
 Parameter: ZPOS -> "26.3746684"
 Parameter: YPHI -> "103.062929"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.226021    0.000000   -0.974122
    0.000000    1.000000    0.000000
    0.974122    0.000000   -0.226021

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  103.06

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-5.12992927"
 Parameter: YPOS -> "-14.9362579"
 Parameter: ZPOS -> "26.3746684"
 Parameter: ZPHI -> "303.828407"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.556708   -0.830709    0.000000
    0.830709    0.556708    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000 -1.000000  ANGLE IS   56.17

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   -5.129929 XMAX =   -5.129929 XAVE =   -5.129929
    YMIN =  -14.936258 YMAX =  -14.936258 YAVE =  -14.936258
    ZMIN =   26.374668 ZMAX =   26.374668 ZAVE =   26.374668
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-5.12992926"
Evaluating: -5.12992926+3.5
 Parameter: XMAX <- "-1.62992926"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-14.9362579"
Evaluating: -14.9362579+3.5
 Parameter: YMAX <- "-11.4362579"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "26.3746684"
Evaluating: 26.3746684+3.5
 Parameter: ZMAX <- "29.8746684"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-5.12992926"
Evaluating: -5.12992926-3.5
 Parameter: XMIN <- "-8.62992926"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-14.9362579"
Evaluating: -14.9362579-3.5
 Parameter: YMIN <- "-18.4362579"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "26.3746684"
Evaluating: 26.3746684-3.5
 Parameter: ZMIN <- "22.8746684"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-1.62992926"
 Parameter: XMIN -> "-8.62992926"
 Parameter: YMAX -> "-11.4362579"
 Parameter: YMIN -> "-18.4362579"
 Parameter: ZMAX -> "29.8746684"
 Parameter: ZMIN -> "22.8746684"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "147"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "147" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "147"
Evaluating: 147
 Parameter: J <- "147"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "147" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "147"
 Parameter: NPOS -> "80"
Evaluating: 147-80
 Parameter: J <- "67"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "67"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.127573497"
Evaluating: (89.1533903-9.0)*(0.127573497-0.5)
 Parameter: XPOS <- "-29.8512469"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.204709231"
Evaluating: (89.1533903-9.0)*(0.204709231-0.5)
 Parameter: YPOS <- "-23.6685563"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.367079014"
Evaluating: (89.1533903-9.0)*(0.367079014-0.5)
 Parameter: ZPOS <- "-10.6540677"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "-29.8512469"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: -29.8512469-44.5766951
 Parameter: XTRAN <- "-74.427942"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-23.6685563"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -23.6685563-44.5766951
 Parameter: YTRAN <- "-68.2452514"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "-10.6540677"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: -10.6540677-44.5766951
 Parameter: ZTRAN <- "-55.2307628"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-74.427942"
 Parameter: YTRAN -> "-68.2452514"
 Parameter: ZTRAN -> "-55.2307628"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -74.427942  -68.245251  -55.230763
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.660328632"
Evaluating: 0.660328632*360.0
 Parameter: XPHI <- "237.718308"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.651041323"
Evaluating: 0.651041323*360.0
 Parameter: YPHI <- "234.374876"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.476965763"
Evaluating: 0.476965763*360.0
 Parameter: ZPHI <- "171.707675"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "-29.8512469"
 Parameter: YPOS -> "-23.6685563"
 Parameter: ZPOS -> "-10.6540677"
 Parameter: XPHI -> "237.718308"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000   -0.534082   -0.845433
    0.000000    0.845433   -0.534082

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS  122.28

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "-29.8512469"
 Parameter: YPOS -> "-23.6685563"
 Parameter: ZPOS -> "-10.6540677"
 Parameter: YPHI -> "234.374876"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.582479    0.000000    0.812845
    0.000000    1.000000    0.000000
   -0.812845    0.000000   -0.582479

 AXIS OF ROTATION IS  0.000000 -1.000000  0.000000  ANGLE IS  125.63

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "-29.8512469"
 Parameter: YPOS -> "-23.6685563"
 Parameter: ZPOS -> "-10.6540677"
 Parameter: ZPHI -> "171.707675"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.989545    0.144224    0.000000
   -0.144224   -0.989545    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS  171.71

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =  -29.851247 XMAX =  -29.851247 XAVE =  -29.851247
    YMIN =  -23.668556 YMAX =  -23.668556 YAVE =  -23.668556
    ZMIN =  -10.654068 ZMAX =  -10.654068 ZAVE =  -10.654068
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "-29.8512469"
Evaluating: -29.8512469+3.5
 Parameter: XMAX <- "-26.3512469"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-23.6685563"
Evaluating: -23.6685563+3.5
 Parameter: YMAX <- "-20.1685563"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "-10.6540677"
Evaluating: -10.6540677+3.5
 Parameter: ZMAX <- "-7.1540677"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "-29.8512469"
Evaluating: -29.8512469-3.5
 Parameter: XMIN <- "-33.3512469"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-23.6685563"
Evaluating: -23.6685563-3.5
 Parameter: YMIN <- "-27.1685563"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "-10.6540677"
Evaluating: -10.6540677-3.5
 Parameter: ZMIN <- "-14.1540677"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "-26.3512469"
 Parameter: XMIN -> "-33.3512469"
 Parameter: YMAX -> "-20.1685563"
 Parameter: YMIN -> "-27.1685563"
 Parameter: ZMAX -> "-7.1540677"
 Parameter: ZMIN -> "-14.1540677"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "148"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "148" and "148".
 IF test evaluated as true.  Performing command
  
 CHARMM>     
  
 CHARMM>            calc cntrand = @cntrand + 1
 Parameter: CNTRAND -> "0"
Evaluating: 0+1
 Parameter: CNTRAND <- "1"
  
 CHARMM>            if cntrand .gt. @cntmax stop ! ABNORMAL TERMINATION: ion placing may not work.. stop here
 Parameter: CNTMAX -> "100"
 Comparing "1" and "100".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            calc j = @i
 Parameter: I -> "148"
Evaluating: 148
 Parameter: J <- "148"
  
 CHARMM>            set ion = POS
 Parameter: ION <- "POS"
  
 CHARMM>     
  
 CHARMM>            if j .gt. @npos then
 Parameter: NPOS -> "80"
 Comparing "148" and "80".
 IF test evaluated as true.  Performing command
  
 CHARMM>               set ion = NEG
 Parameter: ION <- "NEG"
  
 CHARMM>               calc j  = @j - @npos
 Parameter: J -> "148"
 Parameter: NPOS -> "80"
Evaluating: 148-80
 Parameter: J <- "68"
  
 CHARMM>            endif
  
 CHARMM>     
  
 CHARMM>            define target select segid @ion .and. resid @j end
 Parameter: ION -> "NEG"
 Parameter: J -> "68"
 SELRPN>      1 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            calc xpos = ( @A - 9.0 ) * ( ?random - 0.5 )
 Parameter: A -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.58091103"
Evaluating: (89.1533903-9.0)*(0.58091103-0.5)
 Parameter: XPOS <- "6.48529337"
  
 CHARMM>            calc ypos = ( @B - 9.0 ) * ( ?random - 0.5 )
 Parameter: B -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.186616992"
Evaluating: (89.1533903-9.0)*(0.186616992-0.5)
 Parameter: YPOS <- "-25.1187106"
  
 CHARMM>            calc zpos = ( @C - 9.0 ) * ( ?random - 0.5 )
 Parameter: C -> "89.1533903"
 RDCMND substituted energy or value "?RANDOM" to "0.66241768"
Evaluating: (89.1533903-9.0)*(0.66241768-0.5)
 Parameter: ZPOS <- "13.0183277"
  
 CHARMM>     
  
 CHARMM>            ! move target to selected position
  
 CHARMM>            coor stat select target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =   44.576695 XMAX =   44.576695 XAVE =   44.576695
    YMIN =   44.576695 YMAX =   44.576695 YAVE =   44.576695
    ZMIN =   44.576695 ZMAX =   44.576695 ZAVE =   44.576695
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc xtran = @xpos - ?xave
 Parameter: XPOS -> "6.48529337"
 RDCMND substituted energy or value "?XAVE" to "44.5766951"
Evaluating: 6.48529337-44.5766951
 Parameter: XTRAN <- "-38.0914017"
  
 CHARMM>            calc ytran = @ypos - ?yave
 Parameter: YPOS -> "-25.1187106"
 RDCMND substituted energy or value "?YAVE" to "44.5766951"
Evaluating: -25.1187106-44.5766951
 Parameter: YTRAN <- "-69.6954057"
  
 CHARMM>            calc ztran = @zpos - ?zave
 Parameter: ZPOS -> "13.0183277"
 RDCMND substituted energy or value "?ZAVE" to "44.5766951"
Evaluating: 13.0183277-44.5766951
 Parameter: ZTRAN <- "-31.5583674"
  
 CHARMM>            coor trans xdir @xtran ydir @ytran zdir @ztran select target end
 Parameter: XTRAN -> "-38.0914017"
 Parameter: YTRAN -> "-69.6954057"
 Parameter: ZTRAN -> "-31.5583674"
 SELRPN>      1 atoms have been selected out of   9250
 TRANSLATION VECTOR   -38.091402  -69.695406  -31.558367
 SELECTED COORDINATES TRANSLATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! apply a random rotation along XYZ
  
 CHARMM>            calc xphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.852485992"
Evaluating: 0.852485992*360.0
 Parameter: XPHI <- "306.894957"
  
 CHARMM>            calc yphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.397143718"
Evaluating: 0.397143718*360.0
 Parameter: YPHI <- "142.971738"
  
 CHARMM>            calc zphi = ?random * 360.0
 RDCMND substituted energy or value "?RANDOM" to "0.192965858"
Evaluating: 0.192965858*360.0
 Parameter: ZPHI <- "69.4677089"
  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos xdir 1.0 -
 CHARMM>                phi @xphi select target end
 Parameter: XPOS -> "6.48529337"
 Parameter: YPOS -> "-25.1187106"
 Parameter: ZPOS -> "13.0183277"
 Parameter: XPHI -> "306.894957"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    1.000000    0.000000    0.000000
    0.000000    0.600350   -0.799738
    0.000000    0.799738    0.600350

 AXIS OF ROTATION IS -1.000000  0.000000  0.000000  ANGLE IS   53.11

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos ydir 1.0 -
 CHARMM>                phi @yphi select target end
 Parameter: XPOS -> "6.48529337"
 Parameter: YPOS -> "-25.1187106"
 Parameter: ZPOS -> "13.0183277"
 Parameter: YPHI -> "142.971738"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
   -0.798339    0.000000   -0.602209
    0.000000    1.000000    0.000000
    0.602209    0.000000   -0.798339

 AXIS OF ROTATION IS  0.000000  1.000000  0.000000  ANGLE IS  142.97

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>            coor rotate xcen @xpos ycen @ypos zcen @zpos zdir 1.0 -
 CHARMM>                phi @zphi select target end
 Parameter: XPOS -> "6.48529337"
 Parameter: YPOS -> "-25.1187106"
 Parameter: ZPOS -> "13.0183277"
 Parameter: ZPHI -> "69.4677089"
 SELRPN>      1 atoms have been selected out of   9250
 ROTATION MATRIX
    0.350735    0.936475    0.000000
   -0.936475    0.350735    0.000000
    0.000000    0.000000    1.000000

 AXIS OF ROTATION IS  0.000000  0.000000  1.000000  ANGLE IS   69.47

 SELECTED COORDINATES ROTATED IN THE MAIN SET.

  
 CHARMM>     
  
 CHARMM>            ! check if the ions are located within periodic component region(s)
  
 CHARMM>            if pbcztot .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            ! check if the ions are too close to solute
  
 CHARMM>            coor stat sele target end
 SELRPN>      1 atoms have been selected out of   9250
 STATISTICS FOR         1 SELECTED ATOMS:
    XMIN =    6.485293 XMAX =    6.485293 XAVE =    6.485293
    YMIN =  -25.118711 YMAX =  -25.118711 YAVE =  -25.118711
    ZMIN =   13.018328 ZMAX =   13.018328 ZAVE =   13.018328
    WMIN =   -1.000000 WMAX =   -1.000000 WAVE =   -1.000000
  
 CHARMM>            calc dcut = 3.5
Evaluating: 3.5
 Parameter: DCUT <- "3.5"
  
 CHARMM>            calc xmax = ?xmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMAX" to "6.48529336"
Evaluating: 6.48529336+3.5
 Parameter: XMAX <- "9.98529336"
  
 CHARMM>            calc ymax = ?ymax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMAX" to "-25.1187106"
Evaluating: -25.1187106+3.5
 Parameter: YMAX <- "-21.6187106"
  
 CHARMM>            calc zmax = ?zmax + @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMAX" to "13.0183277"
Evaluating: 13.0183277+3.5
 Parameter: ZMAX <- "16.5183277"
  
 CHARMM>            calc xmin = ?xmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?XMIN" to "6.48529336"
Evaluating: 6.48529336-3.5
 Parameter: XMIN <- "2.98529336"
  
 CHARMM>            calc ymin = ?ymin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?YMIN" to "-25.1187106"
Evaluating: -25.1187106-3.5
 Parameter: YMIN <- "-28.6187106"
  
 CHARMM>            calc zmin = ?zmin - @dcut
 Parameter: DCUT -> "3.5"
 RDCMND substituted energy or value "?ZMIN" to "13.0183277"
Evaluating: 13.0183277-3.5
 Parameter: ZMIN <- "9.5183277"
  
 CHARMM>     
  
 CHARMM>            define JUNK sele .not. target .and. -
 CHARMM>                             prop X .lt. @xmax .and. prop X .gt. @xmin .and. -
 CHARMM>                             prop Y .lt. @ymax .and. prop Y .gt. @ymin .and. -
 CHARMM>                             prop Z .lt. @zmax .and. prop Z .gt. @zmin  end
 Parameter: XMAX -> "9.98529336"
 Parameter: XMIN -> "2.98529336"
 Parameter: YMAX -> "-21.6187106"
 Parameter: YMIN -> "-28.6187106"
 Parameter: ZMAX -> "16.5183277"
 Parameter: ZMIN -> "9.5183277"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>     
  
 CHARMM>            if ?nsel .gt. 0 then
 RDCMND substituted energy or value "?NSEL" to "0"
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>            calc cntrand = 0
Evaluating: 0
 Parameter: CNTRAND <- "0"
  
 CHARMM>            increase i by 1
 Parameter: I <- "149"
  
 CHARMM>            if i .le. @nion goto doinit
 Parameter: NION -> "148"
 Comparing "149" and "148".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>        label continue
  
 CHARMM>     
  
 CHARMM>        update image inbf 0

 SELECTED IMAGES ATOMS BEING CENTERED ABOUT  0.000000  0.000000  0.000000

 <MKIMAT2>: updating the image atom lists and remapping
 Transformation   Atoms  Groups  Residues  Min-Distance
    1  N1N1N1R1 has       0       0       0        0.00
    2  N1Z0N1R1 has       0       0       0        0.00
    3  N1P1N1R1 has       0       0       0        2.21
    4  Z0N1N1R1 has       0       0       0        0.00
    5  Z0Z0N1R1 has     207      57      25        0.00
    6  Z0P1N1R1 has      39       9       3        0.00
    7  N1N1Z0R1 has       0       0       0        0.00
    8  N1Z0Z0R1 has      51      20      12        0.00
    9  N1P1Z0R1 has       4       1       1        1.42
   10  Z0N1Z0R1 has     390     113      44        0.00
   12  N1N1P1R1 has       0       0       0        0.00
   13  N1Z0P1R1 has       0       0       0        0.00
   14  N1P1P1R1 has       0       0       0       24.26
 Total of 9941 atoms and 3128 groups and  925 residues were included

 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 IMAGE
  
 CHARMM>        COOR CONVERT SYMMETRIC ALIGNED @A @B @C @alpha @beta @gamma
 Parameter: A -> "89.1533903"
 Parameter: B -> "89.1533903"
 Parameter: C -> "89.1533903"
 Parameter: ALPHA -> "90.0"
 Parameter: BETA -> "90.0"
 Parameter: GAMMA -> "90.0"
  
 CHARMM>        CRYSTAL FREE
  
 CHARMM>     
  
 CHARMM>     
  
 CHARMM>        ! get the number of @pos residues to reorder
  
 CHARMM>        define JUNK sele segid IONS .and. resname @pos end
 Parameter: POS -> "SOD"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natompos
 Parameter: NATOMS -> "0"
 Parameter: NATOMPOS -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr npos by @nresi
 Parameter: NRESI -> "0"
 Parameter: NPOS <- "80"
  
 CHARMM>     
  
 CHARMM>        ! join POS to @pos via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>     
  
 CHARMM>        ! get the number of @neg residues to reorder
  
 CHARMM>        define JUNK sele segid IONS .and. resname @neg end
 Parameter: NEG -> "CLA"
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>        set natoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NATOMS <- "0"
  
 CHARMM>        calc nresi = @natoms / @natomneg
 Parameter: NATOMS -> "0"
 Parameter: NATOMNEG -> "1"
Evaluating: 0/1
 Parameter: NRESI <- "0"
  
 CHARMM>        incr nneg by @nresi
 Parameter: NRESI -> "0"
 Parameter: NNEG <- "68"
  
 CHARMM>     
  
 CHARMM>        ! join NEG to @neg via reordering
  
 CHARMM>        if nresi .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            ! if POS was reordered, NEG may still need to be reordered
  
 CHARMM>            define POS sele segid POS end
 SELRPN>     80 atoms have been selected out of   9250
  
 CHARMM>            set posat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "9103"
 Parameter: POSAT <- "9103"
  
 CHARMM>     
  
 CHARMM>            define NEG sele segid NEG end
 SELRPN>     68 atoms have been selected out of   9250
  
 CHARMM>            set negat = ?selatom
 RDCMND substituted energy or value "?SELATOM" to "9183"
 Parameter: NEGAT <- "9183"
  
 CHARMM>     
  
 CHARMM>            if negat .eq. 0 goto skipreorder
 Comparing "9183" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>            if posat .gt. @negat then
 Parameter: NEGAT -> "9183"
 Comparing "9103" and "9183".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        label skipreorder
  
 CHARMM>     
  
 CHARMM>        !
  
 CHARMM>        ! join everything to IONS segment
  
 CHARMM>        !
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>      0 atoms have been selected out of   9250
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "0"
 Parameter: NIONATOMS <- "0"
  
 CHARMM>     
  
 CHARMM>        define POS sele segid POS end
 SELRPN>     80 atoms have been selected out of   9250
  
 CHARMM>        set nposatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "80"
 Parameter: NPOSATOMS <- "80"
  
 CHARMM>     
  
 CHARMM>        define NEG sele segid NEG end
 SELRPN>     68 atoms have been selected out of   9250
  
 CHARMM>        set nnegatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "68"
 Parameter: NNEGATOMS <- "68"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "0" and "0".
 IF test evaluated as false.  Skip to ELSE or ENDIF
  
 CHARMM>            rename segid IONS sele segid POS end
 SELRPN>     80 atoms have been selected out of   9250
 SEGMENT 'POS     ' IS RENAMED TO 'IONS    '
  
 CHARMM>        endif
  
 CHARMM>     
  
 CHARMM>        define IONS sele segid IONS end
 SELRPN>     80 atoms have been selected out of   9250
  
 CHARMM>        set nionatoms = ?nsel
 RDCMND substituted energy or value "?NSEL" to "80"
 Parameter: NIONATOMS <- "80"
  
 CHARMM>     
  
 CHARMM>        if nionatoms .gt. 0 then
 Comparing "80" and "0".
 IF test evaluated as true.  Performing command
  
 CHARMM>            if nnegatoms .gt. 0 join IONS NEG renumber
 Comparing "68" and "0".
 IF test evaluated as true.  Performing command
 SEGMENTS "IONS    " AND "NEG     " HAVE BEEN JOINED.
 THE RESIDUE IDENTIFIERS HAVE BEEN RENUMBERED
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        3   Number of residues   =      840
         Number of atoms         =     9250   Number of groups     =     2928
         Number of bonds         =     9164   Number of angles     =    16372
         Number of dihedrals     =    23604   Number of impropers  =     1870
         Number of cross-terms   =      688   Number of autogens   =        0
         Number of HB acceptors  =      913   Number of HB donors  =     1082
         Number of NB exclusions =        0   Total charge =   -0.00000
  
 CHARMM>        else
 Skip commands until next ENDIF
  
 CHARMM>     
  
 CHARMM>        incr ionind
 Parameter: IONIND <- "2"
  
 CHARMM>        if ionind le @niontypes goto do_ion
 Parameter: NIONTYPES -> "1"
 Comparing "2" and "1".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    crystal free
  
 CHARMM>     
  
 CHARMM>    open read unit 10 card name step3.4_ions_orient.crd
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step3.4_ions_orient.crd::
 OPNLGU> Unit 10 opened for READONLY access to step3.4_ions_orient.crd
  
 CHARMM>    read coor unit 10 card
          SPATIAL COORDINATES BEING READ FROM UNIT 10
 TITLE> * GENERATED BY CHARMM-GUI (HTTP://WWW.CHARMM-GUI.ORG) V3.7 ON JUN, 02. 2024. JOB
 TITLE> * GENERATES IONS
 TITLE> *  DATE:     6/ 2/24     13:17:22      CREATED BY USER: APACHE
 TITLE> *

 ** WARNING ** Coordinates were overwritten for  9102 atoms.
 *** LEVEL  2 WARNING *** BOMLEV IS    0
  
 CHARMM>     
  
 CHARMM>    open write unit 10 card name step3.4_ions.pdb
 OPNLGU> Unit already open. The old file will be closed first.
 VCLOSE: Closing unit   10 with status "KEEP"
 VOPEN> Attempting to open::step3.4_ions.pdb::
 OPNLGU> Unit 10 opened for WRITE access to step3.4_ions.pdb
  
 CHARMM>    write coor unit 10 pdb
 RDTITL> CLOSE UNIT 10
 RDTITL> No title read.
  Write CHARMM-pdb format
  
 CHARMM>    close unit 10
 VCLOSE: Closing unit   10 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    calc cgtotinit = ?cgtot
 RDCMND substituted energy or value "?CGTOT" to "-5.684341886E-14"
Evaluating: -5.684341886E-14
 Parameter: CGTOTINIT <- "-5.684341886E-14"
  
 CHARMM>    calc cgtot = int( ?cgtot )
 RDCMND substituted energy or value "?CGTOT" to "-5.684341886E-14"
Evaluating: INT(-5.684341886E-14)
 Parameter: CGTOT <- "0"
  
 CHARMM>    if cgtot .ne. 0 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "0" and "0".
 IF test evaluated as false.  Skipping command
  
 CHARMM>    calc cgdiff = abs(@cgtot - @cgtotinit)
 Parameter: CGTOT -> "0"
 Parameter: CGTOTINIT -> "-5.684341886E-14"
Evaluating: ABS(0--5.684341886E-14)
 Parameter: CGDIFF <- "5.684341886E-14"
  
 CHARMM>    if cgdiff .gt. 0.0001 stop ! ABNORMAL TERMINATION: failure to neutralize system
 Comparing "5.684341886E-14" and "0.0001".
 IF test evaluated as false.  Skipping command
  
 CHARMM>     
  
 CHARMM>    define target sele .not. segid IONS end
 SELRPN>   9102 atoms have been selected out of   9250
  
 CHARMM>    if ?nsel .gt. 0 delete atom sele target end
 RDCMND substituted energy or value "?NSEL" to "9102"
 Comparing "9102" and "0".
 IF test evaluated as true.  Performing command
 SELRPN>   9102 atoms have been selected out of   9250

 Message from MAPIC: Atom numbers are changed.

 Message from MAPIC:        692 residues deleted.

 Message from MAPIC:          2 segments deleted.
 DELTIC:      9164 bonds deleted
 DELTIC:     16372 angles deleted
 DELTIC:     23604 dihedrals deleted
 DELTIC:      1870 improper dihedrals deleted
 DELTIC:       688 crossterm maps deleted
 DELTIC:      1082 donors deleted
 DELTIC:       913 acceptors deleted
 PSFSUM> PSF modified: NONBOND lists and IMAGE atoms cleared.
 PSFSUM> Summary of the structure file counters :
         Number of segments      =        1   Number of residues   =      148
         Number of atoms         =      148   Number of groups     =      148
         Number of bonds         =        0   Number of angles     =        0
         Number of dihedrals     =        0   Number of impropers  =        0
         Number of cross-terms   =        0   Number of autogens   =        0
         Number of HB acceptors  =        0   Number of HB donors  =        0
         Number of NB exclusions =        0   Total charge =   12.00000
  
 CHARMM>     
  
 CHARMM>    write title card name step3.4_ions.str
 VOPEN> Attempting to open::step3.4_ions.str::
 RDTITL> * SET NIONTYPES = 1
 RDTITL> * SET NPOSTOT = 80
 RDTITL> * SET NNEGTOT = 68
 RDTITL> * SET NIONTOT = 148
 RDTITL> *
 VCLOSE: Closing unit   90 with status "KEEP"
 **** Warning ****  The following extraneous characters
 were found while command processing in CHARMM
 CARD
  
 CHARMM>     
  
 CHARMM>    !
 CHARMM>    ! Write CHARMM commands to regenerate ion part of PSF
 CHARMM>    !
 CHARMM>     
  
 CHARMM>    set dojoin = no
 Parameter: DOJOIN <- "NO"
  
 CHARMM>     
  
 CHARMM>    bomlev 2 ! force error if no atoms written
  
 CHARMM>     
  
 CHARMM>    write psf  card name step3.4_ions.psf
 VOPEN> Attempting to open::step3.4_ions.psf::
 RDTITL> WRITE COOR CARD NAME STEP3.4_IONS.CRD
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>    write coor card name step3.4_ions.crd
 VOPEN> Attempting to open::step3.4_ions.crd::
 RDTITL>  
 RDTITL> No title read.
 VCLOSE: Closing unit   90 with status "KEEP"
 VCLOSE: Closing unit   90 with status "KEEP"
  
 CHARMM>     
  
 CHARMM>    stop
 VCLOSE: Closing unit   20 with status "KEEP"
$$$$$$  New timer profile $$$$$
 Total time                     18.01 Other:            0.00

                    NORMAL TERMINATION BY NORMAL STOP
                    MOST SEVERE WARNING WAS AT LEVEL  1

                    $$$$$ JOB ACCOUNTING INFORMATION $$$$$
                     ELAPSED TIME:    18.01  SECONDS 
                         CPU TIME:    12.76  SECONDS 
